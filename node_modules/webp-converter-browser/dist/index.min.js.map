{"version":3,"file":"index.min.js","sources":["../src/index.ts"],"sourcesContent":["interface Options {\n  quality?: number\n  width?: number\n  height?: number\n}\n\nconst DEFAULT_QUALITY = 0.75;\n\n/**\n * When it cause CORS, you may failed to use\n */\nexport function srcToWebP(\n  src: string,\n  { quality, width, height }: Options = {},\n): Promise<Blob> {\n  return new Promise((resolve, reject) => {\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n    const image = new Image();\n    image.src = src;\n    image.crossOrigin = 'anonymous';\n    image.onload = (e) => {\n      canvas.width = width || image.width;\n      canvas.height = height || image.height;\n      // @ts-ignore\n      URL.revokeObjectURL(e.target.src);\n      // @ts-ignore\n      context.drawImage(e.target, 0, 0, canvas.width, canvas.height);\n      canvas.toBlob((data) => {\n        resolve(data as Blob);\n      }, 'image/webp', quality || DEFAULT_QUALITY);\n    };\n    image.onerror = (e) => reject(e);\n  });\n}\n\nexport function blobToWebP(\n  data: Blob,\n  { quality, width, height }: Options = {},\n): Promise<Blob> {\n  return srcToWebP(URL.createObjectURL(data), { quality, width, height });\n}\n\nexport function arrayBufferToWebP(\n  data: ArrayBuffer,\n  { quality, width, height }: Options = {},\n): Promise<Blob> {\n  return blobToWebP(new Blob([data]), { quality, width, height });\n}\n"],"names":["srcToWebP","src","quality","width","height","Promise","resolve","reject","canvas","document","createElement","context","getContext","image","Image","crossOrigin","onload","e","URL","revokeObjectURL","target","drawImage","toBlob","data","onerror","blobToWebP","createObjectURL","Blob"],"mappings":"4PAWO,SAASA,EACdC,GACEC,QAAAA,EAASC,MAAAA,EAAOC,OAAAA,GAAoB,IAEtC,OAAO,IAAIC,SAAQ,SAACC,EAASC,GAC3B,IAAMC,EAASC,SAASC,cAAc,UAChCC,EAAUH,EAAOI,WAAW,MAE5BC,EAAQ,IAAIC,MAClBD,EAAMZ,IAAMA,EACZY,EAAME,YAAc,YACpBF,EAAMG,OAAS,SAACC,GACdT,EAAOL,MAAQA,GAASU,EAAMV,MAC9BK,EAAOJ,OAASA,GAAUS,EAAMT,OAEhCc,IAAIC,gBAAgBF,EAAEG,OAAOnB,KAE7BU,EAAQU,UAAUJ,EAAEG,OAAQ,EAAG,EAAGZ,EAAOL,MAAOK,EAAOJ,QACvDI,EAAOc,QAAO,SAACC,GACbjB,EAAQiB,EACV,GAAG,aAAcrB,GAzBC,MA2BpBW,EAAMW,QAAU,SAACP,GAAC,OAAKV,EAAOU,EAAE,CAClC,GACF,CAEO,SAASQ,EACdF,GACErB,QAAAA,EAASC,MAAAA,EAAOC,OAAAA,GAAoB,IAEtC,OAAOJ,EAAUkB,IAAIQ,gBAAgBH,GAAO,CAAErB,QAAAA,EAASC,MAAAA,EAAOC,OAAAA,GAChE,qBAEO,SACLmB,GACErB,QAAAA,EAASC,MAAAA,EAAOC,OAAAA,GAAoB,IAEtC,OAAOqB,EAAW,IAAIE,KAAK,CAACJ,IAAQ,CAAErB,QAAAA,EAASC,MAAAA,EAAOC,OAAAA,GACxD"}
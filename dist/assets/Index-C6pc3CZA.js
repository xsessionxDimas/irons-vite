import{u as yt}from"./vuex-BbOKrtVp.js";import{a as Ft}from"./breadcrumb-BYmEOf4C.js";import{c as $,a as ot,J as Y,I as it,z as J,A as Lt}from"./index-BuVmIl8K.js";import{P as pt}from"./Pagination-D-xfdYmn.js";import{F as wt}from"./FilterIconButton-Bj0WTbms.js";import{h as qt,A as Tt,U as Pt}from"./excel-generator-DMHRo93s.js";import{D as Ct}from"./DownloadIconButton-CIQp-YG7.js";import{_,b as ht}from"./element-plus-BeWdvTRa.js";import{q as P,w as R,x as M,y as kt}from"./date-format-8-IvfSl3.js";import{P as W}from"./Pagination-BiobnanQ.js";import{C as Dt,L as Ut,E as It,U as xt,B as $t,a as At}from"./urls-BkQ91qOg.js";import{d as nt}from"./pinia-BjOS2_Ao.js";import{a as Ot,m as Bt}from"./mapOption-CeGMwmH0.js";import{L as Rt}from"./urls-CWQmf-Uk.js";import{k as B,bL as Vt,r as K,u as r,y as z,p as w,aa as X,q as k,x as m,Y as et,R as I,s as a,aB as n,C as O,a0 as at,c as C,o as gt,B as U,A as st,T as bt,bd as Ht,bb as Mt,a7 as zt,L as jt,F as Kt}from"./@vue-BypzYtbH.js";import{a as Gt,d as Qt}from"./table-sort-Bpdq_Uwn.js";import{_ as V}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{_ as Z}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CCwjwK39.js";import{a as vt}from"./vee-validate-C_msoaAA.js";import{c as ft,a as H,b as tt,d as Et}from"./yup-C6P98bvY.js";import"./property-expr-DEi1ZLzV.js";import{E as St}from"./ErrorAlert-CMKGfwAi.js";import{_ as _t}from"./AutoComplete.vue_vue_type_script_setup_true_lang-DJ43pGTI.js";import{e as Jt}from"./lodash-DrHMlsdo.js";import{_ as Xt}from"./FileDropZone.vue_vue_type_style_index_0_lang-C5PyimC7.js";import{m as Yt}from"./map-anything-abi6NY2Z.js";import{_ as Wt}from"./nw-img-vue-CR837WER.js";import{_ as rt}from"./AutoComplete.vue_vue_type_style_index_0_lang-DrAAOf71.js";import{_ as mt}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CJ7rJST9.js";import{F as Zt}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./useMenuStore-CD5Gmvif.js";import"./PageEnum-DUtfSNQS.js";import"./xlsx-C4maHrMm.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-NSxIV7Fb.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";const lt=nt({id:"equipmentNumberList",state:()=>({stateFilterData:{EquipmentNumber:"",Level:"",SerialNumber:"",EquipmentNumberTo:"",LevelTo:"",SerialNumberTo:"",StartDate:"",EndDate:"",StartDateTo:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},stateLastUsedFilterData:{EquipmentNumber:"",Level:"",SerialNumber:"",EquipmentNumberTo:"",LevelTo:"",SerialNumberTo:"",StartDate:"",EndDate:"",StartDateTo:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},statePageName:"equipmentNumber",stateDisplayData:[],statePagination:new W,stateLoading:!1,statePaginationLoading:!1,stateEquipmentNumberOption:[],stateEquipmentNumberDescOption:[],stateSerialNumberOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,equipmentNumberOption:t=>t.stateEquipmentNumberOption,equipmentNumberDescOption:t=>t.stateEquipmentNumberDescOption,SerialNumberOption:t=>t.stateSerialNumberOption},actions:{async getData(t=!0){const l={EquipmentNumber:this.stateFilterData.EquipmentNumber,Level:this.stateFilterData.Level,SerialNumber:this.stateFilterData.SerialNumber,EquipmentNumberTo:this.stateFilterData.EquipmentNumberTo,LevelTo:this.stateFilterData.LevelTo,SerialNumberTo:this.stateFilterData.SerialNumberTo,StartDate:this.stateFilterData.StartDate?P(this.stateFilterData.StartDate.toLocaleString()):"",EndDate:this.stateFilterData.EndDate?P(this.stateFilterData.EndDate.toLocaleString()):"",StartDateTo:this.stateFilterData.StartDateTo?P(this.stateFilterData.StartDateTo.toLocaleString()):"",EndDateTo:this.stateFilterData.EndDateTo?P(this.stateFilterData.EndDateTo.toLocaleString()):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await $.get(Dt,"",new URLSearchParams(l).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const l=await $.get(Ut,"",new URLSearchParams(t).toString());this.stateEquipmentNumberOption=Ot(l.data.result.content,"equipmentNumber","equipmentNumberDescription")}catch(l){console.log(l)}},async export(){const t={EquipmentNumber:this.stateFilterData.EquipmentNumber,Level:this.stateFilterData.Level,SerialNumber:this.stateFilterData.SerialNumber,EquipmentNumberTo:this.stateFilterData.EquipmentNumberTo,LevelTo:this.stateFilterData.LevelTo,SerialNumberTo:this.stateFilterData.SerialNumberTo,StartDate:this.stateFilterData.StartDate?P(this.stateFilterData.StartDate.toLocaleString()):"",EndDate:this.stateFilterData.EndDate?P(this.stateFilterData.EndDate.toLocaleString()):"",StartDateTo:this.stateFilterData.StartDateTo?P(this.stateFilterData.StartDateTo.toLocaleString()):"",EndDateTo:this.stateFilterData.EndDateTo?P(this.stateFilterData.EndDateTo.toLocaleString()):"",ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await $.getBlob(It,"",new URLSearchParams(t).toString())).data}catch(l){console.log(l)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:l}){if(!t&&!l)this.stateFilterData.Order="";else{const e=l=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setEquipmentNumber(t){this.stateFilterData.EquipmentNumber=t},setLevel(t){this.stateFilterData.Level=t},setSerialNumber(t){this.stateFilterData.SerialNumber=t},setEquipmentNumberTo(t){this.stateFilterData.EquipmentNumberTo=t},setLevelTo(t){this.stateFilterData.LevelTo=t},setSerialNumberTo(t){this.stateFilterData.SerialNumberTo=t},setStartDate(t){this.stateFilterData.StartDate=t},setStartDateTo(t){this.stateFilterData.StartDateTo=t},setEndDate(t){this.stateFilterData.EndDate=t},setEndDateTo(t){this.stateFilterData.EndDateTo=t},async resetFilter(){this.stateFilterData.EquipmentNumber="",this.stateFilterData.Level="",this.stateFilterData.SerialNumber="",this.stateFilterData.EquipmentNumberTo="",this.stateFilterData.LevelTo="",this.stateFilterData.SerialNumberTo="",this.stateFilterData.StartDate="",this.stateFilterData.EndDate="",this.stateFilterData.StartDateTo="",this.stateFilterData.EndDateTo="";const t=this.stateLastUsedFilterData.EquipmentNumber!=="",l=this.stateLastUsedFilterData.Level!=="",e=this.stateLastUsedFilterData.SerialNumber!=="",f=this.stateLastUsedFilterData.EquipmentNumberTo!=="",o=this.stateLastUsedFilterData.LevelTo!=="",u=this.stateLastUsedFilterData.SerialNumberTo!=="",b=this.stateLastUsedFilterData.StartDate!=="",s=this.stateLastUsedFilterData.EndDate!=="",g=this.stateLastUsedFilterData.StartDateTo!=="",v=this.stateLastUsedFilterData.EndDateTo!=="";(t||l||e||f||o||u||b||s||g||v)&&await this.getData()},resetState(){this.stateFilterData={EquipmentNumber:"",Level:"",SerialNumber:"",EquipmentNumberTo:"",LevelTo:"",SerialNumberTo:"",StartDate:"",EndDate:"",StartDateTo:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},this.stateDisplayData=[],this.statePagination=new W,this.stateLoading=!1,this.statePaginationLoading=!1}}}),ct={EquipmentNumberId:0,EquipmentNumber:"",EquipmentNumberDescription:"",SerialNumber:"",Level:"",StartDate:R(new Date),EndDate:R(new Date("12/31/9999"))},G=nt({id:"equipmentNumberForm",state:()=>({stateFormData:{...ct},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1,stateLevelDescOption:[]}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading,levelDescOption:t=>t.stateLevelDescOption},actions:{async insertData(t){this.stateFormData.StartDate=P(R(new Date(this.stateFormData.StartDate))),this.stateFormData.EndDate=P(R(new Date(this.stateFormData.EndDate)));try{this.stateLoading=!0;const l={userAccount:t,ver:"v1"},e=await $.post(`${Dt}?${new URLSearchParams(l).toString()}`,this.stateFormData);e.data.title==="Error"?(this.stateErrors.push(e.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(l){this.stateError=l,this.stateErrors.push(l.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){this.stateFormData.StartDate=P(R(new Date(this.stateFormData.StartDate))),this.stateFormData.EndDate=P(R(new Date(this.stateFormData.EndDate)));try{this.stateLoading=!0;const l={userAccount:t,ver:"v1"},e=await $.post(`${xt}?${new URLSearchParams(l).toString()}`,this.stateFormData);e.data.title==="Error"?(this.stateErrors.push(e.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(l){this.stateError=l,this.stateErrors.push(l.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.EquipmentNumberId=t.equipmentNumberId||0,this.stateFormData.EquipmentNumber=t.equipmentNumber||"",this.stateFormData.EquipmentNumberDescription=t.equipmentNumberDescription||"",this.stateFormData.SerialNumber=t.serialNumber||"",this.stateFormData.Level=t.level||"",this.stateFormData.StartDate=t.startDate||"",this.stateFormData.EndDate=t.endDate||""},resetState(){this.stateFormData={...ct},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1},async getLevelLookup(){const t={ver:"v1"};try{const l=await $.get(Rt,"",new URLSearchParams(t).toString());this.stateLevelDescOption=Bt(l.data.result.content.level)}catch(l){console.log(l)}}}}),te={key:0,style:{height:"100px"}},ee={key:0,class:"row justify-content-center"},ae={key:1,class:"row justify-content-center"},se={class:"row justify-content-center"},re=["onClick"],oe=B({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:l}){const e=t,f=lt(),o=G(),u=l,b=Vt(()=>(e.page-1)*10+1),s=K(""),g=E=>{s.value=E.order;const N={prop:E.prop,order:E.order};f.setSort(N)},v=(E,N,S)=>Gt(E[S],N[S],s.value),F=E=>{o.setFormData(E),u("show-dialog",null)};return(E,N)=>{const S=I("inline-svg"),T=I("el-tooltip"),q=et("loading");return r(f).loading?z((w(),X("div",te,null,512)),[[q,r(f).loading]]):z((w(),k(r(ht),{key:1,data:e.listData,style:{width:"100%"},onSortChange:g,"empty-text":"No Data"},{default:m(()=>[a(r(_),{label:"No",width:"90",align:"center"},{default:m(i=>[n("span",null,O(r(b)+i.$index),1)]),_:1}),a(r(_),{prop:"equipmentNumber",label:"Equipment Number",width:"170",sortable:"","sort-method":(i,c)=>v(i,c,"equipmentNumber")},null,8,["sort-method"]),a(r(_),{prop:"equipmentNumberDescription",label:"Description","min-width":"210",sortable:"","sort-method":(i,c)=>v(i,c,"equipmentNumberDescription")},null,8,["sort-method"]),a(r(_),{prop:"serialNumber",label:"Serial Number",width:"200",sortable:"","sort-method":(i,c)=>v(i,c,"serialNumber")},null,8,["sort-method"]),a(r(_),{prop:"level",label:"Level",width:"120",sortable:"","sort-method":(i,c)=>v(i,c,"level")},null,8,["sort-method"]),a(r(_),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:m(i=>[n("span",null,O(r(M)(i.row.startDate)),1)]),_:1}),a(r(_),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:m(i=>[n("span",null,O(r(M)(i.row.endDate)),1)]),_:1}),a(r(_),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:m(i=>[i.row.isActive?(w(),X("div",ee,[a(S,{src:"/media/svg/tables/rows/check.svg"})])):(w(),X("div",ae,[a(S,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),a(r(_),{prop:"changedOn",label:"Changed on",align:"center",width:"170",sortable:""},{default:m(i=>[n("span",null,O(r(kt)(i.row.changedOn)),1)]),_:1}),a(r(_),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(i,c)=>v(i,c,"changedBy")},null,8,["sort-method"]),a(r(_),{label:"",width:"80"},{default:m(i=>[n("div",se,[a(T,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:m(()=>[n("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:c=>F(i.row)},[a(S,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,re)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[q,r(f).loading]])}}}),ie={class:"col-md-6 fv-row fv-plugins-icon-container"},ne={class:"col-md-6 fv-row fv-plugins-icon-container"},le={class:"col-md-6 fv-row fv-plugins-icon-container"},ue={class:"col-md-6 fv-row fv-plugins-icon-container"},de={class:"col-md-6 fv-row fv-plugins-icon-container"},me={class:"col-md-6 fv-row fv-plugins-icon-container"},ce={class:"dialog-footer"},pe=B({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:l}){const e=t,f=l,o=G(),u=ot(),b=at(e,"visibility"),s=C(()=>o.formData),g=C(()=>o.errors),v=C(()=>o.isError),F=C(()=>o.levelDescOption),E=ft().shape({EquipmentNumber:H().required("Equipment Number is mandatory"),EquipmentNumberDescription:H().required("Equipment Number Description is mandatory"),SerialNumber:H().required("Serial Number Description is mandatory"),StartDate:tt().required("Start Date is mandatory").typeError("Start Date is mandatory"),EndDate:tt().required("End Date is mandatory").min(Et("StartDate"),"End date must be later than start date").typeError("End date must be later than start date").typeError("End Date is mandatory")}),N=()=>{T(""),q(""),i(""),c(""),p(""),D("")},S=(d=!1)=>{h(),N(),o.resetState(),f("handle-close",d)},T=d=>{s.value.EquipmentNumber=d},q=d=>{s.value.EquipmentNumberDescription=d},i=d=>{s.value.SerialNumber=d},c=d=>{s.value.Level=d},p=d=>{s.value.StartDate=d},D=d=>{s.value.EndDate=d},y=async()=>{h(),await E.validate(s.value,{abortEarly:!1}).catch(d=>{o.setErrors(d.errors)}),!v.value&&Y("Are you sure you want to submit ?").then(async d=>{d.isConfirmed&&o.insertData(u.user.Name).then(()=>{o.isError||it("Form has been successfully submitted!","Ok").then(()=>{S(!0)})})})},h=()=>{o.setErrors([])};return gt(()=>{o.getLevelLookup()}),(d,L)=>{const x=I("el-button"),j=I("el-dialog"),A=et("loading");return z((w(),k(j,{modelValue:b.value,"onUpdate:modelValue":L[0]||(L[0]=Q=>b.value=Q),title:"New Data",width:"40%",onClose:L[1]||(L[1]=Q=>S())},{footer:m(()=>[n("span",ce,[a(x,{type:"primary",onClick:y,disabled:r(o).loading},{default:m(()=>[U("Submit")]),_:1},8,["disabled"]),a(x,{type:"secondary",onClick:S,disabled:r(o).loading},{default:m(()=>[U("Close")]),_:1},8,["disabled"])])]),default:m(()=>[a(bt,{name:"fade"},{default:m(()=>[v.value?(w(),k(St,{key:0,errorMessages:g.value,onResetForm:h},null,8,["errorMessages"])):st("",!0)]),_:1}),z((w(),k(r(vt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:m(()=>[n("div",ie,[a(V,{value:s.value.EquipmentNumber,margin:!1,placeholder:"Add Equipment Number",label:"Equipment Number",name:"EquipmentNumber",max:20,onHandleChange:T},null,8,["value"])]),n("div",ne,[a(V,{value:s.value.EquipmentNumberDescription,placeholder:"Add Equipment Number Description",label:"Description",name:"EquipmentNumberDescription",max:40,onHandleChange:q},null,8,["value"])]),n("div",le,[a(V,{value:s.value.SerialNumber,placeholder:"Add Serial Number",label:"Serial Number",name:"SerialNumber",max:20,onHandleChange:i},null,8,["value"])]),n("div",ue,[a(_t,{value:s.value.Level,label:"Level",name:"Level",placeholder:"Add Level",options:F.value,onHandleChange:c},null,8,["value","options"])]),n("div",de,[a(Z,{value:s.value.StartDate?s.value.StartDate.toString():"",placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:p},null,8,["value"])]),n("div",me,[a(Z,{value:s.value.EndDate?s.value.EndDate.toString():"",placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:D},null,8,["value"])])]),_:1})),[[A,r(o).loading]])]),_:1},8,["modelValue"])),[[A,r(o).loading]])}}}),he={class:"col-md-6 fv-row fv-plugins-icon-container"},De={class:"col-md-6 fv-row fv-plugins-icon-container"},ge={class:"col-md-6 fv-row fv-plugins-icon-container"},be={class:"col-md-6 fv-row fv-plugins-icon-container"},ve={class:"col-md-6 fv-row fv-plugins-icon-container"},fe={class:"col-md-6 fv-row fv-plugins-icon-container"},Ee={class:"dialog-footer"},Se=B({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:l}){const e=t,f=l,o=G(),u=ot(),b=at(e,"visibility"),s=C(()=>o.formData),g=C(()=>o.errors),v=C(()=>o.isError),F=C(()=>o.levelDescOption),E=ft().shape({EquipmentNumber:H().required("Equipment Number is mandatory"),EquipmentNumberDescription:H().required("Equipment Number Description is mandatory"),SerialNumber:H().required("Serial Number Description is mandatory"),StartDate:tt().required("Start Date is mandatory").typeError("Start Date is mandatory"),EndDate:tt().required("End Date is mandatory").min(Et("StartDate"),"End date must be later than start date").typeError("End date must be later than start date").typeError("End Date is mandatory")}),N=()=>{s.value.EquipmentNumberId=0,T(""),i(""),q(""),c(""),p("")},S=()=>{N(),y(),o.resetState(),f("handle-close",!1)},T=h=>{s.value.EquipmentNumberDescription=h},q=h=>{s.value.Level=h},i=h=>{s.value.SerialNumber=h},c=h=>{s.value.StartDate=h},p=h=>{s.value.EndDate=h},D=async()=>{y(),await E.validate(s.value,{abortEarly:!1}).catch(h=>{o.setErrors(h.errors)}),!v.value&&Y("Are you sure you want to submit ?").then(async h=>{h.isConfirmed&&o.updateData(u.user.Name).then(()=>{it("Form has been successfully submitted!","Ok").then(()=>{N(),y(),f("handle-close",!0)})})})},y=()=>{o.setErrors([])};return gt(()=>{o.getLevelLookup()}),(h,d)=>{const L=I("el-button"),x=I("el-dialog"),j=et("loading");return z((w(),k(x,{modelValue:b.value,"onUpdate:modelValue":d[0]||(d[0]=A=>b.value=A),title:"Update Data",width:"40%",onClose:d[1]||(d[1]=A=>S())},{footer:m(()=>[n("span",Ee,[a(L,{type:"primary",onClick:D,disabled:r(o).loading},{default:m(()=>[U("Submit")]),_:1},8,["disabled"]),a(L,{type:"secondary",onClick:S,disabled:r(o).loading},{default:m(()=>[U("Close")]),_:1},8,["disabled"])])]),default:m(()=>[a(bt,{name:"fade"},{default:m(()=>[v.value?(w(),k(St,{key:0,errorMessages:g.value,onResetForm:y},null,8,["errorMessages"])):st("",!0)]),_:1}),a(r(vt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:m(()=>[n("div",he,[a(V,{value:s.value.EquipmentNumber,margin:!1,placeholder:"Add Equipment Number",label:"Equipment Number",name:"EquipmentNumber",max:20,disabled:!0},null,8,["value"])]),n("div",De,[a(V,{value:s.value.EquipmentNumberDescription,placeholder:"Add Equipment Number Description",label:"Description",name:"EquipmentNumberDescription",max:40,onHandleChange:T},null,8,["value"])]),n("div",ge,[a(V,{value:s.value.SerialNumber,placeholder:"Add Serial Number",label:"Serial Number",name:"SerialNumber",max:20,onHandleChange:i},null,8,["value"])]),n("div",be,[a(_t,{value:s.value.Level,label:"Level",name:"Level",placeholder:"Add Level",options:F.value,onHandleChange:q},null,8,["value","options"])]),n("div",ve,[a(Z,{value:s.value.StartDate?s.value.StartDate.toString():"",placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:c},null,8,["value"])]),n("div",fe,[a(Z,{value:s.value.EndDate?s.value.EndDate.toString():"",placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:p},null,8,["value"])])]),_:1})]),_:1},8,["modelValue"])),[[j,r(o).loading]])}}}),ut=nt({id:"equipmentNumberBulk",state:()=>({statePagination:new W,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const l={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const e=await $.post(`${$t}?${new URLSearchParams(l).toString()}`,this.stateBulkData);this.stateError=e.data.result.isError?e.data.result.message:"",this.stateIsError=e.data.result.isError}catch(e){console.log(e)}this.stateLoading=!1},async upload({userAccount:t,excelFile:l}){const e={userAccount:t,ver:"v1"},f=`${At}?${new URLSearchParams(e).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const o=await $.postImages(f,l);o.data.statusCode==200?o.data.result.isError?(this.stateIsError=!0,this.stateError=o.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=o.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=Jt.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=o.data.result.isError,this.stateError=o.data.result.message)}catch(o){console.log(o),this.stateIsError=!0,this.stateError=o.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(Qt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new W,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),_e={class:"icon"},Ne=B({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const l=t,e=ut(),f=C(()=>(l.page-1)*10+1),o=u=>{const b={prop:u.prop,order:u.order};e.setSort(b)};return(u,b)=>{const s=I("inline-svg");return w(),k(r(ht),{data:l.listData,style:{width:"100%"},onSortChange:o,"empty-text":"No Data"},{default:m(()=>[a(r(_),{label:"No",width:"60",align:"center"},{default:m(g=>[n("span",null,O(f.value+g.$index),1)]),_:1}),a(r(_),{prop:"equipmentNumber",label:"Equipment Number",width:"200",sortable:""}),a(r(_),{prop:"equipmentNumberDescription",label:"Description",width:"200",sortable:""}),a(r(_),{prop:"serialNumber",label:"Serial Number",width:"200",sortable:""}),a(r(_),{prop:"level",label:"Level",width:"200",sortable:""}),a(r(_),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:m(g=>[n("span",null,O(r(M)(g.row.startDate)),1)]),_:1}),a(r(_),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:m(g=>[n("span",null,O(r(M)(g.row.endDate)),1)]),_:1}),a(r(_),{prop:"validationReason",label:"Remark","min-width":"300",sortable:""}),a(r(_),{prop:"isValid",label:"Status",width:"100",sortable:""},{default:m(g=>[n("div",_e,[a(s,{src:g.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),dt=t=>(Ht("data-v-130f795c"),t=t(),Mt(),t),ye=dt(()=>n("div",{class:"text-center"},null,-1)),Fe=dt(()=>n("div",{class:"mb-3"},[n("span",null,[U(" Download template "),n("a",{href:"documents/MasterDataEquipmentNumber.xlsx",target:"_blank",id:"link-download"},"here"),U(" before uploading file ")])],-1)),Le=dt(()=>n("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[n("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),we={class:"card"},qe={class:"card-body grid-padding"},Te={class:"dialog-footer"},Pe=B({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:l}){const e=t,f=l,o=ot(),u=ut(),b=at(e,"visibility"),s=()=>{const i=Yt(u.validatedData,c=>{const p=c;return{equipmentNumberId:0,equipmentNumber:p.equipmentNumber,level:p.level,equipmentNumberDescription:p.equipmentNumberDescription,serialNumber:p.serialNumber,startDate:p.startDate,endDate:p.endDate}});return Object.values(i)},g=()=>{const i=document.getElementById("link-download");i&&i.click()},v=()=>{u.validatedData.length>0?Y("Cancel Upload Data?","Confirm").then(c=>{c.isConfirmed&&E()}):E()},F=async i=>{await u.upload({userAccount:o.user.Name,excelFile:i}),u.stateError&&J(u.error)},E=(i=!1)=>{u.resetState(),f("handle-close",i)},N=i=>{u.setIsUploadedState(i)},S=i=>{u.setPage(i)},T=()=>{if(u.validatedData.length<1){g();return}const i=["EQUIPMENT NUMBER","EQUIPMENT NUMBER DESCRIPTION","SERIAL NUMBER","LEVEL","START DATE","END DATE","REMARK","STATUS"],c=u.validatedData.map(p=>({equipmentNumber:p.equipmentNumber,equipmentNumberDescription:p.equipmentNumberDescription,serialNumber:p.serialNumber,level:p.level,startDate:M(p.startDate),endDate:M(p.endDate),remark:p.validationReason,status:p.isValid?"OK":"Error"}));qt("EquipmentNumber",i,c)},q=async()=>{if(u.displayData.length<1){J("There is no data to submit");return}if(u.isError){J("There is still invalid row(s)");return}Y("Are you sure you want to submit ?").then(async i=>{if(i.isConfirmed){const c=s();if(u.setBulkData(c),await u.bulkInsert(o.user.Name),u.isError){J(u.stateError);return}it("Form has been successfully submitted!","Ok").then(()=>{E(!0)})}})};return(i,c)=>{const p=I("el-button"),D=I("el-dialog"),y=et("loading");return w(),k(D,{title:"Upload Bulk Data",modelValue:b.value,"onUpdate:modelValue":c[1]||(c[1]=h=>b.value=h),"before-close":v,width:"70%","custom-class":"upload-modal"},{footer:m(()=>[n("div",null,[n("span",Te,[a(p,{type:"success",onClick:T},{default:m(()=>[U("Download")]),_:1}),a(p,{type:"primary",onClick:q},{default:m(()=>[U("Upload")]),_:1}),a(p,{type:"success",onClick:v},{default:m(()=>[U("Cancel")]),_:1})])])]),default:m(()=>[ye,Fe,z(a(Xt,{isSubmissionUploadSuccess:r(u).isUploaded,onHandleCloseUploadedFile:v,onHandleUpload:F,onHandleSetIsExcelFileUploaded:N},null,8,["isSubmissionUploadSuccess"]),[[y,r(u).uploadLoading]]),Le,n("div",we,[n("div",qe,[a(Ne,{"list-data":r(u).displayData,page:r(u).pagination.currentPage},null,8,["list-data","page"])])]),r(u).displayData.length>0?(w(),k(pt,{key:0,onRaisePageChange:c[0]||(c[0]=h=>S(h)),currentPage:r(u).pagination.currentPage,totalPage:r(u).pagination.totalPage,totalPageSize:r(u).pagination.totalPageSize,startPaginationIndex:r(u).pagination.startPaginationIndex,endPaginationIndex:r(u).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):st("",!0)]),_:1},8,["modelValue"])}}}),Ce=Wt(Pe,[["__scopeId","data-v-130f795c"]]),ke={class:"row g-9 my-4"},Ue={class:"w-100 fv-row fv-plugins-icon-container"},Ie={class:"w-100 fv-row fv-plugins-icon-container"},xe={class:"w-100 fv-row fv-plugins-icon-container"},$e={class:"w-100 fv-row fv-plugins-icon-container"},Ae={class:"w-100 fv-row fv-plugins-icon-container"},Oe={class:"dialog-footer"},Be=B({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:l}){const e=lt(),f=G(),o=t,u=l,b=at(o,"visibility"),s=C(()=>e.filterData),g=()=>{v(),e.resetFilter()},v=()=>{u("handle-close",!1)},F=D=>{e.setEquipmentNumber(D)},E=D=>{e.setLevel(D)},N=D=>{e.setEquipmentNumberTo(D)},S=D=>{e.setLevelTo(D)},T=D=>{e.setStartDate(D)},q=D=>{e.setStartDateTo(D)},i=D=>{e.setEndDate(D)},c=D=>{e.setEndDateTo(D)},p=()=>{const D=e.lastUsedFilterData.EquipmentNumber!==e.filterData.EquipmentNumber,y=e.lastUsedFilterData.Level!==e.filterData.Level,h=e.lastUsedFilterData.SerialNumber!==e.filterData.SerialNumber,d=e.lastUsedFilterData.EquipmentNumberTo!==e.filterData.EquipmentNumberTo,L=e.lastUsedFilterData.LevelTo!==e.filterData.LevelTo,x=e.lastUsedFilterData.SerialNumberTo!==e.filterData.SerialNumberTo,j=e.lastUsedFilterData.StartDate!==e.filterData.StartDate,A=e.lastUsedFilterData.EndDate!==e.filterData.EndDate,Q=e.lastUsedFilterData.StartDateTo!==e.filterData.StartDateTo,Nt=e.lastUsedFilterData.EndDateTo!==e.filterData.EndDateTo;u("handle-close",D||y||h||d||L||x||j||A||Q||Nt)};return(D,y)=>{const h=I("el-button"),d=I("el-dialog");return w(),k(d,{modelValue:b.value,"onUpdate:modelValue":y[0]||(y[0]=L=>b.value=L),title:"Filter",width:"60%",onClose:y[1]||(y[1]=L=>v())},{footer:m(()=>[n("span",Oe,[a(h,{type:"secondary",onClick:g},{default:m(()=>[U("Reset")]),_:1}),a(h,{type:"primary",onClick:p},{default:m(()=>[U("Filter")]),_:1})])]),default:m(()=>[n("div",ke,[n("div",Ue,[a(rt,{"value-from":s.value.EquipmentNumber,"value-to":s.value.EquipmentNumberTo,label:"Equipment Number",name:"EquipmentNumber",options:r(e).equipmentNumberOption,onHandleChangeFrom:F,onHandleChangeTo:N},null,8,["value-from","value-to","options"])]),n("div",Ie,[a(rt,{"value-from":s.value.SerialNumber,"value-to":s.value.SerialNumberTo,label:"Serial Number",name:"SerialNumber",options:r(e).SerialNumberOption,onHandleChangeFrom:E,onHandleChangeTo:S},null,8,["value-from","value-to","options"])]),n("div",xe,[a(rt,{"value-from":s.value.Level,"value-to":s.value.LevelTo,label:"Level",name:"level",options:r(f).levelDescOption,onHandleChangeFrom:E,onHandleChangeTo:S},null,8,["value-from","value-to","options"])]),n("div",$e,[a(mt,{"value-from":s.value.StartDate,"value-to":s.value.StartDateTo,label:"Start Date",onHandleChangeFrom:T,onHandleChangeTo:q},null,8,["value-from","value-to"])]),n("div",Ae,[a(mt,{"value-from":s.value.EndDate,"value-to":s.value.EndDateTo,label:"End Date",onHandleChangeFrom:i,onHandleChangeTo:c},null,8,["value-from","value-to"])])])]),_:1},8,["modelValue"])}}}),Re={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},Ve=n("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),He={class:"d-flex justify-content-between align-items-center"},Me={class:"card"},ze={class:"card-body grid-padding"},je={class:"my-5"},is=B({__name:"Index",setup(t){const l=yt(),e=lt(),f=G(),o=ut(),u=K(!1),b=K(!1),s=K(!1),g=K(!1),v=C(()=>e.displayData),F=C(()=>e.pagination),E=d=>{e.setPage(d)};zt(async()=>{l[Lt.ACTIVE_PAGE]("IronLake"),Ft("Equipment Number",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Equipment",pageRoute:"equipmentnumber"},{pageName:"Equipment Number",pageRoute:"equipmentnumber"}]),e.setPage(1),await e.getLookup()}),jt(()=>{e.resetState(),f.resetState(),o.resetState()});const N=async()=>{await e.setPage(1),await e.getLookup()},S=()=>{u.value=!0},T=async d=>{u.value=!1,d&&await N()},q=()=>{b.value=!0},i=async d=>{b.value=!1,d&&await N()},c=()=>{s.value=!0},p=async d=>{s.value=!1,d&&await N()},D=async()=>{const d=await e.export();Zt.saveAs(new Blob([d],{type:"application/octet-stream"}),"Equipment Number.xlsx")},y=()=>{g.value=!0},h=async d=>{g.value=!1,d&&await N()};return(d,L)=>(w(),X(Kt,null,[n("div",Re,[Ve,n("div",He,[a(Tt,{onShowDialog:S}),a(wt,{onShowDialog:c}),a(Ct,{onHandleDownload:D}),a(Pt,{onShowDialog:y})])]),n("div",Me,[n("div",ze,[a(oe,{"list-data":v.value,page:F.value.currentPage,onShowDialog:q},null,8,["list-data","page"])])]),n("div",je,[r(e).paginationLoading?st("",!0):(w(),k(pt,{key:0,onRaisePageChange:L[0]||(L[0]=x=>E(x)),currentPage:F.value.currentPage,totalPage:F.value.totalPage,totalPageSize:F.value.totalPageSize,startPaginationIndex:F.value.startPaginationIndex,endPaginationIndex:F.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),a(pe,{visibility:u.value,onHandleClose:T},null,8,["visibility"]),a(Se,{visibility:b.value,onHandleClose:i},null,8,["visibility"]),a(Be,{visibility:s.value,onHandleClose:p},null,8,["visibility"]),a(Ce,{visibility:g.value,onHandleClose:h},null,8,["visibility"])],64))}});export{is as default};

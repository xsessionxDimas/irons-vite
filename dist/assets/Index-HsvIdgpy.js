import{k as Ue,r as f,c as i,d as be,p as d,aa as h,F as we,$ as tt,aB as l,b4 as $e,C as ue,A as E,a0 as Me,bL as Ye,a7 as gs,Y as rs,y as Nt,b6 as Se,u as J,R as ce,q as re,x as ee,s as R,B as Ee,K as Fa,_ as ns,bd as Yt,bb as zt,o as Mt,L as Ja,P as ha,a1 as Ya,z as _l,n as co,a5 as ss,a2 as cs,m as mo}from"./@vue-BypzYtbH.js";import{b as rt,a as Da,r as fo,o as fs,t as cl,c as za,q as La,s as wl,v as vo,m as Xa,u as po}from"./useEFormStore-DtkLPope.js";import{_ as xs}from"./InformationPopUp.vue_vue_type_style_index_0_lang-O2xYF9Pq.js";import{u as Os,c as Ma,L as yo,_ as go,a as bo,b as ko,D as ho,C as _o}from"./CrackForm-CAm6DVbX.js";import{u as ja}from"./useDefectsStore-j2gYF-8i.js";import{a as Xe,c as wo}from"./element-plus-BeWdvTRa.js";import{e as a,_ as Us}from"./lodash-DrHMlsdo.js";import{i as _e}from"./internet-connection-CnLQPjRt.js";import{I as Sl}from"./IronformConfig-BWypCgSI.js";import{c as So,_ as Cl}from"./Index-D5s2WKlG.js";import{_ as Ct}from"./nw-img-vue-CR837WER.js";import{u as Ls,d as Co,H as Ro,s as To}from"./useHistoricalStore-9gpJHRqR.js";import{u as wa,a as Rl}from"./@vueuse-DFoNmIyu.js";import{a as Jt,c as os,s as Is,f as na,i as Uo}from"./index-BuVmIl8K.js";import{b as Tl,g as Es,h as Fs,a as vs}from"./reference-file-C1vLEEpf.js";import{a as Ha,d as Qa}from"./manipulate-html-string-DqTEGh-F.js";import{C as je,s as $s,d as Ps,a as Ul,T as Ms,V as Io,e as ml,B as Il,S as ps}from"./prev-val-handler-DvA3D_kF.js";import{_ as Za,a as bs}from"./defect-CAkPobhd.js";import{u as $o,_ as Po,a as Do,V as Vo}from"./ViewOnlyNAReasonDialog-DR-Uz59p.js";import{u as Ds}from"./authentication-handler-Pueb_EI7.js";import{d as Bo}from"./pinia-BjOS2_Ao.js";import{u as qa}from"./useGlobalConnectionStore-DV9B81de.js";import{u as As}from"./usePreviewNaFormStore-C1MJT2RQ.js";import{i as Ft,A as Ua,g as ls,G as Ao,H as fl,p as No}from"./date-format-8-IvfSl3.js";import{S as Vs,m as ks,r as da,f as Pa}from"./number-format-BdMuQVyW.js";import{v as ys}from"./uuid-SoommWqA.js";import{u as ya}from"./useOfflineCameraStore-BBsMm6DV.js";import{_ as xo,c as Oo,g as Lo,h as Eo,d as Fo,D as vl,a as pl,C as yl,b as Mo,N as gl,e as jo}from"./DefectPanelGeneric-DsEuK-C7.js";import{u as is}from"./useMasterStore-CzSO06fn.js";import{p as us,H as Ho,l as js,M as Ko,o as Ga,a as Go,b as qo,t as $l,n as Wo,C as Jo,A as bl}from"./helpers-wUOLw-dU.js";import{_ as _a}from"./Textarea.vue_vue_type_style_index_0_lang-v94SEJmi.js";import{_ as Hs}from"./ToastWithIcon.vue_vue_type_style_index_0_lang-wfM94fOM.js";import{_ as ca}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{h as Pl,s as Yo,b as zo,i as Ns}from"./urls-CPQ2HRXU.js";import{_ as Wa}from"./ErrorBox.vue_vue_type_style_index_0_lang-Bysg_zE3.js";import{a as Dl}from"./UploadImageFailureDialog.vue_vue_type_style_index_0_lang-DVBJv3c1.js";import{s as yt,a as kl}from"./string-to-imageinfo-converter-Cdr1iOkP.js";import{_ as Vl}from"./FullScreenDialog.vue_vue_type_style_index_0_lang-DXRDt27h.js";import{S as hs,a as Bl}from"./ImageListModal.vue_vue_type_style_index_0_lang-djt6-PkA.js";import{S as Xo}from"./SelectSearchWithLabel-CWBDKtLo.js";import{_ as Ea}from"./GeneralDialog.vue_vue_type_style_index_0_lang-Bvj3I9QR.js";import{u as Al}from"./usePersonelLabourStore-BUmSURn2.js";import{_ as Nl,T as Qo,a as Zo,b as er}from"./ProcessingTimePopUp.vue_vue_type_style_index_0_lang-DeJTSv0v.js";import{S as xl}from"./SMUDetailDialog-Bs-98WGo.js";import{M as Bs}from"./MachineSMUEnum-CgiCo9nf.js";import{C as tr}from"./CameraIdEnum-C2Xl0HNE.js";import{b as ar}from"./RiskAssessment-Cp7incD6.js";import{_ as Ol}from"./Toast.vue_vue_type_style_index_0_lang-OOgaHWFE.js";import{u as sr}from"./usePreviewFormStore-q8XX1uYG.js";import{_ as lr,a as or,O as rr}from"./OfflineDialog.vue_vue_type_style_index_0_lang-BzWRyL8K.js";import{b as Ks,u as es}from"./useDefectsFormStore-41UTMhiG.js";import{P as nr,C as ir,a as ur}from"./CrackForm-CIiKEd4n.js";import{u as dr}from"./usePositionListStore-BsprGHwA.js";import{u as cr}from"./vue-router-iNp9kJ0K.js";import"./bootstrap-47JNjt8K.js";import{u as Ll,_ as mr}from"./Index.vue_vue_type_script_setup_true_lang-pbRyJFPY.js";import fr from"./Index-Ch5-tvyZ.js";import{D as vr}from"./cbm-helper-BxJZ9NTc.js";import{C as pr}from"./CommentPanel-D0ptrEBp.js";import{O as yr}from"./OnlineStatus-Bhk3CA8-.js";import{g as gr,f as br}from"./DefectPanelGeneric-BYVMPBe-.js";import{u as _s}from"./useCameraStore-BwXVJhPe.js";import{_ as kr}from"./ImagePreview.vue_vue_type_style_index_0_lang-DrcOCjy4.js";import{_ as hr}from"./Check-CTArJpdm.js";import{_ as ms}from"./InformationPopUpSideButton.vue_vue_type_style_index_0_lang-BO5OquVj.js";import{u as _r}from"./useDefectSheetStore-85RM-z1z.js";import"./list-pcxkCnQg.js";import"./urls-B0Rq9QQ3.js";import"./urls-CvqtYZA-.js";import"./methods-bliey5hF.js";import"./useAttachmentStore-CPMOf2aR.js";import"./CrackYesClass-COntz77m.js";import"./urls-hWHEBXep.js";import"./urls-D8F5Tyyp.js";import"./disabled-state-O9W-ZY8y.js";import"./Repair-zyV2di4A.js";import"./NAForm-BdrJ0TGj.js";import"./MessageBox.vue_vue_type_style_index_0_lang-DfpcTVNJ.js";import"./image-close-button-red-B1UxWyBV.js";import"./OfflineFullScreenDialog.vue_vue_type_style_index_0_lang-C2GTRJsq.js";import"./pdf-DNpyvVEz.js";import"./PDFViewerDialog.vue_vue_type_style_index_0_lang-DqiQYePb.js";import"./useAttachmentStore-DqM3autD.js";import"./CrackNoClass-0DSU7BAn.js";import"./dayjs-D0x2Df_K.js";import"./@popperjs-BaMZbQYT.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./@azure-DwL0pga8.js";import"./useDefectsStore-7BpSnT1n.js";import"./DefectNoClass-BqGKOkzR.js";import"./ImagePreviewCabSide-CpYtX9kF.js";import"./BackNavigator-DUE8rWVW.js";import"./usePreviewDefectFormStore-CVtftEdK.js";import"./Index.vue_vue_type_script_setup_true_lang-BKnCIuZK.js";import"./PDFViewerDialog.vue_vue_type_style_index_0_lang-GWz8s3FD.js";import"./object-path-DPahbflh.js";import"./deepmerge-oeePEK50.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./moment-C5S46NFB.js";import"./document_download-C1p7j0nJ.js";import"./ImagePreviews.vue_vue_type_style_index_0_lang-BJGkhvcB.js";import"./webp-converter-browser-C3MD88Lp.js";import"./compressorjs-Cmz8Y9J9.js";import"./file-saver-CwTBvle_.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";import"./green-checklist-BWMKprFt.js";import"./useHistoricalEformDmaStore-Fo4tKNgB.js";import"./manipulate-file-oif_A7gg.js";import"./@progress-DBKeVTWA.js";import"./vue-BzYgrL08.js";import"./pdf-merger-js-DY3-eECH.js";import"./pdf-lib-DrnT2QV2.js";import"./@pdf-lib-CXIx2D9y.js";import"./pako-Dx2kwFQn.js";import"./Pagination-BiobnanQ.js";import"./urls-DI_NR_TT.js";import"./mapOption-CeGMwmH0.js";import"./FormAlreadyOpenedByOtherSupervisor.vue_vue_type_style_index_0_lang-DkxhNkJR.js";import"./DefectForm-eu6l4STx.js";import"./helpers-BS1ZZpAr.js";import"./LargeCamera-BnWfLFAm.js";const wr={class:"d-flex justify-content-between"},Sr=["onClick"],Cr=["onClick"],Rr={key:0,class:"mb-0"},Tr={key:1,class:"mb-0"},Ur=Ue({__name:"GroupStepper",props:{groups:{type:Array,default(){return[]}}},setup(n){const s=rt(),e=ja(),o=Da(),t=f(),r=f("fa-chevron-up"),g=f(!0),u=f(Sl.enableSkipPreservice);let _=f(""),C=f(""),v=f({});const c=i(()=>s.selectedGroup),k=i(()=>o.generalUpdated),P=K=>{var D;if(K.totalTask<=0)return"";const X=K.groupName!=="General"&&K.groupName!=="DEFECT_IDENTIFIED_SERVICE",W=K.totalTask===K.doneTask,w=K.id===((D=c.value)==null?void 0:D.id);return X&&W?w?"done-task-selected":"done-task":""},B=i(()=>s.groups.find(K=>K.groupName=="PRE_SERVICE_OPERATIONAL_CHECK")),m=(K,X)=>{const W={groupId:K,group:X,selectedGroup:c.value,isUpdated:k.value,skipPreService:s.skipPreService,enableSkipPreservice:u.value,preServiceGroup:B.value};return So(W)},b=K=>!a.isUndefined(K.isDisable)&&K.isDisable==="true",S=K=>{if(!a.isUndefined(B.value)&&!a.isUndefined(B.value.doneTask)&&B.value.doneTask!==B.value.totalTask)return K.groupName!==B.value.groupName&&K.groupName!=="DEFECT_IDENTIFIED_SERVICE"&&K.groupName!=="General"},L=async(K,X,W)=>{if(_.value=K,C.value=X,v.value=W,!(!a.isUndefined(W.isDisable)&&W.isDisable=="true")&&!(!s.skipPreService&&S(W)&&u.value)&&!b(W)){t.value=Xe.service({lock:!0,text:"Loading E-Form",background:"rgba(0, 0, 0, 0.7)"});try{await s.setSelectedGroup(K),_e()?X=="DEFECT_IDENTIFIED_SERVICE"&&await e.getDefectFromLocalDB(s.generalForm.workOrder):(await s.getTaskProgress(),X=="DEFECT_IDENTIFIED_SERVICE"?await s.checkCurrentWoPendingOfflineTask()?await e.getDefectFromLocalDB(s.generalForm.workOrder):(await e.getDefectsData(s.generalForm.workOrder),await e.saveDefectServiceFormToLocalDB(s.generalForm.workOrder)):(await s.updateGroupByParam(X),await e.getDefectsData(s.generalForm.workOrder),H(),await e.saveDefectServiceFormToLocalDB(s.generalForm.workOrder)))}catch(w){console.error(w)}finally{t.value.close(),t.value=void 0}}},H=()=>{if(Object.keys(e.DefectSMUHeader).length>0){const K=e.stateData.DefectDetails.find(X=>X.defectHeaderId==e.DefectSMUHeader.id);s.generalForm.smu=K==null?void 0:K.detail.machineSMU,s.generalForm.imageEquipment=JSON.parse(K==null?void 0:K.detail.images)}},F=async K=>{var X;k.value&&(((X=s.selectedGroup)==null?void 0:X.groupName)!=K.groupName&&await L(K.id,K.groupName,K),!(!s.skipPreService&&S(K)&&u.value)&&(b(K)||K.totalTask!=K.doneTask&&s.handleScrollToUnfilledTask()))},x=()=>{g.value=!g.value,r.value=g.value?"fa-chevron-up":"fa-chevron-down"},p=i(()=>!_e());return be(p,async(K,X)=>{!K&&X&&t.value&&L(_.value,C.value,v.value)}),(K,X)=>(d(),h("div",wr,[(d(!0),h(we,null,tt(n.groups,(W,w)=>(d(),h("div",{key:W.id,class:$e(["d-flex flex-column m-1 mb-3 stepper-button",P(W)])},[l("div",{class:$e(["box-menu text-center p-2 d-flex justify-content-center align-items-center stepper-title",[m(W.id,W)]]),onClick:D=>L(W.id,W.groupName,W)},[l("span",null,ue(W.groupLabel),1)],10,Sr),g.value?(d(),h("div",{key:0,class:$e(["text-center box-pill rounded-pill mt-2 mb-4 stepper-button-info w-100 py-2 cursor-pointer",[w==0?"invisible":"",m(W.id,W)]]),onClick:D=>F(W)},[W.groupName=="DEFECT_IDENTIFIED_SERVICE"?(d(),h("p",Rr,"Found: "+ue(W.totalTask)+" item(s)",1)):(d(),h("p",Tr,"Done "+ue(W.doneTask)+"/"+ue(W.totalTask),1))],10,Cr)):E("",!0)],2))),128)),l("div",null,[l("button",{class:"border-0 mt-10 align-items-center",onClick:x,style:{background:"transparent"}},[l("em",{class:$e(["fa",r.value])},null,2)])])]))}}),Ir=Ct(Ur,[["__scopeId","data-v-b50f2566"]]),$r=["src"],El=Ue({__name:"Image",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(n){const s=n,e=f("/media/icons/bumaau/warning.png"),o=f(!0);wa();const t=Me(s,"item"),r=Ye(()=>!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col"),g=Ye(()=>{let c="";return s.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(c=`col-md-${t.value.style.potraitBreakPoint}`,c=`${c} col-lg-${t.value.style.breakPoint}`):(c=`col-md-${t.value.style.potraitBreakPoint}`,c=`${c} col-lg-${t.value.style.breakPoint}`)),c}),u=Ye(()=>{var w,D,U,I,z,oe,me;const c=!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; `:"",k=!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:"",P=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",B=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let m=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";const b=!a.isUndefined((w=s.task)==null?void 0:w.isShowReplacementRow)&&((D=s.task)==null?void 0:D.isShowReplacementRow),S=!a.isUndefined((U=s.task)==null?void 0:U.isShowAdjustmentRow)&&((I=s.task)==null?void 0:I.isShowAdjustmentRow),L=!a.isUndefined((z=s.task)==null?void 0:z.isShowCleanedRow)&&((oe=s.task)==null?void 0:oe.isShowCleanedRow);if(b||S||L||s.isShowAdjustment)m="";else{let M=0;(me=s.task)==null||me.items.forEach(te=>{var T;a.isUndefined(te.style)||(a.isUndefined(te.style.border)?a.isUndefined(te.style.border)&&(M=M+Number(te.style.breakPoint)):((te.style.border.right=="none"||a.isUndefined(te.style.border.right))&&(M=M+Number(te.style.breakPoint)),a.isEqual(te,a.last((T=s.task)==null?void 0:T.items))&&(M=M+Number(te.style.breakPoint))))}),M==12&&(m=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const F=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",x=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",p=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",K=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",X=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";let W="";return m&&(W="padding-bottom: 25px; "),`${W}${c}${k}${P}${B}${m}${F}${x}${p}${K}${X}`}),_=Ye(()=>!a.isUndefined(t.value.style)&&t.value.style.breakPoint=="1"?"width: 20px; height: 20px":""),C=rt();Jt(),gs(async()=>{try{const c=window.URL||window.webkitURL;if(_e())e.value=await vs(t.value.value);else{let k=!0;const P=await Tl(t.value.value);if(!a.isEmpty(P)&&P.createdDate){const B=new Date,m=P.createdDate;(B-m)/(1e3*60*60*24)<1&&(k=!1)}if(k){const B=await Es(t.value.value);e.value=c.createObjectURL(B),Fs(t.value.value,C.stateGeneralForm.workOrder,B)}else e.value=await vs(t.value.value)}o.value=!1}catch{o.value=!1}});const v=Ye(()=>{let c="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(c=""),c});return(c,k)=>{const P=rs("loading");return Nt((d(),h("div",{class:$e([[J(r),J(g),J(v)],"pt-2 px-2 d-flex d-flex justify-content-center"]),style:Se(J(u))},[l("img",{src:e.value,class:"img-fluid",style:Se(J(_))},null,12,$r)],6)),[[P,o.value]])}}}),Pr=["innerHTML"],Fl=Ue({__name:"Label",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object},isShowAdjustment:{type:Boolean}},setup(n){const s=n,e=Me(s,"item"),o=i(()=>{if(s.item.categoryItemType=="previousParamRating"&&!s.item.value)return"-";let c=s.item.categoryItemType==je.PREVIOUS_VALUE_PISTON_PERCENTAGE,k=s.item.value&&s.item.value!="-";return c&&k?`${Number(s.item.value)*100}%`:Ha(s.item.value)}),t=i(()=>{if(!s.item.categoryItemType)return"";const c=s.item.categoryItemType==je.PREVIOUS_VALUE_PISTON_A,k=s.item.categoryItemType==je.PREVIOUS_VALUE_PISTON_B,P=s.item.categoryItemType==je.PREVIOUS_VALUE_PISTON_RESULT,B=s.item.categoryItemType==je.PREVIOUS_VALUE_UOM,m=s.item.categoryItemType==je.PREVIOUS_VALUE_PISTON_PERCENTAGE,b=s.item.categoryItemType==je.PREVIOUS_PARAM_RATING;return c||k||P||B||m||b?"font-size: 10px;":""}),r=i(()=>{var c,k;return((c=s.task)==null?void 0:c.taskType)==="table"||((k=s.task)==null?void 0:k.taskType)==="collapsibleTable"?"col":s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""}),g=i(()=>{var k,P;if(((k=s.task)==null?void 0:k.taskType)==="table"||((P=s.task)==null?void 0:P.taskType)==="collapsibleTable")return"col";let c="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(c=`col-md-${e.value.style.potraitBreakPoint}`,c=`${c} col-lg-${e.value.style.breakPoint}`):(c=`col-md-${e.value.style.potraitBreakPoint}`,c=`${c} col-lg-${e.value.style.breakPoint}`)),c}),u=i(()=>a.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),_=i(()=>{var D,U,I,z,oe,me,M,te;const c=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",k=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",P=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",B=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"",m=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.padding)&&e.value.style.padding.right!="none"?`padding-right: ${e.value.style.padding.right} !important; `:"";let b=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";const S=!a.isUndefined((D=s.task)==null?void 0:D.isShowReplacementRow)&&((U=s.task)==null?void 0:U.isShowReplacementRow),L=!a.isUndefined((I=s.task)==null?void 0:I.isShowAdjustmentRow)&&((z=s.task)==null?void 0:z.isShowAdjustmentRow),H=!a.isUndefined((oe=s.task)==null?void 0:oe.isShowCleanedRow)&&((me=s.task)==null?void 0:me.isShowCleanedRow);if(S||L||H||s.isShowAdjustment)b="";else{let T=0;(M=s.task)==null||M.items.forEach($=>{var ae;a.isUndefined($.style)||(a.isUndefined($.style.border)?a.isUndefined($.style.border)&&(T=T+Number($.style.breakPoint)):(($.style.border.right=="none"||a.isUndefined($.style.border.right))&&(T=T+Number($.style.breakPoint)),a.isEqual($,a.last((ae=s.task)==null?void 0:ae.items))&&(T=T+Number($.style.breakPoint))))}),((te=s.task)==null?void 0:te.showParameter)=="suspensionCylinder"&&console.log("totalCol",T),T==12&&(b=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const x=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",p=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",K=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",X=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",W=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let w="";return b&&(w="padding-bottom: 25px; "),`${w}${c}${k}${P}${B}${b}${x}${p}${K}${X}${W}${m}`}),C=i(()=>`${!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.fontWeight)&&e.value.style.fontWeight!="normal"?`font-weight: ${e.value.style.fontWeight}; `:""}`),v=i(()=>{var k;const c=(k=s.task)==null?void 0:k.updatedBy;return c&&c.name?"":"pb-2"});return(c,k)=>(d(),h("div",{class:$e([[r.value,u.value,g.value,v.value],"px-2 pt-2"]),style:Se(_.value)},[!J(a.isUndefined)(n.item.style)&&n.item.style.visibility!="hidden"?(d(),h("label",{key:0,style:Se([{width:"100%"},[C.value,t.value]]),innerHTML:o.value},null,12,Pr)):E("",!0)],6))}}),ts=Bo({id:"offlineNa",state:()=>({stateLoading:!1,stateCancelled:!1,stateVisible:!1,stateViewVisible:!1,stateIsValid:!0,stateItemKey:"",stateReason:"",stateTitle:"",stateTask:{},statePayload:{updateParams:[]},stateItem:{},stateSuccessUpdateItemKey:"",stateUpdateSuccessFromNetworkError:!1}),getters:{Loading:n=>n.stateLoading,Cancelled:n=>n.stateCancelled,Reason:n=>n.stateReason,Visible:n=>n.stateVisible,ViewVisible:n=>n.stateViewVisible,ItemKey:n=>n.stateItemKey,isValid:n=>n.stateIsValid,selectedGroup:()=>rt().selectedGroup,selectedFitter:()=>rt().employee,onlineStatus:()=>wa(),supervisor:()=>{const n=Jt();return{id:n.user.EmployeeId,name:n.user.Name}},globalConnectionStore:()=>qa(),eformStore:()=>rt()},actions:{setItem(n){this.stateItem=n},setReason(n){this.stateReason=n},setCancelledState(n){this.stateCancelled=n},setItemKey(n){this.stateItemKey=n,this.stateSuccessUpdateItemKey=""},setTask(n){this.stateTask=n},toggleIsVisible(n){this.stateVisible=n,this.stateCancelled=!1},toggleIsViewVisible(n){this.stateViewVisible=n},createPayload(){const n=rt();this.statePayload.id=this.selectedGroup.id,this.statePayload.workorder=this.selectedGroup.workOrder,this.statePayload.headerId=this.selectedGroup.headerId,this.statePayload.updateParams=[];const s=ys(),e=ys();this.statePayload.updateParams.push({keyValue:this.stateTask.key,propertyParams:[{propertyName:"taskValue",propertyValue:this.stateTask.category==="NORMAL"||this.stateTask.category==="CBM"?"3":"4"},{propertyName:"updatedBy",propertyValue:JSON.stringify(this.selectedFitter)},{propertyName:"updatedDate",propertyValue:Ft()},{propertyName:"reason",propertyValue:""}]}),this.statePayload.updateParams.push({keyValue:this.ItemKey,propertyParams:[{propertyName:"value",propertyValue:this.stateTask.category==="NORMAL"||this.stateTask.category==="CBM"?"3":"4"},{propertyName:"updatedBy",propertyValue:JSON.stringify(this.eformStore.employee)},{propertyName:"updatedDate",propertyValue:Ft()}]}),this.statePayload.employee=this.selectedFitter,this.statePayload.defectHeader={workorder:n.generalForm.workOrder,form:this.selectedGroup.modelId,serviceSheetDetailId:this.selectedGroup.id,category:this.stateTask.category,taskId:this.stateTask.key,taskNo:this.stateTask.description!=""?this.stateTask.description.split(";")[0]:this.stateTask.items[0].value,taskDesc:this.stateTask.description!=""?this.stateTask.description:this.stateTask.items[1].value,defectWorkorder:"",formDefect:"DM-PL-F55",defectType:"",cbmMeasurement:"",cbmUom:"",cbmImageKey:"",cbmImageProp:"",isCbmAdjusment:"",taskValue:this.stateTask.category==="NORMAL"||this.stateTask.category==="CBM"?"3":"4",repairedStatus:"Not-Repaired",cbmNAStatus:"Not-Confirm",supervisor:this.supervisor,status:"Submited",defectStatus:"Submited",isActive:"true",defectHeaderId:s,defectDetailId:e},this.statePayload.defectDetail={type:"N/A",reason:this.Reason,title:this.stateTask.description!=""?this.stateTask.description:this.stateTask.items[1].value}},async createNA(){this.stateLoading=!0;const n={ver:"v1"};try{this.createPayload(),await this.updateNAToLocalDB(!1);const s=await os.post(`${fo}?${new URLSearchParams(n).toString()}`,this.statePayload);this.eformStore.updateLocalServiceSheetByParam(this.statePayload.updateParams),this.stateLoading=!1;const e=rt();switch(s.data.result.message){case Vs.TASK_UPDATED_BY_OTHER:return e.toggleTaskAlreadyUpdatedStatus(!0),!1;case Vs.SUBMITTED:return e.toggleFormAlreadySubmitted(!0),!1;case Vs.CLOSE:return e.toggleFormAlreadyClose(!0),!1;default:if(s.data.statusCode==400)return e.toogleTaskErrorDialog(!0),e.stateErrorMessageTaskErrorDialog=s.data.result.message,!1;break}return!0}catch(s){if($s("fe_event_error_service_form_post_na",{errorMessage:s}),this.globalConnectionStore.checkIsErrorNoNetwork(s))return this.eformStore.updateLocalServiceSheetByParam(this.statePayload.updateParams),this.eformStore.updateTaskProgressOnLocalDB2(),this.stateUpdateSuccessFromNetworkError=!0,!0;Ds(s),Is("IRONS",s),console.log(s)}},toggleUpdateSuccessFromNetworkError(n){this.stateUpdateSuccessFromNetworkError=n},async updateNAToLocalDB(n=!0){this.stateLoading=!0,this.createPayload();const s=a.clone(this.statePayload.defectHeader);delete s.supervisor,delete s.defectStatus;const e={...a.clone(s),defectData:JSON.stringify(this.statePayload.defectDetail),statusSync:_e()?"":"Sync",key:"",assetNumber:"",imageAvailable:!0,createdBy:a.clone(this.selectedFitter),createdDate:Ft(),updatedBy:a.clone(this.selectedFitter),updatedDate:Ft()};try{if(await na.serviceSheetDefect.add(e),n)return await fs(this.eformStore.stateGeneralForm.workOrder,this.ItemKey),await na.pendingTask.add({module:"serviceForm",section:"E-Form",type:"Defect",workorder:this.eformStore.generalForm.workOrder,key:this.stateTask.key,bindingKey:this.stateTask.key,payload:JSON.stringify(this.statePayload),syncDate:Ua(),itemKey:this.ItemKey,syncStatus:"Pending"}),this.eformStore.updateLocalServiceSheetByParam(this.statePayload.updateParams),this.eformStore.updateTaskProgressOnLocalDB2(),this.stateLoading=!1,!0}catch(o){return console.log("ðŸ˜£ðŸ˜£ error update na to local",o),this.stateLoading=!1,!1}},async getNADetailValue(n,s){this.stateLoading=!0;const e={ver:"v1"},o={servicesheetDetailId:n,taskId:s};try{let t;if(!_e())t=(await os.post(`${cl}?${new URLSearchParams(e).toString()}`,o)).data.result.content.detail;else{const r=await na.serviceSheetDefect.where({serviceSheetDetailId:n,taskId:s,isActive:"true"}).first();r&&(typeof r.defectData=="string"?t=JSON.parse(r.defectData):t=r.defectData)}return t}catch(t){$s("fe_event_error_service_form_get_na_detail",{errorMessage:t}),t.message.includes("Network Error")&&qa().setSubmitConnectionError(!0),Ds(t),Is("IRONS",t),console.log(t)}this.stateLoading=!1},async getNADetail(n,s){this.stateLoading=!0;const e={ver:"v1"},o={servicesheetDetailId:n,taskId:s};try{const r=(await os.post(`${cl}?${new URLSearchParams(e).toString()}`,o)).data.result.content.detail;As().setNAInfo(r),this.setReason(r.reason),this.stateTitle=r.title,this.stateLoading=!1,this.toggleIsViewVisible(!0)}catch(t){$s("fe_event_error_service_form_get_na_detail",{errorMessage:t}),t.message.includes("Network Error")&&qa().setSubmitConnectionError(!0),Ds(t),Is("IRONS",t),console.log(t)}this.stateLoading=!1},async getNAFromLocalDB(n){try{const s=await na.serviceSheetDefect.where({taskId:n,workorder:this.eformStore.stateGeneralForm.workOrder,isActive:"true"}).first();let e;typeof(s==null?void 0:s.defectData)=="string"?e=JSON.parse(s.defectData):e=s.defectData,console.log("detail",e),As().setNAInfo(e),this.setReason(e.reason),this.stateTitle=e.title,this.stateLoading=!1,this.toggleIsViewVisible(!0)}catch(s){console.log("OFFLINE - error when showing NA detail",s)}},setSuccesItem(n){this.stateSuccessUpdateItemKey=n},resetInstance(){this.stateLoading=!1,this.stateReason="",this.stateVisible=!1,this.stateViewVisible=!1,this.stateIsValid=!0,this.stateTask={},this.statePayload={updateParams:[]}}}}),Dr=l("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[l("h3",null,"Notify Supervisor or Reliability Engineer")],-1),Vr={class:"row text-center pt-5"},Ml=Ue({__name:"CBMDefectC",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(n,{emit:s}){const e=n,o=s,t=Ye(()=>e.show),r=()=>{o("close")};return(g,u)=>{const _=ce("el-button"),C=ce("el-dialog");return d(),re(C,{modelValue:J(t),"onUpdate:modelValue":u[0]||(u[0]=v=>Fa(t)?t.value=v:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:ee(()=>[Dr,l("div",Vr,[R(_,{type:"success",class:"ok-button",onClick:r},{default:ee(()=>[Ee("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),Br=l("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[l("h3",null,"Machine is not to be used. Notify Supervisor or Reliability Engineer Immediately")],-1),Ar={class:"row text-center pt-5"},jl=Ue({__name:"CBMDefectX",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(n,{emit:s}){const e=n,o=s,t=Ye(()=>e.show),r=()=>{o("close")};return(g,u)=>{const _=ce("el-button"),C=ce("el-dialog");return d(),re(C,{modelValue:J(t),"onUpdate:modelValue":u[0]||(u[0]=v=>Fa(t)?t.value=v:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:ee(()=>[Br,l("div",Ar,[R(_,{type:"success",class:"ok-button",onClick:r},{default:ee(()=>[Ee("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),Nr=l("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[l("h3",null,"Please take a photo")],-1),xr={class:"row text-center pt-5"},Hl=Ue({__name:"TakePhoto",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(n,{emit:s}){const e=n,o=s,t=Ye(()=>e.show),r=()=>{o("close")};return(g,u)=>{const _=ce("el-button"),C=ce("el-dialog");return d(),re(C,{modelValue:J(t),"onUpdate:modelValue":u[0]||(u[0]=v=>Fa(t)?t.value=v:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0,"close-on-click-modal":!1,"close-on-press-escape":!1},{default:ee(()=>[Nr,l("div",xr,[R(_,{type:"success",class:"ok-button",onClick:r},{default:ee(()=>[Ee("OK")]),_:1})])]),_:1},8,["modelValue"])}}}),ws=n=>(Yt("data-v-6f8b0ab0"),n=n(),zt(),n),Or={class:"d-flex align-items-center"},Lr=ws(()=>l("span",{class:"el-dialog__title"},"Defect Identified",-1)),Er={class:"ms-2 multiple-defect-badge"},Fr=ws(()=>l("img",{src:Cl,alt:"defect",class:"d-icon"},null,-1)),Mr=["innerHTML"],jr={key:0,class:"mb-2"},Hr={class:"p-2"},Kr={class:"d-flex flex-column"},Gr=ws(()=>l("h4",{class:"title ps-3"},'Change Reason - "Not Applicable" ',-1)),qr={key:0,class:"mt-1 p-2"},Wr=["onClick"],Jr=ws(()=>l("div",{class:"multi-icon"},[l("img",{src:Za,alt:"defect",class:"d-icon"})],-1)),Yr={class:"multi-description"},zr={style:{"white-space":"pre-wrap"}},Xr=Ue({__name:"MultipleDefectListDialog",props:{visibility:{required:!0,type:Boolean},defectList:{required:!1,type:Array,default:[]},isDisabled:{required:!0,type:Boolean},reason:{required:!1,type:String,default:""}},emits:["onClose","onOpenDetail","onCancel","onAddDefect"],setup(n,{emit:s}){const e=n,o=s,t=Me(e,"visibility"),r=is(),g=f(null),u=async()=>{o("onClose")},_=()=>{us(g.value)},C=async()=>{o("onCancel")},v=i(()=>e.reason.split(":")[0]),c=i(()=>e.reason.split(":")[0].includes("Other")),k=i(()=>e.reason.split(":")[1]),P=i(()=>e.defectList&&e.defectList.length>=1?e.defectList[0].detail.title:""),B=async b=>{o("onOpenDetail",b)},m=async()=>{o("onAddDefect")};return(b,S)=>{const L=ce("el-option"),H=ce("el-select"),F=ce("el-dialog");return d(),re(F,{modelValue:t.value,"onUpdate:modelValue":S[1]||(S[1]=x=>t.value=x),width:"90%",center:"","lock-scroll":!1,"before-close":C,onOpened:_,onClosed:u,"custom-class":"el-defect-crack-form-custom multi-defect-list-dialog","destroy-on-close":!0},ns({title:ee(()=>[l("div",Or,[Lr,l("div",Er,[Fr,l("span",null,"+"+ue(n.defectList.length),1)])]),l("span",{class:"el-dialog__title task-title",innerHTML:J(Qa)(P.value),ref_key:"defectDetailRef",ref:g},null,8,Mr)]),default:ee(()=>[l("div",null,[n.reason!=""?(d(),h("div",jr,[l("div",Hr,[l("div",Kr,[Gr,R(H,{modelValue:v.value,"onUpdate:modelValue":S[0]||(S[0]=x=>v.value=x),disabled:!0,class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(J(r).NAConditions,x=>(d(),re(L,{key:x.id,label:x.reviseNaCondition,value:x.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),c.value?(d(),h("div",qr,[R(_a,{value:k.value,label:"Description <span class='red'>*</span>",name:"Description",placeholder:"Write Reason",disabled:!0},null,8,["value"])])):E("",!0)])):E("",!0),(d(!0),h(we,null,tt(n.defectList,x=>(d(),h("div",{class:"multi-defect-list-item py-2 d-flex align-items-center cursor-pointer",key:x.id,onClick:p=>B(x)},[Jr,l("div",Yr,[l("span",zr,ue(x.detail.description),1)])],8,Wr))),128))])]),_:2},[n.isDisabled?void 0:{name:"footer",fn:ee(()=>[l("div",{onClick:m,class:"add-button cursor-pointer"},"+ Add Another Defect")]),key:"0"}]),1032,["modelValue"])}}}),Qr=Ct(Xr,[["__scopeId","data-v-6f8b0ab0"]]),Kl=n=>(Yt("data-v-e05daf94"),n=n(),zt(),n),Zr=Kl(()=>l("span",{class:"el-dialog__title"},"Change Status from Not Applicable",-1)),en=["innerHTML"],tn={class:"mt-1 p-2"},an={class:"d-flex flex-column"},sn=Kl(()=>l("label",{class:"reason_skip--label"},"Changes Reason",-1)),ln={key:0,class:"px-1 text-danger"},on={key:0,class:"mt-1 p-2"},rn={class:"dialog-footer",style:{display:"block","text-align":"right"}},nn=Ue({__name:"OfflineNAReasonDialog",props:{visibility:{required:!0,type:Boolean},naDetail:{required:!0,type:Object}},emits:["onClose","onSave","onCancel"],setup(n,{emit:s}){const e=n,o=s,t=is(),r=Me(e,"visibility"),g=f(!1),u=f(!1);f(!1);const _=f(""),C=f(""),v=f(!1),c=f(!0),k=f(!1),P=f(!1),B=f(null),m=i(()=>t.NAConditions),b=()=>{_.value&&(k.value=!1),v.value=_.value.includes("Other"),v.value?(C.value="",c.value=!0):c.value=!1},S=W=>{C.value=W.value,c.value=C.value===""},L=()=>{_.value?P.value=!0:k.value=!0},H=async()=>{P.value=!1,o("onSave",{selectedReason:_.value,desc:C.value,afterSubmit:()=>{g.value=!0,setTimeout(()=>{g.value=!1,o("onClose")},2e3)}})},F=()=>{o("onCancel")},x=()=>{P.value=!1},p=async()=>{_.value="",C.value="",v.value=!1,k.value=!1,g.value=!1,u.value=!1,o("onClose")},K=()=>{us(B.value)};be(()=>e.naDetail,()=>{X()},{deep:!0});const X=()=>{if(e.naDetail&&e.naDetail.reason){const W=e.naDetail.reason.split(":"),w=m.value.find(D=>D.naCondition==W[0]);w?(_.value=w.reviseNaCondition,e.naDetail.reason.includes("Other")&&(v.value=!0,C.value=W[1])):(v.value=!0,_.value="Other",C.value=W[0]),c.value=!1}};return Mt(()=>{X()}),Ja(()=>{_.value="",C.value="",v.value=!1,c.value=!0,k.value=!1,P.value=!1}),(W,w)=>{const D=ce("el-option"),U=ce("el-select"),I=ce("el-button"),z=ce("el-dialog");return n.naDetail?(d(),re(z,{key:0,modelValue:r.value,"onUpdate:modelValue":w[1]||(w[1]=oe=>r.value=oe),width:"90%",center:"","close-on-click-modal":!1,"close-on-press-escape":!1,"lock-scroll":!1,"before-close":F,onOpened:K,onClosed:p,"custom-class":"el-defect-crack-form-custom reason-dialog","destroy-on-close":!0},{title:ee(()=>[Zr,l("span",{class:"el-dialog__title task-title",innerHTML:J(Qa)(n.naDetail.title),ref_key:"defectDetailRef",ref:B},null,8,en)]),footer:ee(()=>[l("span",rn,[R(I,{onClick:F,style:{"box-shadow":"0px 24px 48px rgba(145, 158, 171, 0.2)"}},{default:ee(()=>[Ee("Cancel")]),_:1}),R(I,{disabled:c.value,class:"button-OK-confirmation",type:"success",onClick:ha(L,["prevent"]),style:{background:"rgb(24, 175, 74)","box-shadow":"rgba(0, 171, 85, 0.24) 0px 8px 16px",color:"white"}},{default:ee(()=>[Ee("Submit")]),_:1},8,["disabled"])])]),default:ee(()=>[l("div",null,[l("div",tn,[l("div",an,[sn,R(U,{modelValue:_.value,"onUpdate:modelValue":w[0]||(w[0]=oe=>_.value=oe),filterable:"",onChange:b,class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(m.value,oe=>(d(),re(D,{key:oe.id,label:oe.reviseNaCondition,value:oe.reviseNaCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),k.value?(d(),h("label",ln,"Required")):E("",!0)])]),v.value?(d(),h("div",on,[R(_a,{"label-class":"dma--textarea-label reason_skip--label","text-class":"dma--textarea-input h-100px reason_skip--text",value:C.value,label:"Description <span class='red'>*</span>",name:"Description",placeholder:"Write Reason",onHandleChange:S},null,8,["value"])])):E("",!0)]),R(Hs,{show:g.value,message:"Data Successfully Submitted"},null,8,["show"]),R(ca,{visibility:P.value,caption:"Please confirm this is the reason you could not do the service item.",onOnNoConfirm:x,onOnYesConfirm:H},null,8,["visibility"])]),_:1},8,["modelValue"])):E("",!0)}}}),un=Ct(nn,[["__scopeId","data-v-e05daf94"]]),Va=n=>(Yt("data-v-989e61fd"),n=n(),zt(),n),dn={class:"px-0 mx-0 d-flex"},cn=["innerHTML"],mn=["innerHTML"],fn=Va(()=>l("img",{src:Cl,alt:"defect",class:"d-icon"},null,-1)),vn=Va(()=>l("img",{src:bs,alt:"na",class:"d-icon"},null,-1)),pn=[vn],yn=Va(()=>l("img",{src:Za,alt:"defect",class:"d-icon"},null,-1)),gn=[yn],bn=Va(()=>l("img",{src:Za,alt:"defect",class:"d-icon"},null,-1)),kn=[bn],hn=Va(()=>l("img",{src:bs,alt:"na",class:"d-icon"},null,-1)),_n=[hn],wn=Va(()=>l("img",{src:Po,alt:"ok",class:"d-icon"},null,-1)),Sn=[wn],Cn={key:0,class:"ms-1 d-flex align-items-center"},Rn=Va(()=>l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Updating...")],-1)),Tn=Va(()=>l("span",{class:"timestamp-task"},"Updating...",-1)),Un=[Rn,Tn],In={key:1,class:"ms-1 d-flex align-items-center",style:{opacity:"0"}},$n=Va(()=>l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Updating...")],-1)),Pn=Va(()=>l("span",{class:"timestamp-task"},"Updating...",-1)),Dn=[$n,Pn],Vn=Ue({__name:"Dropdown",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1},taskGroupName:{type:String,required:!1,default:""},generalSubmitted:{required:!0,type:Boolean}},emits:["setLoading"],setup(n,{emit:s}){const e=n,o=s,t=Me(e,"item"),r=Me(e,"task"),g=Jt(),u=rt(),_=ja(),C=za(),v=Os(),c=ts(),k=f(!1),P=f(!1),B=f(!1),m=f(""),b=f(""),S=f(!1),L=ya(),H=f(!1),F=f(!1),x=$o(),p=f(!1),K=f(null),X=f(!1),W=f(!1),w=f(""),D=f(!1),U=i(()=>{let y="oil cooled";const N=t.value.value,he=ta.value.filter(et=>et.value!=N&&et.value!="");return he.length>0&&(y=he[0].label),`Are you sure want to change brake type to ${y}? Your progress will not be saved.`}),I=y=>{D.value=y},z=f(!1),oe=f(!1),me=i(()=>u.multiDefectList),M=i(()=>{var N;const y=((N=e.task)==null?void 0:N.key)||"";return y!=""?me.value[y]:[]}),te=y=>{k.value=!1,z.value?v.setPredefinedPriority(y.priority):C.setPredefinedPriority(y.priority),P.value=!0},T=y=>{var he;C.toggleIsNeed30Minutes(!1),C.setTask(e.task);const N=y.type=="Less than 30 minutes labour and less than $250 in parts";C.cretateInstance(!N),C.toggleIsNeed30Minutes(!N),C.setDefectRequirment(y.type),Qe(!N),L.addLocalImageInfo({taskKey:(he=e.task)==null?void 0:he.key,workOrder:u.generalForm.workOrder,type:"defect",updatedBy:u.employee.id,email:g.user.Email})},$=async y=>{var N,he,lt;v.setTask(e.task),v.setItemKey(t.value.key),v.cretateInstance(!oe.value),v.setDefectRequirment(y.type),_e()?await v.getPreviousCrackFromLocalDB(u.generalForm.workOrder,(he=e.task)==null?void 0:he.key):v.getPreviousCrackFromState(((N=e.task)==null?void 0:N.key)??""),Fe(),L.addLocalImageInfo({taskKey:((lt=e.task)==null?void 0:lt.key)??"",workOrder:u.generalForm.workOrder,type:"defect",updatedBy:u.employee.id,email:g.user.Email}),z.value=!1},ae=async y=>{z.value?await $(y):T(y)},G=i(()=>B),Z=i(()=>C.Cancelled),ie=i(()=>v.Cancelled),Ce=i(()=>c.Cancelled),st=i(()=>u.generalForm.status=="Submited"),Ke=f(!1),$t=f(!1),kt=f(!1),V=f(""),q=()=>{var y,N;L.addLocalImageInfo({taskKey:((y=e.task)==null?void 0:y.key)??"",workOrder:u.generalForm.workOrder,type:"defect",updatedBy:u.employee.id,email:g.user.Email}),((N=e.task)==null?void 0:N.rating)=="MANUAL_MOUNTING_LEAK"?(L.toggleIsVisible(!0,V.value),L.setShowCloseButton(!1)):a.isEmpty(se.value)||(L.toggleIsVisible(!0,se.value.key),L.setShowCloseButton(!1)),kt.value=!1},fe=i(()=>{let y="Choose One";return!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.placeholder)&&(y=t.value.style.placeholder),y});be(Z,y=>{var N,he;if(o("setLoading",!1),y===!0){if(((N=t.value)==null?void 0:N.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((he=r.value)==null?void 0:he.key)&&(t.value.value=m.value,B.value=!B.value,C.setCancelledState(!1),S.value=!1)}}),be(ie,y=>{var N,he;if(o("setLoading",!1),y===!0){if(((N=t.value)==null?void 0:N.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((he=r.value)==null?void 0:he.key)&&(t.value.value=m.value,B.value=!B.value,v.setCancelledState(!1),S.value=!1)}}),be(Ce,y=>{var N,he;if(o("setLoading",!1),y===!0){if(((N=t.value)==null?void 0:N.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((he=r.value)==null?void 0:he.key)&&(t.value.value=m.value,B.value=!B.value,c.setCancelledState(!1),S.value=!1)}});const Re=i(()=>e.generalStyle?!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col":""),Ne=i(()=>{let y="";return e.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(y=`col-md-${t.value.style.potraitBreakPoint}`,y=`${y} col-lg-${t.value.style.breakPoint}`):(y=`col-md-${t.value.style.potraitBreakPoint}`,y=`${y} col-lg-${t.value.style.breakPoint}`)),y}),Ae=i(()=>{var y;return Le.value?(y=ta.value.find(N=>N.value==String(Le.value)))==null?void 0:y.label:Le.value}),ut=i(()=>{var he,lt,et,We;const y=t.value.value.toString().replaceAll("'","");let N;return y=="1"&&a.isUndefined((he=e.task)==null?void 0:he.showParameter)?N="green":(y=="2"||y=="3"&&((lt=r.value)==null?void 0:lt.category)=="CRACK")&&a.isUndefined(e.task.showParameter)||y=="3"&&((et=r.value)==null?void 0:et.rating)=="SERVICE_CLEANED_AND_REPLACED"?N="red":y=="3"&&(((We=r.value)==null?void 0:We.category)=="NORMAL"||t.value.categoryItemType=="resultStatus")||y=="4"?N="yellow":y=="A"?N="a":y=="B"?N="b":y=="C"?N="c":y=="X"&&(N="x"),N}),mt=i(()=>{let y="";return["brakeTypeDropdown","dropdownTool","dropdownToolDisc"].includes(e.item.categoryItemType)&&(y="breaktype"),y}),ct=i(()=>{var N;let y="";return((N=e.task)==null?void 0:N.showParameter)=="suspensionCylinder"&&(y="suspensionCylinder"),y}),se=i(()=>{var N;return((N=e.task)==null?void 0:N.items.find(he=>{if(he.itemType==="smallCamera")return he}))||{}}),ke=i(()=>{var y;return((y=se.value)==null?void 0:y.value)||[]}),De=async y=>{var N,he;if(C.setPredefinedPriority(""),v.setPredefinedPriority(""),u.generalForm.status=="Submited"){u.toggleFormAlreadySubmitted(!0);return}it(y,!0),(y==="3"&&((N=e.task)==null?void 0:N.category)==="CRACK"||y==="2"&&((he=e.task)==null?void 0:he.category)==="CRACK")&&await v.setReferencePhoto(e.taskGroupName,u.getFieldValueByKey(e.item.imageMapping,"value"))},He=async y=>{var lt,et,We;const N=La(e.task),he=y.selectedReason+":"+y.desc;if(t.value.value=="1"){const Wt=Xe.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"}),Lt=[{keyValue:(lt=r.value)==null?void 0:lt.key,propertyParams:[{propertyName:"taskValue",propertyValue:"1"},{propertyName:"updatedBy",propertyValue:JSON.stringify(u.employee)},{propertyName:"updatedDate",propertyValue:Ft()},{propertyName:"reason",propertyValue:he}]}],Zt=[{keyValue:t.value.key,propertyParams:[{propertyName:"value",propertyValue:"1"},{propertyName:"updatedBy",propertyValue:JSON.stringify(u.employee)},{propertyName:"updatedDate",propertyValue:Ft()}]}],j=[...Lt,...Zt];u.updateAllItems(t.value.key,"1"),_e()?(await u.updateServiceSheetTaskOnLocalDB(j,(et=e.task)==null?void 0:et.key,e.item.key,!1,N),await wl(u.stateWorkOrder,(We=e.task)==null?void 0:We.key,"false")):await u.updateServiceSheetTaskValue(j,g.user.EmployeeId,g.user.Name),Wt.close(),u.setReasonNA(""),y.afterSubmit()}else p.value=!1,it(t.value.value,!1,!1,"",!0),u.setReasonNA(he)},at=async()=>{K.value=null,p.value=!1},gt=async()=>{t.value.value=m.value,at()},ft=()=>{W.value=!1,t.value.value=m.value},dt=async()=>{W.value=!1,S.value=!0,o("setLoading",!0),await u.resetAdjustmentCalibration(),await it(t.value.value,!1,!1,"",!0)},St=f(""),it=async(y,N,he=!1,lt="",et=!1)=>{var Wt,Lt,Zt,j,ne,Oe,pe,xe,Et,fa,Vt,aa,sa,ra,va,de,ye,Te,ot,It,ht,_t,Je,Bt,ia,pa,At,wt,$a,Ys,zs,Xs,Qs,Zs,el,tl,al,sl,ll,ol,rl,nl,il,ul,dl;w.value="",z.value=!1,oe.value=!1,Ge.value=!1;const We=La(e.task);if(a.isUndefined((Lt=(Wt=e.task)==null?void 0:Wt.updatedBy)==null?void 0:Lt.id)||o("setLoading",!0),u.setStateItemKey(t.value.key),V.value="",e.item.categoryItemType=="brakeTypeDropdown"){if(a.isUndefined(e.task.categoryTaskType)){const bt=[{keyValue:(Zt=r.value)==null?void 0:Zt.key,propertyParams:[{propertyName:"taskValue",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]}];_e()?await u.updateServiceSheetTaskOnLocalDB(bt,e.task.key,e.item.key,!1,We):await u.updateItemServiceSheetDetail(bt)}else if(!a.isUndefined(e.task.categoryTaskType)&&((j=e.task)==null?void 0:j.categoryTaskType)==Ps.BRAKE_TYPE_DROPDOWN){if(St.value="",!D.value){St.value=y,I(!0);return}I(!1),S.value=!0,t.value.value=y,u.updateSelectedBrakeTypeDropdownValue(y),await u.updateBrakeTypeDropdownValueAndResetOtherType({task:e.task,item:t.value}),S.value=!1;return}}if(e.item.categoryItemType=="dropdownTool"||e.item.categoryItemType=="dropdownToolDisc"){u.toggleSetSelectedUOMToolTaskKey(""),setTimeout(()=>{var jt;u.toggleSetSelectedUOMToolTaskKey(((jt=e.task)==null?void 0:jt.key)??"")},100),S.value=!0,m.value=Le.value;const bt=[{keyValue:(ne=r.value)==null?void 0:ne.key,propertyParams:[{propertyName:"taskValue",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]}];_e()?await u.updateServiceSheetTaskOnLocalDB(bt,((Oe=e.task)==null?void 0:Oe.key)??"",e.item.key,!1,We):await u.updateItemServiceSheetDetail(bt),t.value.value=y,await u.updateToolUom(e.task,t.value,We),S.value=!1,o("setLoading",!1)}else if(e.item.categoryItemType=="dropdownToolGroup"){S.value=!0;const bt=[{keyValue:t.value.key,propertyParams:[{propertyName:"value",propertyValue:y},{propertyName:"updatedBy",propertyValue:y===""?"":JSON.stringify(u.employee)},{propertyName:"updatedDate",propertyValue:y===""?"":Ft()}]}];let jt;if(_e()?jt=await u.updateServiceSheetTaskOnLocalDB(bt,e.task.key,e.item.key,!1,We):jt=await u.updateServiceSheetTaskValue(bt,g.user.EmployeeId,g.user.Name),jt){t.value.value=y;const ka=[];(pe=u.dropdownToolGroup[e==null?void 0:e.item.key])==null||pe.tasksReset.forEach(ua=>{ka.push(new Promise(Ta=>{const ds=u.getTaskDataBasedOnTaskKey(ua);ua?u.resetCBMAutomation(ds,We).then(Oa=>{Ta(Oa)}):Ta("")}))}),Promise.all(ka).then(async()=>{S.value=!1,u.updateAdjustmentRow()})}}else{if(Le.value===y&&!et||y===((xe=e.task)==null?void 0:xe.taskValue)&&!(Z.value||ie.value||Ce.value))return;if(Aa(),Z.value||ie.value||Ce.value){m.value="",localStorage.removeItem("taskKey");return}else{if(o("setLoading",!0),S.value=!0,et||(localStorage.setItem("taskKey",(Et=r.value)==null?void 0:Et.key),m.value=Le.value,b.value=(fa=r.value)==null?void 0:fa.key,t.value.value=y),((Vt=e.task)==null?void 0:Vt.rating)!="SERVICE_CLEANED_AND_REPLACED"&&(m.value=="3"&&((aa=e.task)==null?void 0:aa.category)==="NORMAL"||m.value=="4"&&((sa=e.task)==null?void 0:sa.category)==="CRACK")&&y!=""&&!Be.value&&!et)K.value=await c.getNADetailValue((ra=u.selectedGroup)==null?void 0:ra.id,(va=r.value)==null?void 0:va.key),p.value=!0;else if(((de=e.task)==null?void 0:de.rating)!="SERVICE_CLEANED_AND_REPLACED"&&(m.value=="2"&&((ye=e.task)==null?void 0:ye.category)==="NORMAL"||m.value=="2"&&((Te=e.task)==null?void 0:Te.category)==="CRACK"||m.value=="3"&&((ot=e.task)==null?void 0:ot.category)==="CRACK")&&!et)if(!(e.task.showParameter&&e.task.showParameter=="suspensionCylinder"))X.value=!0;else{let jt=!1;for(const ka of u.stateStoredAdjustedSuspensionCylinderValue)ka.value&&(jt=!0);jt?W.value=!0:await dt()}else if(((It=e.task)==null?void 0:It.rating)!="SERVICE_CLEANED_AND_REPLACED"&&y==="2"&&((ht=e.task)==null?void 0:ht.category)==="NORMAL"&&a.isUndefined(e.task.showParameter))C.setTask(e.task),C.setItemKey(t.value.key),k.value=!0,C.setItem(t.value),L.addLocalImageInfo({taskKey:e.task.key,workOrder:u.generalForm.workOrder,type:"defect",updatedBy:u.employee.id,email:g.user.Email});else if(y==="3"&&((_t=e.task)==null?void 0:_t.category)==="CRACK")z.value=!0,k.value=!0;else if(y==="2"&&((Je=e.task)==null?void 0:Je.category)==="CRACK")oe.value=!0,z.value=!0,k.value=!0;else if(((Bt=e.task)==null?void 0:Bt.rating)!="SERVICE_CLEANED_AND_REPLACED"&&(y==="3"&&((ia=e.task)==null?void 0:ia.category)==="NORMAL"||y=="3"&&t.value.categoryItemType=="resultStatus"||y==="4"&&((pa=e.task)==null?void 0:pa.category)==="CRACK"))c.setTask(e.task),c.setItemKey(t.value.key),c.toggleIsVisible(!0),c.setItem(t.value);else if(((At=e.task)==null?void 0:At.rating)=="MANUAL_MOUNTING_LEAK"&&((wt=e.task)!=null&&wt.mappingCamera)){let bt;bt=Xe.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"}),u.setMeasurementValueAndUOM("","",e.task.mappingCamera);const jt=await u.updateCBMLeakMounting(e.task,y,t.value);if(u.updateCameraItemCBMTakePhotoCompleteRating(e.task.mappingCamera,e.item.key,y),_e()&&u.handleGenerateLeakMounting(),bt.close(),jt&&u.CameraItemCBMTakePhotoCompleteRating[e.task.mappingCamera].filter(ua=>ua.value=="").length==0){const ua=u.getFieldValueByKey(e.task.mappingCamera,"value");(ua==""||ua.length==0)&&(u.setInputCameraMandatoryKey(t.value.key),Ge.value||ke.value.length==0&&(V.value=e.task.mappingCamera,kt.value=!0),Ge.value=!1)}}else if(y=="C"||y=="X"){let bt;if(!a.isUndefined(t.value.customValidation)){const ua=t.value.customValidation.includes("cbmTakePhotoAllRating"),Ta=t.value.customValidation.includes("cbmTakePhoto");(ua||Ta)&&(bt=Xe.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"}))}const jt=se.value;jt&&u.setMeasurementValueAndUOM("","",jt.key);let ka=!1;if(ka=await u.updateDefect(e.task,y,t.value),!a.isUndefined(t.value.customValidation)){const ua=($a=t.value.customValidation)==null?void 0:$a.includes("cbmTakePhotoAllRating"),Ta=(Ys=t.value.customValidation)==null?void 0:Ys.includes("cbmTakePhoto");(ua||Ta)&&bt.close()}ka&&(y=="C"||y=="X")&&N&&(u.setInputCameraMandatoryKey(t.value.key),Ge.value||ke.value.length==0&&(kt.value=!0),Ge.value=!1)}else if(e.task.showParameter=="suspensionCylinder"&&y=="2")S.value=!0,await u.updateDefectCalibrationDropdown(e.task,t.value,We);else if((y=="2"||y=="3")&&((zs=e.task)==null?void 0:zs.category)==="NORMAL"&&((Xs=e.task)==null?void 0:Xs.rating)=="SERVICE_CLEANED_AND_REPLACED"){let bt;se.value&&se.value.customValidation=="cbmReplaceDefectTakePhoto"&&ke.value.length==0&&(bt=Xe.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"})),C.setTask(e.task),C.setItemKey(t.value.key),C.setItem(t.value),w.value="Defect Service Cleaned and Repaired";try{_e()?await C.updateDefectToLocalDB(!0,!0,!1,!0):(await C.createSingleDefect(!0,!0),await u.getTaskProgress(),await u.updateGroupByParam(u.stateSelectedGroup.groupName))}finally{bt&&bt.visible.value&&(bt.close(),kt.value=!0),S.value=!1}}else{if(t.value.value=="1"){if(_e()&&(await u.checkApprovedLocalDefectOnTask({taskKey:e.task.key})).isAlreadyHandledBySPV){S.value=!1,o("setLoading",!1),t.value.value=m.value;return}u.updateAllItems(t.value.key,"1")}t.value.value==""&&u.updateAllItems(t.value.key,"");let bt;((Qs=e.task)==null?void 0:Qs.category)==="CBM"?(y=="A"||y=="B")&&!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("cbmTakePhotoAllRating")&&(bt=Xe.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"})):((Zs=r.value)==null?void 0:Zs.rating)=="SERVICE_CLEANED_AND_REPLACED"&&y=="1"&&se.value&&se.value.customValidation=="cbmReplaceDefectTakePhoto"&&ke.value.length==0&&(bt=Xe.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"})),m.value&&(((el=e.task)==null?void 0:el.category)==="CBM"||((tl=e.task)==null?void 0:tl.category)==="NORMAL"||((al=e.task)==null?void 0:al.category)==="CRACK")&&await u.deleteDefectOnLocal(e.task);let jt=t.value.value.toString()??"1";if(e.task.showParameter=="suspensionCylinder")t.value.value==""?jt="":jt="1",u.updateStoredAdjustmentOptionValue(t.value.value);else if(((sl=e.task)==null?void 0:sl.category)=="NORMAL"||((ll=e.task)==null?void 0:ll.category)=="CRACK")jt=y;else if(!a.isUndefined(t.value.customValidation)){const Ka=t.value.customValidation.includes("cbmTakePhotoAllRating"),uo=t.value.customValidation.includes("cbmTakePhoto");(Ka||uo)&&(t.value.value==""||y=="")&&(jt="")}const ka={keyValue:(ol=r.value)==null?void 0:ol.key,propertyParams:[{propertyName:"taskValue",propertyValue:y==""?y:jt},{propertyName:"updatedBy",propertyValue:y===""?"":JSON.stringify(u.employee)},{propertyName:"updatedDate",propertyValue:y===""?"":Ft()}]};((rl=e.task)==null?void 0:rl.category)=="NORMAL"&&ka.propertyParams.push({propertyName:"reason",propertyValue:lt});let ua={},Ta={},ds="";t.value.categoryItemType=="resultRating"&&((((nl=e.task)==null?void 0:nl.taskValue)=="3"||((il=e.task)==null?void 0:il.taskValue)=="4")&&(_e()?await u.deleteDefectOnLocal(e.task):await u.deleteDefect(e.task)),Ta={keyValue:e.task.key,propertyParams:[{propertyName:"taskNormalValue",propertyValue:""}]},e.task.items.forEach(Ka=>{Ka.categoryItemType=="resultStatus"&&(ds=Ka.key,ua={keyValue:Ka.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]})}));const Oa=[{keyValue:t.value.key,propertyParams:[{propertyName:"value",propertyValue:y},{propertyName:"updatedBy",propertyValue:y===""?"":JSON.stringify(u.employee)},{propertyName:"updatedDate",propertyValue:y===""?"":Ft()}]}];!a.isUndefined(t.value.isTaskValue)&&t.value.isTaskValue&&Oa.push(ka),t.value.categoryItemType=="resultRating"&&(Oa.push(ua),Oa.push(Ta)),t.value.categoryItemType=="resultStatus"&&(Ta={keyValue:e.task.key,propertyParams:[{propertyName:"taskNormalValue",propertyValue:""}]},Oa.push(ka),Oa.push(Ta));let Ts;_e()?(await fs(u.stateGeneralForm.workOrder,ds),await fs(u.stateGeneralForm.workOrder,`reset-${e.task.key}`),Ts=await u.updateServiceSheetTaskOnLocalDB(Oa,e.task.key,e.item.key,!1,We)):Ts=await u.updateServiceSheetTaskValue(Oa,g.user.EmployeeId,g.user.Name,!0,e.task.key),S.value=!1,o("setLoading",!1),u.setStateItemKey(""),Ts?(((ul=e.task)==null?void 0:ul.category)==="CBM"&&(y=="A"||y=="B")&&(u.setInputCameraMandatoryKey(t.value.key),!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("cbmTakePhotoAllRating")&&(Ge.value||ke.value.length==0&&(kt.value=!0),Ge.value=!1)),y=="1"&&m.value==""&&(u.setInputCameraMandatoryKey(t.value.key),!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("normalTakePhoto")&&(Ge.value||ke.value.length==0&&(kt.value=!0),Ge.value=!1),!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("cbmTakePhoto")&&(Ge.value||ke.value.length==0&&(kt.value=!0),Ge.value=!1)),xt()):t.value.value=m.value,(y=="A"||y=="B")&&!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("cbmTakePhotoAllRating")&&bt.close(),((dl=r.value)==null?void 0:dl.rating)=="SERVICE_CLEANED_AND_REPLACED"&&y=="1"&&bt&&bt.visible.value&&(bt.close(),kt.value=!0)}S.value=!1,(Ie.value==""||a.isUndefined(Ie.value.id)||Ie.value.id=="")&&(H.value=!0),o("setLoading",!1)}}},Le=i(()=>e.item.value.toString().replaceAll("'","")),xt=()=>{e.item.categoryItemType=="brakeTypeDropdown"&&u.updateStoredBrakeTypeValue({key:t.value.key,value:t.value.value})},Ht=i(()=>u.taskAlreadyUpdated),Ge=f(!1);be(Ht,async y=>{y&&(Ge.value=!0)}),Mt(async()=>{Rt(),_e()&&(xt(),Ot(),vt(),setTimeout(()=>{pt()},500)),m.value=t.value.value,setTimeout(()=>{Gt()},500)});const Rt=()=>{if(!t.value.categoryItemType)return;const y=t.value.categoryItemType==je.BRAKE_TYPE_DROPDOWN,N=e.task.categoryTaskType&&e.task.categoryTaskType==Ps.BRAKE_TYPE_DROPDOWN;y&&N&&u.updateSelectedBrakeTypeDropdownValue(t.value.value)},pt=()=>{t.value.categoryItemType=="dropdownToolGroup"&&u.setDropdownToolGroup(t.value.key,Le.value)},Ot=async()=>{if(!a.isUndefined(t.value.brakeTypeItemKey)){let y=u.stateStoredBrakeTypeValue.find(N=>N.key==t.value.brakeTypeItemKey);if(a.isUndefined(y)){let N="";_e()?N=await u.getFieldValueByKey(t.value.mappingKeyId,"value"):N=await u.getValueFromItemKey(t.value.brakeTypeItemKey),u.pushStoredDisabledItems({key:t.value.brakeTypeItemKey,value:N})}y=u.stateStoredBrakeTypeValue.find(N=>N.key==t.value.brakeTypeItemKey),a.isUndefined(y)||Kt(y.value)}},Xt=i(()=>c.stateUpdateSuccessFromNetworkError);be(Xt,async y=>{y&&(await vt(),c.toggleUpdateSuccessFromNetworkError(!1))});const Kt=y=>{var N,he,lt;y==""?(Tt.value=!0,((N=e.task)==null?void 0:N.taskType)=="inline"&&t.value.value&&it("",!1)):y=="Oil Cooled"?e.item.categoryItemType=="dropdownTool"?(Tt.value=!0,((he=e.task)==null?void 0:he.taskType)=="inline"&&t.value.value&&it("",!1)):Tt.value=!1:y=="Caliper"?(e.item.categoryItemType=="dropdownToolDisc"?(Tt.value=!0,((lt=e.task)==null?void 0:lt.taskType)=="inline"&&t.value.value&&it("",!1)):Tt.value=!1,e.item.categoryItemType=="dropdownTool"&&e.item.value==""&&it(ta.value[0].value,!1)):Tt.value=!1},Tt=f(!1),vt=async()=>{var y;if(!a.isUndefined(t.value.disabledByItemKey)){let N=u.stateStoredDisableKeyValue.find(he=>he.key==t.value.disabledByItemKey);if(a.isUndefined(N)){let he;_e()?he=u.getFieldValueByKey(t.value.disabledByItemKey,"value"):he=await u.getValueFromItemKey(t.value.disabledByItemKey),u.pushStoredDisabledItems({key:t.value.disabledByItemKey,value:he})}N=u.stateStoredDisableKeyValue.find(he=>he.key==t.value.disabledByItemKey),(N==null?void 0:N.value)=="3"?(Tt.value=!0,((y=e.task)==null?void 0:y.taskType)=="inline"&&t.value.value&&it("",!1)):Tt.value=!1}},Gt=()=>{var et;if(!(((et=e.task)==null?void 0:et.category)=="CBM")||!t.value.customValidation)return;const he=t.value.customValidation.includes("cbmTakePhotoAllRating"),lt=t.value.customValidation.includes("cbmTakePhoto");if(he||lt){const We=se.value;if((We==null?void 0:We.value).length>0||!t.value.value)return;it("",!1)}};be(Le,async y=>{pt(),xt(),Ot(),await vt(),_e()||u.stateStoredDisableKeyValue.forEach(N=>{N.key==t.value.key&&(N.value=y)})},{deep:!0});const ea=i(()=>u.stateGetDataByParam);be(ea,async(y,N)=>{y&&await vt()});const Ia=i(()=>e.itemLoading);be(()=>u.stateShowSCConfirmToSPC,y=>{var N,he;y&&!a.isUndefined((N=e.task)==null?void 0:N.showParameter)&&((he=e.task)==null?void 0:he.showParameter)=="suspensionCylinder"&&e.item.value!=""&&it("",!1)}),be(Ia,y=>{S.value=y});const Ba=i(()=>u.stateStoredSuspensionCylinderValue);be(Ba,y=>{var lt,et;if(a.isUndefined((lt=e.task)==null?void 0:lt.showParameter)||((et=e.task)==null?void 0:et.showParameter)!="suspensionCylinder")return;let N=!1;y.forEach(We=>{We.value==""&&(N=!0)});let he=!0;N||(y.forEach(We=>{(We.value=="Out of spec"||We.value=="Out Spec")&&(he=!1)}),he&&t.value.value==""&&it("No",!1))},{deep:!0});const Aa=()=>{C.toggleYesVisible(!1),C.toggleViewYesVisible(!1),v.toggleYesVisible(!1),v.toggleViewYesVisible(!1),c.toggleIsVisible(!1),c.toggleIsViewVisible(!1)},Sa=["A","B","C","X"],ta=i(()=>{var Lt,Zt,j,ne;const y=e.item.caption.replace("[","").replace("]","").split("; "),N=e.item.itemValue.replace("[","").replace("]","").split(", ");let he=y.map((Oe,pe)=>({label:Oe.replaceAll("'",""),value:N[pe].replaceAll("'","")}));if(!Be.value){const Oe=((Lt=e.task)==null?void 0:Lt.category)=="NORMAL"&&Le.value=="2",pe=((Zt=e.task)==null?void 0:Zt.category)=="CRACK"&&(Le.value=="2"||Le.value=="3");(((j=e.task)==null?void 0:j.category)=="NORMAL"||((ne=e.task)==null?void 0:ne.category)=="CRACK")&&Le.value=="1"?he=he.filter(xe=>!xe.label.includes("Not Applicable")):(Oe||pe)&&(he=he.filter(xe=>xe.value.includes("1")||xe.value==Le.value))}const lt=e.item.categoryItemType=="brakeTypeDropdown",et=e.item.categoryItemType=="dropdownTool"||e.item.categoryItemType=="dropdownToolDisc",We=lt,Wt=et||Be.value&&!Sa.includes(Le.value);return Le.value!=""&&!We&&Wt&&he.push({label:"Reset",value:""}),he}),Na=i(()=>{var fa,Vt,aa,sa,ra,va,de;const y=!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; `:"",N=!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:"",he=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",lt=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let et=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";const We=!a.isUndefined((fa=e.task)==null?void 0:fa.isShowReplacementRow)&&((Vt=e.task)==null?void 0:Vt.isShowReplacementRow),Wt=!a.isUndefined((aa=e.task)==null?void 0:aa.isShowAdjustmentRow)&&((sa=e.task)==null?void 0:sa.isShowAdjustmentRow),Lt=!a.isUndefined((ra=e.task)==null?void 0:ra.isShowCleanedRow)&&((va=e.task)==null?void 0:va.isShowCleanedRow);if(We||Wt||Lt||e.isShowAdjustment)et="";else{let ye=0;(de=e.task)==null||de.items.forEach(Te=>{var ot;a.isUndefined(Te.style)||(a.isUndefined(Te.style.border)?a.isUndefined(Te.style.border)&&(ye=ye+Number(Te.style.breakPoint)):((Te.style.border.right=="none"||a.isUndefined(Te.style.border.right))&&(ye=ye+Number(Te.style.breakPoint)),a.isEqual(Te,a.last((ot=e.task)==null?void 0:ot.items))&&(ye=ye+Number(Te.style.breakPoint))))}),ye==12&&(et=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const j=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",ne=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",Oe=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",pe=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",xe=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";let Et="";return et&&(Et="padding-bottom: 25px; "),`${Et}${y}${N}${he}${lt}${et}${j}${ne}${Oe}${pe}${xe}`}),xa=async()=>{F.value=!0},Ca=()=>{F.value=!1,C.toggleYesVisible(!1),v.toggleYesVisible(!1)},Ra=async y=>{const N=await C.getApprovalDefect(y);C.setApprovalData(N||{})},A=async y=>{y.defectHeaderId&&(L.reset(),await _.setDefectData(y.defectHeaderId),_.setDefectGeneralStatus(y.defectHeaderId),_.setCompleteStatus(_.getCompleteStatus(y.defectHeaderId)),_.setViewDefectVisible(!0))},Q=()=>{C.setTask(e.task),C.setItemKey(t.value.key),k.value=!0,C.setItem(t.value),L.reset(),F.value=!1},le=async()=>{var N;const y=await v.getCrackHeaderIdLocally(((N=r.value)==null?void 0:N.key)??"");y&&(L.reset(),await _.setCrackData(y),_.setCrackGeneralStatus(y),_.setCompleteStatus(_.getCrackCompleteStatus(y)),_.setViewCrackVisible(!0))},ge=async()=>{var he,lt,et,We;const y=Xe.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"}),N=await u.checkCurrentWoPendingOfflineTask();!_e()&&!N?await c.getNADetail((he=u.selectedGroup)==null?void 0:he.id,(lt=r.value)==null?void 0:lt.key):await c.getNAFromLocalDB((et=r.value)==null?void 0:et.key),await Ra({workorder:u.generalForm.workOrder,taskId:(We=r.value)==null?void 0:We.key}),y.close()},Pe=()=>{var y,N;x.setReason((y=e.task)==null?void 0:y.reason),x.setTitle((N=e.task)==null?void 0:N.description),x.setVisible(!0)},Ie=i(()=>{var y;return(y=e.task)==null?void 0:y.updatedBy});be(Ie,y=>{(y!=""||!a.isUndefined(y.id)&&y.id!="")&&(H.value=!1)},{deep:!0}),be(()=>C.UpdateTaskDefect,y=>{var N;y==((N=e.task)==null?void 0:N.key)&&(C.setTask(e.task),C.setItemKey(t.value.key),C.setItem(t.value))}),be(()=>C.UpdateTaskDefect,async y=>{var N,he;y!=""&&e.item.value==="2"&&((N=e.task)==null?void 0:N.category)==="NORMAL"&&_e()&&await C.getMultipleDefectList(u.generalForm.workOrder,e.task.key,(he=u.selectedGroup)==null?void 0:he.id)}),be(()=>C.stateUpdateTaskDefect,async y=>{var N;y==((N=e.task)==null?void 0:N.key)&&(m.value=t.value.value)}),be(()=>C.OpenDialogConfirmSubmitDefect,y=>{var N;C.UpdateTaskDefect==((N=e.task)==null?void 0:N.key)&&y&&(k.value=y)});const Fe=async()=>{w.value="Crack Repaired",P.value=!1,v.toggleYesVisible(!0)},Qe=async y=>{P.value=!1,C.toggleYesVisible(!0),w.value=y?"Defect Major":"Defect Minor",Pl("form-defect-yes-eform")},qe=async()=>{t.value.value=m.value,X.value=!1},Ze=async()=>{X.value=!1,it(t.value.value,!1,!1,"",!0)},Ve=()=>{t.value.value=m.value,C.toggleYesVisible(!1),v.toggleYesVisible(!1),u.setReasonNA("")},ze=()=>{k.value=!1,Ve()},Pt=()=>{P.value=!1,Ve()},O=()=>{Ke.value=!1},Y=()=>{$t.value=!1},Be=i(()=>Ho(r.value.updatedBy||"",u.employee)),Ut=i(()=>{var pe,xe,Et,fa,Vt,aa,sa,ra,va,de,ye;if(!e.generalSubmitted||e.task.categoryTaskType&&e.task.categoryTaskType==Ps.BRAKE_TYPE_DROPDOWN_DISABLED)return!0;let N=!0;if(!a.isUndefined(r.value.updatedBy)&&!a.isUndefined(r.value.updatedBy.id)&&((pe=r.value)==null?void 0:pe.updatedBy.toString())!=""&&u.employee.id!=r.value.updatedBy.id){const Te=((xe=e.task)==null?void 0:xe.category)=="NORMAL"&&Le.value=="2",ot=((Et=e.task)==null?void 0:Et.category)=="CRACK"&&(Le.value=="2"||Le.value=="3");Te||ot?N=!0:N=!1}const he=ta.value.find(Te=>Te.label.includes("1 - OK, System Working")),lt=ta.value.find(Te=>Te.label.includes("1 - Complete")),et=(t.value.value=="3"||t.value.value=="1"&&he)&&((fa=r.value)==null?void 0:fa.category)=="NORMAL",We=(t.value.value=="1"||t.value.value=="4")&&((Vt=r.value)==null?void 0:Vt.category)=="CRACK",Wt=((aa=r.value)==null?void 0:aa.category)=="CBM",Lt=((sa=r.value)==null?void 0:sa.category)=="NORMAL"&&((ra=r.value)==null?void 0:ra.rating)=="SERVICE_CLEANED_AND_REPLACED",Zt=t.value.value&&e.task.category=="NORMAL"&&e.task.rating=="CALIBRATION",j=t.value.value=="1"&&lt;(et||We||Wt||Zt||Lt||j)&&(N=!0);let ne=!1,Oe=!1;return!a.isUndefined((va=e.task)==null?void 0:va.showParameter)&&((de=e.task)==null?void 0:de.showParameter)=="suspensionCylinder"&&(Le.value=="Yes"||Le.value=="2")&&(Oe=!1),!N||ne||Tt.value||S.value||Oe||st.value||((ye=e.task)==null?void 0:ye.isShowCleanedRow)}),Dt=i(()=>{var N;let y=!0;return!a.isUndefined(r.value.updatedBy)&&!a.isUndefined(r.value.updatedBy.id)&&((N=r.value)==null?void 0:N.updatedBy.toString())!=""&&u.employee.id!=r.value.updatedBy.id&&(y=!1),!y||Tt.value||S.value||st.value}),qt=y=>Ha(y),la=i(()=>{let y="pb-2";return!a.isUndefined(e.task.updatedBy.name)&&e.task.updatedBy.name&&(y=""),y}),oa=i(()=>c.stateSuccessUpdateItemKey);be(oa,y=>{y==t.value.key&&!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("normalTakePhoto")&&(u.setInputCameraMandatoryKey(t.value.key),Ge.value||ke.value.length==0&&(kt.value=!0),Ge.value=!1)});const ba=i(()=>L.stateIsCameraError);be(ba,async y=>{y&&u.stateInputCameraMandatoryKey==t.value.key&&(await it("",!1,!0),u.setInputCameraMandatoryKey(""))});const Qt=i(()=>{let y="";return a.isUndefined(t.value.disabledByItemKey)||u.stateStoredDisableKeyValue.forEach(N=>{N.key==t.value.disabledByItemKey&&(y=N.value)}),y});be(Qt,async()=>{_e()&&await vt()});const ve=i(()=>{let y="";return a.isUndefined(t.value.brakeTypeItemKey)||u.stateStoredBrakeTypeValue.forEach(N=>{N.key==t.value.brakeTypeItemKey&&(y=N.value)}),y});return be(ve,async()=>{_e()&&Kt(ve.value)}),be(()=>C.stateUpdateTaskDefect,async y=>{var N,he;y==e.item.key&&_e()&&await C.getMultipleDefectList(u.generalForm.workOrder,(N=e==null?void 0:e.task)==null?void 0:N.key,(he=u.selectedGroup)==null?void 0:he.id)}),(y,N)=>{var et,We,Wt,Lt,Zt,j,ne,Oe;const he=ce("el-option"),lt=ce("el-select");return d(),h(we,null,[l("div",{class:$e([[Ne.value,Re.value,la.value],"px-2 pt-2 dropdown-eform-status"]),style:Se(Na.value)},[l("div",dn,[(d(),re(lt,{modelValue:Le.value,"onUpdate:modelValue":N[0]||(N[0]=pe=>Le.value=pe),placeholder:fe.value,size:"small",class:$e(["w-100",[ut.value,mt.value,ct.value]]),disabled:Ut.value,onChange:De,key:G.value},ns({default:ee(()=>[(d(!0),h(we,null,tt(ta.value,pe=>(d(),re(he,{key:pe,value:pe.value},{default:ee(()=>[l("span",{innerHTML:pe&&pe.label?qt(pe&&pe.label):""},null,8,cn)]),_:2},1032,["value"]))),128))]),_:2},[Le.value?{name:"prefix",fn:ee(()=>[l("span",{class:"el-input__custom-option",innerHTML:Ae.value},null,8,mn)]),key:"0"}:void 0]),1032,["modelValue","placeholder","disabled","class"])),t.value.value==="2"&&((et=n.task)==null?void 0:et.category)=="NORMAL"&&J(a.isUndefined)(e.task.showParameter)&&e.task.rating!="SERVICE_CLEANED_AND_REPLACED"?(d(),h("div",{key:0,class:"ms-2 multiple-defect-badge",onClick:xa},[fn,l("span",null,"+"+ue(M.value&&M.value.length||0),1)])):E("",!0),t.value.value==="3"&&(((We=n.task)==null?void 0:We.category)=="NORMAL"||((Wt=n.task)==null?void 0:Wt.category)=="CBM")&&e.task.rating!="SERVICE_CLEANED_AND_REPLACED"?(d(),h("div",{key:1,class:"ms-2",onClick:ge},pn)):E("",!0),t.value.value==="2"&&((Lt=n.task)==null?void 0:Lt.category)=="CRACK"?(d(),h("div",{key:2,class:"ms-2",onClick:le},gn)):E("",!0),t.value.value==="3"&&((Zt=n.task)==null?void 0:Zt.category)=="CRACK"?(d(),h("div",{key:3,class:"ms-2",onClick:le},kn)):E("",!0),t.value.value==="4"?(d(),h("div",{key:4,class:"ms-2",onClick:ge},_n)):E("",!0),t.value.value==="1"&&((j=n.task)!=null&&j.reason)&&((ne=n.task)==null?void 0:ne.reason)!=""?(d(),h("div",{key:5,class:"ms-2",onClick:Pe},Sn)):E("",!0)]),S.value?(d(),h("div",Cn,Un)):E("",!0),H.value?(d(),h("div",In,Dn)):E("",!0)],6),R(Ml,{show:Ke.value,onClose:O},null,8,["show"]),R(jl,{show:$t.value,onClose:Y},null,8,["show"]),R(xo,{show:k.value,onSubmit:te,onClose:ze},null,8,["show"]),P.value?(d(),re(Oo,{key:0,show:P.value,onSubmit:ae,onClose:Pt},null,8,["show"])):E("",!0),R(Hl,{show:kt.value,onClose:q},null,8,["show"]),F.value?(d(),re(Qr,{key:1,visibility:F.value,defectList:M.value,"is-disabled":Dt.value,reason:(Oe=e.task)==null?void 0:Oe.reason,onOnClose:Ca,onOnOpenDetail:A,onOnCancel:Ca,onOnAddDefect:Q},null,8,["visibility","defectList","is-disabled","reason"])):E("",!0),R(un,{"na-detail":K.value,visibility:p.value,onOnSave:He,onOnClose:at,onOnCancel:gt},null,8,["na-detail","visibility"]),R(ca,{visibility:X.value,caption:"Are you sure to change this data? Defect data that already recorded will be deleted.",onOnNoConfirm:qe,onOnYesConfirm:Ze},null,8,["visibility"]),R(ca,{visibility:D.value,caption:U.value,noLabel:"Cancel",yesLabel:"Yes, Continue",onOnNoConfirm:N[1]||(N[1]=pe=>I(!1)),onOnYesConfirm:N[2]||(N[2]=pe=>it(St.value,!1))},null,8,["visibility","caption"]),R(ca,{visibility:W.value,caption:"Are you sure want to change it?",onOnNoConfirm:ft,onOnYesConfirm:dt},null,8,["visibility"])],64)}}}),Gl=Ct(Vn,[["__scopeId","data-v-989e61fd"]]),Bn=l("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[l("h3",null,"Please ensure oil level is checked and it is within the tolerance range.")],-1),An={class:"row text-center pt-5"},Nn=Ue({__name:"OilNotInRange",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(n,{emit:s}){const e=n,o=s,t=Ye(()=>e.show),r=()=>{o("close")};return(g,u)=>{const _=ce("el-button"),C=ce("el-dialog");return d(),re(C,{modelValue:J(t),"onUpdate:modelValue":u[0]||(u[0]=v=>Fa(t)?t.value=v:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:ee(()=>[Bn,l("div",An,[R(_,{type:"success",class:"ok-button",onClick:r},{default:ee(()=>[Ee("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),xn={class:"m-0 p-0",style:{"font-weight":"normal"}},On={class:"dialog-footer"},Gs=Ue({__name:"TakeReplacementPhoto",props:{show:{type:Boolean,required:!0},item:{type:Object,required:!0},tool:{type:String,required:!0},side:{type:String,required:!0}},emits:["close"],setup(n,{emit:s}){const e=n,o=i({get(){return e.show},set(g){return g}}),t=s,r=()=>{t("close")};return(g,u)=>{const _=ce("el-button"),C=ce("el-dialog");return d(),re(C,{modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=v=>o.value=v),width:480,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"custom-class":"replacement-dialog"},{footer:ee(()=>[l("span",On,[R(_,{class:"replacement-button",onClick:r},{default:ee(()=>[Ee(" Take a Photo ")]),_:1})])]),default:ee(()=>[l("p",xn,[Ee(" Please take a photo of the "),l("b",null,ue(n.tool),1),Ee(" from the "),l("b",null,ue(n.side),1),Ee(" with the cover removed ")])]),_:1},8,["modelValue"])}}}),Ln={key:0,class:"text-danger ps-2 font-weight-bold"},En={key:1,class:"d-flex align-items-center"},Fn=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),Mn=l("span",{class:"timestamp-task busy"},"Calculating...",-1),jn=[Fn,Mn],Hn={key:2,class:"d-flex align-items-center"},Kn=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Updating...")],-1),Gn=l("span",{class:"timestamp-task busy"},"Updating...",-1),qn=[Kn,Gn],Wn={key:3,class:"ms-1 d-flex align-items-center",style:{opacity:"0"}},Jn=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Updating...")],-1),Yn=l("span",{class:"timestamp-task"},"Updating...",-1),zn=[Jn,Yn],ql=Ue({__name:"Input",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1},isShowAdjustment:{type:Boolean},generalSubmitted:{required:!0,type:Boolean}},setup(n){const s=n,e=Me(s,"item"),o=Me(s,"task"),t=rt(),r=Jt(),g=f(!1),u=f("");let _;const C=f(!1),v=f(!1),c=f(!1),k=ya(),P=f(!1),B=f(!1),m=f(!1),b=f(""),S=Ul(t.stateSelectedGroup),L=f(),H=f(!1),F=f(!1),x=ts(),p=()=>{var le,ge,Pe;(le=e.value.customValidation)!=null&&le.includes("cbmReplaceDefectTakePhoto")&&k.setShowCloseButton(!1);const A=S.getCameraItem(((ge=s.task)==null?void 0:ge.groupTaskId)??"",t.stateSelectedSubGroups);let Q;switch(A&&(Q=A.items.find(Ie=>Ie.itemType==="smallCamera")),Q.value.length<2&&k.toggleIsVisible(!0,Q.key),b.value="",(Pe=s.task)==null?void 0:Pe.SectionData){case"HV Alternator":b.value="alternator";break;case"Retarder Grid Box 1":case"Retarder Grid Box 2":b.value="blower motor";break}k.setReplacementTool(b.value),m.value=!1,k.addLocalImageInfo({taskKey:s.task.key,workOrder:t.generalForm.workOrder,type:"task",updatedBy:t.employee.id,email:r.user.Email})},K=i(()=>{let A="";return!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.suffix)&&(A=e.value.style.suffix),A}),X=i(()=>{let A="Please Input";return(e.value.categoryItemType=="targetRating"||e.value.categoryItemType=="resultParamRating")&&(A=""),!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.placeholder)&&(A=e.value.style.placeholder),A}),W=f(!1),w=f(!1),D=f(!1),U=()=>{var A;(A=s.task)==null||A.items.forEach(Q=>{Q.itemType==="smallCamera"&&(!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmDefectTakePhoto")&&k.setShowCloseButton(!1),!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("normalTakePhoto")&&k.setShowCloseButton(!1),!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhoto")&&k.setShowCloseButton(!1),k.toggleIsVisible(!0,Q.key))}),D.value=!1,k.addLocalImageInfo({taskKey:s.task.key,workOrder:t.generalForm.workOrder,type:"task",updatedBy:t.employee.id,email:r.user.Email})},I=i(()=>s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),z=i(()=>{let A="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(A=`col-md-${e.value.style.potraitBreakPoint}`,A=`${A} col-lg-${e.value.style.breakPoint}`):(A=`col-md-${e.value.style.potraitBreakPoint}`,A=`${A} col-lg-${e.value.style.breakPoint}`)),A}),oe=i(()=>t.taskAlreadyUpdated),me=i(()=>t.generalForm.status=="Submited"),M=f(!1);be(oe,async(A,Q)=>{A&&(M.value=!0)});const te=i(()=>{var Ve;if(!s.generalSubmitted)return!0;let A=!1;const Q=e.value.categoryItemType;(Q=="targetRating"||Q=="resultParamRating")&&(A=!0);let le=!1;(e.value.categoryItemType=="paramRatingDynamic"||q.value)&&o.value.items.forEach(ze=>{ze.itemType=="dropDown"&&(ze.categoryItemType=="dropdownTool"||ze.categoryItemType=="dropdownToolDisc")&&ze.value==""&&(le=!0)});let ge=!1;e.value.categoryItemType=="suspensionParamRating"&&(t.stateStoredAdjustmentOptionValue=="Yes"||t.stateStoredAdjustmentOptionValue=="2")&&(ge=!0);let Pe=!1;e.value.categoryItemType==je.PISTON_INPUT_B&&(Pe=!0),o.value.items.forEach(ze=>{ze.categoryItemType==je.PISTON_INPUT_A&&ze.value&&(Pe=!1)});let Ie=!1;if(fe.value&&(Ie=!0),Ie){let ze,Pt;o.value.items.forEach(O=>{O.categoryItemType==je.PISTON_INPUT_A?ze=O.value:O.categoryItemType==je.PISTON_INPUT_B&&(Pt=O.value)}),ze&&Pt&&(Ie=!1)}let Fe=!1;Re.value&&(Fe=!0),o.value.items.forEach(ze=>{ze.categoryItemType==je.PISTON_INPUT_RESULT&&ze.value&&(Fe=!1)});const Qe=e.value.categoryItemType==je.PREVIOUS_VALUE_PISTON_RATING||e.value.categoryItemType==je.PREVIOUS_TARGET_RATING,qe=(!s.item.valueItemType||s.item.valueItemType!="comment")&&s.isShowAdjustment;let Ze=s.isShowAdjustment;return s.task.rating==Ms.MANUAL_CLEANED&&s.item.valueItemType==Io.COMMENT&&(Ze=!1),A||s.task.isShowAdjustmentRow||((Ve=s.task)==null?void 0:Ve.isShowReplacementRow)||le||T.value||ge||B.value||Ze||me.value||Pe||Ie||Fe||Qe||qe}),T=f(!1),$=i(()=>{let A="text";return(G.value||Z.value||ie.value||Ce.value)&&(A="numeric"),A}),ae=i(()=>s.item.categoryItemType&&(e.value.categoryItemType==je.PREVIOUS_VALUE_PISTON_RATING||e.value.categoryItemType==je.PREVIOUS_TARGET_RATING)?"font-size: 10px !important;":""),G=i(()=>e.value.valueType=="int"),Z=i(()=>{var A;return(A=e.value.customValidation)==null?void 0:A.toLowerCase().includes("percentage")}),ie=i(()=>e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="paramRatingDynamic"||q.value),Ce=i(()=>!a.isUndefined(e.value.mappingKeyId)&&!a.isArray(e.value.mappingKeyId)&&e.value.categoryItemType!="adjustmentSuspensionRating");i(()=>{let A="";return(G.value||Z.value||ie.value||Ce.value)&&(A="number"),A});const st=i({get:()=>{let A=e.value.value;return e.value.categoryItemType==je.PISTON_INPUT_RATING&&e.value.value!=""&&(A=`${Number(e.value.value)*100}%`),A},set:async A=>{if(G.value||ie.value||Ce.value){if(isNaN(Number(A)))return;if(A.length>8)return;if((`${A}`.split(".")||[]).length-1>1)return;if(A.includes(".")){if(`${A}`.split(".")[1].length>2)return;e.value.value=A}if(A.length>5){if(A.length>=6&&A.length<=6){if(A[5]!=".")return;e.value.value=A}}else e.value.value}e.value.value=A}}),Ke=A=>{if(t.generalForm.status=="Submited"){t.toggleFormAlreadySubmitted(!0);return}if(M.value=!1,Ge.value)return;const Q=A.target.value;if($t(Q)){let ge=Q;(G.value||Z.value||ie.value||Ce.value)&&(ge=parseFloat(Q)),isNaN(ge)&&(ge=A.target.value),V(String(ge))}else e.value.value=vt.value},$t=A=>{u.value="";let Q=!0;return(G.value||Z.value||ie.value||Ce.value)&&isNaN(A)&&(Q=!1,u.value="value must be a number"),Q},kt=()=>{var A;if(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic"||q.value){if(!a.isUndefined(e.value.disabledByItemKey&&e.value.value=="")||a.isUndefined(e.value.customValidation)||!((A=e.value.customValidation)!=null&&A.toLowerCase().includes("required")))return!0;if(!ks(e.value.value))return u.value="max. 2 decimal digits",!1}return!0},V=async(A,Q=!0)=>{e.value.categoryItemType=="resultParamRating"&&(Q=!1),Q?A!==vt.value?await Ne(A):u.value="":await Ne(A)},q=i(()=>e.value.categoryItemType==je.PISTON_INPUT_A||e.value.categoryItemType==je.PISTON_INPUT_B),fe=i(()=>e.value.categoryItemType==je.PISTON_INPUT_RESULT),Re=i(()=>e.value.categoryItemType==je.PISTON_INPUT_RATING),Ne=async(A,Q=!0)=>{clearTimeout(_);let le;e.value.value=A;let ge=se();ge&&(ge=kt()),ge&&(u.value="",_=setTimeout(async()=>{var Ie,Fe,Qe;if(s.task.category=="CBM"&&(e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic"||q.value)?C.value=!0:(!a.isUndefined(e.value.mappingKeyId)&&a.isArray(e.value.mappingKeyId),c.value=!0),(Fe=(Ie=s.task)==null?void 0:Ie.rating)!=null&&Fe.includes("AUTOMATIC_REPLACEMENT")&&(L.value=Xe.service({lock:!0,text:"Updating...",background:"rgba(0, 0, 0, 0.7)"})),!a.isUndefined(e.value.customValidation)){const qe=e.value.customValidation.includes("cbmTakePhotoAllRating"),Ze=e.value.customValidation.includes("cbmDefectTakePhoto");if((qe||Ze)&&(e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="paramRatingDynamic")){const Ve=(Qe=s.task)==null?void 0:Qe.items.find(ze=>ze.itemType=="smallCamera");Ve&&Ve.value.length==0&&(le=Xe.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"}))}}if(ea(A)){const qe={keyValue:o.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:A},{propertyName:"updatedBy",propertyValue:A!=""?JSON.stringify(t.employee):""},{propertyName:"updatedDate",propertyValue:A!=""?Ft():""}]};if(Ce.value)A!==""?await Xt(A):await De(qe,A);else{let Ze=!0;if(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic")await it().then(Ve=>{if(Ze=Ve,!Ve.value&&!t.ratingNotMapped&&Q){const ze=e.value.categoryItemType=="resultParamRating";let Pt=a.clone(A);(!ze||!A)&&(H.value=!0),setTimeout(()=>{(!ze||!Pt)&&(H.value=!1)},2e3),A="",e.value.value=""}}).catch(()=>{A="",e.value.value=""}).finally(()=>{le&&le.close(),C.value=!1,L.value&&(L.value.close(),L.value=void 0)});else if(q.value){const Ve=mt();Ve.inputValue||(A=Ve.inputValue)}e.value.categoryItemType=="suspensionParamRating"&&(await t.updateSuspensionCylinderTask(s.task,e.value),Ze=!1,vt.value=A),e.value.categoryItemType=="adjustmentSuspensionRating"&&(await t.updateAdjustmentSuspensionCylinderTask(s.task,e.value),Ze=!0),Ze&&(e.value.category=="cbmCalculateAvg"&&t.toggleCalculatingBrakeAvg(!0),await De(qe,A),vt.value=A,e.value.category=="cbmCalculateAvg"&&(t.setAvgTargetKey(e.value.targetCalculateKeyId),ke()))}}C.value=!1,c.value=!1,e.value.isCalculatingTrue=!1,(ct.value==""||a.isUndefined(ct.value.id)||ct.value.id=="")&&(P.value=!0)},0))};let Ae=0,ut=!1;const mt=()=>{Ae=0,ut=!1;let A=0,Q=0,le="";const ge=e.value.categoryItemType==je.PISTON_INPUT_B,Pe=s.task.items.find(Ie=>Ie.categoryItemType==je.PISTON_INPUT_B);if(ge){Q=Number(e.value.value),le=`${Q}`;const Ie=s.task.items.find(Fe=>Fe.categoryItemType==je.PISTON_INPUT_A);Ie&&(A=Number(Ie.value))}else A=Number(e.value.value),le=`${A}`,Pe&&(Q=Number(Pe.value));return console.log("pistonA",A,"pistonB",Q),Pe&&Pe.value!=""&&(ut=!0,A>Q?(le="",F.value=!0,setTimeout(()=>{F.value=!1},2e3)):(Ae=Q-A,Number.isInteger(Ae)||(Ae=Number(Ae.toFixed(2))))),{inputValue:le}},ct=i(()=>{var A;return(A=s.task)==null?void 0:A.updatedBy});be(ct,A=>{(A!=""||!a.isUndefined(A.id)&&A.id!="")&&(P.value=!1)},{deep:!0});const se=()=>{var A;if((A=e.value.customValidation)!=null&&A.toLowerCase().includes("percentage")){const Q=parseFloat(e.value.value);return isNaN(Q)||Q<0||Q>100?(u.value="must be between 0 - 100",!1):(u.value=="must be between 0 - 100"&&(u.value=""),!0)}return u.value=="must be between 0 - 100"&&(u.value=""),!0},ke=async A=>{const Q=e.value.mappingKeyId,le=[];let ge=!0,Pe;if(t.stateSelectedSubGroups.find(Ie=>Ie.taskGroup.some(Fe=>Fe.task.some(Qe=>Qe.items.some(qe=>(qe.key==e.value.targetCalculateKeyId&&(Pe=qe),qe.key==e.value.targetCalculateKeyId))))),a.isArray(Q)){for(let Fe=0;Fe<Q.length;Fe++){let Qe;Qe=await t.getFieldValueByKey(Q[Fe],"value"),le.push(Number(Qe)),Qe===""&&(ge=!1)}let Ie=0;ge&&(le.forEach(Fe=>{Ie=Ie+Fe}),Ie=a.round(Ie/le.length,2),Ie!=Pe.value&&(Pe.isCalculatingTrue=!0)),t.stateSelectedSubGroups.find(Fe=>Fe.taskGroup.some(Qe=>Qe.task.some(qe=>qe.items.some(Ze=>(Ze.key==e.value.targetCalculateKeyId&&(Pe=Ze),Ze.key==e.value.targetCalculateKeyId))))),ge?Pe.value=Ie:Pe.value&&(Pe.value="")}},De=async(A,Q)=>{let le=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:Q},{propertyName:"updatedBy",propertyValue:Q==""?"":JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Q==""?"":Ft()}]}];if(!a.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&le.push(A),e.value.categoryItemType=="adjustmentSuspensionRating"){const Pe={keyValue:o.value.key,propertyParams:[{propertyName:"updatedBy",propertyValue:Q==""?"":JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Q==""?"":Ft()}]};le.push(Pe)}let ge=!1;if(q.value){if(He.value=!1,Q==""){const Pe=at();le.push(Pe);const Ie=await gt({isReset:!ge});le=[...le,...Ie]}else if(ut){ge=!0;const Pe=await gt({isReset:!ge});He.value&&(Q="",ge=!1,wl(t.stateGeneralForm.workOrder,s.task.key,"false")),le=[...le,...Pe]}}if(_e())if(ge)await t.postFinalDataPistonMovementInput({task:s.task,updateParams:le}),!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes(ml.CBM_TAKE_PHOTO_ALL_RATING)&&(t.setInputCameraMandatoryKey(e.value.key),M.value||dt.value.length==0&&(D.value=!0),M.value=!1);else{const Pe=La(s.task);await t.updateServiceSheetTaskOnLocalDB(le,s.task.key,s.item.key,!0,Pe)}else if(ge){L.value=Xe.service({lock:!0,text:"Updating...",background:"rgba(0, 0, 0, 0.7)"});try{await t.postFinalDataPistonMovementInput({task:s.task,updateParams:le})}finally{L.value.close(),L.value=void 0,!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes(ml.CBM_TAKE_PHOTO_ALL_RATING)&&(t.setInputCameraMandatoryKey(e.value.key),M.value||dt.value.length==0&&(D.value=!0),M.value=!1)}}else await t.updateServiceSheetTaskValue(le,r.user.EmployeeId,r.user.Name,!0,s.task.key)},He=f(!1),at=()=>{const Q=e.value.categoryItemType==je.PISTON_INPUT_B?je.PISTON_INPUT_A:je.PISTON_INPUT_B,le=s.task.items.find(Ie=>Ie.categoryItemType==Q);let ge="";return le&&(ge=le.key),{keyValue:ge,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]}},gt=async A=>{const Q=s.task.items.find(Ie=>Ie.categoryItemType==je.PISTON_INPUT_RESULT);let le="";Q&&(le=Q.key,Q.value=A.isReset?"":Ae);let ge=[];const Pe={keyValue:le,propertyParams:[{propertyName:"value",propertyValue:A.isReset?"":Ae},{propertyName:"updatedBy",propertyValue:A.isReset?"":JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:A.isReset?"":Ft()}]};if(ge.push(Pe),A.isReset){const Ie=ft({isOutOfRange:!1});ge=[...ge,...Ie]}else{const Ie=s.task.items.find(Qe=>Qe.categoryItemType==je.PISTON_INPUT_RATING);let Fe;if(Q&&(Fe=t.getPistonMovementRatingPercentage({task:s.task,item:Q})),Fe)Fe=Fe/100,Ie&&(Ie.value=Fe,ge.push({keyValue:Ie.key,propertyParams:[{propertyName:"value",propertyValue:Fe},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]}));else{H.value=!0;const Qe=ft({isOutOfRange:!0});ge=[...ge,...Qe],He.value=!0,setTimeout(()=>{H.value=!1},2e3)}}return ge},ft=A=>{const Q=[];return s.task.items.forEach(le=>{const ge=le.categoryItemType==je.PISTON_INPUT_RATING,Pe=le.categoryItemType==je.TARGET_RATING,Ie=le.categoryItemType==je.PREVIOUS_VALUE_PISTON_A,Fe=le.categoryItemType==je.PREVIOUS_VALUE_PISTON_B,Qe=le.categoryItemType==je.PREVIOUS_VALUE_PISTON_RESULT,qe=le.categoryItemType==je.PREVIOUS_VALUE_UOM,Ze=le.categoryItemType==je.PREVIOUS_VALUE_PISTON_RATING,Ve=le.categoryItemType==je.PREVIOUS_VALUE_PISTON_PERCENTAGE,ze=Ie||Fe||Qe||qe||Ze||Ve,Pt=le.categoryItemType==je.PISTON_INPUT_B,O=le.categoryItemType==je.PISTON_INPUT_A,Y=le.categoryItemType==je.PISTON_INPUT_RESULT,Be=Pt||O||Y,Ut=ge||Pe||ze;let Dt;A.isOutOfRange?Dt=Ut||Be:Dt=Ut,Dt&&Q.push({keyValue:le.key,propertyParams:[{propertyName:"value",propertyValue:ze?"-":""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]})}),Q.push({keyValue:s.task.key,propertyParams:[{propertyName:"taskValue",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]}),Q},dt=i(()=>{var Q;let A=[];return(Q=s.task)==null||Q.items.forEach(le=>{le.itemType==="smallCamera"&&(A=le.value)}),A}),St=()=>{var Pe,Ie,Fe,Qe;if(!(((Pe=s.task)==null?void 0:Pe.category)=="CBM")||!e.value.customValidation)return;let le;const ge=e.value.customValidation.includes("cbmTakePhotoAllRating");if(le=e.value.customValidation.includes("cbmDefectTakePhoto"),le&&((Ie=s.task)==null?void 0:Ie.taskValue)!="C"&&((Fe=s.task)==null?void 0:Fe.taskValue)!="X"&&(le=!1),ge||le){const qe=(Qe=s.task)==null?void 0:Qe.items.find(Ze=>Ze.itemType=="smallCamera");if((qe==null?void 0:qe.value).length>0||!e.value.value)return;if(e.value.categoryItemType==je.PISTON_INPUT_A){let Ze=!1;for(const Ve of s.task.items)if(Ve.categoryItemType==je.PISTON_INPUT_B&&Ve.value==""){Ze=!0;break}if(Ze)return}Ne("",!1)}},it=async()=>{var Fe,Qe,qe,Ze;let A={};const Q=s.task,le=Q.items.findIndex(Ve=>Ve.key==e.value.key)+1,ge=Q.items[le];let Pe=Q.items.find(Ve=>Ve.itemType==="smallCamera");if(((Fe=s.task)==null?void 0:Fe.rating)==="AUTOMATIC_REPLACEMENT"||((Qe=s.task)==null?void 0:Qe.rating)==="AUTOMATIC_REPLACEMENT_GAP"){const Ve=S.getCameraItem(((qe=s.task)==null?void 0:qe.groupTaskId)??"",t.stateSelectedSubGroups);Ve&&(Pe=Ve.items.find(ze=>ze.itemType==="smallCamera"))}ge&&Pe&&t.setMeasurementValueAndUOM(e.value.value,ge.value,Pe.key),e.value.categoryItemType!="resultParamRating"&&(L.value=Xe.service({lock:!0,text:"Updating...",background:"rgba(0, 0, 0, 0.7)"}));let Ie;return((Ze=s.task)==null?void 0:Ze.rating)==="AUTOMATIC_REPLACEMENT_GAP"?Ie=t.getCBMResultGap(Q,e.value):Ie=t.getCBMResult(Q,e.value),await(Ie==null?void 0:Ie.then(Ve=>{var ze,Pt,O,Y,Be;if(A=Ve,Ve.status&&(Ve.value&&!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhoto")&&(t.setInputCameraMandatoryKey(e.value.key),M.value||dt.value.length==0&&(D.value=!0),M.value=!1),(Ve.value=="A"||Ve.value=="B")&&!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating")&&(t.setInputCameraMandatoryKey(e.value.key),M.value||dt.value.length==0&&(D.value=!0),M.value=!1),(Ve.value=="C"||Ve.value=="X")&&(!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmDefectTakePhoto")||!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating")?(t.setInputCameraMandatoryKey(e.value.key),M.value||dt.value.length==0&&(D.value=!0),M.value=!1):!a.isUndefined(e.value.customValidation)&&((ze=e.value.customValidation)!=null&&ze.includes("cbmReplaceDefectTakePhoto"))&&(t.setInputCameraMandatoryKey(e.value.key),k.setIsReplacementCamera(!1),M.value=!1)),Ve.value!==""&&(((Pt=s.task)==null?void 0:Pt.rating)??"").includes("AUTOMATIC_REPLACEMENT"))){const Dt=t.getAllReplacementTasks(),qt=t.getReplacementPerGroupTask(Dt,((O=s.task)==null?void 0:O.groupTaskId)??""),la=qt.filter(y=>{var N;return y.key!==((N=s.task)==null?void 0:N.key)&&y.rating!="CAB_SIDE"});t.checkIfAnyRatingValueSet(la)||t.updatePreviousReplacementValue(qt);const ba=t.isAllTaskAlreadyHaveRating(la),ve=S.getCameraItem(((Y=s.task)==null?void 0:Y.groupTaskId)??"",t.stateSelectedSubGroups).items.find(y=>y.itemType=="smallCamera");if(ba&&ve.value.length<2){switch(k.setShowCloseButton(!1),k.setIsReplacementCamera(!0),k.setReplacementPosition("cab side"),k.setReplacementPhotoLength(dt.value.length),b.value="",(Be=s.task)==null?void 0:Be.SectionData){case"HV Alternator":b.value="alternator";break;case"Retarder Grid Box 1":case"Retarder Grid Box 2":b.value="blower motor";break}k.setReplacementTool(b.value),m.value=!0}}}).catch(Ve=>{if((Ve==null?void 0:Ve.message)=="Out of range")throw H.value=!0,setTimeout(()=>{H.value=!1},2e3),new Error("Out of range")}).finally(()=>{L.value&&(L.value.close(),L.value=void 0)})),L.value&&(L.value.close(),L.value=void 0),A},Le=i(()=>k.stateIsCameraError);be(Le,async A=>{A&&t.stateInputCameraMandatoryKey==e.value.key&&(await V(""),t.setInputCameraMandatoryKey(""))});const xt=i(()=>{var ge;const A=(ge=e.value.value)==null?void 0:ge.toString().replaceAll("'","");let Q;const le=e.value.categoryItemType==je.PREVIOUS_VALUE_PISTON_RATING||e.value.categoryItemType==je.PREVIOUS_TARGET_RATING;return(e.value.categoryItemType=="targetRating"||le)&&(A=="A"?Q="a":A=="B"?Q="b":A=="C"?Q="c":A=="X"&&(Q="x")),Q}),Ht=i(()=>{var Be,Ut,Dt,qt,la,oa,ba;const A=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",Q=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",le=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",ge=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let Pe=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";const Ie=!a.isUndefined((Be=s.task)==null?void 0:Be.isShowReplacementRow)&&((Ut=s.task)==null?void 0:Ut.isShowReplacementRow),Fe=!a.isUndefined((Dt=s.task)==null?void 0:Dt.isShowAdjustmentRow)&&((qt=s.task)==null?void 0:qt.isShowAdjustmentRow),Qe=!a.isUndefined((la=s.task)==null?void 0:la.isShowCleanedRow)&&((oa=s.task)==null?void 0:oa.isShowCleanedRow);if(Ie||Fe||Qe||s.isShowAdjustment)Pe="";else{let Qt=0;(ba=s.task)==null||ba.items.forEach(ve=>{var y;a.isUndefined(ve.style)||(a.isUndefined(ve.style.border)?a.isUndefined(ve.style.border)&&(Qt=Qt+Number(ve.style.breakPoint)):((ve.style.border.right=="none"||a.isUndefined(ve.style.border.right))&&(Qt=Qt+Number(ve.style.breakPoint)),a.isEqual(ve,a.last((y=s.task)==null?void 0:y.items))&&(Qt=Qt+Number(ve.style.breakPoint))))}),Qt==12&&(Pe=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const Ze=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",Ve=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",ze=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",Pt=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",O=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let Y="";return Pe&&(Y="padding-bottom: 25px; "),`${Y}${A}${Q}${le}${ge}${Pe}${Ze}${Ve}${ze}${Pt}${O}`}),Ge=i(()=>{var Qe,qe,Ze;if(e.value.valueItemType&&e.value.valueItemType=="comment")return(Qe=s.task)!=null&&Qe.updatedBy&&typeof((qe=s.task)==null?void 0:qe.updatedBy)!="string"?t.employee.id!=s.task.updatedBy.id:!1;const A=e.value.categoryItemType=="targetRating";let Q=!0,le=!0;(Ze=o.value)!=null&&Ze.updatedBy&&e.value.categoryItemType!="paramRating"&&(t.employee.id==o.value.updatedBy.id?Q=!0:Q=!1,!a.isUndefined(e.value.updatedBy)&&!a.isUndefined(e.value.updatedBy.id)&&(t.employee.id==e.value.updatedBy.id?le=!0:le=!1),e.value.categoryItemType=="paramRatingDynamic"&&(le=!0,Q=!0),(e.value.categoryItemType==je.PISTON_INPUT_A||je.PISTON_INPUT_B)&&(le=!0,Q=!0));let ge=!1;!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.visibility)&&e.value.style.visibility=="readonly"&&(ge=!0);let Pe=!0,Ie;e.value.category=="cbmCalculateAvg"&&(t.stateSelectedSubGroups.find(Ve=>Ve.taskGroup.some(ze=>ze.task.some(Pt=>Pt.items.some(O=>(O.key==e.value.targetCalculateKeyId&&(Ie=O),O.key==e.value.targetCalculateKeyId))))),!a.isUndefined(Ie.updatedBy)&&!a.isUndefined(Ie.updatedBy.id)&&(t.employee.id==Ie.updatedBy.id?Pe=!0:Pe=!1)),e.value.categoryItemType=="suspensionParamRating"&&(t.stateStoredAdjustmentOptionValue=="No"||t.stateStoredAdjustmentOptionValue=="1")&&(le=!0,Q=!0),e.value.categoryItemType=="adjustmentSuspensionRating"&&(le=!0,Q=!0);const Fe=fe.value||Re.value;return A||!Q||ge||!le||!Pe||Fe}),Rt=()=>{g.value=!1},pt=()=>{W.value=!1},Ot=()=>{w.value=!1},Xt=async A=>{if(t.stateOilToleranceNotMapped)v.value=!0,e.value.value=vt.value;else{let Q;if(_e()?(Q=await t.getFieldValueByKey(e.value.mappingKeyId,"value"),console.log("offline get oil",Q)):Q=await t.getValueFromItemKey(e.value.mappingKeyId),Q!=""){const le=t.oilTolerance;let ge=le.min,Pe=le.max;le.uom=="%"&&(ge=Number(Q)*(ge/100),Pe=Number(Q)*(Pe/100));const Fe=Number(Q)+Number(ge),Qe=Number(Q)+Number(Pe),qe=parseFloat(Fe.toString()).toFixed(2),Ze=parseFloat(Qe.toString()).toFixed(2),Ve=Number(A)>=Number(qe),ze=Number(A)<=Number(Ze);if(Ve&&ze){const Pt={keyValue:o.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:A},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Ft()}]};c.value=!1,await De(Pt,A),vt.value=A}else u.value=`Range refill capacity is between ${qe} until ${Ze}`,c.value=!1,g.value=!0,e.value.value=vt.value}}},Kt=f(),Tt=A=>{if(document.getElementsByClassName("busy").length>0&&A.preventDefault(),G.value||Z.value||ie.value||Ce.value){let le=A.keyCode?A.keyCode:A.which;if(Z.value&&(A.target.value>100&&A.preventDefault(),A.target.value.includes(".")?A.target.value.split(".")[1].length>=2&&A.preventDefault():A.target.value.length>=3&&A.preventDefault()),le==13){Kt.value.blur();return}(le<48||le>57)&&le!=46&&A.preventDefault()}},vt=f("");Mt(async()=>{var A,Q;vt.value=e.value.value,st.value=e.value.value,await ga(),(A=s.task)!=null&&A.mappingToolGroup&&((Q=s.item)==null?void 0:Q.categoryItemType)=="paramRating"&&Gt(t.dropdownToolGroup),setTimeout(()=>{St()},500)});const Gt=async A=>{for(const Q in A)if(A[Q].itemKeyDisabledReset.find(ge=>ge==s.item.key)){A[Q].isFilled?B.value=!1:B.value=!0;break}};be(()=>t.dropdownToolGroup,A=>{var Q,le;(Q=s.task)!=null&&Q.mappingToolGroup&&((le=s.item)==null?void 0:le.categoryItemType)=="paramRating"&&Gt(A)},{deep:!0}),Ja(()=>{e.value={}});const ea=A=>{if(e.value.valueType=="int"){const Q=`${A}`.split(".");let le=!1,ge=Q[0].length>5;return Q[1]&&(le=Q[1].length>2),ge||le?(u.value="max input length is 5 digits and 2 number after .",!1):!0}else return!0},Ia=i(()=>e.value.isCalculatingTrue);be(Ia,(A,Q)=>{A&&(C.value=!0)});const ga=async()=>{var A;if(!a.isUndefined(e.value.disabledByItemKey)){let Q=t.stateStoredDisableKeyValue.find(le=>le.key==e.value.disabledByItemKey);if(a.isUndefined(Q)){let le;_e()?le=await t.getFieldValueByKey(e.value.disabledByItemKey,"value"):le=await t.getValueFromItemKey(e.value.disabledByItemKey),t.pushStoredDisabledItems({key:e.value.disabledByItemKey,value:le})}Q=t.stateStoredDisableKeyValue.find(le=>le.key==e.value.disabledByItemKey),(Q==null?void 0:Q.value)=="3"?(u.value="",T.value=!0,e.value.value&&((A=s.task)==null?void 0:A.taskType)=="inline"&&(await V("",!1),vt.value="")):T.value=!1}},Ba=i(()=>s.itemLoading);be(Ba,A=>{c.value=A});const Aa=i(()=>t.stateGetDataByParam),Sa=i(()=>t.stateSelectedUOMToolTaskKey);be(Sa,(A,Q)=>{var le,ge;A==((le=s.task)==null?void 0:le.key)&&((ge=s.item)==null?void 0:ge.categoryItemType)=="paramRatingDynamic"&&(vt.value="")}),be(Aa,async(A,Q)=>{A&&await ga()}),be(st,async(A,Q)=>{var le;A==""&&((le=s.item)==null?void 0:le.customValidation)=="Required"&&(vt.value=""),A==""&&q.value&&(vt.value=""),e.value.categoryItemType&&e.value.categoryItemType=="resultParamRating"&&e.value.key==t.stateAvgTargetKey&&A.toString()!=Q&&V(A),e.value.disabledByItemKey||await ga()},{deep:!0});const ta=i(()=>{let A="";return a.isUndefined(e.value.disabledByItemKey)||t.stateStoredDisableKeyValue.forEach(Q=>{Q.key==e.value.disabledByItemKey&&(A=Q.value)}),A}),Na=i(()=>!_e());be(Na,async(A,Q)=>{!A&&Q&&e.value.categoryItemType=="paramRating"&&L.value&&(L.value.close(),L.value=void 0,C.value=!1,V(e.value.value))}),be(ta,async()=>{_e()&&await ga()});const xa=i(()=>x.stateUpdateSuccessFromNetworkError);be(xa,async A=>{A&&(await ga(),x.toggleUpdateSuccessFromNetworkError(!1))});const Ca=i(()=>t.stateStoredAdjustmentOptionValue);be(Ca,(A,Q)=>{var le,ge;Q==2&&A==1&&(le=s.task)!=null&&le.showParameter&&((ge=s.task)==null?void 0:ge.showParameter)=="cylinderHeightNeedAdjustment"&&(vt.value="")},{deep:!0}),be(s.item,(A,Q)=>{e.value=A},{deep:!0});const Ra=i(()=>{let A="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(A=""),A});return(A,Q)=>{const le=ce("el-input");return d(),h(we,null,[l("div",{class:$e([[I.value,z.value,Ra.value],"px-2 pt-2 input-eform-status"]),style:Se(Ht.value)},[R(le,{ref_key:"cbmInput",ref:Kt,class:$e([xt.value,K.value!=""?"service-sheet-input":""]),modelValue:st.value,"onUpdate:modelValue":Q[0]||(Q[0]=ge=>st.value=ge),size:"small","input-style":[ae.value],placeholder:X.value,readonly:Ge.value,onKeypress:Tt,onFocusout:Ke,onChange:Tt,inputmode:$.value,disabled:te.value},ns({_:2},[K.value!=""?{name:"append",fn:ee(()=>[Ee(ue(K.value),1)]),key:"0"}:void 0]),1032,["class","modelValue","input-style","placeholder","readonly","inputmode","disabled"]),u.value!=""?(d(),h("label",Ln,ue(u.value),1)):E("",!0),C.value?(d(),h("div",En,jn)):E("",!0),c.value?(d(),h("div",Hn,qn)):E("",!0),P.value?(d(),h("div",Wn,zn)):E("",!0)],6),R(Nn,{show:g.value,onClose:Rt},null,8,["show"]),R(Ml,{show:W.value,onClose:pt},null,8,["show"]),R(jl,{show:w.value,onClose:Ot},null,8,["show"]),R(Hl,{show:D.value,onClose:U},null,8,["show"]),R(Gs,{show:m.value,item:A.$props.item,tool:b.value,side:J(k).replacementPosition,onClose:p},null,8,["show","item","tool","side"]),R(Wa,{visibility:H.value,isCloseButtonShow:!1,caption:"Out Of Range",onOnClose:Q[1]||(Q[1]=()=>{H.value=!1})},null,8,["visibility"]),R(Wa,{visibility:F.value,isCloseButtonShow:!1,caption:"Piston B must be greater or equal to Piston A",onOnClose:Q[2]||(Q[2]=()=>{F.value=!1})},null,8,["visibility"])],64)}}}),Ss=n=>(Yt("data-v-81acc29f"),n=n(),zt(),n),Xn=Ss(()=>l("span",{class:"el-dialog__title",style:{"word-break":"break-word !important","font-size":"18px !important"}},"Detailed picture of Cab Side & Off Cab Side",-1)),Qn={class:"row d-flex flex-column"},Zn={key:0,class:"photo-wrapper"},ei=Ss(()=>l("span",{class:"sub-title"},[l("strong",null,"Cab Side")],-1)),ti={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center"}},ai={class:"d-flex justify-content-center"},si={style:{position:"relative",width:"fit-content"}},li=["src"],oi=Ss(()=>l("div",{class:"my-2"},null,-1)),ri={key:1,class:"photo-wrapper"},ni=Ss(()=>l("span",{class:"sub-title"},[l("strong",null,"Off Cab Side")],-1)),ii={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center",position:"relative"}},ui={class:"d-flex justify-content-center"},di={style:{position:"relative",width:"fit-content"}},ci=["src"],mi=Ue({__name:"OfflineImagePreviewCabSide",props:{visibility:{type:Boolean,required:!1},images:{type:Array,required:!0},viewOnly:{type:Boolean,default:!0}},emits:["onClose","onDelete"],setup(n,{expose:s,emit:e}){const o=n,t=e,r=f([]),g=Me(o,"visibility"),u=f(0),_=f(!1),C=f(!1),v=Rl("(min-width: 1000px)"),c=f(!1),k=f(""),P=f(!1),B=f(),m=f(),b=f(),S=f([]),L=ya(),H=i(()=>v.value?"70%":"90%"),F=async()=>{m.value=o.images.find(T=>T.type=="cab side"),m.value||(m.value=o.images.find(T=>!T.type)),m.value&&await w(m.value.filename)},x=async()=>{b.value=o.images.find(T=>T.type=="off cab side"),!b.value&&o.images.length>0&&(b.value=o.images.find(T=>{var $;return T.filename!=(($=m.value)==null?void 0:$.filename)})),b.value&&await D(b.value.filename)},p=T=>{var ae;if(r.value.length<1)return;let $;return $=(ae=r.value.find(G=>G.key==T))==null?void 0:ae.value,$},K=()=>{g.value=!1,t("onClose",null)},X=()=>{S.value=o.images.map(T=>({imgBlob:T.filename,url:"",description:T.description}))},W=()=>{X(),u.value=0,r.value=[],o.images&&(F(),x())},w=async T=>{_.value=!0,await U(T),_.value=!1},D=async T=>{C.value=!0,await U(T),C.value=!1},U=async T=>{const $={fileUrl:T,ver:"v1"};try{let ae="";const G=await na.pendingTaskFile.where({filename:T}).first(),Z=window.URL||window.webkitURL;if(!G&&!_e()){const ie=`https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/attachment/download_by_url?${new URLSearchParams($).toString()}`,Ce=await os.getBlob(ie),st=new Blob([Ce.data]);ae=URL.createObjectURL(st),await Uo(na,"pendingTaskFile",{key:L.stateDumpToLocalInfo.taskKey,module:"serviceForm",workorder:L.stateDumpToLocalInfo.workOrder,type:L.stateDumpToLocalInfo.type,createdBy:L.stateDumpToLocalInfo.updatedBy,email:L.stateDumpToLocalInfo.email,filename:T,blob:st,status:"Sync",syncDate:Ua()})}else a.isUndefined(G)?ae="":ae=Z.createObjectURL(G.blob);r.value.push({key:T,value:ae}),S.value.forEach(ie=>{ie.imgBlob==T&&(ie.url=ae)})}catch(ae){console.log("image",ae)}},I=T=>{const $=S.value.findIndex(G=>G.imgBlob==T),ae=S.value[$];if($>0){const G=S.value.slice($),Z=S.value.slice(0,$);S.value=[...G,...Z]}k.value=ae.url,c.value=!0},z=()=>{k.value="",c.value=!1},oe=T=>{P.value=!0,B.value=T},me=()=>{P.value=!1},M=()=>{if(!B.value)return;const T={filename:B.value.filename,type:B.value.type};t("onDelete",T),B.value.type=="front"?m.value=void 0:b.value=void 0,B.value=void 0,P.value=!1};return s({openFirstReRender:()=>{W()}}),(T,$)=>{const ae=ce("el-skeleton-item"),G=ce("NwImg"),Z=ce("el-skeleton"),ie=ce("el-dialog");return d(),h(we,null,[R(ie,{modelValue:g.value,"onUpdate:modelValue":$[4]||($[4]=Ce=>g.value=Ce),title:"Detailed picture of Cab Side & Off Cab Side",width:H.value,onOpened:W,onClose:K},{title:ee(()=>[Xn]),default:ee(()=>[l("div",Qn,[m.value?(d(),h("div",Zn,[ei,R(Z,{loading:_.value,animated:""},{template:ee(()=>[R(ae,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:ee(()=>[l("div",ti,[l("div",ai,[l("div",si,[n.viewOnly?E("",!0):(d(),re(G,{key:0,onClick:$[0]||($[0]=Ce=>oe(m.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),p(m.value.filename)!=null?(d(),h("img",{key:1,src:p(m.value.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",onClick:$[1]||($[1]=Ce=>I(m.value.filename)),class:"front"},null,8,li)):E("",!0)])])])]),_:1},8,["loading"])])):E("",!0),oi,b.value?(d(),h("div",ri,[ni,R(Z,{loading:C.value,animated:""},{template:ee(()=>[R(ae,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:ee(()=>[l("div",ii,[l("div",ui,[l("div",di,[n.viewOnly?E("",!0):(d(),re(G,{key:0,onClick:$[2]||($[2]=Ce=>oe(b.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),p(b.value.filename)!=null?(d(),h("img",{key:1,src:p(b.value.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",class:"back",onClick:$[3]||($[3]=Ce=>I(b.value.filename))},null,8,ci)):E("",!0)])])])]),_:1},8,["loading"])])):E("",!0)])]),_:1},8,["modelValue","width"]),R(ca,{visibility:P.value,caption:"Are you sure want to delete this image?",onOnNoConfirm:me,onOnYesConfirm:M},null,8,["visibility"]),R(Vl,{images:S.value,visibility:c.value,image:k.value,onHandleClose:z},null,8,["images","visibility","image"])],64)}}}),fi=Ct(mi,[["__scopeId","data-v-81acc29f"]]),vi=["disabled"],pi={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},yi={class:"text-white"},Wl=Ue({__name:"SmallCamera",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object},isShowAdjustment:{type:Boolean},generalSubmitted:{required:!0,type:Boolean}},setup(n){const s=n,e=Me(s,"item"),o=f(!1),t=Me(s,"task"),r=rt(),g=ya(),u=Jt(),_=f(!1),C=f(),v=Ye(()=>s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),c=Ye(()=>{let M="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(M=`col-md-${e.value.style.potraitBreakPoint}`,M=`${M} col-lg-${e.value.style.breakPoint}`):(M=`col-md-${e.value.style.potraitBreakPoint}`,M=`${M} col-lg-${e.value.style.breakPoint}`)),M}),k=Ye(()=>e.value.value?yt(e.value.value):[]),P=Ye(()=>{var te,T,$;let M=!1;if(((te=s.task)==null?void 0:te.category)=="CBM")s.task.items.every(ae=>{var G,Z;if(ae.itemType=="dropDown"||ae.itemType=="input"){if(ae.customValidation=="cbmTakePhotoAllRating")return M=!0,!1;if(ae.customValidation=="cbmDefectTakePhoto"&&(((G=s.task)==null?void 0:G.taskValue)=="C"||((Z=s.task)==null?void 0:Z.taskValue)=="X"))return M=!0,!1}return!0});else if(((T=s.task)==null?void 0:T.category)=="NORMAL"&&(($=s.task)==null?void 0:$.rating)=="SERVICE_CLEANED_AND_REPLACED")return!0;return M}),B=async M=>{e.value.value=yt(e.value.value);const te=e.value.value;e.value.value=te.filter(T=>T.filename!=M.filename),g.setIsReplacementCamera(!0),g.setCurrent(e.value.key),await X().then(()=>{g.clearCurrent(),e.value.value.length<2&&(g.setReplacementPosition(M.type),I())})},m=Ye(()=>{var te;let M="";switch((te=s.task)==null?void 0:te.SectionData){case"HV Alternator":M="alternator";break;case"Retarder Grid Box 1":case"Retarder Grid Box 2":M="blower motor";break}return M});be(k,()=>{L()});const b=(M=!1,te=!0)=>{var G,Z;const T=L()=="camRead";let $=!0;const ae=!!((Z=(G=s.task)==null?void 0:G.updatedBy)!=null&&Z.id);if(!(T||ae&&!$)){if(r.generalForm.status=="Submited"){r.toggleFormAlreadySubmitted(!0);return}g.setIsActionFromDelete(M),g.toggleIsVisible(!0,e.value.key),g.setShowCloseButton(te),g.addLocalImageInfo({taskKey:s.task.key,workOrder:r.generalForm.workOrder,type:"task",updatedBy:r.employee.id,email:u.user.Email})}},S=Ye(()=>a.cloneDeep(g.ImageObjects.find(M=>M.Id===e.value.key))),L=()=>{var te,T,$,ae,G;let M="camActive";return!a.isUndefined((T=(te=s.task)==null?void 0:te.updatedBy)==null?void 0:T.id)&&!a.isUndefined(e.value.updatedBy.id)&&(((ae=($=s.task)==null?void 0:$.updatedBy)==null?void 0:ae.id)==r.employee.id,k.value.length==0?M="camActive":M="camUser"),((G=s.task)==null?void 0:G.rating)==="CAB_SIDE"&&k.value.length===2&&(M="camRead"),M},H=Ye(()=>s.generalSubmitted?L()!="camRead":!1),F=()=>{var M;((M=s.task)==null?void 0:M.rating)=="CAB_SIDE"&&g.setIsReplacementCamera(!0),o.value=!0},x=()=>{o.value=!1},p=Ye(()=>{var fe,Re,Ne,Ae,ut,mt,ct;const M=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",te=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",T=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",$=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let ae=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";const G=!a.isUndefined((fe=s.task)==null?void 0:fe.isShowReplacementRow)&&((Re=s.task)==null?void 0:Re.isShowReplacementRow),Z=!a.isUndefined((Ne=s.task)==null?void 0:Ne.isShowAdjustmentRow)&&((Ae=s.task)==null?void 0:Ae.isShowAdjustmentRow),ie=!a.isUndefined((ut=s.task)==null?void 0:ut.isShowCleanedRow)&&((mt=s.task)==null?void 0:mt.isShowCleanedRow);if(G||Z||ie||s.isShowAdjustment)ae="";else{let se=0;(ct=s.task)==null||ct.items.forEach(ke=>{var De;a.isUndefined(ke.style)||(a.isUndefined(ke.style.border)?a.isUndefined(ke.style.border)&&(se=se+Number(ke.style.breakPoint)):((ke.style.border.right=="none"||a.isUndefined(ke.style.border.right))&&(se=se+Number(ke.style.breakPoint)),a.isEqual(ke,a.last((De=s.task)==null?void 0:De.items))&&(se=se+Number(ke.style.breakPoint))))}),se==12&&(ae=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const st=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",Ke=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",$t=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",kt=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",V=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let q="";return ae&&(q="padding-bottom: 25px; "),`${q}${M}${te}${T}${$}${ae}${st}${Ke}${$t}${kt}${V}`}),K=async M=>{if(P.value&&k.value.length==1)o.value=!1,b(!0);else{const te=a.uniqBy(e.value.value,"filename");e.value.value=te.filter(T=>T!=M),g.setCurrent(e.value.key),g.clearCurrent(),await X(),e.value.value.length==0&&x()}},X=async()=>{var $;const M={keyValue:t.value.key,propertyParams:[{propertyName:"updatedBy",propertyValue:JSON.stringify(r.employee)},{propertyName:"updatedDate",propertyValue:Ft()}]};e.value.isTaskValue&&M.propertyParams.push({propertyName:"taskValue",propertyValue:JSON.stringify(e.value.value)});const te=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:JSON.stringify(e.value.value)},{propertyName:"updatedBy",propertyValue:JSON.stringify(r.employee)},{propertyName:"updatedDate",propertyValue:Ft()}]}];!a.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&te.push(M);const T=La(s.task);if(_e())r.updateServiceSheetTaskOnLocalDB(te,s.task.key,s.item.key,!1,T);else{const ae={taskKey:($=s.task)==null?void 0:$.key,targetItem:e.value.key,bindingKey:T};r.updateServiceSheetTaskValue(te,u.user.EmployeeId,u.user.Name,!0,"",ae)}},W=f(!1),w=()=>{W.value=!1},D=()=>{W.value=!1,g.isReplacementCamera&&e.value.value.length<2?I():b(!1,!0)},U=async()=>{var ae;_.value=!1,e.value.value==""&&(e.value.value=[]);let M=[];S.value&&(M=yt(S.value.ImageInfos));const te=yt(e.value.value),T=M.filter(G=>!te.includes(G));if(e.value.value=yt(e.value.value),g.IsFromActionDelete)e.value.value=T;else{const G=a.uniqBy([...e.value.value,...T],"filename");e.value.value=Array.from(G)}const $=((ae=s.task)==null?void 0:ae.rating)=="CAB_SIDE";g.setIsReplacementCamera($),await X().then(()=>{g.isReplacementCamera?g.isReplacementCamera&&e.value.value.length<2&&(_.value=!0):W.value=!0,setTimeout(()=>{var G;(G=C.value)==null||G.openFirstReRender()},2e3),setTimeout(()=>{var G;(G=C.value)==null||G.openFirstReRender()},2e3)}),g.setReplacementPhotoLength(e.value.value.length),g.setIsActionFromDelete(!1)},I=()=>{g.setIsActionFromDelete(!1),g.setShowCloseButton(!1),g.toggleIsVisible(!0,e.value.key)},z=Ye(()=>r.generalForm.status=="Submited"),oe=Ye(()=>{var ae;if(!s.generalSubmitted)return!0;let M=!0,te=!1,T=!1;t.value.items.every(G=>G.categoryItemType=="paramRatingDynamic"?(T=!0,!1):!0),T&&(M=!0,t.value.items.every(G=>G.itemType=="dropDown"&&(G.categoryItemType=="dropdownTool"||G.categoryItemType=="dropdownToolDisc")&&G.value==""?(te=!0,!1):!0));let $=!1;return((ae=s.task)==null?void 0:ae.rating)==="CAB_SIDE"&&s.item.value.length===2&&($=!0),!M||te||$||z.value});be(S,async(M,te)=>{!a.isUndefined(M)&&M.ImageInfos.length>0&&(M.ImageInfos.length!=(te==null?void 0:te.ImageInfos.length)?await U():g.IsFromActionDelete&&(a.isEqual(M,te)||await U()))},{deep:!0});const me=Ye(()=>{let M="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(M=""),M});return(M,te)=>{var $;const T=ce("NwImg");return d(),h("div",{class:$e([[J(v),J(c),J(me)],"pt-2"]),style:Se(J(p))},[l("div",{class:$e(["row",!J(a.isUndefined)(e.value.value)&&e.value.value.length>0?"justify-content-around":"justify-content-center"])},[l("div",{class:$e(["d-flex justify-content-center",!J(a.isUndefined)(e.value.value)&&e.value.value.length>0?"col-6 pe-0 ps-1":"col-6 px-0"])},[l("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:te[0]||(te[0]=ae=>b()),disabled:J(oe)},[L()=="camUser"?(d(),re(T,{key:0,src:"/media/svg/dma/camera/e-form/png/cam-user.png",style:{height:"12px",width:"14px"},alt:"camera"})):L()=="camRead"?(d(),re(T,{key:1,src:"/media/svg/dma/camera/e-form/png/cam-read.png",style:{height:"12px",width:"14px"},alt:"camera"})):(d(),re(T,{key:2,src:"/media/svg/dma/camera/e-form/png/cam-active.png",style:{height:"12px",width:"14px"},alt:"camera"}))],8,vi)],2),J(k)&&J(k).length>0?(d(),h("div",pi,[l("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:F,style:{"background-color":"#18AF4A"}},[l("label",yi,"+"+ue(J(k).length),1)])])):E("",!0)],2),o.value?(d(),h(we,{key:0},[(($=n.task)==null?void 0:$.rating)=="CAB_SIDE"?(d(),re(fi,{key:0,ref_key:"preview",ref:C,images:J(k),visibility:o.value,"view-only":!1,onOnClose:x,onOnDelete:B},null,8,["images","visibility"])):(d(),re(Ma,{key:1,images:J(k),visibility:o.value,showDeleteButton:J(H),onHandleClose:x,onHandleDelete:K,showRemainingPhotosMessage:!0},null,8,["images","visibility","showDeleteButton"]))],64)):E("",!0),R(Gs,{show:_.value,item:M.$props.item,tool:J(m),side:"off cab side",onClose:D},null,8,["show","item","tool"]),R(Dl,{visibility:W.value,caption:"The photo successfully taken, would you like to take another photo?",onOnNoConfirm:w,onOnYesConfirm:D},null,8,["visibility"])],6)}}}),gi={class:"p-2"},bi={class:"form-check checkbox-success item-checkbox"},Jl=Ue({__name:"CheckBox",props:{item:{type:Object,required:!0},task:{type:Object},generalStyle:{type:Boolean,default:!0}},setup(n){const s=n,e=Me(s,"item"),o=Me(s,"task"),t=rt(),r=Jt(),g=i({get:()=>JSON.parse(s.item.value),set:async c=>{var B;const k={keyValue:(B=o.value)==null?void 0:B.key,propertyParams:[{propertyName:"taskValue",propertyValue:e.value.value.toString()},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]},P=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:c.toString()},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}];!a.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&P.push(k),await t.updateServiceSheetTaskValue(P,r.user.EmployeeId,r.user.Name)}}),u=i(()=>!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col"),_=i(()=>{let c="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(c=`col-md-${e.value.style.potraitBreakPoint}`,c=`${c} col-lg-${e.value.style.breakPoint}`):(c=`col-md-${e.value.style.potraitBreakPoint}`,c=`${c} col-lg-${e.value.style.breakPoint}`)),c}),C=i(()=>{var w,D,U,I,z,oe,me;const c=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",k=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",P=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",B=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let m=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";const b=!a.isUndefined((w=s.task)==null?void 0:w.isShowReplacementRow)&&((D=s.task)==null?void 0:D.isShowReplacementRow),S=!a.isUndefined((U=s.task)==null?void 0:U.isShowAdjustmentRow)&&((I=s.task)==null?void 0:I.isShowAdjustmentRow),L=!a.isUndefined((z=s.task)==null?void 0:z.isShowCleanedRow)&&((oe=s.task)==null?void 0:oe.isShowCleanedRow);if(b||S||L)m="";else{let M=0;(me=s.task)==null||me.items.forEach(te=>{var T;a.isUndefined(te.style)||(a.isUndefined(te.style.border)?a.isUndefined(te.style.border)&&(M=M+Number(te.style.breakPoint)):((te.style.border.right=="none"||a.isUndefined(te.style.border.right))&&(M=M+Number(te.style.breakPoint)),a.isEqual(te,a.last((T=s.task)==null?void 0:T.items))&&(M=M+Number(te.style.breakPoint))))}),M==12&&(m=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const F=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",x=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",p=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",K=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",X=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let W="";return m&&(W="padding-bottom: 25px; "),`${W}${c}${k}${P}${B}${m}${F}${x}${p}${K}${X}`}),v=i(()=>{let c="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(c=""),c});return(c,k)=>(d(),h("div",{class:$e([[_.value,u.value,v.value],"pt-2 px-2 d-flex align-items-center d-flex justify-content-center"]),style:Se(C.value)},[l("div",gi,[l("div",bi,[Nt(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=P=>g.value=P)},null,512),[[Ya,g.value]])])])],6))}}),ki={key:0,style:{height:"100px"}},hi={key:0,class:"row text-center my-10"},_i={class:"text-danger"},wi={key:1,class:"row justify-content-end pt-4 pe-10"},Si={class:"div page-controller",style:{"margin-left":"auto"}},Ci=["disabled"],Ri=["disabled"],qs=Ue({__name:"OfflinePDFViewerDialog",props:{show:{type:Boolean,required:!0},blobUrl:{type:String,required:!0}},emits:["handleCloseModal"],setup(n,{emit:s}){const e=n,o=s,t=f(""),r=f(1),g=f(1),u=f(!0);f(null);const _=f(""),C=f(!1);wa();const v=Me(e,"show"),c=async()=>{if(C.value=!1,t.value="",r.value=1,g.value=1,e.blobUrl!=""){const B=`ver=v1&fileUrl=${e.blobUrl}`,m=window.URL||window.webkitURL;try{u.value=!0;const b=`https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_attachment/download_by_url?${B}`;if(_e())await k(m);else{let S=!0;const L=await Tl(e.blobUrl);if(!a.isEmpty(L)&&L.createdDate){const H=new Date,F=L.createdDate;(H.getTime()-F.getTime())/(1e3*60*60*24)<1&&(S=!1)}if(S){const F=(await os.getBlob(b)).data,x=new Blob([F]);t.value=m.createObjectURL(x);const p=await na.taskReference.where({filename:e.blobUrl});p&&p.delete(),await na.taskReference.add({workorder:L.workorder,filename:e.blobUrl,file:x,fileType:"pdf",createdDate:new Date})}else await k(m)}}catch(b){console.log("error show pdf",b),C.value=!0,e.blobUrl.includes("#")?_.value="PDF not yet attached":_.value=`${b}`}finally{u.value=!1}}},k=async B=>{const m=await na.taskReference.where({filename:e.blobUrl}).first();m?t.value=B.createObjectURL(m.file):(C.value=!0,_.value="Error Getting PDF on offline mode")};Mt(async()=>{await c()}),be(v,B=>{B&&c()},{deep:!0});const P=()=>{o("handleCloseModal")};return(B,m)=>{const b=ce("el-dialog"),S=rs("loading");return d(),re(b,{modelValue:v.value,"onUpdate:modelValue":m[2]||(m[2]=L=>v.value=L),title:"Preview",width:"80%","custom-class":"show-pdf","close-on-click-modal":!1,"close-on-press-escape":!1,onClose:m[3]||(m[3]=L=>P())},{default:ee(()=>[u.value?Nt((d(),h("div",ki,null,512)),[[S,u.value]]):(d(),h(we,{key:1},[C.value?(d(),h("div",hi,[l("span",_i,ue(_.value),1)])):(d(),h("div",wi,[l("div",Si,[l("button",{type:"button",disabled:r.value<=1,onClick:m[0]||(m[0]=L=>r.value--),class:"btn btn-success btn-sm ok-button"},"â®",8,Ci),Ee(" "+ue(r.value)+" / "+ue(g.value)+" ",1),l("button",{type:"button",disabled:r.value>=g.value,onClick:m[1]||(m[1]=L=>r.value++),class:"btn btn-success btn-sm ok-button"},"â¯",8,Ri)])]))],64))]),_:1},8,["modelValue"])}}}),Ti=["innerHTML"],Yl=Ue({__name:"OfflineHTML",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object},isShowAdjustment:{type:Boolean}},setup(n){const s=n,e=Me(s,"item"),o=f(null),t=f(""),r=i(()=>{var b;return(b=Ha(s.item.value))==null?void 0:b.replaceAll("{BLOB_URL}","https://digitaldevbumaausta001.blob.core.windows.net")}),g=i(()=>s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),u=i(()=>a.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),_=i(()=>{var oe,me,M,te,T,$,ae;const b=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",S=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",L=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",H=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"",F=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.padding)&&e.value.style.padding.right!="none"?`padding-right: ${e.value.style.padding.right}; !important `:"";let x=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";const p=!a.isUndefined((oe=s.task)==null?void 0:oe.isShowReplacementRow)&&((me=s.task)==null?void 0:me.isShowReplacementRow),K=!a.isUndefined((M=s.task)==null?void 0:M.isShowAdjustmentRow)&&((te=s.task)==null?void 0:te.isShowAdjustmentRow),X=!a.isUndefined((T=s.task)==null?void 0:T.isShowCleanedRow)&&(($=s.task)==null?void 0:$.isShowCleanedRow);if(p||K||X||s.isShowAdjustment)x="";else{let G=0;(ae=s.task)==null||ae.items.forEach(Z=>{var ie;a.isUndefined(Z.style)||(a.isUndefined(Z.style.border)?a.isUndefined(Z.style.border)&&(G=G+Number(Z.style.breakPoint)):((Z.style.border.right=="none"||a.isUndefined(Z.style.border.right))&&(G=G+Number(Z.style.breakPoint)),a.isEqual(Z,a.last((ie=s.task)==null?void 0:ie.items))&&(G=G+Number(Z.style.breakPoint))))}),G==12&&(x=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const w=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",D=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",U=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",I=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",z=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${b}${S}${L}${H}${x}${w}${D}${U}${I}${z}${F}`}),C=i(()=>`${!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.fontWeight)&&e.value.style.fontWeight!="normal"?`font-weight: ${e.value.style.fontWeight}; `:""}`),v=f(!1),c=b=>{v.value=b},k=i(()=>{let b="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(b=`col-md-${e.value.style.potraitBreakPoint}`,b=`${b} col-lg-${e.value.style.breakPoint}`),b});Mt(()=>{try{Array.from(o.value.getElementsByClassName("show-pdf")).forEach(S=>{S.onclick=L=>{L.preventDefault(),P.value=!0,t.value=S.href}})}catch(b){console.log(b)}try{Array.from(o.value.getElementsByClassName("spv-print-pdf")).forEach(S=>{S.onclick=L=>{L.preventDefault(),P.value=!0,t.value=S.href,c(!0)}})}catch(b){console.log(b)}});const P=f(!1),B=()=>{P.value=!1},m=i(()=>{let b="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(b=""),b});return(b,S)=>(d(),h(we,null,[l("div",{class:$e([[g.value,u.value,k.value,m.value],"px-2 pt-2"]),style:Se(_.value)},[!J(a.isUndefined)(n.item.style)&&n.item.style.visibility!="hidden"?(d(),h("span",{key:0,ref_key:"html",ref:o,innerHTML:r.value,style:Se(C.value)},null,12,Ti)):E("",!0)],6),R(qs,{show:P.value,onHandleCloseModal:B,"blob-url":t.value},null,8,["show","blob-url"]),R(xs,{show:v.value,onClose:c,"title-pop-up":"if required, see your supervisor to print this"},null,8,["show"])],64))}}),zl=Ue({__name:"InteractiveButton",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object},isShowAdjustment:{type:Boolean}},emits:["showTaskAdjustment"],setup(n,{emit:s}){const e=n,o=s,t=Me(e,"item"),r=Me(e,"task"),g=i(()=>e.generalStyle?!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col":""),u=i(()=>!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:""),_=i(()=>!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; border-color: ${t.value.style.bgColor};`:""),C=rt(),v=i(()=>{let H="";return e.task.isShowAdjustmentRow&&(H="opacity: 50%;"),e.task.isShowReplacementRow&&(H="opacity: 50%;"),k.value&&(H="opacity: 50%;"),H}),c=i(()=>C.generalForm.status=="Submited"),k=i(()=>{const H=e.task.taskValue=="";let F=e.task.taskValue=="A"||e.task.taskValue=="B";e.task.rating==Ms.MANUAL_CLEANED&&(F=e.task.taskValue=="A");let x=!0;return!a.isUndefined(e.task.updatedBy)&&!a.isUndefined(e.task.updatedBy.id)&&(C.employee.id==e.task.updatedBy.id?x=!0:x=!1),H||F||e.task.isShowAdjustmentRow||!x||e.isShowAdjustment||c.value||e.task.isShowReplacementRow||e.task.isShowCleanedRow}),P=i(()=>{let H="";return e.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(H=`col-md-${t.value.style.potraitBreakPoint}`,H=`${H} col-lg-${t.value.style.breakPoint}`):(H=`col-md-${t.value.style.potraitBreakPoint}`,H=`${H} col-lg-${t.value.style.breakPoint}`)),H}),B=i(()=>a.isUndefined(t.value.style)?"":t.value.style.textAlign=="left"?"text-start":t.value.style.textAlign=="right"?"text-end":"text-center"),m=i(()=>{var me,M,te,T,$,ae,G;const H=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",F=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let x=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";const p=!a.isUndefined((me=e.task)==null?void 0:me.isShowReplacementRow)&&((M=e.task)==null?void 0:M.isShowReplacementRow),K=!a.isUndefined((te=e.task)==null?void 0:te.isShowAdjustmentRow)&&((T=e.task)==null?void 0:T.isShowAdjustmentRow),X=!a.isUndefined(($=e.task)==null?void 0:$.isShowCleanedRow)&&((ae=e.task)==null?void 0:ae.isShowCleanedRow);if(p||K||X||e.isShowAdjustment)x="";else{let Z=0;(G=e.task)==null||G.items.forEach(ie=>{var Ce;a.isUndefined(ie.style)||(a.isUndefined(ie.style.border)?a.isUndefined(ie.style.border)&&(Z=Z+Number(ie.style.breakPoint)):((ie.style.border.right=="none"||a.isUndefined(ie.style.border.right))&&(Z=Z+Number(ie.style.breakPoint)),a.isEqual(ie,a.last((Ce=e.task)==null?void 0:Ce.items))&&(Z=Z+Number(ie.style.breakPoint))))}),Z==12&&(x=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const w=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",D=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",U=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",I=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",z=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";let oe="";return x&&(oe="padding-bottom: 25px; "),`${oe}${H}${F}${x}${w}${D}${U}${I}${z}`}),b=async()=>{var H,F,x;if(!((H=r.value)!=null&&H.replacement.measurement)){const p={modelId:C.stateGeneralForm.modelId,psTypeId:C.stateGeneralForm.psTypeId,taskId:(F=r.value)==null?void 0:F.key},K=(x=r.value)==null?void 0:x.replacement;K&&(K.measurement=await C.getReplacementDefault(p))}},S=()=>{t.value.value=="Adjustment"?(r.value.isShowAdjustmentRow=!0,o("showTaskAdjustment",!0)):t.value.value==="Replaced"?b().then(()=>{r.value&&(r.value.isShowReplacementRow=!0,o("showTaskAdjustment",!0))}):t.value.value=="Cleaned"&&(r.value&&(r.value.isShowCleanedRow=!0),o("showTaskAdjustment",!0))},L=i(()=>{let H="pb-2";return!a.isUndefined(e.task.updatedBy.name)&&e.task.updatedBy.name&&(H=""),H});return(H,F)=>{const x=ce("el-button");return d(),h("div",{class:$e([[g.value,B.value,P.value,L.value],"px-2 pt-2"]),style:Se(m.value)},[!J(a.isUndefined)(n.item.style)&&n.item.style.visibility!="hidden"?(d(),re(x,{key:0,style:Se([u.value,_.value,v.value]),size:"small",type:"success",onClick:S,class:"item-button w-100",disabled:k.value},{default:ee(()=>[Ee(ue(n.item.value),1)]),_:1},8,["style","disabled"])):E("",!0)],6)}}}),Ui={class:"row w-100"},Ii=l("div",{class:"col-1 pb-1 px-2"},null,-1),$i={class:"col-2 pb-1 px-2",style:Se([])},Pi={key:0,class:"text-danger ps-2 font-weight-bold"},Di={key:1,class:"d-flex align-items-center"},Vi=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),Bi=l("span",{class:"timestamp-task"},"Updating...",-1),Ai=[Vi,Bi],Ni={class:"col-1 pb-1 px-2",style:Se([])},xi={class:"col-1 col-md-1 pb-1 px-2 input-eform-status",style:Se([])},Oi={class:"col-1 col-md-1 pb-1 px-2",style:Se([])},Li={class:"row justify-content-center"},Ei={class:"px-0 col-6 d-flex justify-content-center"},Fi=["disabled"],Mi=["src"],ji={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},Hi={class:"text-white"},Ki={key:0,class:"row w-100"},Gi={key:1,class:"row w-100"},qi=l("div",{class:"col-1 pb-1 px-2"},null,-1),Wi={key:0,class:"d-flex align-items-center"},Ji=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),Yi=l("span",{class:"timestamp-task"},"Updating...",-1),zi=[Ji,Yi],Xi=Ue({__name:"TaskAdjustment",props:{task:{type:Object,required:!0},generalSubmitted:{required:!0,type:Boolean}},emits:["showTaskAdjustment"],setup(n,{emit:s}){const e=n,o=s;wa();const t=async V=>{const q=r.value.adjustment.pictures;r.value.adjustment.pictures=q.filter(fe=>fe!=V),I.setCurrent(`${r.value.key}-adjustment`),I.clearCurrent(),await D.addCBMAdjustmentPictures(r.value),r.value.adjustment.pictures.length==0},r=Me(e,"task"),g=f(!1),u=f(""),_=f(!1),C=i(()=>{let V="col-4 col-md-3";return e.task.adjustment.isCommentAdjustment&&(V="col-5 col-md-4"),V}),v=i(()=>{let V="col-2";return e.task.adjustment.isCommentAdjustment&&(V="col-1"),V}),c=i(()=>{let V="col-4 col-md-3 ";return e.task.adjustment.isCommentAdjustment&&(V="col-5 col-md-4"),V}),k=i(()=>{let V="col-6 col-md-7 ";return e.task.adjustment.isCommentAdjustment&&(V="col-5 col-md-6"),V}),P=i({get:()=>r.value.adjustment.measurement,set:V=>{const q=V;if(!isNaN(Number(q))){{if(q.length>8)return;if((`${q}`.split(".")||[]).length-1>1)return;if(q.includes(".")){if(`${q}`.split(".")[1].length>2)return;r.value.adjustment.measurement=q}if(q.length>5){if(q.length>=6&&q.length<=6){if(q[5]!=".")return;r.value.adjustment.measurement=q}}else r.value.adjustment.measurement}r.value.adjustment.measurement=q}}}),B=i(()=>r.value.adjustment.pictures?yt(r.value.adjustment.pictures):[]),m=i(()=>D.generalForm.status=="Submited"),b=i(()=>!e.generalSubmitted),S=i(()=>!!0||m.value),L=i(()=>e.generalSubmitted?!!0||m.value:!0),H=i(()=>{var q,fe;if(!e.generalSubmitted)return!0;let V=!0;return(q=r.value)!=null&&q.adjustment.updatedBy&&D.employee.id!=((fe=r.value)==null?void 0:fe.adjustment.updatedBy).id&&(V=!1),!V||m.value}),F=()=>{g.value=!1},x=()=>{g.value=!0},p=i(()=>{let V="";return e.task.items.forEach(q=>{!a.isUndefined(q.style)&&!a.isUndefined(q.style.border)&&q.style.border.left!="none"&&(V=q.style.border.left)}),V}),K=i(()=>{let V="",q=!1;return r.value.items.forEach(fe=>{!a.isUndefined(fe.style)&&!a.isUndefined(fe.style.border)&&fe.style.border.bottom!="none"&&(q=!0)}),q&&(V=`border-bottom: ${p.value}`),V});i(()=>{let V=!1;r.value.items.forEach(fe=>{!a.isUndefined(fe.style)&&!a.isUndefined(fe.style.border)&&fe.style.border.bottom!="none"&&(V=!0)});let q="";return r.value.adjustment.updatedBy.name!=""&&V&&(q=`border-bottom: ${p.value}`),q});const X=f(),W=V=>{var fe;let q=V.keyCode?V.keyCode:V.which;if(q==13){(fe=X.value)==null||fe.blur();return}(q<48||q>57)&&q!=46&&V.preventDefault()},w=()=>a.isUndefined(P.value=="")?ks(P.value)?!0:(u.value="max. 2 decimal digits",!1):!0,D=rt(),U=f(!1),I=ya(),z=f(!1),oe=Jt(),me=f(!1),M=()=>{var q;let V="/media/svg/dma/camera/e-form/png/cam-active.png";return a.isUndefined(((q=e.task.adjustment.updatedBy)==null?void 0:q.id)&&r.value.adjustment.pictures.length>0)||(V="/media/svg/dma/camera/e-form/png/cam-user.png"),L.value&&r.value.adjustment.pictures.length>0&&(V="/media/svg/dma/camera/e-form/png/cam-read.png"),V},te=async V=>{const q=La(e.task);let fe=V.target.value;if(!S.value&&fe!=$t.value){me.value=!0;const Re=[{keyValue:e.task.adjustment.key,propertyParams:[{propertyName:"commentValue",propertyValue:fe}]}];_e()?await D.updateServiceSheetTaskOnLocalDB(Re,e.task.adjustment.key,`changeComment-${e.task.adjustment.key}`,!1,q):await D.updateServiceSheetTaskValue(Re,oe.user.EmployeeId,oe.user.Name),me.value=!1,$t.value=fe}},T=V=>{const q=String(V).split(".");let fe=!1,Re=q[0].length>5;return q[1]&&(fe=q[1].length>2),Re||fe?(u.value="max input length is 5 digits and 2 number after .",!1):!0},$=async V=>{const q=La(e.task);u.value="";let fe=parseFloat(V.target.value);isNaN(fe)&&(fe=V.target.value);let Re=String(fe);if(S.value)return;let Ne=w();if(Ne&&(Ne=T(Re)),Ne)if(Re&&Re!=Ke.value){z.value=!0,r.value.adjustment.measurement=Re;const Ae=await D.getAdjusmentRating(r.value,q);Ae?(Ke.value=Re,(Ae=="C"||Ae=="X")&&(U.value=!0)):(await D.deleteAdjusmentTask(r.value,q),_.value=!0,setTimeout(()=>{_.value=!1},2e3),Ke.value="",Re="",r.value.adjustment.measurement=""),z.value=!1}else Re==""&&Re!=Ke.value&&(await D.getAdjusmentRating(r.value,q),Ke.value="",u.value="",Re="",r.value.adjustment.measurement="")},ae=()=>{var Re;const V=M()=="/media/svg/dma/camera/e-form/png/cam-read.png";let q=!0;const fe=!!((Re=e.task.adjustment.updatedBy)!=null&&Re.id);V||fe&&!q||(I.toggleIsVisible(!0,`${r.value.key}-adjustment`),U.value=!1)},G=async()=>{const V=La(e.task);if(r.value.adjustment.measurement){const q=Xe.service({lock:!0,text:"Deleting Adjustment",background:"rgba(0, 0, 0, 0.7)"});await D.deleteAdjusmentTask(r.value,V),q.close(),I.setCurrent(`${r.value.key}-adjustment`),I.clearCurrent()}o("showTaskAdjustment",!1),r.value.isShowAdjustmentRow=!1},Z=i(()=>{const V=r.value.adjustment.rating;let q;return V=="A"?q="a":V=="B"?q="b":V=="C"?q="c":V=="X"&&(q="x"),q}),ie=i(()=>a.cloneDeep(I.ImageObjects.find(V=>V.Id===`${r.value.key}-adjustment`))),Ce=f(!1),st=()=>{let V=[];ie.value&&(V=yt(ie.value.ImageInfos));const q=yt(r.value.adjustment.pictures),fe=V.filter(Re=>!q.some(Ne=>Re.filename===Ne.filename));r.value.adjustment.pictures=yt(r.value.adjustment.pictures),r.value.adjustment.pictures=[...r.value.adjustment.pictures,...fe],D.addCBMAdjustmentPictures(r.value),Ce.value=!0};be(ie,async(V,q)=>{!a.isUndefined(V)&&V.ImageInfos.length>0&&V.ImageInfos.length!=(q==null?void 0:q.ImageInfos.length)&&await st()},{deep:!0});const Ke=f(""),$t=f(""),kt=f("");return Mt(()=>{Ke.value=r.value.adjustment.measurement,kt.value=r.value.adjustment.measurement,a.isUndefined(r.value.adjustment.commentValue)||($t.value=r.value.adjustment.measurement)}),(V,q)=>{const fe=ce("el-input"),Re=ce("el-button");return d(),h(we,null,[l("div",Ui,[Ii,l("div",{class:"col-1 pb-1 px-2",style:Se([`border-left: ${p.value}`])},null,4),l("div",{class:$e(["pb-1 px-2",C.value]),style:Se([])},ue(n.task.adjustment.description),3),l("div",$i,[R(fe,{ref_key:"adjustmentInput",ref:X,modelValue:P.value,"onUpdate:modelValue":q[0]||(q[0]=Ne=>P.value=Ne),size:"small",placeholder:"Please Input",onKeypress:W,onFocusout:$,inputmode:"numeric",readonly:S.value,disabled:b.value},null,8,["modelValue","readonly","disabled"]),u.value!=""?(d(),h("label",Pi,ue(u.value),1)):E("",!0),z.value?(d(),h("div",Di,Ai)):E("",!0)]),l("div",Ni,ue(n.task.adjustment.uom),1),l("div",xi,[R(fe,{modelValue:r.value.adjustment.rating,"onUpdate:modelValue":q[1]||(q[1]=Ne=>r.value.adjustment.rating=Ne),modelModifiers:{lazy:!0},size:"small",disabled:"",class:$e(Z.value)},null,8,["modelValue","class"])]),l("div",Oi,[l("div",Li,[l("div",Ei,[l("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:ae,disabled:L.value},[l("img",{src:M(),style:{height:"12px",width:"14px"}},null,8,Mi)],8,Fi)]),r.value.adjustment.pictures.length>0?(d(),h("div",ji,[l("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:x,style:{"background-color":"#18AF4A"}},[l("label",Hi,"+"+ue(r.value.adjustment.pictures.length),1)])])):E("",!0)])]),l("div",{class:$e(["pb-1 px-2",v.value]),style:Se([`border-right: ${p.value}`])},[R(Re,{disabled:H.value,type:"danger",size:"small",class:"item-button w-100",onClick:G},{default:ee(()=>[Ee("Delete")]),_:1},8,["disabled"])],6)]),n.task.adjustment.updatedBy.name?(d(),h("div",Ki,[l("div",{class:"d-flex justify-content-end py-1 col-11 offset-1 timestamp-task",style:Se([`border-left: ${p.value}; border-right: ${p.value}`])},ue(n.task.adjustment.updatedBy.name)+", "+ue(n.task.adjustment.updatedDate),5)])):E("",!0),J(a.isUndefined)(r.value.adjustment.commentValue)?E("",!0):(d(),h("div",Gi,[qi,l("div",{class:"col-1 pb-1 px-2",style:Se([`border-left: ${p.value}`,K.value])},null,4),l("div",{class:$e(["pb-1 px-2",c.value]),style:Se([K.value])},ue(n.task.adjustment.commentLabel),7),l("div",{class:$e(["pb-1 px-2",k.value]),style:Se([K.value,`border-right: ${p.value}`])},[R(fe,{modelValue:r.value.adjustment.commentValue,"onUpdate:modelValue":q[2]||(q[2]=Ne=>r.value.adjustment.commentValue=Ne),modelModifiers:{lazy:!0},size:"small",placeholder:r.value.adjustment.commentPlaceHolder,onFocusout:te,readonly:S.value,disabled:b.value},null,8,["modelValue","placeholder","readonly","disabled"]),me.value?(d(),h("div",Wi,zi)):E("",!0)],6)])),g.value?(d(),re(Ma,{key:2,images:B.value,visibility:g.value,showDeleteButton:!L.value,onHandleClose:F,onHandleDelete:t},null,8,["images","visibility","showDeleteButton"])):E("",!0),R(Wa,{visibility:_.value,isCloseButtonShow:!1,caption:"Out Of Range",onOnClose:q[3]||(q[3]=()=>{_.value=!1})},null,8,["visibility"])],64)}}}),Qi={class:"row w-100"},Zi=l("div",{class:"col-1 pb-1 px-2"},null,-1),eu={class:"col-4 col-md-3 pb-1 px-2",style:Se([])},tu=l("div",{class:"col-1 pb-1 px-2"},null,-1),au={class:"col-2 pb-1 px-2",style:Se([])},su={key:0,class:"text-danger ps-2 font-weight-bold"},lu={key:1,class:"d-flex align-items-center"},ou=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),ru=l("span",{class:"timestamp-task"},"Updating...",-1),nu=[ou,ru],iu={class:"col-1 pb-1 px-2",style:Se([])},uu={class:"col-1 col-md-1 pb-1 px-2 input-eform-status",style:Se([])},du={key:0,class:"row w-100"},cu={key:1,class:"row w-100"},mu=l("div",{class:"col-1 pb-1 px-2"},null,-1),fu={key:0,class:"d-flex align-items-center"},vu=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),pu=l("span",{class:"timestamp-task"},"Updating...",-1),yu=[vu,pu],gu=Ue({__name:"TaskReplacement",props:{task:{type:Object,required:!0},generalSubmitted:{required:!0,type:Boolean}},emits:["showTaskAdjustment"],setup(n,{emit:s}){const e=n,o=s,t=rt(),r=Me(e,"task"),g=f(!1),u=Ul(t.stateSelectedGroup),_=f(""),C=f(""),v=f(!1),c=i(()=>{let T={};return e.task.items.forEach($=>{$.categoryItemType=="paramRating"&&(T=$)}),T}),k=i(()=>e.generalSubmitted?e.task.rating=="AUTOMATIC_REPLACEMENT_GAP":!0),P=i(()=>!e.generalSubmitted),B=i({get:()=>r.value.replacement.measurement,set:T=>{const $=T;if(!isNaN(Number($))){{if($.length>8)return;if((`${$}`.split(".")||[]).length-1>1)return;if($.includes(".")){if(`${$}`.split(".")[1].length>2)return;r.value.replacement.measurement=$}if($.length>5){if($.length>=6&&$.length<=6){if($[5]!=".")return;r.value.replacement.measurement=$}}else r.value.replacement.measurement}r.value.replacement.measurement=$}}}),m=()=>{var G,Z,ie;(G=c.value.customValidation)!=null&&G.includes("cbmReplaceDefectTakePhoto")&&x.setShowCloseButton(!1);const T=u.getCameraItem(((Z=e.task)==null?void 0:Z.groupTaskId)??"",t.stateSelectedSubGroups);let $;T&&($=T.items.find(Ce=>Ce.itemType==="smallCamera")),$.value.length<2&&x.toggleIsVisible(!0,$.key);let ae;switch((ie=e.task)==null?void 0:ie.SectionData){case"HV Alternator":ae="alternator";break;case"Retarder Grid Box 1":case"Retarder Grid Box 2":ae="blower motor";break}x.setReplacementTool(ae),g.value=!1},b=i(()=>e.generalSubmitted?!!0:!0),S=i(()=>{let T="";return e.task.items.forEach($=>{!a.isUndefined($.style)&&!a.isUndefined($.style.border)&&$.style.border.left!="none"&&(T=$.style.border.left)}),T}),L=i(()=>{let T="",$=!1;return r.value.items.forEach(ae=>{!a.isUndefined(ae.style)&&!a.isUndefined(ae.style.border)&&ae.style.border.bottom!="none"&&($=!0)}),$&&(T=`border-bottom: ${S.value}`),T}),H=f(),F=T=>{var ae;let $=T.keyCode?T.keyCode:T.which;if($==13){(ae=H.value)==null||ae.blur();return}($<48||$>57)&&$!=46&&T.preventDefault()},x=ya(),p=f(!1),K=Jt(),X=f(!1),W=async T=>{if(!b.value&&T!=M.value){X.value=!0;const $=[{keyValue:e.task.replacement.key,propertyParams:[{propertyName:"commentValue",propertyValue:T}]}];_e()?await t.updateServiceSheetTaskOnLocalDB($,e.task.replacement.key,`changeComment-${e.task.replacement.key}`):await t.updateServiceSheetTaskValue($,K.user.EmployeeId,K.user.Name),X.value=!1,M.value=T}},w=async T=>{let $=T.target.value;await W($)},D=async T=>{if(b.value)return;const $=Xe.service({lock:!0,text:"Updating...",background:"rgba(0, 0, 0, 0.7)"});T!=me.value&&(p.value=!0,r.value.replacement.measurement=T,await t.getReplacementRating(r.value)?me.value=T:(v.value=!0,setTimeout(()=>{v.value=!1},2e3),me.value="",T="",r.value.replacement.measurement=""),p.value=!1),$.close()},U=()=>a.isUndefined(B.value=="")?ks(B.value)?!0:(C.value="max. 2 decimal digits",!1):!0,I=async T=>{let $=parseFloat(T.target.value);isNaN($)&&($=T.target.value);let ae=String($);U()&&await D(ae)},z=async()=>{if(r.value.replacement.measurement){const T=Xe.service({lock:!0,text:"Deleting Replacement",background:"rgba(0, 0, 0, 0.7)"});await t.deleteReplacementTask(r.value),T.close(),x.setCurrent(`${r.value.key}-replacement`),x.clearCurrent()}r.value.isShowReplacementRow=!1,o("showTaskAdjustment",!1)},oe=i(()=>{const T=r.value.replacement.rating;let $;return T=="A"?$="a":T=="B"?$="b":T=="C"?$="c":T=="X"&&($="x"),$}),me=f(""),M=f(""),te=f("");return Mt(async()=>{if(!a.isUndefined(r.value.replacement.commentValue))if(r.value.replacement.commentValue)M.value=r.value.replacement.commentValue;else{const T="";r.value.replacement.commentValue=T,W(T)}t.stateIsReplaceValue&&(await D(r.value.replacement.measurement),t.toggleIsReplaceValue(!1)),me.value=r.value.replacement.measurement,te.value=r.value.replacement.measurement}),(T,$)=>{const ae=ce("el-input"),G=ce("el-button");return d(),h(we,null,[l("div",Qi,[Zi,l("div",{class:"col-1 pb-1 px-2",style:Se([`border-left: ${S.value}`])},null,4),l("div",eu,ue(n.task.replacement.description),1),tu,l("div",au,[R(ae,{ref_key:"replacementInput",ref:H,modelValue:B.value,"onUpdate:modelValue":$[0]||($[0]=Z=>B.value=Z),size:"small",placeholder:"Please Input",onKeypress:F,onFocusout:I,inputmode:"numeric",readonly:b.value,disabled:k.value},null,8,["modelValue","readonly","disabled"]),C.value!=""?(d(),h("label",su,ue(C.value),1)):E("",!0),p.value?(d(),h("div",lu,nu)):E("",!0)]),l("div",iu,ue(n.task.replacement.uom),1),l("div",uu,[R(ae,{modelValue:r.value.replacement.rating,"onUpdate:modelValue":$[1]||($[1]=Z=>r.value.replacement.rating=Z),modelModifiers:{lazy:!0},size:"small",disabled:"",class:$e(oe.value)},null,8,["modelValue","class"])]),l("div",{class:"col-2 pb-1 px-2",style:Se([`border-right: ${S.value}`])},[R(G,{disabled:b.value,type:"danger",size:"small",class:"item-button w-100",onClick:z},{default:ee(()=>[Ee("Delete")]),_:1},8,["disabled"])],4)]),n.task.replacement.updatedBy.name?(d(),h("div",du,[l("div",{class:"d-flex justify-content-end py-1 col-11 offset-1 timestamp-task",style:Se([`border-left: ${S.value}; border-right: ${S.value}`])},ue(n.task.replacement.updatedBy.name)+", "+ue(n.task.replacement.updatedDate),5)])):E("",!0),J(a.isUndefined)(r.value.replacement.commentValue)?E("",!0):(d(),h("div",cu,[mu,l("div",{class:"col-1 pb-1 px-2",style:Se([`border-left: ${S.value}`,L.value])},null,4),l("div",{class:"col-5 col-md-4 pb-1 px-2",style:Se([L.value])},ue(n.task.replacement.commentLabel),5),l("div",{class:"col-5 col-md-6 pb-1 px-2",style:Se([L.value,`border-right: ${S.value}`])},[R(ae,{modelValue:r.value.replacement.commentValue,"onUpdate:modelValue":$[2]||($[2]=Z=>r.value.replacement.commentValue=Z),modelModifiers:{lazy:!0},size:"small",placeholder:r.value.replacement.commentPlaceHolder,onFocusout:w,readonly:b.value,disabled:P.value},null,8,["modelValue","placeholder","readonly","disabled"]),X.value?(d(),h("div",fu,yu)):E("",!0)],4)])),R(Gs,{show:g.value,item:c.value,tool:_.value,side:"cab side",onClose:m},null,8,["show","item","tool"]),R(Wa,{visibility:v.value,isCloseButtonShow:!1,caption:"Out Of Range",onOnClose:$[3]||($[3]=()=>{v.value=!1})},null,8,["visibility"])],64)}}}),bu={class:"row w-100","data-testid":"task-cleaned-row"},ku=l("div",{class:"col-1 pb-1 px-2"},null,-1),hu=["innerHTML"],_u={key:0,class:"d-flex align-items-center"},wu=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),Su=l("span",{class:"timestamp-task"},"Updating...",-1),Cu=[wu,Su],Ru={class:"row justify-content-center"},Tu={class:"px-0 col-6 d-flex justify-content-center"},Uu=["disabled"],Iu=["src"],$u={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},Pu={class:"text-white"},Du={key:0,class:"row w-100"},Vu=Ue({__name:"TaskCleaned",props:{task:{type:Object,required:!0},generalSubmitted:{required:!0,type:Boolean}},emits:["showTaskAdjustment"],setup(n,{emit:s}){const e=n,o=s;wa();const t=async G=>{const Z=r.value.cleaned.pictures;r.value.cleaned.pictures=Z.filter(ie=>ie!=G),w.setCurrent(`${r.value.key}-cleaned`),w.clearCurrent(),await X.addCBMCleanedPictures(r.value),r.value.cleaned.pictures.length==0},r=Me(e,"task"),g=f(!1),u=f(""),_=f(!1),C=i(()=>{let G="col-6 col-md-5";return e.task.cleaned.isCommentAdjustment&&(G="col-6 col-md-5"),G}),v=i(()=>{let G="col-2";return e.task.cleaned.isCommentAdjustment&&(G="col-1"),G});i(()=>{let G="col-4 col-md-3 ";return e.task.cleaned.isCommentAdjustment&&(G="col-5 col-md-4"),G}),i(()=>{let G="col-6 col-md-7 ";return e.task.cleaned.isCommentAdjustment&&(G="col-5 col-md-6"),G});const c=i({get:()=>r.value.cleaned.rating,set:G=>{r.value.cleaned.rating=G}}),k=i(()=>{const G=e.task.items.find(Ke=>Ke.itemType=="dropDown"&&Ke.customValidation&&Ke.customValidation=="cbmTakePhotoAllRating"),Z=G.caption.replace("[","").replace("]","").split("; "),ie=G.itemValue.replace("[","").replace("]","").split(", ");let Ce=Z.map((Ke,$t)=>({label:Ke.replaceAll("'",""),value:ie[$t].replaceAll("'","")}));const st=Ce.findIndex(Ke=>Ke.value===e.task.taskValue);return Ce=st!==-1?Ce.slice(0,st):[],Ce}),P=G=>Ha(G);i(()=>{var G;return c.value?(G=k.value.find(Z=>Z.value==String(c.value)))==null?void 0:G.label:c.value});const B=i(()=>r.value.cleaned.pictures?yt(r.value.cleaned.pictures):[]),m=i(()=>X.generalForm.status=="Submited"),b=i(()=>!e.generalSubmitted||k.value.length==1?!0:!!0||m.value),S=i(()=>e.generalSubmitted?!!0||m.value:!0),L=i(()=>{var Z,ie;if(!e.generalSubmitted)return!0;let G=!0;return(Z=r.value)!=null&&Z.cleaned.updatedBy&&X.employee.id!=((ie=r.value)==null?void 0:ie.cleaned.updatedBy).id&&(G=!1),!G||m.value}),H=()=>{g.value=!1},F=()=>{g.value=!0},x=i(()=>{let G="";return e.task.items.forEach(Z=>{!a.isUndefined(Z.style)&&!a.isUndefined(Z.style.border)&&Z.style.border.left!="none"&&(G=Z.style.border.left)}),G}),p=i(()=>{let G="",Z=!1;return r.value.items.forEach(ie=>{!a.isUndefined(ie.style)&&!a.isUndefined(ie.style.border)&&ie.style.border.bottom!="none"&&(Z=!0),e.task.cleaned.rating&&(Z=!1)}),Z&&(G=`border-bottom: ${x.value}`),G}),K=i(()=>{let G=!1;r.value.items.forEach(ie=>{!a.isUndefined(ie.style)&&!a.isUndefined(ie.style.border)&&ie.style.border.bottom!="none"&&(G=!0)});let Z="";return r.value.cleaned.updatedBy.name!=""&&G&&(Z=`border-bottom: ${x.value}`),Z});f();const X=rt(),W=f(!1),w=ya(),D=f(!1);Jt(),f(!1);const U=()=>{var Z;let G="/media/svg/dma/camera/e-form/png/cam-active.png";return!a.isUndefined((Z=e.task.cleaned.updatedBy)==null?void 0:Z.id)&&r.value.cleaned.pictures.length>0&&(G="/media/svg/dma/camera/e-form/png/cam-user.png"),G},I=async G=>{const Z=La(e.task);let ie=G;e.generalSubmitted&&(ie&&ie!=$.value?(D.value=!0,r.value.cleaned.measurement=ie,await X.getCleanedRating(r.value,Z)?$.value=ie:(await X.deleteCleanedTask(r.value,Z),_.value=!0,setTimeout(()=>{_.value=!1},2e3),$.value="",ie="",r.value.cleaned.measurement=""),D.value=!1):ie==""&&ie!=$.value&&(await X.getCleanedRating(r.value,Z),$.value="",u.value="",ie="",r.value.cleaned.measurement="",D.value=!1))},z=()=>{var Ce;const G=U()=="/media/svg/dma/camera/e-form/png/cam-read.png";let Z=!0;const ie=!!((Ce=e.task.cleaned.updatedBy)!=null&&Ce.id);G||ie&&!Z||(w.toggleIsVisible(!0,`${r.value.key}-cleaned`),W.value=!1)},oe=async()=>{const G=La(e.task);if(r.value.cleaned.rating){const Z=Xe.service({lock:!0,text:"Deleting Cleaned Value",background:"rgba(0, 0, 0, 0.7)"});await X.deleteCleanedTask(r.value,G),Z.close(),w.setCurrent(`${r.value.key}-cleaned`),w.clearCurrent()}o("showTaskAdjustment",!1),r.value.isShowCleanedRow=!1},me=i(()=>{const G=r.value.cleaned.rating;let Z;return G=="A"?Z="a":G=="B"?Z="b":G=="C"?Z="c":G=="X"&&(Z="x"),Z}),M=i(()=>a.cloneDeep(w.ImageObjects.find(G=>G.Id===`${r.value.key}-cleaned`))),te=f(!1),T=()=>{let G=[];M.value&&(G=yt(M.value.ImageInfos));const Z=yt(r.value.cleaned.pictures),ie=G.filter(Ce=>!Z.some(st=>Ce.filename===st.filename));r.value.cleaned.pictures=yt(r.value.cleaned.pictures),r.value.cleaned.pictures=[...r.value.cleaned.pictures,...ie],X.addCBMCleanedPictures(r.value),te.value=!0};be(M,async(G,Z)=>{!a.isUndefined(G)&&G.ImageInfos.length>0&&G.ImageInfos.length!=(Z==null?void 0:Z.ImageInfos.length)&&await T()},{deep:!0});const $=f("");f("");const ae=f("");return Mt(()=>{r.value.cleaned.rating==""&&(r.value.cleaned.rating="A",I("A")),$.value=r.value.cleaned.rating,ae.value=r.value.cleaned.rating}),(G,Z)=>{const ie=ce("el-option"),Ce=ce("el-select"),st=ce("el-button");return d(),h(we,null,[l("div",bu,[ku,l("div",{class:"col-1 pb-1 px-2",style:Se([`border-left: ${x.value}`,p.value])},null,4),l("div",{class:$e(["pb-1 px-2",C.value]),style:Se([p.value])},ue(n.task.cleaned.description),7),l("div",{class:"col-2 pb-1 px-2",style:Se([p.value])},[(d(),re(Ce,{modelValue:c.value,"onUpdate:modelValue":Z[0]||(Z[0]=Ke=>c.value=Ke),placeholder:"Choose One",size:"small",class:$e(["w-100",[me.value]]),disabled:b.value,onChange:I,key:n.task.cleaned.key},{default:ee(()=>[(d(!0),h(we,null,tt(k.value,Ke=>(d(),re(ie,{key:Ke,value:Ke.value},{default:ee(()=>[l("span",{innerHTML:Ke&&Ke.label?P(Ke&&Ke.label):""},null,8,hu)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled","class"])),D.value?(d(),h("div",_u,Cu)):E("",!0)],4),l("div",{class:"col-1 col-md-1 pb-1 px-2",style:Se([p.value])},[l("div",Ru,[l("div",Tu,[l("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:z,disabled:S.value},[l("img",{src:U(),style:{height:"12px",width:"14px"}},null,8,Iu)],8,Uu)]),r.value.cleaned.pictures.length>0?(d(),h("div",$u,[l("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:F,style:{"background-color":"#18AF4A"}},[l("label",Pu,"+"+ue(r.value.cleaned.pictures.length),1)])])):E("",!0)])],4),l("div",{class:$e(["pb-1 px-2",v.value]),style:Se([`border-right: ${x.value}`,p.value])},[R(st,{disabled:L.value,type:"danger",size:"small",class:"item-button w-100",onClick:oe},{default:ee(()=>[Ee("Delete")]),_:1},8,["disabled"])],6)]),n.task.cleaned.updatedBy.name?(d(),h("div",Du,[l("div",{class:"d-flex justify-content-end py-1 col-11 offset-1 timestamp-task",style:Se([`border-left: ${x.value}; border-right: ${x.value}; ${K.value}`])},ue(n.task.cleaned.updatedBy.name)+", "+ue(n.task.cleaned.updatedDate),5)])):E("",!0),g.value?(d(),re(Ma,{key:1,images:B.value,visibility:g.value,showDeleteButton:!S.value,onHandleClose:H,onHandleDelete:t},null,8,["images","visibility","showDeleteButton"])):E("",!0),R(Wa,{visibility:_.value,isCloseButtonShow:!1,caption:"Out Of Range",onOnClose:Z[1]||(Z[1]=()=>{_.value=!1})},null,8,["visibility"])],64)}}}),Ws=n=>(Yt("data-v-6147ee12"),n=n(),zt(),n),Bu=Ws(()=>l("span",{class:"el-dialog__title"},"Are you sure you want to skip these checks first?",-1)),Au=Ws(()=>l("span",{class:"el-dialog__title task-title"},"Please provide a reason as to why the Pre-Service Operational Checks could not be done at the start of this service.",-1)),Nu={class:"mt-1 p-2"},xu={class:"d-flex flex-column"},Ou=Ws(()=>l("label",{class:"reason_skip--label"},[Ee("Reason "),l("span",{class:"red"},"*")],-1)),Lu={key:0,class:"px-1 text-danger"},Eu={key:0,class:"mt-1 p-2"},Fu={class:"dialog-footer",style:{display:"block","text-align":"right"}},Mu=Ue({__name:"PreServiceReasonDialog",props:{visibility:{required:!0,type:Boolean},options:{required:!1,type:Array,default:[]}},emits:["onClose","onSave","onCancel"],setup(n,{emit:s}){const e=n,o=s,t=Me(e,"visibility"),r=f(!1),g=f(!1);f(!1);const u=f(""),_=f(!0),C=f(!1),v=f(""),c=f(!1),k=()=>{v.value&&(C.value=!1),c.value=v.value.includes("Other"),c.value?(u.value="",_.value=!0):_.value=!1},P=H=>{u.value=H.value,_.value=u.value===""},B=()=>{v.value?m():C.value=!0},m=async()=>{o("onSave",{reason:`${v.value};;${u.value}`,showToast(){r.value=!0,setTimeout(()=>{r.value=!1,o("onClose")},2e3)}})},b=()=>{o("onCancel")},S=()=>{v.value="",c.value=!1,u.value=""},L=async()=>{u.value="",C.value=!1,r.value=!1,g.value=!1,S(),o("onClose")};return(H,F)=>{const x=ce("el-option"),p=ce("el-select"),K=ce("el-button"),X=ce("el-dialog");return d(),re(X,{modelValue:t.value,"onUpdate:modelValue":F[1]||(F[1]=W=>t.value=W),width:"90%",center:"","lock-scroll":!1,"before-close":b,onClosed:L,"custom-class":"el-defect-crack-form-custom reason-dialog","destroy-on-close":!0},{title:ee(()=>[Bu,Au]),footer:ee(()=>[l("span",Fu,[R(K,{onClick:b,style:{"box-shadow":"0px 24px 48px rgba(145, 158, 171, 0.2)"}},{default:ee(()=>[Ee("Cancel")]),_:1}),R(K,{disabled:_.value,class:"button-OK-confirmation",type:"success",onClick:ha(B,["prevent"]),style:{background:"rgb(24, 175, 74)","box-shadow":"rgba(0, 171, 85, 0.24) 0px 8px 16px",color:"white"}},{default:ee(()=>[Ee("Submit")]),_:1},8,["disabled"])])]),default:ee(()=>[l("div",null,[l("div",Nu,[l("div",xu,[Ou,R(p,{modelValue:v.value,"onUpdate:modelValue":F[0]||(F[0]=W=>v.value=W),filterable:"",onChange:k,class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(n.options,W=>(d(),re(x,{key:W.id,label:W,value:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),C.value?(d(),h("label",Lu,"Required")):E("",!0)])]),c.value?(d(),h("div",Eu,[R(_a,{"label-class":"dma--textarea-label reason_skip--label","text-class":"dma--textarea-input h-100px reason_skip--text",value:u.value,label:"Description <span class='red'>*</span>",name:"Description",placeholder:"Write Reason",onHandleChange:P},null,8,["value"])])):E("",!0)]),R(Hs,{show:r.value,message:"Pre-Service Operational Checks cannot be performed at the start of this service has been submitted"},null,8,["show"])]),_:1},8,["modelValue"])}}}),ju=Ct(Mu,[["__scopeId","data-v-6147ee12"]]),Hu={class:"p-2"},Ku={class:"form-check checkbox-success item-checkbox"},Gu=["disabled"],qu=Ue({__name:"CheckBoxPreService",props:{item:{type:Object,required:!0},task:{type:Object},generalStyle:{type:Boolean,default:!0},generalSubmitted:{required:!0,type:Boolean}},setup(n){const s=n,e=Me(s,"item"),o=Me(s,"task"),t=rt(),r=Jt(),g=f(!1),u=i({get:()=>JSON.parse(s.item.value),set:H=>{e.value.value=H}}),_=()=>{g.value=!0},C=H=>{k(H)},v=()=>{e.value.value="false",c()},c=()=>{g.value=!1},k=async H=>{var K;const F=Xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),x={keyValue:(K=o.value)==null?void 0:K.key,propertyParams:[{propertyName:"reason",propertyValue:H.reason},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Ft()}]},p=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:"true"},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Ft()}]}];p.push(x),_e()?await t.updateServiceSheetTaskOnLocalDB(p,s.task.key,s.item.key,!1,s.task.key):await t.updateServiceSheetTaskValue(p,r.user.EmployeeId,r.user.Name),t.setSkipPreService(!0),F.close(),H.showToast()},P=i(()=>!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col"),B=i(()=>t.generalForm.status=="Submited"),m=i(()=>(console.log(B),s.item.value=="true"||t.isAllPreServiceFinished||B.value||!s.generalSubmitted)),b=i(()=>{let H="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(H=`col-md-${e.value.style.potraitBreakPoint}`,H=`${H} col-lg-${e.value.style.breakPoint}`):(H=`col-md-${e.value.style.potraitBreakPoint}`,H=`${H} col-lg-${e.value.style.breakPoint}`)),H}),S=i(()=>{var z,oe,me;const H=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",F=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",x=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",p=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let K=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((z=s.task)==null?void 0:z.isShowAdjustmentRow)&&((oe=s.task)!=null&&oe.isShowAdjustmentRow))K="";else{let M=0;(me=s.task)==null||me.items.forEach(te=>{var T;a.isUndefined(te.style)||(a.isUndefined(te.style.border)?a.isUndefined(te.style.border)&&(M=M+Number(te.style.breakPoint)):((te.style.border.right=="none"||a.isUndefined(te.style.border.right))&&(M=M+Number(te.style.breakPoint)),a.isEqual(te,a.last((T=s.task)==null?void 0:T.items))&&(M=M+Number(te.style.breakPoint))))}),M==12&&(K=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const X=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",W=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",w=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",D=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",U=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let I="";return K&&(I="padding-bottom: 25px; "),`${I}${H}${F}${x}${p}${K}${X}${W}${w}${D}${U}`}),L=i(()=>{let H="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(H=""),H});return be(()=>s.item.value,H=>{let F=!1;H=="true"&&(F=!0),t.setSkipPreService(F)}),Mt(()=>{let H=!1;s.item.value=="true"&&(H=!0),t.setSkipPreService(H)}),(H,F)=>(d(),h(we,null,[l("div",{class:$e([[b.value,P.value,L.value],"pt-2 px-2 d-flex align-items-center d-flex justify-content-center"]),style:Se(S.value)},[l("div",Hu,[l("div",Ku,[Nt(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":F[0]||(F[0]=x=>u.value=x),onChange:_,disabled:m.value},null,40,Gu),[[Ya,u.value]])])])],6),R(ju,{options:J(t).stateSkipPreServiceReasonOptions,visibility:g.value,onOnSave:C,onOnClose:c,onOnCancel:v},null,8,["options","visibility"])],64))}}),Wu={key:0,class:"mt-2"},Ju={class:"text-end reason_skip--updateBy"},Yu={key:0,class:"row w-100",style:{height:"25px"}},zu=l("div",{class:"col-1"},null,-1),Xu=Ue({__name:"InlineTask",props:{task:{type:Object,required:!0},taskIndex:{type:Number,required:!0},taskGroup:{type:Array,required:!0},taskGroupName:{type:String,required:!1,default:""},generalSubmitted:{required:!0,type:Boolean}},setup(n){const s=n,e=rt(),o=i(()=>{let w=!0;if(s.task.showParameter=="suspensionCylinder"){w=!1;let D=!0,U=!1;(e.stateStoredSuspensionCylinderValue||e.stateStoredSuspensionCylinderValue.length>0)&&e.stateStoredSuspensionCylinderValue.forEach(I=>{I.value||(D=!1),(I.value=="Out of spec"||I.value=="Out Spec")&&(U=!0)}),w=D&&U}return s.task.showParameter=="cylinderHeightNeedAdjustment"&&(e.stateStoredAdjustmentOptionValue=="Yes"||e.stateStoredAdjustmentOptionValue=="2"?w=!0:w=!1),s.task.showParameter=="cylinderHeightAdjustmentsFilled"&&(w=!0,e.stateStoredAdjustedSuspensionCylinderValue.forEach(D=>{D.value||(w=!1)})),w=t(w),w}),t=w=>{let D=w;return e.SelectedBrakeTypeDropdown==Il.OIL_COOLED?s.task.showParameter==ps.BRAKE_TYPE_CALIPER&&(D=!1):s.task.showParameter==ps.BRAKE_TYPE_OIL_COOLED&&(D=!1),D},r=i(()=>{let w="",D;return s.task.items.length<=1?D=s.task.items[0]:D=s.task.items[1],!a.isUndefined(D.style)&&!a.isUndefined(D.style.border)&&D.style.border.top!="none"&&(w="mt-3"),w}),g=i(()=>{let w="";if(s.task.taskValue!=null&&s.task.taskValue==""&&(w="task-required"),s.task.items.forEach(D=>{D.categoryItemType=="brakeTypeDropdown"&&D.value=="Caliper"&&(w="")}),s.task.childGroupTaskId&&e.stateSelectedSubGroups.forEach(D=>{D.taskGroup.forEach(U=>{U.task.forEach(I=>{I.parentGroupTaskId&&I.parentGroupTaskId==s.task.childGroupTaskId&&I.taskValue&&(w="")})})}),s.task.rating=="CALIBRATION"){for(const D of s.task.items)if(D.itemType=="statusInfo"&&!D.value){w="task-required";break}}if(s.task.showParameter&&s.task.showParameter=="cylinderHeightNeedAdjustment"&&s.task.items.length==7){const U=s.task.items.find(I=>I.itemType=="statusInfo");U&&U.value===""&&o.value&&(w="task-required")}return o.value||(w=""),w}),u=i(()=>e.stateGetDataByParam);be(u,async(w,D)=>{w&&(s.task.isShowCleanedRow||S(!1))});const _=i(()=>{let w=12,D=0;return s.task.items.every(U=>!a.isUndefined(U.style)&&U.style.visibility=="hidden"&&(a.isUndefined(U.style)||a.isUndefined(U.style.border)||U.style.border.left=="none")?(w=Number(w)-Number(U.style.breakPoint),D=Number(D)+Number(U.style.breakPoint),!0):!1),`col-${w} offset-${D}`}),C=f(""),v=f(""),c=i(()=>{let w=0;return s.task.items.forEach((D,U)=>{if(U+1==s.task.items.length&&D.itemType=="dropDown"){const I=s.task.items[U-1];!a.isUndefined(I.style)&&!a.isUndefined(I.style.border)&&I.style.border.right!="none"&&(s.task.items.length==3?w=Number(I.style.breakPoint)-1:s.task.items.forEach((z,oe)=>{if(oe>1&&oe<=U-1){let me=0;if(!a.isUndefined(z.style.potraitBreakPoint))me=z.style.potraitBreakPoint;else{let M=0;z.style.breakPoint=="none"?(s.task.items.forEach((te,T)=>{te.style.breakPoint!="none"&&(M+=Number(te.style.breakPoint))}),me=12-M):me=z.style.breakPoint-M}w+=Number(me)}}))}}),w}),k=i(()=>{let w=0;return s.task.items.forEach((D,U)=>{if(U+1==s.task.items.length&&D.itemType=="dropDown"){const I=s.task.items[U-1];!a.isUndefined(I.style)&&!a.isUndefined(I.style.border)&&I.style.border.right!="none"&&(s.task.items.length==3?w=Number(I.style.breakPoint)-1:s.task.items.forEach((z,oe)=>{if(oe>1&&oe<=U-1){let me=0,M=0;z.style.breakPoint=="none"?(s.task.items.forEach((te,T)=>{te.style.breakPoint!="none"&&(M+=Number(te.style.breakPoint))}),me=12-M):me=z.style.breakPoint-M,w+=Number(me)}}))}}),w}),P=i(()=>{let w=!1,D=!1,U=!1;return s.task.items.forEach((I,z)=>{if(z==1&&!a.isUndefined(I.style)&&!a.isUndefined(I.style.border)&&I.style.border.left!="none"&&(w=!0,C.value=I.style.border.left,!a.isUndefined(I.style)&&!a.isUndefined(I.style.border)&&I.style.border.bottom!="none"&&(U=!0)),z+1==s.task.items.length&&I.itemType=="dropDown"){const oe=s.task.items[z-1];!a.isUndefined(oe.style)&&!a.isUndefined(oe.style.border)&&oe.style.border.right!="none"&&(D=!0,v.value=oe.style.border.right)}}),w&&D&&!U}),B=f(!1),m=f(!1),b=w=>{B.value=w},S=w=>{m.value=w},L=i(()=>{let w=40;return B.value&&(w=60),w}),H=i(()=>{var me,M,te,T,$,ae;const w=s.task.items.find(G=>G.style.visibility!="hidden"),D=a.last(s.task.items),U=!a.isUndefined((me=s.task)==null?void 0:me.isShowReplacementRow)&&((M=s.task)==null?void 0:M.isShowReplacementRow),I=!a.isUndefined((te=s.task)==null?void 0:te.isShowAdjustmentRow)&&((T=s.task)==null?void 0:T.isShowAdjustmentRow),z=!a.isUndefined(($=s.task)==null?void 0:$.isShowCleanedRow)&&((ae=s.task)==null?void 0:ae.isShowCleanedRow);return!(U||I||z||m.value)&&!a.isUndefined(D.style)&&!a.isUndefined(D.style.border)&&D.style.border.bottom!="none"&&!a.isUndefined(w.style)&&!a.isUndefined(w.style.border)&&w.style.border.left!="none"}),F=i(()=>{var T,$,ae,G,Z,ie;const w=s.task.items.find(Ce=>Ce.style.visibility!="hidden"),D=a.last(s.task.items);let U=!a.isUndefined(D.style)&&!a.isUndefined(D.style.border)&&D.style.border.right!="none"?`border-right: ${D.style.border.right}; `:"",I=!a.isUndefined(w.style)&&!a.isUndefined(w.style.border)&&w.style.border.left!="none"?`border-left: ${w.style.border.left}; `:"",z=s.task.updatedBy.name&&!a.isUndefined(D.style)&&!a.isUndefined(D.style.border)&&D.style.border.bottom!="none"?"margin-bottom: 1rem; ":"";H.value&&(U="",I="");const oe=!a.isUndefined((T=s.task)==null?void 0:T.isShowReplacementRow)&&(($=s.task)==null?void 0:$.isShowReplacementRow),me=!a.isUndefined((ae=s.task)==null?void 0:ae.isShowAdjustmentRow)&&((G=s.task)==null?void 0:G.isShowAdjustmentRow),M=!a.isUndefined((Z=s.task)==null?void 0:Z.isShowCleanedRow)&&((ie=s.task)==null?void 0:ie.isShowCleanedRow);return(oe||me||M||m.value)&&(z=""),U?`${U}${I}${z}`:`${z}`}),x=i(()=>{var oe,me,M,te,T,$;const w=a.last(s.task.items),D=!a.isUndefined((oe=s.task)==null?void 0:oe.isShowReplacementRow)&&((me=s.task)==null?void 0:me.isShowReplacementRow),U=!a.isUndefined((M=s.task)==null?void 0:M.isShowAdjustmentRow)&&((te=s.task)==null?void 0:te.isShowAdjustmentRow),I=!a.isUndefined((T=s.task)==null?void 0:T.isShowCleanedRow)&&(($=s.task)==null?void 0:$.isShowCleanedRow);return D||U||I||m.value||s.task.updatedBy.name&&!a.isUndefined(w.style)&&!a.isUndefined(w.style.border)&&w.style.border.bottom!="none"&&`${w.style.border.bottom}`,""}),p=i(()=>{let w="";return a.isUndefined(s.task.generalStyle)||(w=s.task.generalStyle),w}),K=i(()=>{let w="";const D=s.task.customStyle;return a.isUndefined(D)||D.split(" | ").forEach(I=>{I.includes("noteStyle")&&!a.isUndefined(s.taskGroup[s.taskIndex-1].updatedBy.name)&&s.taskGroup[s.taskIndex-1].updatedBy.name&&(w=`${w} ${I.split(" = ")[1]}`)}),w}),X=i(()=>s.task.items.findIndex(w=>w.customValidation=="preServiceTab")>=0),W=i(()=>{let w=s.task.reason||"";return w&&(w.includes("Other")?w=w.split(";;")[1]:w=w.split(";;")[0]),w});return(w,D)=>Nt((d(),h("div",null,[l("div",{class:$e(["row w-100",[r.value,g.value]]),style:Se([p.value,K.value])},[(d(!0),h(we,null,tt(s.task.items,U=>(d(),h(we,{key:U.key},[U.itemType==="image"?(d(),re(El,{key:0,item:U,task:n.task},null,8,["item","task"])):E("",!0),U.itemType==="label"?(d(),re(Fl,{key:1,item:U,task:n.task,"is-show-adjustment":m.value},null,8,["item","task","is-show-adjustment"])):E("",!0),U.itemType==="input"?(d(),re(ql,{key:2,item:U,task:n.task,"is-show-adjustment":m.value,"general-submitted":n.generalSubmitted},null,8,["item","task","is-show-adjustment","general-submitted"])):E("",!0),U.itemType==="smallCamera"?(d(),re(Wl,{key:3,item:U,task:n.task,"is-show-adjustment":m.value,"general-submitted":n.generalSubmitted},null,8,["item","task","is-show-adjustment","general-submitted"])):E("",!0),U.itemType==="html"?(d(),re(Yl,{key:4,item:U,task:n.task,"is-show-adjustment":m.value},null,8,["item","task","is-show-adjustment"])):E("",!0),U.itemType==="button"?(d(),re(zl,{key:5,item:U,task:n.task,onShowTaskAdjustment:S,"is-show-adjustment":m.value},null,8,["item","task","is-show-adjustment"])):E("",!0),U.itemType==="statusInfo"?(d(),re(hs,{key:6,item:U,task:n.task},null,8,["item","task"])):E("",!0),U.itemType==="checkbox"&&U.customValidation=="preServiceTab"?(d(),re(qu,{key:7,item:U,task:n.task,"general-submitted":n.generalSubmitted},null,8,["item","task","general-submitted"])):U.itemType==="checkbox"?(d(),re(Jl,{key:8,item:U,task:n.task},null,8,["item","task"])):E("",!0),U.itemType==="dropDown"?(d(),re(Gl,{key:9,item:U,taskGroupName:s.taskGroupName,task:n.task,"general-submitted":n.generalSubmitted,onSetLoading:b},null,8,["item","taskGroupName","task","general-submitted"])):E("",!0)],64))),128))],6),X.value&&!J(a.isUndefined)(n.task.reason)&&n.task.reason!=""?(d(),h("div",Wu,[R(_a,{value:W.value,"label-class":"dma--textarea-label reason_skip--label","text-class":"dma--textarea-input h-100px reason_skip--text--disabled",label:"Reason",name:"reason",disabled:!0},null,8,["value"]),l("div",Ju,ue(n.task.updatedBy.name)+", "+ue(n.task.updatedDate),1)])):(d(),h(we,{key:1},[n.task.updatedBy.name?(d(),h("div",{key:0,class:"row position-absolute pe-3 text-nowrap",style:Se(`top: ${L.value}px; right: calc(var(--bs-gutter-x) / 2);`)},[l("div",{class:$e(["d-flex justify-content-end pb-1 my-0 timestamp-task",_.value]),style:Se([x.value])},ue(n.task.updatedBy.name)+", "+ue(n.task.updatedDate),7)],4)):E("",!0),n.task.updatedBy.name?(d(),h(we,{key:1},[H.value?E("",!0):(d(),h("div",Yu,[P.value?(d(),h(we,{key:1},[zu,l("div",{class:"col-1",style:Se(`border-left: ${C.value}`)},null,4),l("div",{class:$e(`col-md-${c.value} col-lg-${k.value}`),style:Se(`border-right: ${v.value}`)},null,6)],64)):(d(),h("div",{key:0,style:Se(F.value),class:$e(_.value)},null,6))]))],64)):E("",!0),n.task.rating=="AUTOMATIC"&&(n.task.isShowAdjustmentRow||m.value)?(d(),re(Xi,{key:2,task:n.task,onShowTaskAdjustment:S,"general-submitted":n.generalSubmitted},null,8,["task","general-submitted"])):E("",!0),(n.task.rating=="AUTOMATIC_REPLACEMENT"||n.task.rating=="AUTOMATIC_REPLACEMENT_GAP")&&(n.task.isShowReplacementRow||m.value)?(d(),re(gu,{key:3,task:n.task,onShowTaskAdjustment:S,"general-submitted":n.generalSubmitted},null,8,["task","general-submitted"])):E("",!0),n.task.rating==J(Ms).MANUAL_CLEANED&&(n.task.isShowCleanedRow||m.value)?(d(),re(Vu,{key:4,task:n.task,onShowTaskAdjustment:S,"general-submitted":n.generalSubmitted},null,8,["task","general-submitted"])):E("",!0)],64))],512)),[[_l,o.value]])}}),Qu=Ue({__name:"TableRow",props:{item:{type:Object,required:!0},task:{type:Object},itemLoading:{type:Boolean,default:!1},generalSubmitted:{required:!0,type:Boolean}},setup(n){const s=n,e=i(()=>{const t=[];for(const r in s.item)t.push(s.item[r]);return t}),o=t=>{let r="";return!a.isUndefined(t.style)&&!a.isUndefined(t.style.textvAlign)&&(r=`align-self-${t.style.textvAlign}`),r};return(t,r)=>(d(!0),h(we,null,tt(e.value,g=>(d(),h("div",{class:$e([o(g),"eform-table-row col px-0"]),key:g.key},[g.itemType==="image"?(d(),re(El,{key:0,item:g,task:n.task},null,8,["item","task"])):E("",!0),g.itemType==="label"?(d(),re(Fl,{key:1,item:g,task:n.task},null,8,["item","task"])):E("",!0),g.itemType==="input"?(d(),re(ql,{key:2,item:g,task:n.task,"item-loading":n.itemLoading,"general-submitted":n.generalSubmitted},null,8,["item","task","item-loading","general-submitted"])):E("",!0),g.itemType==="dropDown"?(d(),re(Gl,{key:3,item:g,task:n.task,"item-loading":n.itemLoading,"general-submitted":n.generalSubmitted},null,8,["item","task","item-loading","general-submitted"])):E("",!0),g.itemType==="smallCamera"?(d(),re(Wl,{key:4,item:n.item,task:n.task,"general-submitted":n.generalSubmitted},null,8,["item","task","general-submitted"])):E("",!0),n.item.itemType==="checkbox"?(d(),re(Jl,{key:5,item:n.item,task:n.task},null,8,["item","task"])):E("",!0),g.itemType==="html"?(d(),re(Bl,{key:6,item:g,task:n.task},null,8,["item","task"])):E("",!0),n.item.itemType==="button"?(d(),re(zl,{key:7,item:n.item,task:n.task},null,8,["item","task"])):E("",!0),n.item.itemType==="statusInfo"?(d(),re(hs,{key:8,item:n.item,task:n.task},null,8,["item","task"])):E("",!0)],2))),128))}}),Zu={class:"row w-100 mx-0 mb-5"},ed={key:0,class:"col-1 px-2"},td={class:"row text-center task-table__header py-2 w-100"},ad=Ue({__name:"TableTask",props:{task:{type:Object,required:!0},generalSubmitted:{required:!0,type:Boolean}},setup(n){const s=n,e=i(()=>s.task.header.replaceAll("'","").replace("[","").replace("]","").split(", ")),o=v=>{let c="";return!a.isUndefined(s.task.style)&&!a.isUndefined(s.task.style.borderBottom)&&s.task.style.borderBottom=="none"?c="":c="border-bottom-table",v+1==s.task.items.length&&(c="border-bottom-table"),c},t=rt();wa();const r=ts(),g=i(()=>s.task),u=f(!1),_=i(()=>{let v="";if(a.isUndefined(s.task.disabledByItemKey))return v;const c=t.stateStoredDisableKeyValue.find(k=>k.key==s.task.disabledByItemKey);return a.isUndefined(c)||(v=c.value),r.stateSuccessUpdateItemKey==""&&(v=""),v});be(_,async v=>{v=="3"&&C()},{deep:!0});const C=async()=>{if(!a.isUndefined(s.task.disabledByItemKey)){let v=t.stateStoredDisableKeyValue.find(c=>c.key==s.task.disabledByItemKey);if(a.isUndefined(v)){let c;_e()?c=await t.getFieldValueByKey(s.task.disabledByItemKey,"value"):c=await t.getValueFromItemKey(s.task.disabledByItemKey),t.pushStoredDisabledItems({key:s.task.disabledByItemKey,value:c})}if(v=t.stateStoredDisableKeyValue.find(c=>c.key==s.task.disabledByItemKey),(v==null?void 0:v.value)=="3"){const c=[];s.task.items.forEach(k=>{for(var P in k){const B=k[P];if(!a.isUndefined(B.disabledByItemKey)&&B.value){const m={keyValue:B.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]};c.push(m),fs(t.stateGeneralForm.workOrder,B.key)}}}),c.length>0&&(u.value=!0,await t.updateItemFromTask(c,s.task.key),_e()&&t.updateSelectedSubGroupFromServiceSheets(),u.value=!1)}}};return(v,c)=>(d(),h("div",Zu,[!J(a.isUndefined)(g.value.style)&&g.value.style.category=="taskTable"?(d(),h("div",ed)):E("",!0),l("div",{class:$e(["task-table",!J(a.isUndefined)(g.value.style)&&g.value.style.category=="taskTable"?"col-11 px-0":"col-12 pe-0"]),style:{"font-size":"12px !important"}},[l("label",null,ue(g.value.description),1),l("div",td,[(d(!0),h(we,null,tt(e.value,k=>(d(),h("div",{class:"col font-weight-normal task-table__header__item",key:k},ue(k),1))),128))]),(d(!0),h(we,null,tt(g.value.items,(k,P)=>(d(),h("div",{key:k.key,class:$e(["row w-100 task-table__body d-flex align-items-start",o(P)])},[R(Qu,{item:k,task:g.value,"item-loading":u.value,"general-submitted":n.generalSubmitted},null,8,["item","task","item-loading","general-submitted"])],2))),128))],2)]))}}),Xl=Ct(ad,[["__scopeId","data-v-356f63f1"]]),sd={class:"row w-100 mt-3 mb-3"},ld={key:0,class:"col-1 px-2"},od={class:"small-hyperlink-text-style"},rd=Ue({__name:"CollapsibleTableTask",props:{task:{type:Object,required:!0},generalSubmitted:{required:!0,type:Boolean}},setup(n){const s=n,e=f("open"),o=rt(),t=i(()=>{let u=!0;return u=r(u),u}),r=u=>{let _=u;return o.SelectedBrakeTypeDropdown==Il.OIL_COOLED?s.task.showParameter==ps.BRAKE_TYPE_CALIPER&&(_=!1):s.task.showParameter==ps.BRAKE_TYPE_OIL_COOLED&&(_=!1),_},g=i(()=>{let u="";return!a.isUndefined(s.task.style)&&!a.isUndefined(s.task.style.defaultCollapse)&&(u=s.task.style.defaultCollapse),u});return(u,_)=>{const C=ce("el-collapse-item"),v=ce("el-collapse");return Nt((d(),h("div",sd,[!J(a.isUndefined)(n.task.style)&&n.task.style.collapseCategory=="taskTable"?(d(),h("div",ld)):E("",!0),l("div",{class:$e(["task-table collapsible-table-container",!J(a.isUndefined)(n.task.style)&&n.task.style.collapseCategory=="taskTable"?"col-11 px-0":"col-12 pe-0"])},[R(v,{class:"task-group general-accordion py-1 px-5",modelValue:e.value,"onUpdate:modelValue":_[0]||(_[0]=c=>e.value=c)},{default:ee(()=>[R(C,{name:g.value},{title:ee(()=>[l("span",od,ue(n.task.triggerCaption),1)]),default:ee(()=>[R(Xl,{task:n.task,"general-submitted":n.generalSubmitted},null,8,["task","general-submitted"])]),_:1},8,["name"])]),_:1},8,["modelValue"])],2)],512)),[[_l,t.value]])}}}),nd=Ue({__name:"TaskGroup",props:{taskGroup:{type:Object,required:!0}},setup(n){const s=n,e=rt(),o=Da(),t=f(""),r=()=>{t.value=s.taskGroup.key,e.decreaseCollapse()},g=Ye(()=>o.generalUpdated),u=Ye(()=>s.taskGroup),_=Ye(()=>e.stateToggleExpandTaskGroup);be(_,c=>{c&&r()}),Mt(()=>{r(),v()});const C=()=>{a.isEmpty(t.value)?e.increaseeCollapse():e.decreaseCollapse()},v=()=>{e.stateSelectedSubGroups.forEach(c=>{c.taskGroup.forEach(k=>{if(k.key=="MECHANICAL_SERVICE_SUSPENSION"){let P=[],B=[];k.task.forEach(m=>{m.items.forEach(b=>{b.categoryItemType=="suspensionTargetRating"&&P.push({key:b.key,value:b.value}),b.categoryItemType=="adjustmentSuspensionTargetRating"&&B.push({key:b.key,value:b.value})}),a.isUndefined(m.showParameter)||m.showParameter=="suspensionCylinder"&&e.updateStoredAdjustmentOptionValue(m.taskValue)}),e.pushDataToAdjustedSuspensionCylinderStoredValue(B),e.pushDataToSuspensionCylinderStoredValue(P)}})})};return be(u,()=>{r(),v()},{deep:!0}),(c,k)=>{const P=ce("el-collapse-item"),B=ce("el-collapse");return d(),re(B,{modelValue:t.value,"onUpdate:modelValue":k[0]||(k[0]=m=>t.value=m),class:"task-group e-form-only py-1 px-5 mb-3",onClick:C},{default:ee(()=>[R(P,{title:n.taskGroup.name,name:n.taskGroup.key},{default:ee(()=>[(d(!0),h(we,null,tt(s.taskGroup.task,(m,b)=>(d(),h("div",{key:m.key,class:"ps-3 position-relative"},[m.taskType=="inline"?(d(),re(Xu,{key:0,task:m,taskGroupName:n.taskGroup.name,"task-index":b,"task-group":n.taskGroup.task,"general-submitted":J(g)},null,8,["task","taskGroupName","task-index","task-group","general-submitted"])):E("",!0),m.taskType==="table"?(d(),re(Xl,{key:1,task:m,"general-submitted":J(g)},null,8,["task","general-submitted"])):E("",!0),m.taskType=="collapsibleTable"?(d(),re(rd,{key:2,task:m,"general-submitted":J(g)},null,8,["task","general-submitted"])):E("",!0)]))),128))]),_:1},8,["title","name"])]),_:1},8,["modelValue"])}}}),id={class:"ps-0 mt-5"},ud={class:"card"},dd=Ue({__name:"SubGroup",props:{subGroup:{type:Object,required:!0}},setup(n){const s=n,e=rt(),o=i(()=>{let t=s.subGroup.taskGroup;return Sl.enableSkipPreservice||(t=t.filter(r=>r.key!="Skip_Preservice")),t});return Mt(async()=>{const t=await e.checkCurrentWoPendingOfflineTask();(_e()||!t)&&setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},0)}),(t,r)=>(d(),h("div",id,[l("div",ud,[(d(!0),h(we,null,tt(o.value,g=>(d(),re(nd,{key:g.key,"task-group":g},null,8,["task-group"]))),128))])]))}}),ma=n=>(Yt("data-v-fdcfba73"),n=n(),zt(),n),cd={class:"mt-5 ps-0"},md=ma(()=>l("h4",{class:"subtitle ps-3"},"Service Labour Personnel",-1)),fd={class:"p-2 me-0"},vd={class:"row",style:{width:"101%"}},pd={class:"col-12 pe-0"},yd={class:"p-2 me-0"},gd={class:"row",style:{width:"101%"}},bd={class:"col-6 pe-0"},kd=["value"],hd=ma(()=>l("label",{for:"floatingInput",class:"text-nowrap"},"Actual Service Start (each labour personnel)",-1)),_d={class:"col-6 pe-0"},wd={class:"form-floating mb-3",style:{position:"relative !important"}},Sd=["value"],Cd=ma(()=>l("label",{for:"floatingInput"},"Shift",-1)),Rd=ma(()=>l("h4",{class:"subtitle ps-3"},"Equipment Information",-1)),Td={class:"d-flex flex-row justify-content-between"},Ud={class:"p-2 d-flex flex-row flex-grow-1"},Id={class:"d-flex w-100"},$d={class:"flex-fill"},Pd={class:"form-floating mb-3"},Dd=["value"],Vd=ma(()=>l("label",null,"Unit Number",-1)),Bd={class:"flex-fill ps-3"},Ad={class:"form-floating mb-3"},Nd=["value"],xd=ma(()=>l("label",{for:"floatingInput"},"Serial Number",-1)),Od={class:"flex-fill ps-3"},Ld={class:"form-floating mb-3"},Ed=["value"],Fd=ma(()=>l("label",{for:"floatingInput"},"Work Order",-1)),Md={class:"flex-fill ps-3"},jd={class:"form-floating mb-3 position-relative"},Hd=["value"],Kd=["value","disabled"],Gd={key:2,class:"ms-2 position-absolute",style:{top:"2px",right:"0"}},qd=ma(()=>l("img",{src:Do,style:{width:"1.25rem",height:"1.25rem"}},null,-1)),Wd=[qd],Jd=ma(()=>l("label",{for:"floatingInput2",class:"text-nowrap"},"Machine SMU",-1)),Yd={key:0,class:"text-danger ps-2 font-weight-bold"},zd={class:"ms-2"},Xd=["disabled"],Qd=["src"],Zd={key:0,class:"ms-2"},ec={class:"p-3 justify-items-center rounded",style:{background:"#18AF4A"}},tc={key:0,class:"d-flex flex-row justify-content-end timestamp-task"},ac={class:"d-flex flex-row justify-content-between"},sc={class:"p-2 d-flex flex-row flex-grow-1"},lc={class:"d-flex w-100"},oc={class:"flex-fill"},rc={class:"form-floating mb-3"},nc=["value"],ic=ma(()=>l("label",null,"Actual Service Start",-1)),uc={class:"flex-fill ps-3"},dc={class:"form-floating mb-3"},cc=["value"],mc=ma(()=>l("label",{for:"floatingInput"},"HM Offset",-1)),fc={key:0,class:"d-flex",style:{"flex-basis":"40%"}},vc={class:"flex-fill ps-3"},pc={class:"form-floating mb-3"},yc=["value"],gc=["value"],bc=ma(()=>l("label",{for:"floatingInput2",class:"text-nowrap"},"Travel Hours",-1)),kc={key:0,class:"text-danger ps-2 font-weight-bold"},hc={class:"ms-2"},_c=["disabled"],wc=["src"],Sc={key:0,class:"ms-2"},Cc={class:"p-3 justify-items-center rounded",style:{background:"#18AF4A"}},Rc={class:"d-flex flex-row justify-content-between"},Tc={class:"p-2 d-flex flex-row flex-grow-1"},Uc={class:"d-flex w-100"},Ic={class:"flex-fill"},$c={class:"form-floating mb-3"},Pc=["value"],Dc=ma(()=>l("label",null,"Actual Service Finish",-1)),Vc={key:0,class:"d-flex",style:{"flex-basis":"40%"}},Bc={class:"flex-fill ps-3"},Ac={class:"form-floating mb-3"},Nc=["value"],xc=["value"],Oc=ma(()=>l("label",{for:"floatingInput2",class:"text-nowrap"},"Swing Hours",-1)),Lc={key:0,class:"text-danger ps-2 font-weight-bold"},Ec={class:"ms-2"},Fc=["disabled"],Mc=["src"],jc={key:0,class:"ms-2"},Hc={class:"p-3 justify-items-center rounded",style:{background:"#18AF4A"}},Kc=Ue({__name:"CardEquipmentInformation",props:{data:{required:!0,type:Object},timer:{required:!0,type:String}},emits:["onPersonelSelected","updateTimer"],setup(n,{expose:s,emit:e}){const o=n,t=e,r=Da(),g=Jt(),u=ya(),_=rt(),C=Al(),v=za();wa();const c=f(_.serviceStart),k=f(_.shift),P=f("Equipment Information"),B=f(""),m=f({smu:"",travelHour:"",swingHour:""}),b=f(!1),S=f(!1),L=f(!1),H=f(!1),F=f(!1),x=f(!1),p=f(""),K=f(!1),X=f(!1),W=f(""),w=f(""),D=f(!1),U=f(""),I=f(!1),z=f({name:"",id:""}),oe=f(""),me=f(""),M=f(""),te=i(()=>a.isUndefined(r.generalForm.hmOffset)||r.generalForm.hmOffset==""?r.HmOffset==""||r.HmOffset=="Not Applicable"?0:Number(r.HmOffset):r.generalForm.hmOffset),T=i(()=>{const j=r.smuActual,ne=r.smuTolerance;return Number(Number(j)+Number(ne.min))}),$=i(()=>{const j=r.smuActual,ne=r.smuTolerance;return Number(Number(j)+Number(ne.max))}),ae=i(()=>T.value-te.value),G=i(()=>$.value-te.value),Z=j=>Ko({smu:j,hmOffset:te.value,range:{min:T.value,max:$.value}}),ie=i(()=>{var j;return z.value.name?z.value:(j=o.data)==null?void 0:j.smuBy}),Ce=i(()=>{var j;return oe.value!=""?oe.value:(j=o.data)==null?void 0:j.smuDate}),st=i(()=>({isError:v.stateErrorMessage!="",messages:v.stateErrorMessage})),Ke=()=>{let j="/media/svg/dma/camera/e-form/png/cam-active.png";return pt.value&&(j="/media/svg/dma/camera/e-form/png/cam-read.png"),V.value.length>0&&(j="/media/svg/dma/camera/e-form/png/cam-user.png"),j},$t=()=>{let j="/media/svg/dma/camera/e-form/png/cam-active.png";return Ot.value&&(j="/media/svg/dma/camera/e-form/png/cam-read.png"),q.value.length>0&&(j="/media/svg/dma/camera/e-form/png/cam-user.png"),j},kt=()=>{let j="/media/svg/dma/camera/e-form/png/cam-active.png";return Xt.value&&(j="/media/svg/dma/camera/e-form/png/cam-read.png"),fe.value.length>0&&(j="/media/svg/dma/camera/e-form/png/cam-user.png"),j},V=i(()=>{try{const j=r.generalForm.imageEquipment;return a.isUndefined(j)?[]:j==""?[]:yt(j)}catch{return[]}}),q=i(()=>{try{const j=r.generalForm.travelHourImages;return a.isUndefined(j)?[]:j==""?[]:yt(j)}catch{return[]}}),fe=i(()=>{try{const j=r.generalForm.swingHourImages;return a.isUndefined(j)?[]:j==""?[]:yt(j)}catch{return[]}}),Re=i(()=>a.cloneDeep(u.ImageObjects.find(j=>j.Id==="equipment-smu"))),Ne=i(()=>a.cloneDeep(u.ImageObjects.find(j=>j.Id==="equipment-swing"))),Ae=i(()=>a.cloneDeep(u.ImageObjects.find(j=>j.Id==="equipment-travel"))),ut=f(),mt=async()=>{let j=[];Re.value&&(j=yt(Re.value.ImageInfos));const ne=yt(r.generalForm.imageEquipment),Oe=j.filter(pe=>!ne.includes(pe));if(await r.updateSMUImages([a.last(Oe)]),r.generalForm.imageEquipment.length==1)if(_e()){let pe=o.data.smu;I.value||U.value!=""&&U.value!=o.data.smu&&(pe=U.value,await le()),r.updateSMUImageToLocal(),De(pe),K.value=!0,setTimeout(()=>{K.value=!1},2e3)}else{ut.value=Xe.service({lock:!0,text:"Uploading Picture",background:"rgba(0, 0, 0, 0.7)"});try{if(!(await r.updateSMUImageToBE()).data.result.isError){K.value=!0,ut.value.close(),setTimeout(()=>{K.value=!1},2e3);let xe=o.data.smu;if(I.value||U.value!=""&&U.value!=o.data.smu&&(xe=U.value,await le()),xe!=""){try{await v.createSMUDefect({val:da(xe),hmOffset:String(r.HmOffset),range:{MinRange:T.value,MaxRange:$.value},smuDate:oe.value,isInRange:Z(xe)}),_.getTaskProgress()}catch{De(xe)}X.value=!1}}I.value=!1}finally{ut.value.close()}}else _e()&&await r.updateSMUImageToLocal()},ct=()=>{D.value=!0},se=i(()=>{var xe,Et;let j=da(a.cloneDeep(((xe=o.data)==null?void 0:xe.smu)||U.value));const ne=Number(j)+Number(te.value)>=T.value,Oe=Number(j)+Number(te.value)<=$.value;let pe=Bs.STATUS_NOT_IN_RANGE;return ne&&Oe&&(pe=Bs.STATUS_IN_RANGE),{title:Bs.TITLE(pe),machineSMU:((Et=o.data)==null?void 0:Et.smu)||U.value,minRange:T.value,maxRange:$.value,smuDue:r.smuActual,assetNumber:_.unitNumber,serialNumber:_.generalForm.serialNumber,images:JSON.stringify(V.value),hmOffset:r.HmOffset,key:"",type:"",reason:""}}),ke=i(()=>{const j=v.Ownership;return js(j)}),De=async(j,ne)=>{await v.updateDefectSMUToLocalDB({val:da(j),hmOffset:String(r.HmOffset),range:{MinRange:T.value,MaxRange:$.value},smuDate:oe.value,isInRange:ne||Z(j)}),_.getMultiDefectList()},He=async()=>{let j=[];Ne.value&&(j=yt(Ne.value.ImageInfos));const ne=yt(r.generalForm.swingHourImages),Oe=j.filter(xe=>!ne.includes(xe));await r.updateSwingImages(Oe);const pe=async()=>{await r.updateTravelSwingImageToLocal("swingHourImages",r.generalForm.swingHourImages)};if(_e())pe();else try{await r.updateTravelSwingImageToBE("swingHourImages",r.generalForm.swingHourImages)}catch{pe()}},at=async()=>{let j=[];Ae.value&&(j=yt(Ae.value.ImageInfos));const ne=yt(r.generalForm.travelHourImages),Oe=j.filter(xe=>!ne.includes(xe));await r.updateTravelImages(Oe);const pe=async()=>{await r.updateTravelSwingImageToLocal("travelHourImages",r.generalForm.travelHourImages)};if(_e())pe();else try{await r.updateTravelSwingImageToBE("travelHourImages",r.generalForm.travelHourImages)}catch{pe()}};be(Re,async(j,ne)=>{!a.isUndefined(j)&&j.ImageInfos.length>0&&(a.isEqual(j.ImageInfos,ne==null?void 0:ne.ImageInfos)||await mt())},{deep:!0}),be(Ne,async(j,ne)=>{!a.isUndefined(j)&&j.ImageInfos.length>0&&(a.isEqual(j.ImageInfos,ne==null?void 0:ne.ImageInfos)||await He())},{deep:!0}),be(Ae,async(j,ne)=>{!a.isUndefined(j)&&j.ImageInfos.length>0&&(a.isEqual(j.ImageInfos,ne==null?void 0:ne.ImageInfos)||await at())},{deep:!0});const gt=f(!1),ft=()=>{gt.value=!0},dt=f(!1),St=()=>{dt.value=!0},it=()=>{dt.value=!1},Le=f(!1),xt=()=>{Le.value=!0},Ht=()=>{Le.value=!1},Ge=()=>{gt.value=!1},Rt=i(()=>!!Gt.value.name),pt=i(()=>!Gt.value.name||V.value.length>1?!0:r.stateIsSmuCameraDisabled||_.generalForm.smu==""),Ot=i(()=>!Gt.value.name||q.value.length>1?!0:r.stateIsTravelHourCameraDisabled||_.generalForm.travelHour==""),Xt=i(()=>!Gt.value.name||fe.value.length>1?!0:r.stateIsSwingHourCameraDisabled||_.generalForm.swingHour==""),Kt=()=>{Ia(),I.value=!0,Ge()},Tt=j=>{r.deleteSwingPic(j),u.setCurrent("equipment-swing"),u.clearCurrent(),r.stateGeneralForm.isSwingMandatoryTakePhoto&&fe.value.length==0&&Sa(!1),fe.value.length==0&&Ht()},vt=j=>{r.deleteTravelPic(j),u.setCurrent("equipment-travel"),u.clearCurrent(),r.stateGeneralForm.isTravelMandatoryTakePhoto&&q.value.length==0&&ta(!1),q.value.length==0&&it()},Gt=i(()=>_.employee),ea=i(()=>Gt.value.name!=""&&r.generalUpdated),Ia=()=>{u.toggleIsVisible(!0,"equipment-smu"),u.addLocalImageInfo({taskKey:"GENERAL",workOrder:r.generalForm.workOrder,type:"imageEquipment",updatedBy:_.employee.id,email:g.user.Email})},ga=()=>{u.toggleIsVisible(!0,"equipment-smu"),u.addLocalImageInfo({taskKey:"GENERAL",workOrder:r.generalForm.workOrder,type:"imageEquipment",updatedBy:_.employee.id,email:g.user.Email}),u.setShowCloseButton(!1),H.value=!1},Ba=()=>{ta(!1),F.value=!1},Aa=()=>{Sa(!1),x.value=!1},Sa=(j=!0)=>{u.toggleIsVisible(!0,"equipment-swing"),u.addLocalImageInfo({taskKey:"GENERAL",workOrder:r.generalForm.workOrder,type:"imageSwing",updatedBy:_.employee.id,email:g.user.Email}),u.setShowCloseButton(j)},ta=(j=!0)=>{u.toggleIsVisible(!0,"equipment-travel"),u.addLocalImageInfo({taskKey:"GENERAL",workOrder:r.generalForm.workOrder,type:"imageTravel",updatedBy:_.employee.id,email:g.user.Email}),u.setShowCloseButton(j)},Na=()=>{b.value=!1},xa=()=>{S.value=!1},Ca=i(()=>{let j=Pa(U.value);return j=="0"&&(j=""),j}),Ra=i(()=>{let j=Pa(me.value);return j=="0"&&(j=""),j}),A=i(()=>{let j=Pa(M.value);return j=="0"&&(j=""),j}),Q=async j=>{if(m.value.smu="",U.value=j,r.SMUToleranceNotMapped)m.value.smu="SMU tolerance not yet mapped",S.value=!0;else if(Z(j))if(r.generalForm.imageEquipment.length>0)if(le(),_e())De(U.value);else try{v.createSMUDefect({val:da(U.value),hmOffset:String(r.HmOffset),range:{MinRange:T.value,MaxRange:$.value},smuDate:oe.value,isInRange:Z(U.value)}),_.getTaskProgress()}catch{De(U.value)}else H.value=!0;else p.value=`<b>Is this correct Machine SMU value?</b><br><span>Machine SMU should be in range <b>${ae.value} to ${G.value}</b></span>`,L.value=!0},le=async(j="")=>{const ne=da(j||U.value);oe.value=ne==""?"":Ft(),z.value=ne==""?"":v.selectedFitter,r.addPropertyParam("GENERAL","smu",ne),r.addPropertyParam("GENERAL","smuBy",JSON.stringify(z.value)),r.addPropertyParam("GENERAL","smuDate",oe.value),r.addPropertyParam("GENERAL","hmOffset",String(r.HmOffset)),r.updateSMUONGeneral({value:ne,smuBy:z.value,smuDate:oe.value});const Oe=()=>{r.updateSMUValueToLocal({smu:ne,hmOffset:String(r.HmOffset),smuDate:oe.value,smuBy:z.value})};try{if(_e())Oe();else try{await r.updateSMUValueToBE({smu:ne,hmOffset:String(r.HmOffset),smuDate:oe.value,smuBy:z.value})}catch{Oe()}}finally{}},ge=f(),Pe=()=>{L.value=!1,U.value="",z.value={id:"",name:""},oe.value="",ge.value.value="",co(()=>{ge.value.focus()})},Ie=()=>{if(L.value=!1,X.value=!0,r.generalForm.imageEquipment.length>0)if(le(),_e())De(U.value);else try{v.createSMUDefect({val:da(U.value),hmOffset:String(r.HmOffset),range:{MinRange:T.value,MaxRange:$.value},smuDate:oe.value,isInRange:Z(U.value)}),_.getTaskProgress()}catch{De(U.value)}else H.value=!0};let Fe;const Qe=async j=>{if(j.target.value=Pa(da(j.target.value)),m.value.smu="",clearTimeout(Fe),j.target.value=="")return!1;const ne=j.target.value;Fe=setTimeout(async()=>{if(O("smu")){let pe=!1;_e()||(pe=await Y("smu")),pe||await Q(ne)}else j.target.value="",U.value=""},0)},qe=j=>{j.target.value=Ga(j.target.value)},Ze=async j=>{m.value.travelHour="";let ne=da(a.cloneDeep(j));r.addPropertyParam("GENERAL","travelHour",ne),r.updateTravelHourONGeneral(ne);const Oe=async()=>{await r.updateSwingValueToLocal(ne,"travelHour")};if(_e())Oe();else try{await r.updateSwingTravelValueToBE("travelHour",ne)}catch{Oe()}},Ve=async j=>{if(W.value==j.target.value)return;j.target.value=Pa(da(j.target.value)),m.value.travelHour="",clearTimeout(Fe);const ne=j.target.value;Fe=setTimeout(async()=>{if(O("travelHour")){let pe=!1;_e()||(pe=await Y("travelHour")),pe||(r.stateGeneralForm.isTravelMandatoryTakePhoto&&q.value.length==0&&(F.value=!0),await Ze(ne))}else j.target.value=""},0)},ze=async j=>{m.value.swingHour="";let ne=da(a.cloneDeep(j));r.addPropertyParam("GENERAL","swingHour",ne),r.updateSwingHourONGeneral(ne);const Oe=async()=>{await r.updateSwingValueToLocal(ne,"swingHour")};if(_e())Oe();else try{await r.updateSwingTravelValueToBE("swingHour",ne)}catch{Oe()}},Pt=async j=>{if(W.value==j.target.value)return;j.target.value=Pa(da(j.target.value)),m.value.swingHour="",clearTimeout(Fe);const ne=j.target.value;Fe=setTimeout(async()=>{if(O("swingHour")){let pe=!1;_e()||(pe=await Y("swingHour")),pe||(r.stateGeneralForm.isSwingMandatoryTakePhoto&&fe.value.length==0&&(x.value=!0),await ze(ne))}else j.target.value=""},0)},O=j=>{const ne="Labour Personnel Name Personnel field must be completed";return _.employee.id==""||a.isUndefined(_.employee.id)?(m.value[j]=ne,!1):!0},Y=async j=>{let ne,Oe="";return j=="smu"?(Oe="SMU",w.value="SMU"):j=="travelHour"?(Oe="Travel Hour",w.value="Travel Hours"):j=="swingHour"&&(Oe="Swing Hour",w.value="Swing Hours"),await r.getServiceSheetHeaderKeyVal(j,Oe).then(async pe=>{pe!=""?(b.value=!0,j=="smu"&&(L.value=!1,Be()),_.updateGeneralValue(j,pe),setTimeout(()=>{},0),ne=!0):ne=!1}),ne},Be=async()=>{await r.getServiceSheetHeaderKeyVal("imageEquipment","SMU Images").then(async j=>{j!=""&&_.updateGeneralValue("imageEquipment",j)})},Ut=j=>{let ne=j.keyCode?j.keyCode:j.which;if((ne<48||ne>57)&&ne!=46&&j.preventDefault(),ne==13){ge.value.blur();return}},Dt=()=>{B.value="relative-hidder"},qt=()=>{B.value=""},la=()=>{const j=r.stateShiftList,ne=Ao(r.stateTimeZone),Oe=j.find(pe=>{const xe=pe.startHourType=="PM"?fl(`${pe.startHour}:00`):`${pe.startHour}:00`,Et=pe.endHourType=="PM"?fl(`${pe.endHour}:00`):`${pe.endHour}:00`;if(pe.startHourType=="PM"&&pe.endHourType=="AM"){if(ne>"12:00:00"){if(ne>=xe||ne<=Et)return pe}else if(ne<=xe&&ne<=Et)return pe}else if(ne>=xe&&ne<=Et)return pe});return a.isUndefined(Oe)?No(r.stateTimeZone):Oe.shift.toLowerCase().includes("shift")?Oe.shift:`${Oe.shift} Shift`},oa=j=>{if(j.value!="")if(r.generalForm.log.length==0)r.setFitterInfoFitter(j,ls(r.stateTimeZone),k.value),r.setIsFitterLoggedInExist(!1);else{const ne=r.generalForm.log.filter(Oe=>{if(!a.isUndefined(Oe.employee))return Oe.employee.id==j.value});if(ne.length==0)r.setFitterInfoFitter(j,ls(r.stateTimeZone),k.value),r.setIsFitterLoggedInExist(!1);else{const Oe=a.last(ne);r.setFitterInfo(Oe);const pe=ls(r.stateTimeZone).split(" ")[1],xe=r.stateShiftList.find(Vt=>{let aa=!1;if(Vt.startHourType=="AM"&&Vt.endHourType=="PM"){const sa=Number(Vt.endHour.split(":")[0])+6;let ra=`${Number(sa)+12}:${Vt.endHour.split(":")[1]}`;aa=pe>=Vt.startHour&&pe<=ra}else if(Vt.startHourType=="PM"&&Vt.endHourType=="AM"){let sa=`${Number(Vt.startHour.split(":")[0])+12}:${Vt.startHour.split(":")[1]}`;const ra=`${Number(Vt.endHour)+6}:${Vt.endHour.split(":")[1]}`;pe<"24:00:00"?aa=pe<=sa||pe>=ra:aa=pe<=sa&&pe<=ra}else aa=!0;return aa});let Et=Number(xe==null?void 0:xe.endHour.split(":")[0])+6;(xe==null?void 0:xe.endHourType)=="PM"&&(Et+=12);let fa=`${Et}:${xe==null?void 0:xe.endHour.split(":")[1]}:${xe==null?void 0:xe.endHour.split(":")[2]}`;pe<fa&&r.setIsFitterLoggedInExist(!0)}}},ba=async j=>{B.value="",c.value=`${ls(r.stateTimeZone)} (${r.stateTimeZoneDesc})`,k.value=la();const ne={id:j.value,name:j.label};_.updateSelectedFitter(ne),oa(j),t("onPersonelSelected");const Oe={key:ys(),mechanic:ne,serviceStart:"<<ServerDateTime>>",serviceEnd:"",shift:k.value};r.addPropertyParam("GENERAL","servicePersonnels",JSON.stringify(Oe)),r.setCurrentPersoneel(Oe),_.updateServiceStart(c.value);for(const pe in m.value)m.value[pe]=="Labour Personnel Name Personnel field must be completed"&&(m.value[pe]="");_.updateSelectedFitter(ne)},Qt=f(),ve=()=>{m.value.travelHour="Required"},y=()=>{m.value.swingHour="Required"},N=()=>{m.value.travelHour=""},he=()=>{m.value.swingHour=""},lt=async j=>{const ne=!j.newDetail.title.toLowerCase().includes("not");if(le(j.newDetail.machineSMU),!a.isEqual(V.value,JSON.parse(j.newDetail.images))){r.updateSMUImages(JSON.parse(j.newDetail.images));const pe=()=>{r.updateSMUImageToLocal()};if(_e())pe();else try{await r.updateSMUImageToBE()}catch{pe()}}if(_e())De(j.newDetail.machineSMU,ne);else try{v.createSMUDefect({val:da(j.newDetail.machineSMU),hmOffset:String(r.HmOffset),range:{MinRange:T.value,MaxRange:$.value},smuDate:oe.value,isInRange:ne}),_.getTaskProgress()}catch{De(j.newDetail.machineSMU,ne)}j.callback()},et=tr.SMU_REVISE,We=i(()=>{const j=u.ImageObjects.find(ne=>ne.Id===et);return a.cloneDeep(j)}),Wt=()=>{u.toggleIsVisible(!0,et),u.setIsActionFromDelete(!0)},Lt=()=>{u.reset()},Zt=()=>{v.resetErrorStatus()};return s({showTravelRequired:ve,showSwingRequired:y,hideTravelRequired:N,hideSwingRequired:he}),Mt(()=>{_.stateFromHomePage&&(Qt.value.optionSelected({label:"",value:""}),c.value="",_.setFromHomePage(!1),U.value=o.data.smu)}),Ja(()=>{ut.value&&ut.value.close()}),(j,ne)=>{const Oe=ce("el-collapse-item"),pe=ce("el-collapse");return d(),h(we,null,[l("div",cd,[R(pe,{modelValue:P.value,"onUpdate:modelValue":ne[2]||(ne[2]=xe=>P.value=xe),class:"general-accordion task-group py-1 px-5 mb-3"},{default:ee(()=>[R(Oe,{name:"Equipment Information"},{title:ee(()=>[md]),default:ee(()=>{var xe;return[l("div",fd,[l("div",vd,[l("div",pd,[R(Xo,{ref_key:"selectFitter",ref:Qt,"field-label":"Labour Personnel Name",placeholder:"Select your name",data:J(C).PersonelLabours,value:Gt.value.name,"display-label":!0,onOnFocus:Dt,onOnLostFocus:qt,onOnSelected:ba,disabled:ea.value},null,8,["data","value","disabled"])])])]),l("div",yd,[l("div",gd,[l("div",bd,[l("div",{class:$e(["form-floating mb-3",B.value]),style:{position:"relative !important"}},[l("input",{type:"text",class:"form-control",disabled:"",value:c.value},null,8,kd),hd],2)]),l("div",_d,[l("div",wd,[l("input",{type:"text",class:"form-control no-float",disabled:"",value:k.value},null,8,Sd),Cd])])])]),Rd,l("div",Td,[l("div",Ud,[l("div",Id,[l("div",$d,[l("div",Pd,[l("input",{type:"text",class:"form-control",disabled:"",value:J(_).unitNumber},null,8,Dd),Vd])]),l("div",Bd,[l("div",Ad,[l("input",{type:"text",class:"form-control",disabled:"",value:n.data.serialNumber},null,8,Nd),xd])]),l("div",Od,[l("div",Ld,[l("input",{type:"text",class:"form-control",disabled:"",value:n.data.workOrder},null,8,Ed),Fd])]),l("div",Md,[l("div",jd,[n.data.smu!==""?(d(),h("input",{key:0,type:"text",class:"form-control",placeholder:"Machine SMU",disabled:"",value:J(Pa)(n.data.smu),pattern:"[0-9]*",inputmode:"numeric"},null,8,Hd)):(d(),h("input",{key:1,type:"text",name:"machine-smu",ref_key:"machineSMUField",ref:ge,class:"form-control",placeholder:"Machine SMU",onKeypress:Ut,onInput:qe,value:Ca.value,disabled:L.value||H.value,onFocusout:Qe,pattern:"[0-9]*",inputmode:"numeric"},null,40,Kd)),!n.data.isApprovedSmu&&n.data.smu&&((xe=Gt.value)!=null&&xe.name)?(d(),h("div",Gd,[l("button",{class:"btn p-4 justify-items-center rounded cursor-pointer svg-icon svg-icon-btech-primary-500",onClick:ct},Wd)])):E("",!0),Jd]),m.value.smu?(d(),h("label",Yd,ue(m.value.smu),1)):E("",!0)]),l("div",zd,[l("button",{class:"btn p-4 justify-items-center rounded",disabled:pt.value||V.value.length>0,style:{background:"#F4F6F8",cursor:"pointer"},onClick:Ia},[l("img",{src:Ke(),style:{height:"20px",width:"24px"},alt:"smu"},null,8,Qd)],8,Xd)]),V.value.length>0?(d(),h("div",Zd,[l("div",ec,[l("span",{style:{"font-weight":"700",color:"white"},onClick:ft},"+"+ue(V.value.length),1)])])):E("",!0)])])]),ie.value&&Ce.value?(d(),h("div",tc,ue(ie.value.name)+", "+ue(Ce.value),1)):E("",!0),l("div",ac,[l("div",sc,[l("div",lc,[l("div",oc,[l("div",rc,[l("input",{type:"text",class:"form-control",disabled:"",value:n.data.serviceStart},null,8,nc),ic])]),l("div",uc,[l("div",dc,[l("input",{type:"text",class:"form-control",disabled:"",value:J(r).HmOffset},null,8,cc),mc])]),J(a.isUndefined)(n.data.travelHour)?E("",!0):(d(),h("div",fc,[l("div",vc,[l("div",pc,[n.data.travelHour!==""||J(r).generalUpdated||J(r).generalForm.status=="Submited"?(d(),h("input",{key:0,type:"text",class:"form-control travel-swing",placeholder:"Travel Hours",disabled:"",value:J(Pa)(n.data.travelHour),pattern:"[0-9]*",inputmode:"numeric"},null,8,yc)):(d(),h("input",{key:1,type:"text",class:"form-control travel-swing",placeholder:"Travel Hours",onKeypress:Ut,onInput:qe,value:Ra.value,onFocusin:ne[0]||(ne[0]=()=>{W.value=Ra.value}),onFocusout:Ve,pattern:"[0-9]*",inputmode:"numeric"},null,40,gc)),bc]),m.value.travelHour?(d(),h("label",kc,ue(m.value.travelHour),1)):E("",!0)]),l("div",hc,[l("button",{class:"btn p-4 justify-items-center rounded",disabled:Ot.value||q.value.length>0,style:{background:"#F4F6F8",cursor:"pointer"},onClick:ta},[l("img",{src:$t(),style:{height:"20px",width:"24px"},alt:"travel"},null,8,wc)],8,_c)]),q.value.length>0?(d(),h("div",Sc,[l("div",Cc,[l("span",{style:{"font-weight":"700",color:"white"},onClick:St},"+"+ue(q.value.length),1)])])):E("",!0)]))])])]),l("div",Rc,[l("div",Tc,[l("div",Uc,[l("div",Ic,[l("div",$c,[l("input",{type:"text",class:"form-control",disabled:"",value:n.data.serviceEnd},null,8,Pc),Dc])]),J(a.isUndefined)(n.data.swingHour)?E("",!0):(d(),h("div",Vc,[l("div",Bc,[l("div",Ac,[n.data.swingHour!==""||J(r).generalUpdated||J(r).generalForm.status=="Submited"?(d(),h("input",{key:0,type:"text",class:"form-control travel-swing",placeholder:"Swing Hours",disabled:"",value:J(Pa)(n.data.swingHour),pattern:"[0-9]*",inputmode:"numeric"},null,8,Nc)):(d(),h("input",{key:1,type:"text",class:"form-control travel-swing",placeholder:"Swing Hours",onKeypress:Ut,onInput:qe,value:A.value,onFocusin:ne[1]||(ne[1]=()=>{W.value=Ra.value}),onFocusout:Pt,pattern:"[0-9]*",inputmode:"numeric"},null,40,xc)),Oc]),m.value.swingHour?(d(),h("label",Lc,ue(m.value.swingHour),1)):E("",!0)]),l("div",Ec,[l("button",{class:"btn p-4 justify-items-center rounded",disabled:Xt.value||fe.value.length>0,style:{background:"#F4F6F8",cursor:"pointer"},onClick:Sa},[l("img",{src:kt(),style:{height:"20px",width:"24px"},alt:"swing"},null,8,Mc)],8,Fc)]),fe.value.length>0?(d(),h("div",jc,[l("div",Hc,[l("span",{style:{"font-weight":"700",color:"white"},onClick:xt},"+"+ue(fe.value.length),1)])])):E("",!0)]))])])])]}),_:1})]),_:1},8,["modelValue"])]),R(Ea,{"modal-type":"alreadyFilled",show:b.value,type:w.value,onClose:Na},null,8,["show","type"]),R(Ea,{"modal-type":"notMapped",show:S.value,onClose:xa},null,8,["show"]),gt.value?(d(),re(Ma,{key:0,images:V.value,"show-delete-button":Rt.value,"show-remaining-photos-message":!Z,visibility:gt.value,onHandleClose:Ge,onHandleDelete:Kt},null,8,["images","show-delete-button","show-remaining-photos-message","visibility"])):E("",!0),dt.value?(d(),re(Ma,{key:1,images:q.value,visibility:dt.value,showDeleteButton:!Ot.value,onHandleClose:it,onHandleDelete:vt},null,8,["images","visibility","showDeleteButton"])):E("",!0),Le.value?(d(),re(Ma,{key:2,images:fe.value,visibility:Le.value,showDeleteButton:!Xt.value,onHandleClose:Ht,onHandleDelete:Tt},null,8,["images","visibility","showDeleteButton"])):E("",!0),R(Nl,{visibility:L.value,caption:p.value,onOnNoConfirm:Pe,onOnYesConfirm:Ie},null,8,["visibility","caption"]),R(ca,{visibility:H.value,caption:"Please take photo of Machine SMU in the cabin dashboard","yes-label":"Take a Photo","hide-no":!0,onOnYesConfirm:ga},null,8,["visibility"]),R(ca,{visibility:F.value,caption:"Please take photo","yes-label":"Take a Photo","hide-no":!0,onOnYesConfirm:Ba},null,8,["visibility"]),R(ca,{visibility:x.value,caption:"Please take photo","yes-label":"Take a Photo","hide-no":!0,onOnYesConfirm:Aa},null,8,["visibility"]),R(Hs,{show:K.value,message:"Machine SMU photo has been taken"},null,8,["show"]),R(xl,{show:D.value,"onUpdate:show":ne[3]||(ne[3]=xe=>D.value=xe),detailDefect:se.value,ownership:ke.value,"view-only":n.data.isApprovedSmu,"error-status":st.value,isFitter:!0,"cameras-image":We.value,onUpdateDefectDetailSMU:lt,onRetakePhoto:Wt,onResetPhoto:Lt,onResetErrorStatus:Zt},null,8,["show","detailDefect","ownership","view-only","error-status","cameras-image"])],64)}}}),Gc=Ct(Kc,[["__scopeId","data-v-fdcfba73"]]),qc={class:"mt-5 ps-0"},Wc=l("div",{class:"p-2"},[l("img",{src:ar,alt:"cautions"})],-1),Jc={class:"p-2 bg-green flex-fill"},Yc=["innerHTML"],zc=Ue({__name:"OfflineSafetyPrecautions",props:{data:{required:!0,type:Array}},setup(n){const s=f("Safety Precautions"),e=f(null),o=f(""),t=f(!1),r=()=>{t.value=!1},g=u=>Ha(u).replaceAll("{BLOB_URL}","https://digitaldevbumaausta001.blob.core.windows.net");return Mt(()=>{try{e.value&&Array.from(e.value).forEach(u=>{Array.from(u.getElementsByClassName("show-pdf")).forEach(C=>{C.onclick=v=>{v.preventDefault(),t.value=!0,o.value=C.href}})})}catch(u){console.log(u)}}),(u,_)=>{const C=ce("el-collapse-item"),v=ce("el-collapse");return d(),h(we,null,[l("div",qc,[R(v,{modelValue:s.value,"onUpdate:modelValue":_[0]||(_[0]=c=>s.value=c),class:"task-group general-accordion py-1 px-5 mb-3"},{default:ee(()=>[R(C,{title:"Safety Precautions",name:"Safety Precautions"},{default:ee(()=>[(d(!0),h(we,null,tt(n.data,(c,k)=>(d(),h("div",{key:c.key,class:$e(["d-flex justify-content-start",k==n.data.length-1?"mb-5":""])},[Wc,l("div",Jc,[c.items[1].taskType!="html"?(d(),h(we,{key:0},[Ee(ue(c.items[1].value),1)],64)):(d(),h("span",{key:1,ref_for:!0,ref_key:"safetyPrecautinsHtml",ref:e,innerHTML:g(c.items[1].value)},null,8,Yc))])],2))),128))]),_:1})]),_:1},8,["modelValue"])]),R(qs,{show:t.value,onHandleCloseModal:r,"blob-url":o.value},null,8,["show","blob-url"])],64)}}}),Xc={class:"ps-2 justify-content-start"},Qc={class:"p-2 row justify-content-between"},Zc={class:"col-7 form-check checkbox-success"},em=["disabled","id"],tm=["for"],am={class:"col-5 text-end"},sm=Ue({__name:"CheckBoxItem",props:{item:{required:!0,type:Object},index:{type:Number},isAggrementChecked:{type:Boolean,default:!1}},setup(n){const s=n,e=Me(s,"item"),o=Da(),t=rt(),r=Jt();wa();const g=i(()=>{const v=e.value.value=="true"||e.value.value==!0,c=o.generalForm&&o.generalForm.status=="Submited";return!s.isAggrementChecked||v||c}),u=i({get:()=>s.item.value,set:v=>{let c=t.generalForm.checkBeforeTruck.items.find(k=>k.key==s.item.key);c&&(c.value=v),_()}}),_=async()=>{const v=Xe.service({lock:!0,text:"Updating",background:"rgba(0, 0, 0, 0.7)"}),c={keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:e.value.value},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};_e()?await o.updateCheckBeforeTruckToLocalDB(c,e.value.key):await o.postCheckBeforeTruckItem(c,e.value.key)&&await t.postGenerateServiceSheet(r.user.EmployeeId,r.user.Name,r.user.SiteId),v.close()},C=i(()=>{var c,k;let v="";return!a.isUndefined(s.item.updatedDate)&&!a.isUndefined((c=s.item.updatedBy)==null?void 0:c.name)&&(v=`${(k=s.item.updatedBy)==null?void 0:k.name}, ${s.item.updatedDate}`),v});return(v,c)=>(d(),h("div",Xc,[l("div",Qc,[l("div",Zc,[Nt(l("input",{class:"form-check-input",type:"checkbox",disabled:g.value,"onUpdate:modelValue":c[0]||(c[0]=k=>u.value=k),id:n.item.caption},null,8,em),[[Ya,u.value]]),l("label",{class:"form-check-label subtitle",for:n.item.caption},ue(n.item.caption),9,tm)]),l("div",am,ue(C.value),1)])]))}}),lm=Ct(sm,[["__scopeId","data-v-e4e373e3"]]),om={class:"p-2 check-truck-info d-flex"},rm={class:"form-check p-0 icon"},nm=["src"],im={class:"form-check text ps-6"},um=["innerHTML"],dm=Ue({__name:"CheckTruckInfo",props:{item:{required:!0,type:Object}},setup(n){const e=Me(n,"item"),o=f(!0),t=f("");wa();const r=Da();return gs(async()=>{if(e.value.icon){e.value.icon.value;try{const g=window.URL||window.webkitURL;let u="";if(_e())u=await vs(e.value.icon.value);else{const _=await Es(e.value.icon.value);u=g.createObjectURL(_),Fs(e.value.icon.value,r.stateGeneralForm.workOrder,_,e.value.key,"task",r.eformStore.employee.id)}t.value=u,o.value=!1}catch{o.value=!1}}}),(g,u)=>{const _=rs("loading");return d(),h("div",om,[l("div",rm,[Nt(l("img",{src:t.value,class:"img-fluid"},null,8,nm),[[_,o.value]])]),l("div",im,[l("span",{innerHTML:e.value.value},null,8,um)])])}}}),cm=Ct(dm,[["__scopeId","data-v-013fab9d"]]),Ql=n=>(Yt("data-v-42eb4030"),n=n(),zt(),n),mm=Ql(()=>l("span",{class:"el-dialog__title"},"You may now enter the service without completing the wash checks",-1)),fm={class:"mt-1 p-2"},vm={class:"d-flex flex-column"},pm=Ql(()=>l("label",{class:"reason_skip--label"},[Ee("Reason "),l("span",{class:"red"},"*")],-1)),ym={key:0,class:"px-1 text-danger"},gm={key:0,class:"mt-1 p-2"},bm={class:"dialog-footer",style:{display:"block","text-align":"right"}},km=Ue({__name:"ReasonDialog",props:{visibility:{required:!0,type:Boolean},options:{required:!1,type:Array,default:[]}},emits:["onClose","onSave","onCancel"],setup(n,{emit:s}){const e=n,o=s,t=Da(),r=Me(e,"visibility"),g=f(!1),u=f(!1);f(!1);const _=f(""),C=f(""),v=f(!1),c=f(!0),k=f(!1);be(()=>t.ReasonUpdated,H=>{H&&(g.value=!0,setTimeout(()=>{g.value=!1,o("onClose")},2e3))});const P=()=>{_.value&&(k.value=!1),v.value=_.value.includes("Other"),v.value?(C.value="",c.value=!0):c.value=!1},B=H=>{C.value=H.value,c.value=C.value===""},m=()=>{_.value?b():k.value=!0},b=async()=>{o("onSave",{selectedReason:_.value,desc:C.value})},S=()=>{o("onCancel")},L=async()=>{_.value="",C.value="",v.value=!1,k.value=!1,g.value=!1,u.value=!1,o("onClose")};return(H,F)=>{const x=ce("el-option"),p=ce("el-select"),K=ce("el-button"),X=ce("el-dialog");return d(),re(X,{modelValue:r.value,"onUpdate:modelValue":F[1]||(F[1]=W=>r.value=W),width:"90%",center:"","lock-scroll":!1,"before-close":S,onClosed:L,"custom-class":"el-defect-crack-form-custom reason-dialog","destroy-on-close":!0},{title:ee(()=>[mm]),footer:ee(()=>[l("span",bm,[R(K,{onClick:S,style:{"box-shadow":"0px 24px 48px rgba(145, 158, 171, 0.2)"}},{default:ee(()=>[Ee("Cancel")]),_:1}),R(K,{disabled:c.value,class:"button-OK-confirmation",type:"success",onClick:ha(m,["prevent"]),style:{background:"rgb(24, 175, 74)","box-shadow":"rgba(0, 171, 85, 0.24) 0px 8px 16px",color:"white"}},{default:ee(()=>[Ee("Submit")]),_:1},8,["disabled"])])]),default:ee(()=>[l("div",null,[l("div",fm,[l("div",vm,[pm,R(p,{modelValue:_.value,"onUpdate:modelValue":F[0]||(F[0]=W=>_.value=W),filterable:"",onChange:P,class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(n.options,W=>(d(),re(x,{key:W.id,label:W,value:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),k.value?(d(),h("label",ym,"Required")):E("",!0)])]),v.value?(d(),h("div",gm,[R(_a,{"label-class":"dma--textarea-label reason_skip--label","text-class":"dma--textarea-input h-100px reason_skip--text",value:C.value,label:"Description <span class='red'>*</span>",name:"Description",placeholder:"Write Reason",onHandleChange:B},null,8,["value"])])):E("",!0)]),R(Ol,{visibility:g.value,caption:"Now you can enter the service without completing the wash checks"},null,8,["visibility"])]),_:1},8,["modelValue"])}}}),hm=Ct(km,[["__scopeId","data-v-42eb4030"]]),_m={class:"ps-2 justify-content-start"},wm={class:"p-2 row justify-content-between"},Sm={class:"col-7 form-check checkbox-success"},Cm=["disabled","id"],Rm=["for"],Tm={class:"text-end reason_skip--updateBy"},Um={key:1,class:"border my-3"},Im=Ue({__name:"CheckBoxItemWithDialog",props:{item:{required:!0,type:Object},lastIndex:{type:Boolean},isAggrementChecked:{type:Boolean,default:!1}},setup(n){const s=n,e=Me(s,"item"),o=f(!1),t=Da(),r=rt(),g=Jt();let u={},_=!1;const C=F=>{_=F},v=i({get:()=>s.item.value,set:F=>{c(F)}}),c=F=>{let x=r.generalForm.checkBeforeTruck.items.find(p=>p.key==s.item.key);x&&(x.value=F)},k=F=>{F.target.checked==!0?(o.value=!0,C(!0)):L({selectedReason:"",desc:"",reset:!0})},P=i(()=>e.value.reason?e.value.reason.includes("Other")?e.value.reason.split(";;")[1]:e.value.reason.split(";;")[0]:""),B=i(()=>{const F=t.generalForm&&t.generalForm.status=="Submited";return!s.isAggrementChecked||t.AllWashChecked||t.generalUpdated||F}),m=F=>{F&&L(F)},b=()=>{o.value=!1},S=()=>{v.value="false",C(!1),b()},L=async F=>{const x=Xe.service({lock:!0,text:"Updating",background:"rgba(0, 0, 0, 0.7)"});let p=`${F.selectedReason};;${F.desc}`,K="true",X=Ft();F.reset&&(p="",K="false",X="",u.updatedBy={},u.updatedDate=""),u=a.cloneDeep(e.value),u.value=a.cloneDeep(K),u.reason=a.cloneDeep(p);const W={keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:K},{propertyName:"reason",propertyValue:p},{propertyName:"updatedDate",propertyValue:X}]};let w;_e()?(await t.updateCheckBeforeTruckToLocalDB(W,e.value.key,p,F.reset),w=!1):w=await t.postCheckBeforeTruckItem(W,e.value.key,F.reset),w?(F.reset?v.value="true":v.value="false",b(),await r.postGenerateServiceSheet(g.user.EmployeeId,g.user.Name,g.user.SiteId),x.close()):(v.value=K,e.value.reason=p,t.setSkipWash(K),x.close(),F.reset?t.setReasonUpdated(!1):t.setReasonUpdated(!0))},H=i(()=>{var x,p;let F="";return!a.isUndefined(e.value.updatedDate)&&!a.isUndefined((x=e.value.updatedBy)==null?void 0:x.name)&&(F=`${(p=e.value.updatedBy)==null?void 0:p.name}, ${e.value.updatedDate}`),F});return be(v,(F,x)=>{(!F||F=="false")&&x&&(_?c(x):S())},{deep:!0}),be(P,(F,x)=>{!F&&x&&u&&(e.value.value=u.value,e.value.reason=u.reason,e.value.updatedBy=u.updatedBy,e.value.updatedDate=u.updatedDate,e.value.value&&e.value.value=="true"&&t.setSkipWash("true"))},{deep:!0}),be(H,(F,x)=>{F&&(u.updatedBy=a.cloneDeep(s.item.updatedBy),u.updatedDate=a.cloneDeep(s.item.updatedDate))},{deep:!0}),Ja(()=>{C(!1),u={}}),(F,x)=>(d(),h("div",_m,[l("div",wm,[l("div",Sm,[Nt(l("input",{class:"form-check-input",type:"checkbox",disabled:B.value,id:n.item.caption,"onUpdate:modelValue":x[0]||(x[0]=p=>v.value=p),onChange:k},null,40,Cm),[[Ya,v.value]]),l("label",{class:"form-check-label subtitle",for:n.item.caption},ue(n.item.caption),9,Rm)])]),(e.value.value=="true"||e.value.value)&&e.value.reason!=""?(d(),h(we,{key:0},[R(_a,{value:P.value||"","label-class":"dma--textarea-label reason_skip--label","text-class":"dma--textarea-input h-100px reason_skip--text--disabled",label:"Reason",name:"reason",disabled:!0},null,8,["value"]),l("div",Tm,ue(H.value),1)],64)):E("",!0),n.lastIndex?E("",!0):(d(),h("div",Um)),R(hm,{options:n.item.reasonList,visibility:o.value,onOnSave:m,onOnClose:b,onOnCancel:S},null,8,["options","visibility"])]))}}),$m=Ct(Im,[["__scopeId","data-v-ede7abc4"]]),Pm={key:0,class:"mt-5 ps-0"},Dm="WASH AND CHECKS BEFORE MACHINE ENTERS THE WORKSHOP:",Vm="WASH AND CHECK BEFORE MACHINE ENTERS THE WORKSHOP OR SHUTDOWN AREA:",Bm="WASH AND CHECK BEFORE MACHINE ENTERS THE SHUTDOWN AREA:",Am=Ue({__name:"CardCheckBeforeTruck",props:{data:{required:!0,type:Object},isAggrementChecked:{type:Boolean,default:!1}},setup(n){const s=n,e=rt(),o=f(""),t=i(()=>e.generalForm.checkBeforeTruck.items),r=i(()=>{let u="";return a.isUndefined(s.data.taskGroupName)?(u=Go(e.generalForm.modelId)?Vm:"",u||(u=qo(e.generalForm.modelId)?Bm:Dm),u):s.data.taskGroupName}),g=()=>{o.value=r.value};return Mt(()=>{g()}),be(()=>e.generalForm.modelId,()=>{g()}),(u,_)=>{const C=ce("el-collapse-item"),v=ce("el-collapse");return t.value.length>0?(d(),h("div",Pm,[R(v,{modelValue:o.value,"onUpdate:modelValue":_[0]||(_[0]=c=>o.value=c),class:"task-group general-accordion py-1 px-5 mb-3"},{default:ee(()=>[R(C,{title:r.value,name:r.value},{default:ee(()=>[(d(!0),h(we,null,tt(t.value,(c,k)=>(d(),h(we,{key:c.label},[c.itemType=="html"?(d(),re(cm,{key:0,item:c},null,8,["item"])):c.category!="skipOtherWash"?(d(),re(lm,{key:1,item:c,index:k,"is-aggrement-checked":n.isAggrementChecked},null,8,["item","index","is-aggrement-checked"])):c.category=="skipOtherWash"?(d(),re($m,{key:2,item:c,"last-index":k==t.value.length-1,"is-aggrement-checked":n.isAggrementChecked},null,8,["item","last-index","is-aggrement-checked"])):E("",!0)],64))),128))]),_:1},8,["title","name"])]),_:1},8,["modelValue"])])):E("",!0)}}}),Nm=Ct(Am,[["__scopeId","data-v-71a7c52b"]]),Cs=n=>(Yt("data-v-10effea1"),n=n(),zt(),n),xm=Cs(()=>l("span",{class:"el-dialog__title",style:{"word-break":"break-word !important","font-size":"18px !important"}},"Detailed picture of Pre-Task Risk Assessment Form",-1)),Om={class:"row d-flex flex-column"},Lm={key:0,class:"photo-wrapper"},Em=Cs(()=>l("span",{class:"sub-title"},[l("strong",null,"Front Page")],-1)),Fm={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center"}},Mm={class:"d-flex justify-content-center"},jm={style:{position:"relative",width:"fit-content"}},Hm=["src"],Km={class:"timestampp"},Gm=Cs(()=>l("div",{class:"my-2"},null,-1)),qm={key:1,class:"photo-wrapper"},Wm=Cs(()=>l("span",{class:"sub-title"},[l("strong",null,"Back Page")],-1)),Jm={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center",position:"relative"}},Ym={class:"d-flex justify-content-center"},zm={style:{position:"relative",width:"fit-content"}},Xm=["src"],Qm={class:"timestampp"},Zm=Ue({__name:"ImagePreviewPrerisk",props:{visibility:{type:Boolean,required:!1},images:{type:Array,required:!0},viewOnly:{type:Boolean,default:!0},workOrder:{type:String,default:""},employeeId:{type:String,default:""}},emits:["onClose","onDelete"],setup(n,{expose:s,emit:e}){const o=n,t=e,r=f([]),g=Me(o,"visibility"),u=f(0),_=f(!1),C=f(!1),v=Rl("(min-width: 1000px)"),c=f(!1),k=f(""),P=f(!1),B=f(),m=f(),b=f(),S=f([]);wa();const L=i(()=>v.value?"70%":"90%"),H=async()=>{m.value=o.images.find(T=>T.imageType=="front"),m.value||(m.value=o.images.find(T=>!T.imageType)),m.value&&await w(typeof m.value.image=="string"?m.value.image:m.value.image.filename)},F=async()=>{b.value=o.images.find(T=>T.imageType=="back"),!b.value&&o.images.length>0&&(b.value=o.images.find(T=>{var $;return T.image.filename!=(($=m.value)==null?void 0:$.image).filename})),b.value&&await D(typeof b.value.image=="string"?b.value.image:b.value.image.filename)},x=T=>`${T.updatedBy.name}, ${T.updatedDate}`,p=T=>{var ae;if(r.value.length<1)return;let $;do $=(ae=r.value.find(G=>G.key==T))==null?void 0:ae.value;while(!$);return $},K=()=>{g.value=!1,t("onClose",null)},X=()=>{if(!o.images)return;const T=o.images.map($=>$.image);S.value=yt(T).map($=>({imgBlob:$.filename,url:"",description:$.description}))},W=()=>{X(),u.value=0,r.value=[],o.images&&(H(),F())},w=async T=>{_.value=!0,await U(T),_.value=!1},D=async T=>{C.value=!0,await U(T),C.value=!1},U=async T=>{try{const $=window.URL||window.webkitURL;let ae="";if(_e())ae=await Fo(T);else{const G=await Lo(T);ae=$.createObjectURL(G),Eo(T,o.workOrder,G,"PreRisk","task",o.employeeId)}r.value.push({key:T,value:ae}),S.value.forEach(G=>{G.imgBlob==T&&(G.url=ae)})}catch($){console.log("image",$)}},I=T=>{const $=S.value.findIndex(G=>G.imgBlob==T),ae=S.value[$];if($>0){const G=S.value.slice($),Z=S.value.slice(0,$);S.value=[...G,...Z]}k.value=ae.url,c.value=!0},z=()=>{k.value="",c.value=!1},oe=T=>{P.value=!0,B.value=T},me=()=>{P.value=!1},M=()=>{B.value&&(t("onDelete",typeof B.value.image=="string"?B.value.image:B.value.image.filename),B.value.imageType=="front"?m.value=void 0:b.value=void 0,B.value=void 0,P.value=!1)};return s({openFirstReRender:()=>{W()}}),(T,$)=>{const ae=ce("el-skeleton-item"),G=ce("NwImg"),Z=ce("el-skeleton"),ie=ce("el-dialog");return d(),h(we,null,[R(ie,{modelValue:g.value,"onUpdate:modelValue":$[4]||($[4]=Ce=>g.value=Ce),title:"Detailed picture of Pre-Task Risk Assessment Form",width:L.value,onOpened:W,onClose:K},{title:ee(()=>[xm]),default:ee(()=>[l("div",Om,[m.value?(d(),h("div",Lm,[Em,R(Z,{loading:_.value,animated:""},{template:ee(()=>[R(ae,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:ee(()=>[l("div",Fm,[l("div",Mm,[l("div",jm,[n.viewOnly?E("",!0):(d(),re(G,{key:0,onClick:$[0]||($[0]=Ce=>oe(m.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),p(m.value.image.filename)!=null?(d(),h("img",{key:1,src:p(m.value.image.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",onClick:$[1]||($[1]=Ce=>I(m.value.image.filename)),class:"front"},null,8,Hm)):E("",!0)])]),l("div",Km,ue(x(m.value)),1)])]),_:1},8,["loading"])])):E("",!0),Gm,b.value?(d(),h("div",qm,[Wm,R(Z,{loading:C.value,animated:""},{template:ee(()=>[R(ae,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:ee(()=>[l("div",Jm,[l("div",Ym,[l("div",zm,[n.viewOnly?E("",!0):(d(),re(G,{key:0,onClick:$[2]||($[2]=Ce=>oe(b.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),p(b.value.image.filename)!=null?(d(),h("img",{key:1,src:p(b.value.image.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",class:"back",onClick:$[3]||($[3]=Ce=>I(b.value.image.filename))},null,8,Xm)):E("",!0)])]),l("div",Qm,ue(x(b.value)),1)])]),_:1},8,["loading"])])):E("",!0)])]),_:1},8,["modelValue","width"]),R(ca,{visibility:P.value,caption:"Are you sure want to delete this image?",onOnNoConfirm:me,onOnYesConfirm:M},null,8,["visibility"]),R(Vl,{images:S.value,visibility:c.value,"new-version":!0,image:k.value,onHandleClose:z},null,8,["images","visibility","image"])],64)}}}),ef=Ct(Zm,[["__scopeId","data-v-10effea1"]]),tf=n=>(Yt("data-v-6163749a"),n=n(),zt(),n),af={class:"mt-5 px-0"},sf={class:"row vcp mx-0 py-4 d-flex justify-content-between me-3 risk-assessment-title"},lf=tf(()=>l("div",{class:"col title ps-6"},[Ee("Take photo of completed Pre-Task Risk Assessment Form "),l("span",{class:"text-danger"},"(required)"),Ee(".")],-1)),of={class:"col-2 col-md-1"},rf={class:"row justify-content-center"},nf={class:"px-0 col-6"},uf=["disabled"],df=["src"],cf={key:0,class:"col-6 ps-0 pe-1"},mf={class:"text-white"},ff=Ue({__name:"CardRiskAssessment",props:{ready:{required:!0,type:Boolean}},emits:["onFrontPageTaken"],setup(n,{expose:s,emit:e}){const o=e,t=ya(),r=Da(),g=rt(),u=Jt(),_=f([]),C=f(0),v=f(),c=i(()=>g.employee);be(c,async I=>{C.value=0,r.IsFitterLoggedInExist?r.FitterInfo.employee.id==I.id?w.value=r.FitterInfo.riskPhotos:w.value=[]:w.value=[]},{deep:!0}),wa();const k=f(0),P=f(!1),B=f(!1),m=()=>{P.value=!0},b=i(()=>{let I=!1,z=!0;const oe=g.employee;!Us.isUndefined(oe.id)&&oe.id&&(I=!0),w.value.length>1&&(z=!1);let me=!r.generalUpdated;return I&&z&&me}),S=i(()=>{const I=g.employee,z=(I==null?void 0:I.id)!="";F();const oe=_.value.length>1;return z&&oe}),L=()=>{let I="/media/svg/dma/camera/e-form/png/cam-active.png";return S.value?I="/media/svg/dma/camera/e-form/png/cam-read.png":(_.value.length>0||r.IsSelectedFitterAlreadyLoggedIn)&&(I="/media/svg/dma/camera/e-form/png/cam-user.png"),I},H=i(()=>{let I=[];return g.employee.id?(F(),_.value):I}),F=()=>{if(C.value>0)return;let I=[];if(!Array.isArray(r.generalForm.riskAssesment[0].value))return I;const z=g.employee;I=kl(r.generalForm.riskAssesment[0].value).filter(M=>{const te=M;if(te.updatedBy.id==z.id)return te}),I=I.filter((M,te,T)=>te===T.findIndex($=>$.image.filename===M.image.filename&&$.imageType===M.imageType)),I.filter(M=>!M.imageType).length>0?I=a.orderBy(I,M=>M.updatedDate):I=a.orderBy(I,M=>M.imageType,["desc"]),_.value=I.slice(0,2),_.value.forEach(M=>{typeof M.image=="string"&&(M.image={filename:M.image,description:M.image.includes("^")?M.image.split("^")[1]:""})}),C.value=1},x=i(()=>Us.cloneDeep(t.ImageObjects.find(I=>I.Id==="pre-risk"))),p=i(()=>{var I;return(I=x.value)==null?void 0:I.ImageInfos.length}),K=i(()=>g.generalForm.riskAssesment[0].key);be(p,()=>{k.value+=1});const X=()=>{P.value=!1},W=async I=>{let z=r.generalForm.riskAssesment[0].value;z=z.filter(oe=>typeof oe.image=="string"?oe.image!=I:oe.image.filename!=I),await g.updateRiskAssesment(z),U()};be(x,async(I,z)=>{var oe;C.value=0,!Us.isUndefined(I)&&I.ImageInfos.length>0&&(r.addPropertyParam(K.value,"value",JSON.stringify((oe=x.value)==null?void 0:oe.ImageInfos)),I.ImageInfos.length!=(z==null?void 0:z.ImageInfos.length)&&await D())},{deep:!0});const w=f([]),D=async()=>{r.toggleChangeIsRiskAssesmentPhotoTaken(!0);let I;_e()?I=Ft():I=await r.getServerTimestamp();const z=g.employee;let oe={};x.value&&(oe=yt(x.value.ImageInfos)[0]);const me=r.generalForm.riskAssesment[0].value;let M=[];if(Array.isArray(me)){let ae=kl(me);[...new Set(ae.map(Z=>Z.updatedBy.id))].forEach(Z=>{let ie=ae.filter(st=>st.updatedBy.id==Z),Ce=ie.filter(st=>st.imageType).slice(0,2);Ce.length<2&&(Ce=a.orderBy(ie,st=>st.updatedDate).slice(0,1),Ce[0].imageType=Ce[0].imageType==""?"front":Ce[0].imageType),M=[...M,...Ce]})}let te=M.filter(ae=>ae.updatedBy.id==z.id).slice(0,1),T="front";te.length>0&&(T=te[0].imageType=="front"?"back":T);const $={image:oe,imageType:T,updatedDate:I,updatedBy:z};M.push($),te=M.filter(ae=>ae.updatedBy.id==z.id),te.length<2?o("onFrontPageTaken"):(B.value=!0,setTimeout(()=>{var ae;B.value=!1,(ae=v.value)==null||ae.openFirstReRender()},2e3)),t.setCurrent("pre-risk"),t.clearCurrent(),await g.updateRiskAssesment(M),r.setFitterInfoRiskPhotos(oe),T=="back"&&r.setGeneralFitterInfoToIndexedDB(!0)},U=()=>{t.toggleIsVisible(!0,"pre-risk"),t.addLocalImageInfo({taskKey:r.generalForm.riskAssesment[0].key,workOrder:r.generalForm.workOrder,type:"pre-risk",updatedBy:g.employee.id,email:u.user.Email})};return s({triggerCamera:U}),(I,z)=>{var oe;return d(),h(we,null,[l("div",af,[l("div",sf,[lf,l("div",of,[l("div",rf,[l("div",nf,[l("button",{class:"btn btn-sm btn-icon btn-bg-light",disabled:!b.value,style:{cursor:"default"}},[l("img",{src:L(),style:{height:"12px",width:"14px"},alt:"camera"},null,8,df)],8,uf)]),H.value&&H.value.length>0?(d(),h("div",cf,[l("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:m,style:{"background-color":"#18AF4A"}},[l("label",mf,"+"+ue(H.value.length),1)])])):E("",!0)])])])]),P.value?(d(),re(ef,{key:0,workOrder:J(r).stateGeneralForm.workOrder,taskId:J(r).generalForm.riskAssesment[0].key,employeeId:(oe=c.value)==null?void 0:oe.id,ref_key:"preview",ref:v,images:_.value,visibility:P.value,"view-only":!1,onOnDelete:W,onOnClose:X},null,8,["workOrder","taskId","employeeId","images","visibility"])):E("",!0),R(Ol,{visibility:B.value,caption:"Pre-Task Risk Assessment Photo Sucessfully Taken"},null,8,["visibility"])],64)}}}),vf=Ct(ff,[["__scopeId","data-v-6163749a"]]),Js=n=>(Yt("data-v-7655cd8f"),n=n(),zt(),n),pf={class:"el-dialog__title"},yf={key:0,class:"status-badge-dialog-header approved-badge p-1"},gf={key:1,class:"status-badge-dialog-header declined-badge p-1"},bf=["innerHTML"],kf={class:"mt-1 p-2"},hf={class:"d-flex flex-column"},_f=Js(()=>l("h4",{class:"title ps-3"},"Reason",-1)),wf={key:0,class:"mt-1 p-2"},Sf={key:1,class:"mt-1 py-2"},Cf={class:"row mb-1"},Rf={class:"col"},Tf=Js(()=>l("div",{class:"form-floating approved-text-box"},[l("div",{class:"form-control",style:{"white-space":"break-spaces"}},"This information has been approved"),l("label",null,"Confirmed")],-1)),Uf={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},If={key:2,class:"mt-1 py-2"},$f={class:"row mb-1"},Pf={class:"col"},Df={class:"form-floating declined-text-box"},Vf={class:"form-control",style:{"white-space":"break-spaces"}},Bf=Js(()=>l("label",null,"Declined",-1)),Af={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},Nf=Ue({__name:"ViewOnlyNAForm",props:{visibility:{required:!0,type:Boolean}},emits:["close"],setup(n,{emit:s}){const e=n,o=s,t=As(),r=za(),g=ts(),u=is(),_=Me(e,"visibility"),C=f(null),v=i(()=>t.Details),c=i(()=>r.ApprovalDefect),k=()=>{us(C.value)},P=i(()=>{var b;return(b=v.value)==null?void 0:b.reason.split(":")[0]}),B=i(()=>{var b;return(b=v.value)==null?void 0:b.reason.split(":")[0].includes("Other")}),m=async()=>{_.value&&(console.log("terpanggil na close"),o("close"),t.resetInstance(),g.resetInstance())};return(b,S)=>{const L=ce("el-option"),H=ce("el-select"),F=ce("el-dialog");return d(),re(F,{modelValue:_.value,"onUpdate:modelValue":S[1]||(S[1]=x=>_.value=x),width:"90%",center:"",onOpened:k,onClose:m,"destroy-on-close":!0,"custom-class":"el-defect-crack-form-custom"},{title:ee(()=>[l("span",pf,[Ee("Not Applicable "),c.value&&c.value.cbmNAStatus=="Confirmed"?(d(),h("span",yf,"Confirmed")):c.value&&c.value.cbmNAStatus=="Decline"?(d(),h("span",gf,"Declined")):E("",!0)]),l("span",{class:"el-dialog__title task-title",innerHTML:J(Qa)(v.value.title),ref_key:"defectDetailRef",ref:C},null,8,bf)]),default:ee(()=>[l("div",kf,[l("div",hf,[_f,R(H,{modelValue:P.value,"onUpdate:modelValue":S[0]||(S[0]=x=>P.value=x),disabled:!0,class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(J(u).NAConditions,x=>(d(),re(L,{key:x.id,label:x.naCondition,value:x.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),B.value?(d(),h("div",wf,[R(_a,{value:J(Yo)(v.value.reason),label:"Why not applicable item task?",name:"Reason",disabled:!0},null,8,["value"])])):E("",!0),c.value&&c.value.cbmNAStatus=="Confirmed"?(d(),h("div",Sf,[l("div",Cf,[l("div",Rf,[Tf,c.value.approvedBy&&c.value.approvedDate?(d(),h("div",Uf,ue(c.value.approvedBy.name)+", "+ue(c.value.approvedDate),1)):E("",!0)])])])):c.value&&c.value.cbmNAStatus=="Decline"&&c.value.declineReason?(d(),h("div",If,[l("div",$f,[l("div",Pf,[l("div",Df,[l("div",Vf,ue(c.value.declineReason),1),Bf]),c.value.declineBy&&c.value.declineDate?(d(),h("div",Af,ue(c.value.declineBy.name)+", "+ue(c.value.declineDate),1)):E("",!0)])])])):E("",!0)]),_:1},8,["modelValue"])}}}),xf=Ct(Nf,[["__scopeId","data-v-7655cd8f"]]),Zl=n=>(Yt("data-v-8d26a89b"),n=n(),zt(),n),Of=Zl(()=>l("span",{class:"el-dialog__title"},"Not Applicable",-1)),Lf=["innerHTML"],Ef={class:"mt-1 p-2"},Ff={class:"d-flex flex-column"},Mf=Zl(()=>l("label",null,"Why could you not complete the required service item?",-1)),jf={key:0,class:"px-1 text-danger"},Hf={key:0,class:"mt-1 p-2"},Kf={class:"my-5 w-100"},Gf=["disabled"],qf=Ue({__name:"NAForm",props:{visibility:{required:!0,type:Boolean}},setup(n){const s=n,e=ts(),o=Jt(),t=rt(),r=is(),g=ya(),u=Me(s,"visibility"),_=f(!1),C=f(!1),v=f(!1),c=f(!0),k=f(!1),P=f(""),B=f(""),m=f(!1),b=f(!0),S=f(!1),L=f(null),H=i(()=>t.taskUpdated),F=i(()=>t.formAlreadySubmitted),x=i(()=>$l(e.stateTask));be(F,me=>{me&&(e.toggleIsVisible(!1),t.resetTaskUpdated(),_.value=!1,c.value=!1,k.value=!1,k.value=!1,e.setCancelledState(!0))});const p=i(()=>t.taskAlreadyUpdated);be(p,me=>{me&&(e.toggleIsVisible(!1),t.resetTaskUpdated(),_.value=!1,c.value=!1,k.value=!1,k.value=!1,e.setCancelledState(!0))}),be(H,me=>{e.Visible==!0&&(me===!1&&(k.value=!0),me===!0&&(t.stateItemKey||(_.value=!0),_.value&&setTimeout(()=>{I()},2e3)))});const K=()=>{P.value&&(S.value=!1),m.value=P.value.includes("Other"),m.value?(B.value="",b.value=!0):b.value=!1,e.setReason(P.value)},X=me=>{B.value=me.value,b.value=B.value===""},W=async()=>{let me={},M={},te={};e.stateItem.categoryItemType=="resultStatus"&&(M={keyValue:e.stateTask.key,propertyParams:[{propertyName:"taskNormalValue",propertyValue:e.stateTask.category==="NORMAL"||e.stateTask.category==="CBM"?"3":"4"}]},e.stateTask.items.forEach(ae=>{ae.categoryItemType=="resultRating"&&(me={keyValue:ae.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]}),ae.itemType=="smallCamera"&&(te={keyValue:ae.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]})}));const T=[];e.stateItem.categoryItemType=="resultStatus"&&(T.push(me),T.push(M),T.push(te),g.clearImageById(te.keyValue)),t.setStateItemKey(""),T.length>0?_e()?await t.updateServiceSheetTaskOnLocalDB(T,e.stateTask.key,`reset-${e.stateTask.key}`,!1,e.stateTask.key):await t.updateServiceSheetTaskValue(T,o.user.EmployeeId,o.user.Name):(t.resetTaskUpdated(),setTimeout(()=>{t.setTaskUpdated()},50),_e()||(t.getTaskProgress(),t.updateGroupByParam(t.stateSelectedGroup.groupName))),t.stateStoredDisableKeyValue.filter(ae=>ae.key==e.ItemKey).length<1?t.pushStoredDisabledItems({key:e.ItemKey,value:e.stateTask.category==="NORMAL"||e.stateTask.category==="CBM"?"3":"4"}):t.updateAllItems(e.ItemKey,e.stateTask.category==="NORMAL"||e.stateTask.category==="CBM"?"3":"4")},w=()=>{P.value?v.value=!0:S.value=!0},D=async()=>{v.value=!1,e.Reason.includes("Other")&&e.setReason(`${e.Reason}:${B.value}`);const me=Xe.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"}),M=e.stateTask.taskValue=="2",te=e.stateTask.taskValue=="C"||e.stateTask.taskValue=="X";(M||te)&&await vo(t.stateGeneralForm.workOrder,e.stateTask.key,"false");let T;_e()?T=await e.updateNAToLocalDB():T=await e.createNA(),T?await W():t.taskErrorDialog&&I(),me.close()},U=()=>{v.value=!1},I=()=>{e.toggleIsVisible(!1),t.resetTaskUpdated(),_.value=!1,c.value=!1,k.value=!1},z=async()=>{c.value===!0?(e.setCancelledState(!0),e.setSuccesItem("")):e.setSuccesItem(e.stateItemKey),P.value="",B.value="",m.value=!1,S.value=!1,_.value=!1,C.value=!1,e.resetInstance()},oe=()=>{c.value=!0,us(L.value)};return(me,M)=>{const te=ce("el-option"),T=ce("el-select"),$=ce("el-dialog");return d(),re($,{modelValue:u.value,"onUpdate:modelValue":M[1]||(M[1]=ae=>u.value=ae),width:"90%",center:"","lock-scroll":!1,onClosed:z,onOpened:oe,"custom-class":"el-defect-crack-form-custom","destroy-on-close":!0},{title:ee(()=>[Of,l("span",{class:"el-dialog__title task-title",innerHTML:J(Qa)(x.value),ref_key:"defectDetailRef",ref:L},null,8,Lf)]),default:ee(()=>[l("div",null,[l("div",Ef,[l("div",Ff,[Mf,R(T,{modelValue:P.value,"onUpdate:modelValue":M[0]||(M[0]=ae=>P.value=ae),filterable:"",onChange:K,class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(J(r).NAConditions,ae=>(d(),re(te,{key:ae.id,label:ae.naCondition,value:ae.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),S.value?(d(),h("label",jf,"Required")):E("",!0)])]),m.value?(d(),h("div",Hf,[R(_a,{value:B.value,label:"Description",name:"Description",onHandleChange:X},null,8,["value"])])):E("",!0),l("div",Kf,[l("button",{class:"btn btn-success w-100",onClick:w,disabled:b.value,style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},"Submit",8,Gf)])]),R(ca,{visibility:v.value,caption:"Please confirm this is the reason you could not do the service item.",onOnNoConfirm:U,onOnYesConfirm:D},null,8,["visibility"]),R(lr,{show:_.value},null,8,["show"])]),_:1},8,["modelValue"])}}}),Wf=Ct(qf,[["__scopeId","data-v-8d26a89b"]]),nt=n=>(Yt("data-v-642461fe"),n=n(),zt(),n),Jf={class:"d-flex justify-content-between"},Yf=nt(()=>l("span",{class:"el-dialog__title"},"Crack Repair Request",-1)),zf=["innerHTML"],Xf={class:"d-flex",style:{"margin-right":"3rem"}},Qf={class:"d-flex flex-row justify-content-between"},Zf={class:"py-2 d-flex flex-row flex-grow-1"},ev={class:"flex-fill"},tv={class:"form-floating"},av=["innerHTML"],sv=nt(()=>l("label",{for:"floatingInput"},"Asset Number",-1)),lv={class:"flex-fill ps-3"},ov={class:"form-floating"},rv=["innerHTML"],nv=nt(()=>l("label",{for:"floatingInput"},"Serial Number",-1)),iv={class:"flex-fill ps-3"},uv={class:"form-floating"},dv=["innerHTML"],cv=nt(()=>l("label",{for:"floatingInput"},"Ownership",-1)),mv={class:"d-flex flex-row justify-content-between"},fv={class:"d-flex justify-content-center reference-photo"},vv={class:"mt-1 py-2"},pv={class:"mt-1 py-2"},yv={class:"row"},gv={class:"col pe-0"},bv={class:"form-floating"},kv=["value"],hv=nt(()=>l("label",null,"Raised By",-1)),_v={class:"mt-1 py-2"},wv={class:"row"},Sv={class:"col-4 pe-0 date"},Cv={class:"form-floating"},Rv=["value"],Tv=nt(()=>l("label",null,"Date Raised",-1)),Uv={class:"col pe-0 d-flex"},Iv={class:"d-flex flex-column flex-fill"},$v={class:"form-floating"},Pv=nt(()=>l("label",{class:"text-nowrap"},"How long will this crack repair take?",-1)),Dv={key:0,class:"mt-2"},Vv={class:"ms-2 d-flex align-items-center"},Bv={class:"mt-1 py-2"},Av={class:"mt-1 px-3 previous-crack-container word-breaker"},Nv=nt(()=>l("div",{class:"row justify-content-center table-header-background-color p-1"}," Crack Length ",-1)),xv=nt(()=>l("div",{class:"row table-header-background-color p-1"},[l("div",{class:"col"},"Location"),l("div",{class:"col-3"},"Previous"),l("div",{class:"col-3"},"Current"),l("div",{class:"col-1"})],-1)),Ov={class:"col"},Lv={class:"col-3"},Ev={class:"col-3"},Fv=["value","onInput"],Mv={key:0,class:"mt-2"},jv=nt(()=>l("div",{class:"col-1"}," mm",-1)),Hv=nt(()=>l("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[l("div",{class:"col-3"},"Priority"),l("div",{class:"col-6"},"Action"),l("div",{class:"col-3 text-break"},"Person Responsible")],-1)),Kv={class:"row p-3 m-1 priority-container"},Gv={class:"col-3"},qv={class:"form-check"},Wv=nt(()=>l("label",{class:"form-check-label"}," (P1) Immediate ",-1)),Jv=nt(()=>l("div",{class:"col-6 word-breaker"},"Shall shut machine down and udertake repairs.",-1)),Yv=nt(()=>l("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),zv={class:"row p-3 m-1 priority-container"},Xv={class:"col-3"},Qv={class:"form-check"},Zv=nt(()=>l("label",{class:"form-check-label"}," (P2) Urgent ",-1)),ep=nt(()=>l("div",{class:"col-6 word-breaker"},"Shall complete within 7 days.",-1)),tp=nt(()=>l("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),ap={class:"row p-3 m-1 priority-container"},sp={class:"col-3"},lp={class:"form-check"},op=nt(()=>l("label",{class:"form-check-label"}," (P3) Routine ",-1)),rp=nt(()=>l("div",{class:"col-6 word-breaker"},"Shall complete within 60 days.",-1)),np=nt(()=>l("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),ip={class:"row p-3 m-1 priority-container"},up={class:"col-3"},dp={class:"form-check"},cp=nt(()=>l("label",{class:"form-check-label"}," (P4) Monitor ",-1)),mp=nt(()=>l("div",{class:"col-6 word-breaker"},"Shall continue to inspect and monitor for 90 days.",-1)),fp=nt(()=>l("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),vp=nt(()=>l("div",{class:"mt-2"},null,-1)),pp=nt(()=>l("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[l("div",{class:"col-3"},"Part Number"),l("div",{class:"col-5"},"Part Description"),l("div",{class:"col-1"},"Qty"),l("div",{class:"col"}),l("div",{class:"col"})],-1)),yp={class:"col-3 px-0"},gp={class:"d-flex flex-column"},bp=["value","onChange"],kp={key:0,class:"mt-2"},hp={class:"col-5"},_p={class:"d-flex flex-column"},wp=["value","onChange"],Sp={key:0,class:"mt-2"},Cp={class:"col-1 px-1 d-flex flex-column justify-content-start"},Rp={class:"row p-0 m-0 h-50 w-100"},Tp={class:"p-0 col-12 d-flex"},Up=["onUpdate:modelValue","onInput","onFocusout"],Ip={key:0,class:"mt-2 flex-fill"},$p={class:"col px-1 d-flex flex-column justify-content-start"},Pp={class:"row p-0 m-0 h-100 w-100 align-items-center"},Dp={class:"col px-1 d-flex flex-column justify-content-start position-relative"},Vp={class:"row p-0 m-0 h-100 w-100 align-items-center"},Bp={class:"position-absolute",style:{top:"10px",right:"0px"}},Ap=["onClick"],Np={class:"d-flex justify-content-between align-items-center flex-row-reverse"},xp={class:"fw-bolder"},Op=["href"],Lp=nt(()=>l("img",{src:ur},null,-1)),Ep=nt(()=>l("em",{class:"fa fa-plus me-2"},null,-1)),Fp=nt(()=>l("div",{class:"mt-2"},null,-1)),Mp=nt(()=>l("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[l("div",{class:"col-6"},"Labour Activity"),l("div",{class:"col-2"},"Qty"),l("div",{class:"col-2 word-breaker"},"Hours Each"),l("div",{class:"col-2 word-breaker"},"Total Hours")],-1)),jp={class:"col-6 px-0"},Hp={class:"d-flex flex-column"},Kp={key:0,class:"mt-2"},Gp={class:"col-2 d-flex justify-content-start"},qp={class:"d-flex flex-column"},Wp=["onUpdate:modelValue","onInput","onFocusout"],Jp={key:0,class:"mt-2"},Yp={class:"col-2 d-flex justify-content-start"},zp={class:"d-flex flex-column"},Xp=["onUpdate:modelValue","onInput","onFocusout"],Qp={key:0,class:"mt-2"},Zp={class:"col-2 d-flex flex-column justify-content-start"},ey={class:"row p-0 m-0 h-50 w-100"},ty={class:"p-0 col-12 d-flex"},ay=["value"],sy=["onClick"],ly={key:0,class:"mt-2 flex-fill"},oy=nt(()=>l("em",{class:"fa fa-plus me-2"},null,-1)),ry=nt(()=>l("div",{class:"mt-2"},null,-1)),ny={class:"d-flex flex-fill flex-column"},iy={class:"d-flex flex-row"},uy=["value","placeholder","onChange"],dy=["onClick"],cy={key:0,class:"mt-2"},my=nt(()=>l("em",{class:"fa fa-plus me-2"},null,-1)),fy=nt(()=>l("div",{class:"mt-2"},null,-1)),vy={class:"d-flex flex-row"},py={class:"d-flex flex-fill flex-column"},yy={key:0,class:"mt-2"},gy=["onClick"],by={key:0,class:"mt-2"},ky=nt(()=>l("em",{class:"fa fa-plus me-2"},null,-1)),hy=nt(()=>l("div",{class:"mt-2"},null,-1)),_y={class:"d-flex flex-row"},wy={class:"d-flex flex-fill flex-column"},Sy={key:0,class:"mt-2"},Cy=["onClick"],Ry={key:0,class:"mt-2"},Ty=nt(()=>l("em",{class:"fa fa-plus me-2"},null,-1)),Uy=Ue({__name:"CrackYesForm",props:{visibility:{required:!0,type:Boolean},assetNumber:{required:!0,type:String},predefinedPriority:{required:!0,type:String,default:"P1"},workorder:{required:!1,type:String,default:""},crackData:{required:!0,type:Object}},setup(n){const s=n,e=ya(),o=Os(),t=rt(),r=dr(),g=is(),u=f(!1),_=Ks(),C=ja(),v=f(""),c=f("Priority"),k=f("Parts Required"),P=f("Labour"),B=f("Other Resources Required (optional)"),m=f("Defect Symptom"),b=f("Defect Cause"),S=f(!1),L=f(!1),H=f(!0),F=f(!1),x=Me(s,"visibility"),p=Me(s,"crackData"),K=f(""),X=f([""]),W=f([""]),w=f([""]),D=f([""]),U=f([!0]),I=f([""]),z=f([!0]),oe=f(!1),me=f(ys()),M=f(!1),te=f(),T=i(()=>s.crackData.DefectRequirement!="Less than 30 minutes labour and less than $250 in parts"&&p.value.Parts.length==0),$=i(()=>a.isUndefined(o.images)?[]:o.images.ImageInfos),ae=i(()=>({images:$.value,description:s.crackData.Description.value,priority:s.crackData.Priority,instruction:s.crackData.Instruction.value,plannedDuration:s.crackData.PlannedDuration.value,parts:s.crackData.Parts,labours:s.crackData.Labours,resources:s.crackData.Resources,symptoms:s.crackData.Symptoms,causes:s.crackData.Causes,crackLength:s.crackData.CrackLength}));let G=[];const Z=f(""),ie=i({get:()=>{let O=Z.value;return O=Z.value,O},set:O=>{Z.value=O}}),Ce=i(()=>o.SerialNumber),st=i(()=>{const O=o.Ownership;return js(O)}),Ke=O=>O===""?O:Pa(da(O)),$t=()=>{ke.value?oe.value=!0:o.toggleYesVisible(!1)},kt=()=>{oe.value=!1},V=()=>{if(oe.value=!1,o.toggleYesVisible(!1),G.length==0)return;const O=na.pendingTaskFile.where("filename").anyOf(G);O&&O.delete()},q=i(()=>o.stateCrackInfo.CrackLength),fe=i(()=>t.taskUpdated),Re=i(()=>"Crack Identified Description"),Ne=i(()=>"Crack Repair Instructions / Actions"),Ae=i(()=>t.formAlreadySubmitted),ut=i(()=>$l(o.stateTask));i(()=>s.crackData.DefectRequirement!="Less than 30 minutes labour and less than $250 in parts");const mt=i(()=>{const O="Boilermaker";return r.positionOption&&r.positionOption.find(Y=>Y.label==O)?O:""});be(Ae,O=>{O&&(o.toggleYesVisible(!1),t.resetTaskUpdated(),S.value=!1,H.value=!1,F.value=!1,o.setCancelledState(!0),e.clearCurrent())});const ct=i(()=>t.taskAlreadyUpdated);be(ct,O=>{O&&(o.toggleYesVisible(!1),t.resetTaskUpdated(),S.value=!1,H.value=!1,F.value=!1,o.setCancelledState(!0),e.clearCurrent())}),be(fe,O=>{o.CrackYesVisible&&(O===!1&&(F.value=!0),O===!0&&(t.stateItemKey||(S.value=!0)))});const se=["images","description","defectPriority","instruction","plannedDuration","parts","labours","resources","symptoms","causes","crackLength"],ke=i(()=>Wo(se,te.value,ae.value)),De=()=>{const O=Da();return`${ls(O.stateTimeZone)} (${O.stateTimeZoneDesc})`},He=O=>{let Y=O.keyCode?O.keyCode:O.which;(Y<48||Y>57)&&Y!=46&&O.preventDefault()},at=(O,Y)=>{O.preventDefault(),O.target.value=Ga(O.target.value),isNaN(Number(O.target.value))&&(p.value.setCurrentCrack(Y,O.target.value),p.value.validateCurrentCrack(p.value.CrackLength[Y])),p.value.setCurrentCrack(Y,O.target.value),p.value.validateCurrentCrack(p.value.CrackLength[Y])},gt=O=>{p.value.setDescription(O.value),p.value.validateDescription()},ft=O=>{O.preventDefault(),O.target.value=Ga(O.target.value),isNaN(Number(O.target.value))&&(p.value.setPlannedDuration(O.target.value),p.value.validatePlannedDuration()),p.value.setPlannedDuration(O.target.value),p.value.validatePlannedDuration()},dt=O=>{p.value.setInstruction(O.value),p.value.validateInstruction()},St=(O,Y)=>{O.preventDefault(),p.value.setPartNumber(Y,O.target.value)},it=(O,Y)=>{O.preventDefault(),p.value.setPartDescription(Y,O.target.value),p.value.validatePartDescription(p.value.Parts[Y])},Le=(O,Y)=>{O.preventDefault(),O.target.value=Ga(O.target.value),isNaN(Number(O.target.value))&&(p.value.setPartQty(Y,O.target.value),p.value.validatePartQty(p.value.Parts[Y])),p.value.setPartQty(Y,O.target.value),p.value.validatePartQty(p.value.Parts[Y])},xt=O=>{const{value:Y,index:Be}=O;p.value.setPartImage(Be,Y),G.push(a.last(Y).filename)},Ht=O=>{const{value:Y,index:Be}=O;p.value.setPartAttachment(Be,Y),G.push(a.last(Y).url)},Ge=()=>{if(p.value.Parts.every(Y=>Y.partDescription!==""&&Y.qty!==void 0)){for(const Y in p.value.Parts)if(Object.prototype.hasOwnProperty.call(p.value.Parts,Y)){const Be=p.value.Parts[Y];if(!Be.partNumberValidation.isValid||!Be.descriptionValidation.isValid||!Be.qtyValidation.isValid)return}}else{p.value.validateParts();return}p.value.addPart({partNumber:"",partDescription:"",qty:""})},Rt=O=>{p.value.removeParts(O)},pt=O=>{p.value.setLabourActivity(O,X.value[O]),p.value.validateLaboursActivity(p.value.Labours[O])},Ot=(O,Y)=>{O.preventDefault(),O.target.value=Ga(O.target.value),isNaN(Number(O.target.value))&&(p.value.setLabourQty(Y,O.target.value),p.value.validateLaboursQty(p.value.Labours[Y]),p.value.Labours[Y].position||pt(Y),Kt(Y)),p.value.setLabourQty(Y,O.target.value),p.value.validateLaboursQty(p.value.Labours[Y]),p.value.Labours[Y].position||pt(Y),Kt(Y)},Xt=(O,Y)=>{O.preventDefault(),O.target.value=Ga(O.target.value),isNaN(Number(O.target.value))&&(p.value.setLabourHireEach(Y,O.target.value),p.value.validateLaboursHireEach(p.value.Labours[Y]),p.value.Labours[Y].position||pt(Y),Kt(Y)),p.value.setLabourHireEach(Y,O.target.value),p.value.validateLaboursHireEach(p.value.Labours[Y]),p.value.Labours[Y].position||pt(Y),Kt(Y)},Kt=O=>{if(!p.value.Labours[O].qty||!p.value.Labours[O].hireEach)return;p.value.Labours[O].totalHoursValidation.message="",p.value.Labours[O].totalHoursValidation.isValid=!0;const Y=+p.value.Labours[O].qty,Be=+p.value.Labours[O].hireEach;let Ut=Y*Be;Number.isInteger(Ut)||(Ut=Number((Math.round(Ut*100)/100).toFixed(2))),p.value.setLabourTotalHours(O,Ut.toString())},Tt=()=>{if(p.value.Labours.every(Y=>Y.position!==""&&Y.qty!==""&&Y.hireEach!==""&&Y.totalHours!=="")){for(const Y in p.value.Labours)if(Object.prototype.hasOwnProperty.call(p.value.Labours,Y)){const Be=p.value.Labours[Y];if(!Be.positionValidation.isValid||!Be.qtyValidation.isValid||!Be.hireEachValidation.isValid)return}p.value.validateLabours()&&(p.value.addLabour({position:"",qty:"",hireEach:"",totalHours:""}),X.value.push(mt.value),pt(p.value.Labours.length-1))}else{p.value.validateLabours();return}},vt=O=>{X.value.splice(O,1),p.value.removeLabours(O)},Gt=(O,Y)=>{O.preventDefault(),p.value.setResources(Y,O.target.value),!(Y==0&&p.value.Resources[Y].value=="")&&p.value.validateResource(p.value.Resources[Y])},ea=()=>{if(!p.value.Resources.every(Y=>Y.value!=="")){p.value.validateResourcesAdd();return}p.value.addResource("")},Ia=O=>{p.value.removeResource(O),p.value.validateResourcesRemove()},ga=O=>{I.value[O]="",z.value[O]=!0,p.value.setCauses(O,w.value[O]),p.value.validateCause(p.value.Causes[O])},Ba=O=>{I.value[O.index]=O.value,z.value[O.index]=I.value[O.index]!=""},Aa=()=>{L.value=!1,M.value=!0,zo("form-crack-yes-eform  ","parts-collapse")},Sa=()=>{for(const Be in p.value.Causes)if(Object.prototype.hasOwnProperty.call(p.value.Causes,Be)&&!p.value.Causes[Be].isValid)return;if(!p.value.Causes.every(Be=>Be.value!=="")){p.value.validateCauses();return}const Y=w.value.length-1;if(w.value[Y]==="Other")if(I.value[Y])z.value[Y]=!0;else{z.value[Y]=!1;return}p.value.addCauses(""),w.value.push(""),I.value.push(""),z.value.push(!0)},ta=O=>{w.value.splice(O,1),I.value.splice(O,1),z.value.splice(O,1),p.value.removeCauses(O)},Na=O=>{D.value[O]="",U.value[O]=!0,p.value.setSymptom(O,W.value[O]),p.value.validateSymptom(p.value.Symptoms[O])},xa=O=>{D.value[O.index]=O.value,U.value[O.index]=D.value[O.index]!=""},Ca=()=>{for(const Be in p.value.Symptoms)if(Object.prototype.hasOwnProperty.call(p.value.Symptoms,Be)&&!p.value.Symptoms[Be].isValid)return;if(!p.value.Symptoms.every(Be=>Be.value!=="")){p.value.validateSymptoms();return}const Y=W.value.length-1;if(W.value[Y]==="Other")if(D.value[Y])U.value[Y]=!0;else{U.value[Y]=!1;return}p.value.addSymptom(""),W.value.push(""),D.value.push(""),U.value.push(!0)},Ra=O=>{W.value.splice(O,1),D.value.splice(O,1),U.value.splice(O,1),p.value.removeSymptom(O)},A=async()=>{t.setStateItemKey(""),t.resetTaskUpdated(),setTimeout(()=>{t.setTaskUpdated()},50),_e()||(t.getTaskProgress(),t.updateGroupByParam(t.stateSelectedGroup.groupName)),t.updateAllItems(o.ItemKey,"3")},Q=()=>{for(const Y in p.value.Symptoms)if(Object.prototype.hasOwnProperty.call(p.value.Symptoms,Y)&&!p.value.Symptoms[Y].isValid)return!1;const O=W.value.length-1;return W.value[O]==="Other"&&(D.value[O]?U.value[O]=!0:U.value[O]=!1),U.value[O]},le=()=>{for(const Y in p.value.Causes)if(Object.prototype.hasOwnProperty.call(p.value.Causes,Y)&&!p.value.Causes[Y].isValid)return!1;const O=w.value.length-1;return w.value[O]==="Other"&&(I.value[O]?z.value[O]=!0:z.value[O]=!1),z.value[O]},ge=async()=>{var Y;p.value.validateDefectForm();const O=a.isUndefined(o.images)||o.images.ImageInfos.length<1;O&&(u.value=!0,Ns()),(Y=p.value)!=null&&Y.IsValid&&Q()&&le()&&!O?L.value=!0:(Pt(),Ns())},Pe=()=>{p.value.Symptoms.forEach((O,Y)=>{O.value=O.value==="Other"?`Other:${D.value[Y]}`:O.value})},Ie=()=>{p.value.Causes.forEach((O,Y)=>{O.value=O.value==="Other"?`Other:${I.value[Y]}`:O.value})},Fe=async O=>{L.value=!1;const Y=Xe.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});p.value.setAssetNumber(s.assetNumber),p.value.setPriority(K.value),p.value.setIsComplete(O.isComplete),Pe(),Ie();let Be;_e()?Be=await o.updateDefectToLocalDB():Be=await o.createCrack(),Be?await A():t.taskErrorDialog&&qe(),_e()||C.getDefectsDataAll(s.workorder),Y.close()},Qe=()=>{L.value=!1},qe=()=>{K.value="",X.value=[mt.value],W.value=[""],w.value=[""],D.value=[""],U.value=[!0],I.value=[""],z.value=[!0],o.toggleYesVisible(!1),t.resetTaskUpdated(),S.value=!1,H.value=!1,F.value=!1},Ze=async()=>{H.value===!0&&o.setCancelledState(!0),X.value=[mt.value],W.value=[""],w.value=[""],D.value=[""],U.value=[!0],I.value=[""],z.value=[!0],Z.value="",u.value=!1,o.resetInstance(),e.clearCurrent(),e.setShowCloseButton(!1),M.value=!1,e.reset()},Ve=f(null),ze=()=>{G=[],e.setShowCloseButton(!0),K.value=s.predefinedPriority,v.value=o.referencePhoto.title,Pl(me.value),H.value=!0,X.value=[mt.value],te.value={images:a.cloneDeep($.value),description:a.cloneDeep(s.crackData.Description.value),priority:a.cloneDeep(s.crackData.Priority),instruction:a.cloneDeep(s.crackData.Instruction.value),plannedDuration:a.cloneDeep(s.crackData.PlannedDuration.value),parts:a.cloneDeep(s.crackData.Parts),labours:a.cloneDeep(s.crackData.Labours),resources:a.cloneDeep(s.crackData.Resources),symptoms:a.cloneDeep(s.crackData.Symptoms),causes:a.cloneDeep(s.crackData.Causes),crackLength:a.cloneDeep(s.crackData.CrackLength)},te.value.labours[0].position=mt.value,us(Ve.value),M.value=!1},Pt=()=>{c.value="Priority",k.value="Parts Required",P.value="Labour",B.value="Other Resources Required (optional)",m.value="Defect Symptom",b.value="Defect Cause"};return be($,O=>{O.length>0&&(u.value=!1)},{deep:!0}),(O,Y)=>{const Be=ce("Label"),Ut=ce("el-image"),Dt=ce("el-collapse-item"),qt=ce("el-collapse"),la=ce("el-option"),oa=ce("el-select"),ba=ce("el-dialog"),Qt=rs("loading");return Nt((d(),re(ba,{modelValue:x.value,"onUpdate:modelValue":Y[13]||(Y[13]=ve=>x.value=ve),width:"90%",center:"","lock-scroll":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"custom-class":`el-defect-crack-form-custom form-crack-yes-eform ${me.value}`,"before-close":$t,onOpened:ze,onClosed:Ze},{title:ee(()=>[l("div",Jf,[l("div",null,[Yf,l("span",{class:"el-dialog__title task-title",innerHTML:J(Qa)(ut.value),ref_key:"defectDetailRef",ref:Ve},null,8,zf)]),l("div",Xf,[l("div",{class:$e(["rounded d-flex justify-content-center align-items-center header-badge text-badge mx-2",[n.crackData.Type=="YES"?"yellowish yellowish-text":"blueish blueish-text"]])},[l("div",null,ue(n.crackData.Type=="YES"?"Repair required":"Monitor"),1)],2)])])]),default:ee(()=>[l("div",null,[l("div",Qf,[l("div",Zf,[l("div",ev,[l("div",tv,[l("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:n.assetNumber},null,8,av),sv])]),l("div",lv,[l("div",ov,[l("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:Ce.value},null,8,rv),nv])]),l("div",iv,[l("div",uv,[l("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:st.value},null,8,dv),cv])])])]),l("div",mv,[R(yo,{id:"crack",disabled:!1,"allow-delete":!0,"is-monitoring":!1,"is-mandatory":!0,"old-version":!0,"has-submitted":u.value},null,8,["has-submitted"])]),u.value?(d(),re(Be,{key:0,class:"error-label"},{default:ee(()=>[Ee("Required")]),_:1})):E("",!0),J(o).referencePhoto.blob&&J(o).referencePhoto.blob!=""?(d(),re(qt,{key:1,class:"task-group general-accordion py-1 px-5",modelValue:v.value,"onUpdate:modelValue":Y[0]||(Y[0]=ve=>v.value=ve)},{default:ee(()=>[R(Dt,{title:J(o).referencePhoto.title,name:J(o).referencePhoto.title},{default:ee(()=>[l("div",fv,[R(Ut,{src:J(o).referencePhoto.blob},null,8,["src"])])]),_:1},8,["title","name"])]),_:1},8,["modelValue"])):E("",!0),l("div",vv,[R(_a,{value:p.value.Description.value,label:Re.value,name:"defectPlaceholder",errorMessage:p.value.Description.errorMessage,"is-valid":p.value.Description.isValid,onHandleChange:gt},null,8,["value","label","errorMessage","is-valid"])]),l("div",pv,[l("div",yv,[l("div",gv,[l("div",bv,[l("input",{type:"text",class:"form-control",disabled:"",value:J(o).selectedFitter.name},null,8,kv),hv])])])]),l("div",_v,[l("div",wv,[l("div",Sv,[l("div",Cv,[l("input",{type:"text",class:"form-control",disabled:"",value:De()},null,8,Rv),Tv])]),l("div",Uv,[l("div",Iv,[l("div",$v,[Nt(l("input",{type:"text",class:"form-control",onInput:ha(ft,["prevent"]),"onUpdate:modelValue":Y[1]||(Y[1]=ve=>ie.value=ve),pattern:"[0-9]*",inputmode:"numeric",onKeypress:He,onFocusout:ft},null,544),[[ss,ie.value]]),Pv]),p.value.PlannedDuration.isValid?E("",!0):(d(),h("div",Dv,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(p.value.PlannedDuration.errorMessage),1)]),_:1})]))]),l("div",Vv,[R(Be,null,{default:ee(()=>[Ee("Hours")]),_:1})])])])]),l("div",Bv,[R(_a,{value:p.value.Instruction.value,label:Ne.value,name:"instructionPlaceholder",errorMessage:p.value.Instruction.errorMessage,"is-valid":p.value.Instruction.isValid,onHandleChange:dt},null,8,["value","label","errorMessage","is-valid"])]),l("div",Av,[Nv,xv,(d(!0),h(we,null,tt(q.value,(ve,y)=>(d(),h("div",{key:ve,class:"row my-1 d-flex align-items-center"},[l("div",Ov,ue(J(Jo)(ve)),1),l("div",Lv,ue(Ke(ve.previousCrack))+" "+ue(ve.previousCrack!="-"?"mm":"-"),1),l("div",Ev,[l("input",{type:"text",class:"form-control",value:ve.currentCrack,onInput:N=>at(N,y),onKeypress:He,pattern:"[0-9]*",inputmode:"numeric"},null,40,Fv),p.value.CrackLength[y].isValid?E("",!0):(d(),h("div",Mv,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(p.value.CrackLength[y].errorMessage),1)]),_:2},1024)]))]),jv]))),128))]),R(qt,{class:"task-group general-accordion py-1 px-5",modelValue:c.value,"onUpdate:modelValue":Y[6]||(Y[6]=ve=>c.value=ve)},{default:ee(()=>[R(Dt,{title:"Priority",name:"Priority"},{default:ee(()=>[Hv,l("div",Kv,[l("div",Gv,[l("div",qv,[Nt(l("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":Y[2]||(Y[2]=ve=>K.value=ve),value:"P1"},null,512),[[cs,K.value]]),Wv])]),Jv,Yv]),l("div",zv,[l("div",Xv,[l("div",Qv,[Nt(l("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":Y[3]||(Y[3]=ve=>K.value=ve),value:"P2"},null,512),[[cs,K.value]]),Zv])]),ep,tp]),l("div",ap,[l("div",sp,[l("div",lp,[Nt(l("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":Y[4]||(Y[4]=ve=>K.value=ve),value:"P3"},null,512),[[cs,K.value]]),op])]),rp,np]),l("div",ip,[l("div",up,[l("div",dp,[Nt(l("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":Y[5]||(Y[5]=ve=>K.value=ve),value:"P4"},null,512),[[cs,K.value]]),cp])]),mp,fp])]),_:1})]),_:1},8,["modelValue"]),vp,R(qt,{class:"task-group general-accordion py-1 px-5 parts-collapse",modelValue:k.value,"onUpdate:modelValue":Y[7]||(Y[7]=ve=>k.value=ve)},{default:ee(()=>[R(Dt,{title:"Parts Required",name:"Parts Required"},{default:ee(()=>[M.value?(d(),re(nr,{key:0})):E("",!0),pp,(d(!0),h(we,null,tt(p.value.Parts,(ve,y)=>(d(),h("div",{class:"row p-3 m-1 priority-container px-0",key:ve.partNumber},[l("div",yp,[l("div",gp,[l("input",{type:"text",class:"form-control",value:p.value.Parts[y].partNumber,onChange:N=>St(N,y)},null,40,bp),ve.partNumberValidation.isValid?E("",!0):(d(),h("div",kp,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.partNumberValidation.message),1)]),_:2},1024)]))])]),l("div",hp,[l("div",_p,[l("input",{type:"text",class:"form-control",value:ve.partDescription,onChange:N=>it(N,y)},null,40,wp),ve.descriptionValidation.isValid?E("",!0):(d(),h("div",Sp,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.descriptionValidation.message),1)]),_:2},1024)]))])]),l("div",Cp,[l("div",Rp,[l("div",Tp,[Nt(l("input",{class:"form-control","onUpdate:modelValue":N=>ve.qty=N,onInput:N=>Le(N,y),pattern:"[0-9]*",inputmode:"numeric",onKeypress:He,onFocusout:N=>Le(N,y)},null,40,Up),[[ss,ve.qty]])])]),ve.qtyValidation.isValid?E("",!0):(d(),h("div",Ip,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.qtyValidation.message),1)]),_:2},1024)]))]),l("div",$p,[l("div",Pp,[R(go,{index:y,"item-value":ve.images||[],onHandleChangeImage:xt},null,8,["index","item-value"])])]),l("div",Dp,[l("div",Vp,[R(bo,{index:y,"item-value":ve.attachment||[],onHandleChangeAttachment:Ht},null,8,["index","item-value"])]),l("div",Bp,[l("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:ha(N=>Rt(y),["prevent"])},null,8,Ap)])])]))),128)),l("div",Np,[l("div",xp,[Ee(" Check Partbook "),l("a",{href:J(_).statePartReference.linkAddress,target:"_blank",class:"fw-bolder",style:{color:"#18AF4A"}},[Lp,Ee(" "+ue(J(_).statePartReference.brand),1)],8,Op)]),l("button",{class:"my-3 btn-add-new",onClick:Ge},[Ep,Ee(" Add more parts ")])])]),_:1})]),_:1},8,["modelValue"]),Fp,R(qt,{class:"task-group general-accordion py-1 px-5",modelValue:P.value,"onUpdate:modelValue":Y[9]||(Y[9]=ve=>P.value=ve)},{default:ee(()=>[R(Dt,{title:"Labour",name:"Labour"},{default:ee(()=>[Mp,(d(!0),h(we,null,tt(p.value.Labours,(ve,y)=>(d(),h("div",{key:ve,class:"row p-3 m-1 priority-container ps-0"},[l("div",jp,[l("div",Hp,[R(oa,{modelValue:X.value[y],"onUpdate:modelValue":N=>X.value[y]=N,placeholder:"Choose One",onChange:N=>pt(y),class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(J(r).positionOption,N=>(d(),re(la,{key:N.value,label:N.label,value:N.label},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),ve.positionValidation.isValid?E("",!0):(d(),h("div",Kp,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.positionValidation.message),1)]),_:2},1024)]))])]),l("div",Gp,[l("div",qp,[Nt(l("input",{class:"form-control","onUpdate:modelValue":N=>ve.qty=N,pattern:"[0-9]*",inputmode:"numeric",onKeypress:Y[8]||(Y[8]=(...N)=>J(bl)&&J(bl)(...N)),onInput:ha(N=>Ot(N,y),["prevent"]),onFocusout:N=>Ot(N,y)},null,40,Wp),[[ss,ve.qty]]),ve.qtyValidation.isValid?E("",!0):(d(),h("div",Jp,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.qtyValidation.message),1)]),_:2},1024)]))])]),l("div",Yp,[l("div",zp,[Nt(l("input",{class:"form-control","onUpdate:modelValue":N=>ve.hireEach=N,onKeypress:He,pattern:"[0-9]*",inputmode:"numeric",onInput:ha(N=>Xt(N,y),["prevent"]),onFocusout:N=>Xt(N,y)},null,40,Xp),[[ss,ve.hireEach]]),ve.hireEachValidation.isValid?E("",!0):(d(),h("div",Qp,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.hireEachValidation.message),1)]),_:2},1024)]))])]),l("div",Zp,[l("div",ey,[l("div",ty,[l("input",{class:"form-control",value:ve.totalHours,disabled:""},null,8,ay),l("div",{class:$e(["ms-4 d-flex align-items-center",y===0?"hidden":""])},[l("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:ha(N=>vt(y),["prevent"])},null,8,sy)],2)])]),ve.totalHoursValidation.isValid?E("",!0):(d(),h("div",ly,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.totalHoursValidation.message),1)]),_:2},1024)]))])]))),128)),l("button",{class:"my-3 btn-add-new",onClick:Tt},[oy,Ee(" Add more labour ")])]),_:1})]),_:1},8,["modelValue"]),ry,R(qt,{class:"task-group general-accordion py-1 px-5",modelValue:B.value,"onUpdate:modelValue":Y[10]||(Y[10]=ve=>B.value=ve)},{default:ee(()=>[R(Dt,{title:"Other Resources Required (optional)",name:"Other Resources Required (optional)"},{default:ee(()=>[(d(!0),h(we,null,tt(p.value.Resources,(ve,y)=>(d(),h("div",{class:"p-2 d-flex",key:ve.value},[l("div",ny,[l("div",iy,[l("input",{type:"text",class:"form-control",value:ve.value,placeholder:`Resource ${Number(y)+1}`,onChange:N=>Gt(N,y)},null,40,uy),l("div",{class:$e(["ms-4 d-flex align-items-center",y===0?"hidden":""])},[l("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:ha(N=>Ia(y),["prevent"])},null,8,dy)],2)]),ve.isValid?E("",!0):(d(),h("div",cy,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.errorMessage),1)]),_:2},1024)]))])]))),128)),l("button",{class:"my-3 btn-add-new",onClick:ea},[my,Ee(" Add new resource ")])]),_:1})]),_:1},8,["modelValue"]),fy,R(qt,{class:"task-group general-accordion py-1 px-5",modelValue:m.value,"onUpdate:modelValue":Y[11]||(Y[11]=ve=>m.value=ve)},{default:ee(()=>[R(Dt,{title:"Defect Symptom",name:"Defect Symptom"},{default:ee(()=>[(d(!0),h(we,null,tt(p.value.Symptoms,(ve,y)=>(d(),h("div",{class:"p-2 d-flex flex-column",key:ve.value},[l("div",vy,[l("div",py,[R(oa,{modelValue:W.value[y],"onUpdate:modelValue":N=>W.value[y]=N,placeholder:"Select Symptom",filterable:"",onChange:N=>Na(y),class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(J(g).Symptoms,N=>(d(),re(la,{key:N.id,label:N.symptom,value:N.symptom},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),W.value[y]==="Other"?(d(),h("div",yy,[R(_a,{value:D.value[y],label:"Description",name:"Description",errorMessage:"Required","is-valid":U.value[y],index:y,onHandleChange:xa},null,8,["value","is-valid","index"])])):E("",!0)]),l("div",{class:$e(["ms-4 d-flex align-items-center",y===0?"hidden":""])},[l("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:ha(N=>Ra(y),["prevent"])},null,8,gy)],2)]),ve.isValid?E("",!0):(d(),h("div",by,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.errorMessage),1)]),_:2},1024)]))]))),128)),l("button",{class:"my-3 btn-add-new",onClick:ha(Ca,["prevent"])},[ky,Ee(" Add another symptom ")])]),_:1})]),_:1},8,["modelValue"]),hy,R(qt,{class:"task-group general-accordion py-1 px-5",modelValue:b.value,"onUpdate:modelValue":Y[12]||(Y[12]=ve=>b.value=ve)},{default:ee(()=>[R(Dt,{title:"Defect Cause",name:"Defect Cause"},{default:ee(()=>[(d(!0),h(we,null,tt(p.value.Causes,(ve,y)=>(d(),h("div",{class:"p-2 d-flex flex-column",key:ve.value},[l("div",_y,[l("div",wy,[R(oa,{modelValue:w.value[y],"onUpdate:modelValue":N=>w.value[y]=N,placeholder:"Select Cause",filterable:"",onChange:N=>ga(y),class:"w-100"},{default:ee(()=>[(d(!0),h(we,null,tt(J(g).Causes,N=>(d(),re(la,{key:N.id,label:N.causes,value:N.causes},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),w.value[y]==="Other"?(d(),h("div",Sy,[R(_a,{value:I.value[y],label:"Description",name:"Description",errorMessage:"Required","is-valid":z.value[y],index:y,onHandleChange:Ba},null,8,["value","is-valid","index"])])):E("",!0)]),l("div",{class:$e(["ms-4 d-flex align-items-center",y===0?"hidden":""])},[l("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:ha(N=>ta(y),["prevent"])},null,8,Cy)],2)]),ve.isValid?E("",!0):(d(),h("div",Ry,[R(Be,{class:"error-label"},{default:ee(()=>[Ee(ue(ve.errorMessage),1)]),_:2},1024)]))]))),128)),l("button",{class:"my-3 btn-add-new",onClick:Sa},[Ty,Ee(" Add another cause ")])]),_:1})]),_:1},8,["modelValue"]),l("div",{class:"my-5 w-100"},[l("button",{class:"btn btn-success w-100",onClick:ge,style:{background:"#18af4a","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}}," Submit ")])]),R(ir,{show:L.value,"parts-warning":T.value,onAddParts:Aa,onClose:Qe,onSubmit:Fe},null,8,["show","parts-warning"]),R(ca,{visibility:oe.value,caption:"Are you sure want to close the crack form? <br /> Note: By closing the crack form, you will lose your crack data that you have already inputted.",onOnNoConfirm:kt,onOnYesConfirm:V},null,8,["visibility"]),R(ko,{show:S.value,onClose:qe,message:"Crack Recording Information Successfully Submitted"},null,8,["show"])]),_:1},8,["modelValue","custom-class"])),[[Qt,J(o).Loading]])}}}),Iy=Ct(Uy,[["__scopeId","data-v-642461fe"]]),$y={class:"row justify-content-end"},Py={key:0,class:"col-3 col-sm-2 col-xl-1"},Dy={class:"row justify-content-end"},Vy=["disabled"],hl=Ue({__name:"SubmitButton",emits:["submit"],setup(n,{emit:s}){const e=rt(),o=s,t=ja(),r=async()=>{const v=Xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),c=await e.setShowNextPage(u.value);c&&u.value=="Submit"?o("submit",c):e.stateSelectedGroup.groupName=="DEFECT_IDENTIFIED_SERVICE"&&_e()&&await t.getDefectFromLocalDB(e.generalForm.workOrder),v.close()},g=v=>!!(a.isEmpty(v)||!v.id&&!v.name&&_.value),u=i(()=>_.value&&e.generalForm.status!="Submited"?"Submit":"Next"),_=i(()=>e.isAllTaskDone),C=i(()=>{const v=e.stateGroups.findIndex(c=>{var k;return c.groupName==((k=e.stateSelectedGroup)==null?void 0:k.groupName)});return v+1>=e.groups.length?v+1==e.groups.length&&u.value=="Submit":!0});return(v,c)=>(d(),h("div",$y,[C.value?(d(),h("div",Py,[l("div",Dy,[l("button",{type:"button",class:"btn btn-success",disabled:g(J(e).employee),onClick:r,style:{"background-color":"#18AF4A"}},ue(u.value),9,Vy)])])):E("",!0)]))}}),By=n=>(Yt("data-v-84978a95"),n=n(),zt(),n),Ay={class:"mt-5 ps-0",style:{width:"100%"}},Ny=By(()=>l("div",{class:"d-flex flex-fill align-items-center"},[l("div",null,[l("img",{src:"/media/logos/bumaau/defects.png",class:"icon",alt:"defects"})]),l("div",{class:"ms-5"},[l("h4",{class:"title"},"Historical Defect")])],-1)),xy={key:0,class:"text-danger"},Oy={class:"d-flex flex-column"},Ly=["onClick"],Ey=Ue({__name:"HistoricalDefects",props:{isHitOnline:{type:Boolean}},emits:["show-history"],setup(n,{emit:s}){const e=s,o=Ll(),t=Ls(),r=i(()=>t.defectList),g=u=>{o.setSelectedForm(u),e("show-history")};return(u,_)=>{const C=ce("el-collapse-item"),v=ce("el-collapse");return d(),h("div",Ay,[R(v,{class:"task-group general-accordion py-1 ps-3 pe-3"},{default:ee(()=>[R(C,{name:"1"},{title:ee(()=>[Ny]),default:ee(()=>[u.isHitOnline?E("",!0):(d(),h("p",xy," Out of network, data cannot be retrieved. ")),l("div",Oy,[(d(!0),h(we,null,tt(r.value.slice(0,3),c=>(d(),h("p",{key:c.workOrder,onClick:k=>g(c),style:{cursor:"pointer"}},ue(c.unitNumber)+" - "+ue(c.equipmentModel)+" - "+ue(c.psType)+" Hour Service - "+ue(c.workOrder),9,Ly))),128))])]),_:1})]),_:1})])}}}),Fy=Ct(Ey,[["__scopeId","data-v-84978a95"]]),My=n=>(Yt("data-v-dc57b6af"),n=n(),zt(),n),jy={class:"mt-5 ps-0",style:{width:"100%"}},Hy=My(()=>l("div",{class:"d-flex flex-fill align-items-center"},[l("div",null,[l("img",{src:"/media/logos/bumaau/e-form.png",class:"icon",alt:"e-Form"})]),l("div",{class:"ms-5"},[l("h4",{class:"title"},"Historical Digital Service Forms")])],-1)),Ky={key:0,class:"text-danger"},Gy={class:"d-flex flex-column"},qy=["onClick"],Wy=Ue({__name:"HistoricalEForm",props:{isHitOnline:{type:Boolean}},emits:["show-history"],setup(n,{emit:s}){const e=s,o=Ls(),t=i(()=>o.formList),r=g=>{e("show-history",g)};return(g,u)=>{const _=ce("el-collapse-item"),C=ce("el-collapse");return d(),h("div",jy,[R(C,{class:"task-group general-accordion py-1 ps-3 pe-3"},{default:ee(()=>[R(_,{name:"1"},{title:ee(()=>[Hy]),default:ee(()=>[g.isHitOnline?E("",!0):(d(),h("p",Ky," Out of network, data cannot be retrieved. ")),l("div",Gy,[(d(!0),h(we,null,tt(t.value.slice(0,3),v=>(d(),h("p",{key:v.workOrder,onClick:c=>r(v),style:{cursor:"pointer"}},ue(`${v.equipmentNumber} - ${v.equipmentModelDescription} - ${v.psTypeId} Hour Service - ${v.workOrder}`),9,qy))),128))])]),_:1})]),_:1})])}}}),Jy=Ct(Wy,[["__scopeId","data-v-dc57b6af"]]),Yy=l("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[l("h3",null,"Rating for this task not been mapped yet, please insert mapping on IronLake first")],-1),zy={class:"row text-center pt-5"},Xy=Ue({__name:"NotMapped",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(n,{emit:s}){const e=n,o=s,t=Ye(()=>e.show),r=()=>{o("close")};return(g,u)=>{const _=ce("el-button"),C=ce("el-dialog");return d(),re(C,{modelValue:J(t),"onUpdate:modelValue":u[0]||(u[0]=v=>Fa(t)?t.value=v:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:ee(()=>[Yy,l("div",zy,[R(_,{type:"success",class:"ok-button",onClick:r},{default:ee(()=>[Ee("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),eo=n=>(Yt("data-v-51fa86e2"),n=n(),zt(),n),Qy={class:"mt-0 ps-0"},Zy=eo(()=>l("div",{class:"row px-2 item mx-1 w-100 defect-panel-header"},[l("div",{class:"col align-items-center d-flex text-break"},"Task Description"),l("div",{class:"col-1 column-sm-30-percent column-md-23-percent column-lg-16-percent column-xl-16-percent align-items-center d-flex justify-content-center"},"Status"),l("div",{class:"col-1 column-sm-20-percent column-md-24-percent column-lg-10-percent column-xl-10-percent align-items-center d-flex justify-content-center"},"Review Status")],-1)),eg={key:0,class:"row flex-nowrap px-2 my-2 mx-1 w-100"},tg=eo(()=>l("p",{style:{"text-align":"center"}},"No data recorded",-1)),ag=[tg],sg={class:"row flex-nowrap px-2 my-2 mx-1 w-100"},lg={class:"col align-items-center d-flex text-break"},og=["innerHTML"],rg={class:"col-1 column-sm-30-percent column-md-23-percent column-lg-16-percent column-xl-16-percent align-items-center d-flex justify-content-center"},ng={class:"col-1 column-sm-20-percent column-md-24-percent column-lg-10-percent column-xl-10-percent align-items-center d-flex justify-content-center"},ig=["onClick"],ug={class:"row flex-nowrap w-100 flex-row-reverse create-by",style:{"font-size":"13px !important"}},dg=Ue({__name:"DefectSMUPanel",props:{viewOnly:{required:!1,type:Boolean,default:!1},supervisor:{required:!1,type:Boolean,default:!0},fitterId:{required:!1,type:String,default:""},plannerApprove:{required:!1,type:Boolean,default:!1}},emits:["onRefreshData","onGetPositionY"],setup(n,{emit:s}){const e=n,o=ja(),t=ya(),r=za(),g=s,u=f("SMU Machine Acknowledgement"),_=f(""),C=f(!1),v=i(()=>o.ApprovalData.SMUDefectHeaders),c=i(()=>o.DefectSMUDetail),k=i(()=>{const F=r.Ownership;return js(F)}),P=F=>!F.toLowerCase().includes("not"),B=(F,x)=>{let p="light-yellow color-dark-yellow";const K=x==null?void 0:x.find(X=>X.id===F);if(e.supervisor){if(K)switch(K.status){case"Submited":p="light-yellow color-dark-yellow";break;case"Acknowledge":p="light-green color-dark-green";break}}else!a.isUndefined(K.plannerStatus)&&K.plannerStatus&&(p="light-green color-dark-green");return p},m=async F=>{g("onGetPositionY"),t.setCurrent("defect");const x=o.setSMUDefectData(F);_.value=F,x&&(C.value=!0)},b=i(()=>o.DefectSMUHeader),S=i(()=>{if(b.value){const{approvedBy:F,approvedDate:x,status:p}=b.value;return{approvedBy:F,approvedDate:x,status:p}}}),L=()=>{g("onRefreshData")},H=i(()=>{var F;if(v.value.length>0){const x=o.ApprovalData.SMUDefectDetails.find(p=>p.defectHeaderId==v.value[0].id)??null;if(x)return`${((F=x.updatedBy)==null?void 0:F.name)||x.createdBy.name}, ${x.updatedDate!=""?x.updatedDate:x.createdDate}`}return""});return(F,x)=>{const p=ce("el-collapse-item"),K=ce("el-collapse");return d(),h(we,null,[l("div",Qy,[R(K,{class:"task-group general-accordion py-1 px-5 testing",modelValue:u.value,"onUpdate:modelValue":x[0]||(x[0]=X=>u.value=X)},{default:ee(()=>[R(p,{title:"SMU Machine Acknowledgement",name:"SMU Machine Acknowledgement"},{default:ee(()=>[Zy,v.value.length<1?(d(),h("div",eg,ag)):(d(!0),h(we,{key:1},tt(v.value,X=>(d(),h("div",{key:X.id,class:"item px-2 my-2 mx-1"},[l("div",sg,[l("div",lg,[l("span",{class:"text-break defect-identified-task",innerHTML:J(Qa)(X.taskDesc)},null,8,og)]),l("div",rg,ue(P(X.taskDesc)?"In Range":"Out of Range"),1),l("div",ng,[l("div",{class:$e(["label d-flex align-items-center acknowledge-btn py-2 px-1 rounded text-center justify-content-center cursor-pointer",B(X.id,v.value)]),onClick:W=>m(X.id)}," Detailed Information ",10,ig)])]),l("div",ug,ue(H.value),1)]))),128))]),_:1})]),_:1},8,["modelValue"])]),R(xl,{show:C.value,"onUpdate:show":x[1]||(x[1]=X=>C.value=X),detailDefect:c.value,ownership:k.value,"view-only":!0,plannerApprove:n.plannerApprove,"approval-s-p-v-data":S.value,onOnRefreshData:L},null,8,["show","detailDefect","ownership","plannerApprove","approval-s-p-v-data"])],64)}}}),cg=Ct(dg,[["__scopeId","data-v-51fa86e2"]]),mg=Ue({__name:"IndexEform",props:{data:{type:Object,required:!1,default(){return null}},comments:{type:[],required:!1,default:null}},setup(n){const s=ja(),e=rt(),o=za(),t=f(null),r=f(""),g=f(!1),u=f(!1),_=n,C=i(()=>_.data?_.data:s.ApprovalData),v=i(()=>_.comments?_.comments.slice().sort(c):s.Comments.slice().sort(c)),c=(b,S)=>{const L=parseInt(b.taskDesc.split(";;")[0]),H=parseInt(S.taskDesc.split(";;")[0]);return L-H},k=b=>{u.value=b},P=async()=>{const b=Xe.service({lock:!0,text:"Refresh Data...",background:"rgba(0, 0, 0, 0.7)"});_e()?(await s.getDefectFromLocalDB(e.generalForm.workOrder),await e.updateTaskProgressOnLocalDB2()):await e.checkCurrentWoPendingOfflineTask()?(await s.getDefectFromLocalDB(e.generalForm.workOrder),await e.updateTaskProgressOnLocalDB2()):(await s.getDefectsData(e.generalForm.workOrder),e.getTaskProgress(),await s.saveDefectServiceFormToLocalDB(e.generalForm.workOrder)),b.close()},B=()=>{try{Array.from(t.value.getElementsByClassName("show-pdf")).forEach(S=>{S.onclick=L=>{L.preventDefault(),g.value=!0,r.value=S.href}})}catch(b){console.log(b)}try{Array.from(t.value.getElementsByClassName("spv-print-pdf")).forEach(S=>{S.onclick=L=>{L.preventDefault(),g.value=!0,r.value=S.href,k(!0)}})}catch(b){console.log(b)}};Mt(async()=>{B(),await o.getPartReference(e.stateGeneralForm.equipment)});const m=()=>{g.value=!1};return(b,S)=>(d(),h(we,null,[l("div",{ref_key:"defectDetailRef",ref:t,class:"mb-3"},[R(vr),R(cg,{"view-only":!0}),R(vl,{"view-only":!1,"is-form":!0,supervisor:!0,"fitter-id":JSON.stringify(J(e).employee),onOnRefreshData:P,onOnHandlePdf:B,title:"Repairs Completed"},null,8,["fitter-id"]),R(vl,{"view-only":!1,"is-form":!0,supervisor:!0,"fitter-id":JSON.stringify(J(e).employee),onOnRefreshData:P,onOnHandlePdf:B,title:"Further Action Required"},null,8,["fitter-id"]),R(pl,{"view-only":!1,"is-form":!0,supervisor:!0,"fitter-id":JSON.stringify(J(e).employee),onOnRefreshData:P,"asset-number":J(e).stateUnitNumber,form:J(e).generalForm.modelId,workorder:J(e).generalForm.workOrder,"disable-add-generic":J(e).generalForm.status=="Submited",title:"Repairs Completed"},null,8,["fitter-id","asset-number","form","workorder","disable-add-generic"]),R(pl,{"view-only":!1,"is-form":!0,supervisor:!0,"fitter-id":JSON.stringify(J(e).employee),onOnRefreshData:P,"asset-number":J(e).stateUnitNumber,form:J(e).generalForm.modelId,workorder:J(e).generalForm.workOrder,"disable-add-generic":J(e).generalForm.status=="Submited",title:"Further Action Required"},null,8,["fitter-id","asset-number","form","workorder","disable-add-generic"]),R(yl,{"view-only":!1,"is-form":!0,supervisor:!0,"fitter-id":JSON.stringify(J(e).employee),onOnRefreshData:P,title:"Repairs Completed"},null,8,["fitter-id"]),R(yl,{"view-only":!1,"is-form":!0,supervisor:!0,"fitter-id":JSON.stringify(J(e).employee),onOnRefreshData:P,title:"Further Action Required"},null,8,["fitter-id"]),R(Mo,{headers:C.value.CBMHeaders,"defect-status":J(e).generalForm.defectStatus},null,8,["headers","defect-status"]),R(gl,{title:"Not Applicable Item Check",headers:C.value.DefectNAHeaders,"is-defect":!0},null,8,["headers"]),R(gl,{"planner-approve":!1,title:"Not Applicable Crack Check",headers:C.value.CrackNAHeaders,"is-defect":!1},null,8,["headers"]),R(pr,{headers:v.value},null,8,["headers"])],512),R(qs,{show:g.value,onHandleCloseModal:m,"blob-url":r.value},null,8,["show","blob-url"]),R(xs,{show:u.value,onClose:k,"title-pop-up":"if required, see your supervisor to print this"},null,8,["show"])],64))}}),fg=l("div",{class:"row text-center pt-3 pb-3 text-dark modal-title text-break"},[l("h3",null,"Cannot Access this form With Different Supervisor")],-1),vg={class:"row text-center pt-5"},pg=Ue({__name:"FormAlreadyOpenedByOtherSupervisor",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(n,{emit:s}){const e=n,o=s,t=Ye(()=>e.show),r=()=>{o("close")};return(g,u)=>{const _=ce("el-button"),C=ce("el-dialog");return d(),re(C,{modelValue:J(t),"onUpdate:modelValue":u[0]||(u[0]=v=>Fa(t)?t.value=v:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:ee(()=>[fg,l("div",vg,[R(_,{type:"success",class:"ok-button",onClick:r},{default:ee(()=>[Ee("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),yg=["src"],to=Ue({__name:"Image",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(n){const s=n,e=f("/media/svg/dma/warning.svg"),o=f(!0);wa();const t=Me(s,"item"),r=Ye(()=>!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col"),g=Ye(()=>{let c="";return s.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(c=`col-md-${t.value.style.potraitBreakPoint}`,c=`${c} col-lg-${t.value.style.breakPoint}`):(c=`col-md-${t.value.style.potraitBreakPoint}`,c=`${c} col-lg-${t.value.style.breakPoint}`)),c}),u=Ye(()=>{var x,p,K,X;const c=!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; `:"",k=!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:"",P=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",B=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let m=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((x=s.task)==null?void 0:x.isShowAdjustmentRow)&&((p=s.task)!=null&&p.isShowAdjustmentRow))m="";else{let W=0;(K=s.task)==null||K.items.forEach(w=>{var D;a.isUndefined(w.style)||(a.isUndefined(w.style.border)?a.isUndefined(w.style.border)&&(W=W+Number(w.style.breakPoint)):((w.style.border.right=="none"||a.isUndefined(w.style.border.right))&&(W=W+Number(w.style.breakPoint)),a.isEqual(w,a.last((D=s.task)==null?void 0:D.items))&&(W=W+Number(w.style.breakPoint))))}),W==12&&(m=!((X=s.task.updatedBy)!=null&&X.name)&&!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const b=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",S=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",L=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",H=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",F=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";return`${c}${k}${P}${B}${m}${b}${S}${L}${H}${F}`}),_=Ye(()=>!a.isUndefined(t.value.style)&&t.value.style.breakPoint=="1"?"width: 20px; height: 20px":""),C=rt();gs(async()=>{try{const c=window.URL||window.webkitURL;if(_e())e.value=await vs(t.value.value);else{const k=await Es(t.value.value);e.value=c.createObjectURL(k),Fs(t.value.value,C.stateGeneralForm.workOrder,k)}o.value=!1}catch{o.value=!1}});const v=Ye(()=>{let c="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(c=""),c});return(c,k)=>{const P=rs("loading");return Nt((d(),h("div",{class:$e([[J(r),J(g),J(v)],"pt-2 px-2 d-flex d-flex justify-content-center"]),style:Se(J(u))},[l("img",{src:e.value,class:"img-fluid",style:Se(J(_))},null,12,yg)],6)),[[P,o.value]])}}}),gg=["innerHTML"],ao=Ue({__name:"Label",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(n){const s=n,e=Me(s,"item"),o=i(()=>Ha(s.item.value)),t=i(()=>{var v,c;return((v=s.task)==null?void 0:v.taskType)==="table"||((c=s.task)==null?void 0:c.taskType)==="collapsibleTable"?"col":s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""}),r=i(()=>{var c,k;if(((c=s.task)==null?void 0:c.taskType)==="table"||((k=s.task)==null?void 0:k.taskType)==="collapsibleTable")return"col";let v="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(v=`col-md-${e.value.style.potraitBreakPoint}`,v=`${v} col-lg-${e.value.style.breakPoint}`):(v=`col-md-${e.value.style.potraitBreakPoint}`,v=`${v} col-lg-${e.value.style.breakPoint}`)),v}),g=i(()=>a.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),u=i(()=>{var F,x,p,K;const v=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",c=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",k=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",P=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let B=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((F=s.task)==null?void 0:F.isShowAdjustmentRow)&&((x=s.task)!=null&&x.isShowAdjustmentRow))B="";else{let X=0;(p=s.task)==null||p.items.forEach(W=>{var w;a.isUndefined(W.style)||(a.isUndefined(W.style.border)?a.isUndefined(W.style.border)&&(X=X+Number(W.style.breakPoint)):((W.style.border.right=="none"||a.isUndefined(W.style.border.right))&&(X=X+Number(W.style.breakPoint)),a.isEqual(W,a.last((w=s.task)==null?void 0:w.items))&&(X=X+Number(W.style.breakPoint))))}),X==12&&(B=!((K=s.task.updatedBy)!=null&&K.name)&&!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const m=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",b=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",S=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",L=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",H=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${v}${c}${k}${P}${B}${m}${b}${S}${L}${H}`}),_=i(()=>`${!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.fontWeight)&&e.value.style.fontWeight!="normal"?`font-weight: ${e.value.style.fontWeight}; `:""}`),C=i(()=>{let v="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(v=""),v});return(v,c)=>(d(),h("div",{class:$e([[t.value,g.value,r.value,C.value],"px-2 pt-2"]),style:Se(u.value)},[!J(a.isUndefined)(n.item.style)&&n.item.style.visibility!="hidden"?(d(),h("label",{key:0,style:Se(_.value),innerHTML:o.value},null,12,gg)):E("",!0)],6))}}),as=n=>(Yt("data-v-fdc2de2c"),n=n(),zt(),n),bg={class:"px-0 mx-0 d-flex"},kg=["innerHTML"],hg=["innerHTML"],_g={key:0,class:"ms-2"},wg=as(()=>l("img",{src:bs,alt:"na",class:"d-icon"},null,-1)),Sg=[wg],Cg=as(()=>l("img",{src:Za,alt:"defect",class:"d-icon"},null,-1)),Rg=[Cg],Tg=as(()=>l("img",{src:Za,alt:"defect",class:"d-icon"},null,-1)),Ug=[Tg],Ig=as(()=>l("img",{src:bs,alt:"na",class:"d-icon"},null,-1)),$g=[Ig],Pg={key:0,class:"ms-1 d-flex align-items-center"},Dg=as(()=>l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Updating...")],-1)),Vg=as(()=>l("span",null,"Updating...",-1)),Bg=[Dg,Vg],Ag=Ue({__name:"Dropdown",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},emits:["setLoading"],setup(n,{emit:s}){const e=n,o=s,t=Me(e,"item"),r=Me(e,"task"),g=Jt(),u=es(),_=Ks(),C=gr(),v=br(),c=qa(),k=f(!1),P=f(!1),B=f(""),m=f(""),b=f(!1),S=_s(),L=f([]),H=se=>{L.value=se},F=()=>{L.value.length<1?V():kt(),L.value=[]},x=i(()=>P),p=i(()=>_.Cancelled),K=i(()=>C.Cancelled),X=i(()=>v.Cancelled),W=f(!1),w=f(!1),D=f(!1),U=()=>{var se;(se=e.task)==null||se.items.forEach(ke=>{ke.itemType==="smallCamera"&&(S.toggleIsVisible(!0,ke.key),S.setShowCloseButton(!1),S.setShowCloseButton(!1))}),D.value=!1},I=i(()=>{let se="Choose One";return!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.placeholder)&&(se=t.value.style.placeholder),se});be(p,se=>{var ke,De,He;if(o("setLoading",!1),se===!0){if(((ke=t.value)==null?void 0:ke.categoryItemType)=="resultRating")return;const at=localStorage.getItem("taskKey");console.log((De=r.value)==null?void 0:De.key),at===((He=r.value)==null?void 0:He.key)&&(t.value.value=B.value,P.value=!P.value,_.setCancelledState(!1),b.value=!1)}}),be(K,se=>{var ke,De;if(o("setLoading",!1),se===!0){if(((ke=t.value)==null?void 0:ke.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((De=r.value)==null?void 0:De.key)&&(t.value.value=B.value,P.value=!P.value,C.setCancelledState(!1),b.value=!1)}}),be(X,se=>{var ke,De;if(o("setLoading",!1),se===!0){if(((ke=t.value)==null?void 0:ke.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((De=r.value)==null?void 0:De.key)&&(t.value.value=B.value,P.value=!P.value,v.setCancelledState(!1),b.value=!1)}});const z=i(()=>e.generalStyle?!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col":""),oe=i(()=>{let se="";return e.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(se=`col-md-${t.value.style.potraitBreakPoint}`,se=`${se} col-lg-${t.value.style.breakPoint}`):(se=`col-md-${t.value.style.potraitBreakPoint}`,se=`${se} col-lg-${t.value.style.breakPoint}`)),se}),me=i(()=>{var se;return $.value?(se=ie.value.find(ke=>ke.value==String($.value)))==null?void 0:se.label:$.value}),M=i(()=>{var De,He;const se=t.value.value.toString().replaceAll("'","");let ke;return se=="1"?ke="green":se=="2"||se=="3"&&((De=r.value)==null?void 0:De.category)=="CRACK"?ke="red":se=="3"&&(((He=r.value)==null?void 0:He.category)=="NORMAL"||t.value.categoryItemType=="resultStatus")||se=="4"?ke="yellow":se=="A"?ke="a":se=="B"?ke="b":se=="C"?ke="c":se=="X"&&(ke="x"),ke}),te=se=>{T(se,!0)},T=async(se,ke,De=!1)=>{var He,at,gt,ft,dt,St,it,Le,xt,Ht,Ge,Rt,pt;if(a.isUndefined((at=(He=e.task)==null?void 0:He.updatedBy)==null?void 0:at.id)||o("setLoading",!0),u.setStateItemKey(t.value.key),e.item.categoryItemType=="dropdownTool")if(c.stateConnectionStatus)b.value=!0,B.value=$.value,t.value.value=se,await u.updateToolUom(e.task,t.value),b.value=!1;else{c.setSubmitConnectionError(!0),t.value.value=B.value,localStorage.removeItem("taskKey");return}else{if($.value===se||se===((gt=e.task)==null?void 0:gt.taskValue)&&!(p.value||K.value||X.value))return;if(Z(),p.value||K.value||X.value){B.value="",localStorage.removeItem("taskKey");return}else if(c.stateConnectionStatus){if(o("setLoading",!0),b.value=!0,localStorage.setItem("taskKey",(ft=r.value)==null?void 0:ft.key),B.value=$.value,m.value=(dt=r.value)==null?void 0:dt.key,t.value.value=se,se==="2"&&((St=e.task)==null?void 0:St.category)==="NORMAL")_.setTask(e.task),_.setItemKey(t.value.key),k.value=!0,_.setItem(t.value);else if(se==="3"&&((it=e.task)==null?void 0:it.category)==="CRACK")C.setTask(e.task),C.setItemKey(t.value.key),C.cretateInstance(!0),await C.getPreviousCrack(u.generalForm.workOrder,u.generalForm.modelId,u.generalForm.psTypeId,e.task.key),C.toggleYesVisible(!0);else if(se==="2"&&((Le=e.task)==null?void 0:Le.category)==="CRACK")C.setTask(e.task),C.setItemKey(t.value.key),C.cretateInstance(!1),await C.getPreviousCrack(u.generalForm.workOrder,u.generalForm.modelId,u.generalForm.psTypeId,e.task.key),C.toggleNoVisible(!0);else if(se==="3"&&((xt=e.task)==null?void 0:xt.category)==="NORMAL"||se=="3"&&t.value.categoryItemType=="resultStatus"||se==="4"&&((Ht=e.task)==null?void 0:Ht.category)==="CRACK")v.setTask(e.task),v.setItemKey(t.value.key),v.toggleIsVisible(!0),v.setItem(t.value);else if(se=="C"||se=="X"){const Ot=e.task.items.find(Kt=>Kt.itemType==="smallCamera");Ot&&u.setMeasurementValueAndUOM("","",Ot.key),await u.updateDefect(e.task,se,t.value)&&(se=="C"||se=="X")&&ke&&(u.setInputCameraMandatoryKey(t.value.key),D.value=!0)}else{B.value&&(((Ge=e.task)==null?void 0:Ge.category)==="CBM"||((Rt=e.task)==null?void 0:Rt.category)==="NORMAL")&&await u.deleteDefect(e.task);const Ot={keyValue:(pt=r.value)==null?void 0:pt.key,propertyParams:[{propertyName:"taskValue",propertyValue:t.value.value.toString()??"1"},{propertyName:"updatedBy",propertyValue:se===""?"":JSON.stringify(u.employee)},{propertyName:"updatedDate",propertyValue:se===""?"":"<<ServerDateTime>>"}]};let Xt={},Kt={};t.value.categoryItemType=="resultRating"&&((e.task.taskValue=="3"||e.task.taskValue=="4")&&await u.deleteDefect(e.task),Kt={keyValue:e.task.key,propertyParams:[{propertyName:"taskNormalValue",propertyValue:""}]},e.task.items.forEach(vt=>{vt.categoryItemType=="resultStatus"&&(Xt={keyValue:vt.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]})}));const Tt=[{keyValue:t.value.key,propertyParams:[{propertyName:"value",propertyValue:se},{propertyName:"updatedBy",propertyValue:se===""?"":JSON.stringify(u.employee)},{propertyName:"updatedDate",propertyValue:se===""?"":"<<ServerDateTime>>"}]}];!a.isUndefined(t.value.isTaskValue)&&t.value.isTaskValue&&Tt.push(Ot),t.value.categoryItemType=="resultRating"&&(Tt.push(Xt),Tt.push(Kt)),await u.updateServiceSheetTaskValue(Tt,g.user.EmployeeId,g.user.Name).then(vt=>{var Gt;u.setStateItemKey(""),vt?(((Gt=e.task)==null?void 0:Gt.category)==="CBM"&&(se=="A"||se=="B")&&(u.setInputCameraMandatoryKey(t.value.key),!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("cbmTakePhotoAllRating")&&(D.value=!0)),se=="1"&&B.value==""&&(u.setInputCameraMandatoryKey(t.value.key),!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("normalTakePhoto")&&(D.value=!0),!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("cbmTakePhoto")&&(D.value=!0))):t.value.value=B.value})}b.value=!1,o("setLoading",!1)}else{c.setSubmitConnectionError(!0),localStorage.removeItem("taskKey"),t.value.value=B.value;return}}},$=i(()=>e.item.value.toString().replaceAll("'",""));Mt(()=>{B.value=t.value.value});const ae=f(!1);be($,async(se,ke)=>{var De;if(!a.isUndefined(t.value.disabledByItemKey)){let He=u.stateStoredDisableKeyValue.find(at=>at.key==t.value.disabledByItemKey);if(a.isUndefined(He)){const at=await u.getValueFromItemKey(t.value.disabledByItemKey);u.pushStoredDisabledItems({key:t.value.disabledByItemKey,value:at})}He=u.stateStoredDisableKeyValue.find(at=>at.key==t.value.disabledByItemKey),(He==null?void 0:He.value)=="3"?(ae.value=!0,((De=e.task)==null?void 0:De.taskType)=="inline"&&t.value.value&&T("",!1)):ae.value=!1}se=="3"&&u.stateStoredDisableKeyValue.forEach(He=>{He.key==t.value.disabledByItemKey&&(He.value=se)})},{deep:!0});const G=i(()=>e.itemLoading);be(G,se=>{b.value=se});const Z=()=>{_.toggleYesVisible(!1),_.toggleNoVisible(!1),_.toggleViewNoVisible(!1),_.toggleViewYesVisible(!1),C.toggleYesVisible(!1),C.toggleNoVisible(!1),C.toggleViewNoVisible(!1),C.toggleViewYesVisible(!1),v.toggleIsVisible(!1),v.toggleIsViewVisible(!1)},ie=i(()=>{const se=e.item.caption.replace("[","").replace("]","").split("; "),ke=e.item.itemValue.replace("[","").replace("]","").split(", ");return se.map((He,at)=>({label:He.replaceAll("'",""),value:ke[at].replaceAll("'","")}))}),Ce=i(()=>{var Le,xt,Ht,Ge;const se=!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; `:"",ke=!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:"",De=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",He=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let at=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((Le=e.task)==null?void 0:Le.isShowAdjustmentRow)&&((xt=e.task)!=null&&xt.isShowAdjustmentRow))at="";else{let Rt=0;(Ht=e.task)==null||Ht.items.forEach(pt=>{var Ot;a.isUndefined(pt.style)||(a.isUndefined(pt.style.border)?a.isUndefined(pt.style.border)&&(Rt=Rt+Number(pt.style.breakPoint)):((pt.style.border.right=="none"||a.isUndefined(pt.style.border.right))&&(Rt=Rt+Number(pt.style.breakPoint)),a.isEqual(pt,a.last((Ot=e.task)==null?void 0:Ot.items))&&(Rt=Rt+Number(pt.style.breakPoint))))}),Rt==12&&(at=!((Ge=e.task.updatedBy)!=null&&Ge.name)&&!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const gt=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",ft=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",dt=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",St=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",it=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";return`${se}${ke}${De}${He}${at}${gt}${ft}${dt}${St}${it}`}),st=async()=>{var ke,De;const se=Xe.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await _.getDefectDetail((ke=u.selectedGroup)==null?void 0:ke.id,(De=r.value)==null?void 0:De.key),se.close()},Ke=async()=>{var ke,De;const se=Xe.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await C.getCrackDetail((ke=u.selectedGroup)==null?void 0:ke.id,(De=r.value)==null?void 0:De.key),se.close()},$t=async()=>{var ke,De;const se=Xe.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await v.getNADetail((ke=u.selectedGroup)==null?void 0:ke.id,(De=r.value)==null?void 0:De.key),se.close()},kt=async()=>{k.value=!1,_.cretateInstance(!0),_.toggleYesVisible(!0)},V=()=>{k.value=!1,_.cretateInstance(!1),_.toggleNoVisible(!0)},q=()=>{L.value=[],k.value=!1,t.value.value=B.value},fe=()=>{W.value=!1},Re=()=>{w.value=!1},Ne=i(()=>{var De;let se=!0;!a.isUndefined(r.value.updatedBy)&&!a.isUndefined(r.value.updatedBy.id)&&((De=r.value)==null?void 0:De.updatedBy.toString())!=""&&u.employee.id!=r.value.updatedBy.id&&(se=!1);let ke=!1;return($.value=="2"||$.value=="3"||$.value=="4")&&(ke=!0),!se||ke||ae.value||b.value}),Ae=se=>Ha(se),ut=i(()=>{let se="pb-2";return!a.isUndefined(e.task.updatedBy.name)&&e.task.updatedBy.name&&(se=""),se}),mt=i(()=>v.stateSuccessUpdateItemKey);be(mt,se=>{se==t.value.key&&!a.isUndefined(t.value.customValidation)&&t.value.customValidation.includes("normalTakePhoto")&&(u.setInputCameraMandatoryKey(t.value.key),D.value=!0)});const ct=i(()=>S.stateIsCameraError);return be(ct,async se=>{se&&u.stateInputCameraMandatoryKey==t.value.key&&(await T("",!1,!0),u.setInputCameraMandatoryKey(""))}),(se,ke)=>{var St,it,Le,xt,Ht;const De=ce("el-option"),He=ce("el-select"),at=ce("CBMDefectC"),gt=ce("CBMDefectX"),ft=ce("DefectConfirmationDialog"),dt=ce("TakePhoto");return d(),h(we,null,[l("div",{class:$e([[oe.value,z.value,ut.value],"px-2 pt-2 dropdown-eform-status"]),style:Se(Ce.value)},[l("div",bg,[(d(),re(He,{modelValue:$.value,"onUpdate:modelValue":ke[0]||(ke[0]=Ge=>$.value=Ge),placeholder:I.value,size:"small",class:$e(["w-100",M.value]),disabled:Ne.value,onChange:te,key:x.value},ns({default:ee(()=>[(d(!0),h(we,null,tt(ie.value,Ge=>(d(),re(De,{key:Ge,value:Ge.value},{default:ee(()=>[l("span",{innerHTML:Ge&&Ge.label?Ae(Ge&&Ge.label):""},null,8,kg)]),_:2},1032,["value"]))),128))]),_:2},[$.value?{name:"prefix",fn:ee(()=>[l("span",{class:"el-input__custom-option",innerHTML:me.value},null,8,hg)]),key:"0"}:void 0]),1032,["modelValue","placeholder","disabled","class"])),t.value.value==="2"&&((St=n.task)==null?void 0:St.category)=="NORMAL"?(d(),h("div",_g,[l("img",{src:Za,alt:"defect",class:"d-icon",onClick:st})])):E("",!0),t.value.value==="3"&&(((it=n.task)==null?void 0:it.category)=="NORMAL"||((Le=n.task)==null?void 0:Le.category)=="CBM")?(d(),h("div",{key:1,class:"ms-2",onClick:$t},Sg)):E("",!0),t.value.value==="2"&&((xt=n.task)==null?void 0:xt.category)=="CRACK"?(d(),h("div",{key:2,class:"ms-2",onClick:Ke},Rg)):E("",!0),t.value.value==="3"&&((Ht=n.task)==null?void 0:Ht.category)=="CRACK"?(d(),h("div",{key:3,class:"ms-2",onClick:Ke},Ug)):E("",!0),t.value.value==="4"?(d(),h("div",{key:4,class:"ms-2",onClick:$t},$g)):E("",!0)]),b.value?(d(),h("div",Pg,Bg)):E("",!0)],6),R(at,{show:W.value,onClose:fe},null,8,["show"]),R(gt,{show:w.value,onClose:Re},null,8,["show"]),k.value?(d(),re(ft,{key:0,show:k.value,"check-list-arr":L.value,onUpdateCheckList:H,onSubmit:F,onClose:q},null,8,["show","check-list-arr"])):E("",!0),R(dt,{show:D.value,onClose:U},null,8,["show"])],64)}}}),so=Ct(Ag,[["__scopeId","data-v-fdc2de2c"]]),Ng={key:0,class:"text-danger ps-2 font-weight-bold"},xg={key:1,class:"d-flex align-items-center"},Og=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),Lg=l("span",null,"Calculating...",-1),Eg=[Og,Lg],Fg={key:2,class:"d-flex align-items-center"},Mg=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Updating...")],-1),jg=l("span",null,"Updating...",-1),Hg=[Mg,jg],lo=Ue({__name:"Input",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},setup(n){const s=n,e=Me(s,"item"),o=Me(s,"task"),t=rt(),r=Jt(),g=Xa(),u=f(!1),_=f("");let C;const v=f(!1),c=f(!1),k=f(!1),P=_s();f("");const B=i(()=>{let V="";return!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.suffix)&&(V=e.value.style.suffix),V}),m=i(()=>{let V="Please Input";return(e.value.categoryItemType=="targetRating"||e.value.categoryItemType=="resultParamRating")&&(V=""),!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.placeholder)&&(V=e.value.style.placeholder),V});f(!1),f(!1);const b=f(!1),S=i(()=>s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),L=i(()=>{let V="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(V=`col-md-${e.value.style.potraitBreakPoint}`,V=`${V} col-lg-${e.value.style.breakPoint}`):(V=`col-md-${e.value.style.potraitBreakPoint}`,V=`${V} col-lg-${e.value.style.breakPoint}`)),V}),H=i(()=>{let V=!1;const q=e.value.categoryItemType;(q=="targetRating"||q=="resultParamRating")&&(V=!0);let fe=!1;return e.value.categoryItemType=="paramRatingDynamic"&&o.value.items.forEach(Re=>{Re.itemType=="dropDown"&&Re.categoryItemType=="dropdownTool"&&Re.value==""&&(fe=!0)}),V||s.task.isShowAdjustmentRow||fe||F.value}),F=f(!1),x=i(()=>{var q;let V="text";return(e.value.valueType=="int"||(q=e.value.customValidation)!=null&&q.toLowerCase().includes("percentage"))&&(V="numeric"),V}),p=i(()=>e.value.valueType=="int"),K=i(()=>{var V;return(V=e.value.customValidation)==null?void 0:V.toLowerCase().includes("percentage")}),X=i(()=>e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="paramRatingDynamic"),W=i(()=>!a.isUndefined(e.value.mappingKeyId)&&!a.isArray(e.value.mappingKeyId)),w=i({get:()=>e.value.value,set:async V=>{if(p.value||X.value||W.value){if(V.length>8)return;if((`${V}`.split(".")||[]).length-1>1)return;if(V.includes(".")){if(`${V}`.split(".")[1].length>2)return;e.value.value=V}if(V.length>5){if(V.length>=6&&V.length<=6){if(V[5]!=".")return;e.value.value=V}}else e.value.value}e.value.value=V,D()}}),D=()=>{if(!e.value.value)g.deleteParams(e.value.key);else{const V={keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:e.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};g.addUpdateParams(V)}},U=()=>{var V;if(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic"){if(!a.isUndefined(e.value.disabledByItemKey&&e.value.value=="")||a.isUndefined(e.value.customValidation)||!((V=e.value.customValidation)!=null&&V.toLowerCase().includes("required")))return!0;if(!ks(e.value.value))return _.value="max. 2 decimal digits",!1}return!0},I=async V=>{if(V!=ie.value){clearTimeout(C),e.value.value=V;let q=z();q&&(q=U()),q&&(_.value="",C=setTimeout(async()=>{if(s.task.category=="CBM"&&(e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic")?v.value=!0:(!a.isUndefined(e.value.mappingKeyId)&&a.isArray(e.value.mappingKeyId),k.value=!0),Ce(V)){const Re={keyValue:o.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:V},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};if(W.value)V!==""?await G(V):await me(Re,V);else{let Ne=!0;(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic")&&await M().then(Ae=>{Ne=Ae,!Ae&&t.ratingNotMapped}),Ne&&(await me(Re,V),ie.value=V,e.value.category=="cbmCalculateAvg"&&(t.setAvgTargetKey(e.value.targetCalculateKeyId),oe()))}}v.value=!1,k.value=!1,e.value.isCalculatingTrue=!1},0))}else _.value=""},z=()=>{var V;if((V=e.value.customValidation)!=null&&V.toLowerCase().includes("percentage")){const q=parseFloat(e.value.value);return isNaN(q)||q<0||q>100?(_.value="must be between 0 - 100",!1):(_.value=="must be between 0 - 100"&&(_.value=""),!0)}return _.value=="must be between 0 - 100"&&(_.value=""),!0},oe=async V=>{const q=e.value.mappingKeyId,fe=[];let Re;if(t.stateSelectedSubGroups.find(Ne=>Ne.taskGroup.some(Ae=>Ae.task.some(ut=>ut.items.some(mt=>(mt.key==e.value.targetCalculateKeyId&&(Re=mt),mt.key==e.value.targetCalculateKeyId))))),Re.isCalculatingTrue=!0,a.isArray(q)){for(let Ae=0;Ae<q.length;Ae++){const ut=await t.getValueFromItemKey(q[Ae]);fe.push(Number(ut))}let Ne=0;fe.forEach(Ae=>{Ne=Ne+Ae}),Ne=a.round(Ne/fe.length,2),t.stateSelectedSubGroups.find(Ae=>Ae.taskGroup.some(ut=>ut.task.some(mt=>mt.items.some(ct=>(ct.key==e.value.targetCalculateKeyId&&(Re=ct),ct.key==e.value.targetCalculateKeyId))))),Re.value=Ne}},me=async(V,q)=>{const fe=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:q},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]}];!a.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&fe.push(V),await t.updateServiceSheetTaskValue(fe,r.user.EmployeeId,r.user.Name)},M=async()=>{let V=!0;const q=s.task,fe=q.items.findIndex(Ae=>Ae.key==e.value.key)+1,Re=q.items[fe],Ne=q.items.find(Ae=>Ae.itemType==="smallCamera");return Re&&Ne&&t.setMeasurementValueAndUOM(e.value.value,Re.value,Ne.key),await t.getCBMResult(q,e.value).then(Ae=>{V=Ae.status,Ae.status&&(Ae.value&&!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhoto")&&(t.setInputCameraMandatoryKey(e.value.key),b.value=!0),(Ae.value=="A"||Ae.value=="B")&&!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating")&&(t.setInputCameraMandatoryKey(e.value.key),b.value=!0),(Ae.value=="C"||Ae.value=="X")&&(!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmDefectTakePhoto")||!a.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating"))&&(t.setInputCameraMandatoryKey(e.value.key),b.value=!0))}),V},te=i(()=>P.stateIsCameraError);be(te,async V=>{V&&t.stateInputCameraMandatoryKey==e.value.key&&(await I(""),t.setInputCameraMandatoryKey(""))});const T=i(()=>{const V=e.value.value.toString().replaceAll("'","");let q;return e.value.categoryItemType=="targetRating"&&(V=="A"?q="a":V=="B"?q="b":V=="C"?q="c":V=="X"&&(q="x")),q}),$=i(()=>{var ke,De,He,at;const V=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",q=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",fe=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",Re=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let Ne=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((ke=s.task)==null?void 0:ke.isShowAdjustmentRow)&&((De=s.task)!=null&&De.isShowAdjustmentRow))Ne="";else{let gt=0;(He=s.task)==null||He.items.forEach(ft=>{var dt;a.isUndefined(ft.style)||(a.isUndefined(ft.style.border)?a.isUndefined(ft.style.border)&&(gt=gt+Number(ft.style.breakPoint)):((ft.style.border.right=="none"||a.isUndefined(ft.style.border.right))&&(gt=gt+Number(ft.style.breakPoint)),a.isEqual(ft,a.last((dt=s.task)==null?void 0:dt.items))&&(gt=gt+Number(ft.style.breakPoint))))}),gt==12&&(Ne=!((at=s.task.updatedBy)!=null&&at.name)&&!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const Ae=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",ut=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",mt=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",ct=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",se=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${V}${q}${fe}${Re}${Ne}${Ae}${ut}${mt}${ct}${se}`}),ae=i(()=>{const V=e.value.categoryItemType=="targetRating";let q=!0;!a.isUndefined(o.value.updatedBy)&&!a.isUndefined(o.value.updatedBy.id)&&(t.employee.id==o.value.updatedBy.id?q=!0:q=!1);let fe=!0;!a.isUndefined(e.value.updatedBy)&&!a.isUndefined(e.value.updatedBy.id)&&(t.employee.id==e.value.updatedBy.id?fe=!0:fe=!1);let Re=!1;!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.visibility)&&e.value.style.visibility=="readonly"&&(Re=!0);let Ne=!0,Ae;return e.value.category=="cbmCalculateAvg"&&(t.stateSelectedSubGroups.find(ut=>ut.taskGroup.some(mt=>mt.task.some(ct=>ct.items.some(se=>(se.key==e.value.targetCalculateKeyId&&(Ae=se),se.key==e.value.targetCalculateKeyId))))),!a.isUndefined(Ae.updatedBy)&&!a.isUndefined(Ae.updatedBy.id)&&(t.employee.id==Ae.updatedBy.id?Ne=!0:Ne=!1)),V||!q||Re||!fe||!Ne}),G=async V=>{t.stateOilToleranceNotMapped?(c.value=!0,e.value.value=ie.value):await t.getValueFromItemKey(e.value.mappingKeyId).then(async q=>{if(q!=""){const fe=t.oilTolerance;let Re=fe.min,Ne=fe.max;fe.uom=="%"&&(Re=Number(q)*(Re/100),Ne=Number(q)*(Ne/100));const ut=Number(q)+Number(Re),mt=Number(q)+Number(Ne),ct=V>=ut,se=V<=mt;if(ct&&se){const ke={keyValue:o.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:V},{propertyName:"updatedBy",propertyValue:JSON.stringify(t.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};k.value=!1,await me(ke,V),ie.value=V}else _.value=`Range refill capacity is between ${ut} until ${mt}`,k.value=!1,u.value=!0,e.value.value=ie.value}})},Z=V=>{if(p.value||K.value||X.value||W.value){let q=V.keyCode?V.keyCode:V.which;K.value&&(V.target.value>100&&V.preventDefault(),V.target.value.includes(".")?V.target.value.split(".")[1].length>=2&&V.preventDefault():V.target.value.length>=3&&V.preventDefault()),(q<48||q>57)&&q!=46&&V.preventDefault()}},ie=f("");Mt(async()=>{ie.value=e.value.value,w.value=e.value.value,await Ke()}),Ja(()=>{e.value={}});const Ce=V=>{if(e.value.valueType=="int"){const q=V.split(".");let fe=!1,Re=q[0].length>5;return q[1]&&(fe=q[1].length>2),Re||fe?(_.value="max input length is 5 digits and 2 number after .",!1):!0}else return!0},st=i(()=>e.value.isCalculatingTrue);be(st,(V,q)=>{V&&(v.value=!0)});const Ke=async()=>{var V;if(!a.isUndefined(e.value.disabledByItemKey)){let q=t.stateStoredDisableKeyValue.find(fe=>fe.key==e.value.disabledByItemKey);if(a.isUndefined(q)){const fe=await t.getValueFromItemKey(e.value.disabledByItemKey);t.pushStoredDisabledItems({key:e.value.disabledByItemKey,value:fe})}q=t.stateStoredDisableKeyValue.find(fe=>fe.key==e.value.disabledByItemKey),(q==null?void 0:q.value)=="3"?(F.value=!0,e.value.value&&((V=s.task)==null?void 0:V.taskType)=="inline"&&await I("")):F.value=!1}},$t=i(()=>s.itemLoading);be($t,V=>{k.value=V}),be(w,async(V,q)=>{V==""&&(ie.value=""),e.value.categoryItemType&&e.value.categoryItemType=="resultParamRating"&&e.value.key==t.stateAvgTargetKey&&V!=q&&I(V),await Ke()},{deep:!0}),be(s.item,(V,q)=>{e.value=V},{deep:!0});const kt=i(()=>{let V="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(V=""),V});return(V,q)=>{const fe=ce("el-input");return d(),h("div",{class:$e([[S.value,L.value,kt.value],"px-2 pt-2 input-eform-status"]),style:Se($.value)},[R(fe,{class:$e([T.value,B.value!=""?"service-sheet-input":""]),modelValue:w.value,"onUpdate:modelValue":q[0]||(q[0]=Re=>w.value=Re),size:"small",placeholder:m.value,readonly:ae.value,onKeypress:Z,inputmode:x.value,disabled:H.value},ns({_:2},[B.value!=""?{name:"append",fn:ee(()=>[Ee(ue(B.value),1)]),key:"0"}:void 0]),1032,["class","modelValue","placeholder","readonly","inputmode","disabled"]),_.value!=""?(d(),h("label",Ng,ue(_.value),1)):E("",!0),v.value?(d(),h("div",xg,Eg)):E("",!0),k.value?(d(),h("div",Fg,Hg)):E("",!0)],6)}}}),Kg=["disabled"],Gg=["src"],qg={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},Wg={class:"text-white"},oo=Ue({__name:"SmallCamera",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(n){const s=n,e=Me(s,"item"),o=f(!1),t=Me(s,"task"),r=es(),g=_s(),u=Jt(),_=Ye(()=>s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),C=Ye(()=>{let w="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(w=`col-md-${e.value.style.potraitBreakPoint} col-lg-${e.value.style.breakPoint}`),w}),v=Ye(()=>e.value.value?yt(e.value.value):[]),c=()=>{g.toggleIsVisible(!0,e.value.key)},k=Ye(()=>a.cloneDeep(g.ImageObjects.find(w=>w.Id===e.value.key))),P=()=>{var D;let w="/media/svg/dma/camera/e-form/png/cam-active.png";return(D=s.task)!=null&&D.updatedBy&&e.value.updatedBy&&(s.task.updatedBy.id==r.employee.id?v.value.length>0&&(w="/media/svg/dma/camera/e-form/png/cam-user.png"):w="/media/svg/dma/camera/e-form/png/cam-read.png"),w},B=Ye(()=>{let w=!1;return v.value.length==1&&(w=!0),!X.value&&!w}),m=()=>{o.value=!0},b=()=>{o.value=!1},S=Ye(()=>{var $,ae,G;const w=!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",D=!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",U=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",I=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let z=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined(($=s.task)==null?void 0:$.isShowAdjustmentRow)&&((ae=s.task)!=null&&ae.isShowAdjustmentRow))z="";else{let Z=0;(G=s.task)==null||G.items.forEach(ie=>{var Ce;a.isUndefined(ie.style)||(a.isUndefined(ie.style.border)?a.isUndefined(ie.style.border)&&(Z=Z+Number(ie.style.breakPoint)):((ie.style.border.right=="none"||a.isUndefined(ie.style.border.right))&&(Z=Z+Number(ie.style.breakPoint)),a.isEqual(ie,a.last((Ce=s.task)==null?void 0:Ce.items))&&(Z=Z+Number(ie.style.breakPoint))))}),Z==12&&(z=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const oe=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",me=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",M=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",te=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",T=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${w}${D}${U}${I}${z}${oe}${me}${M}${te}${T}`}),L=async w=>{e.value.value=yt(e.value.value);const D=e.value.value;e.value.value=D.filter(U=>U.filename!=w),g.setCurrent(e.value.key),await H(),e.value.value.length==0&&b(),g.clearCurrent()},H=async()=>{const w={keyValue:t.value.key,propertyParams:[{propertyName:"updatedBy",propertyValue:JSON.stringify(r.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]},D=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:JSON.stringify(e.value.value)},{propertyName:"updatedBy",propertyValue:JSON.stringify(r.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}];!a.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&D.push(w),r.updateServiceSheetTaskValue(D,u.user.EmployeeId,u.user.Name)},F=f(!1),x=()=>{F.value=!1},p=()=>{F.value=!1,c()},K=async()=>{e.value.value==""&&(e.value.value=[]);let w=[];k.value&&(w=yt(k.value.ImageInfos));const D=yt(e.value.value),U=w.filter(I=>!D.includes(I));e.value.value=yt(e.value.value),e.value.value=[...e.value.value,...U],await H(),F.value=!0},X=Ye(()=>{var D;let w=!0;return(D=t.value)!=null&&D.updatedBy&&r.employee.id!=t.value.updatedBy.id&&(w=!1),!w});be(k,async(w,D)=>{!a.isUndefined(w)&&w.ImageInfos.length>0&&w.ImageInfos.length!=(D==null?void 0:D.ImageInfos.length)&&await K()},{deep:!0});const W=Ye(()=>{var D;let w="pb-2";return(D=s.task)!=null&&D.updatedBy&&s.task.updatedBy.name&&(w=""),w});return(w,D)=>(d(),h("div",{class:$e([[J(_),J(C),J(W)],"pt-2"]),style:Se(J(S))},[l("div",{class:$e(["row",!J(a.isUndefined)(e.value.value)&&e.value.value.length>0?"justify-content-around":"justify-content-center"])},[l("div",{class:$e(["d-flex justify-content-center",!J(a.isUndefined)(e.value.value)&&e.value.value.length>0?"col-6 pe-0 ps-1":"col-6 px-0"])},[l("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:c,disabled:J(X)},[l("img",{src:P(),style:{height:"12px",width:"14px"},alt:"photo"},null,8,Gg)],8,Kg)],2),J(v)&&J(v).length>0?(d(),h("div",qg,[l("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:m,style:{"background-color":"#18AF4A"}},[l("label",Wg,"+"+ue(J(v).length),1)])])):E("",!0)],2),o.value?(d(),re(kr,{key:0,type:"task","re-render":!1,images:J(v),"show-delete-button":J(B),"is-mandatory":!0,visibility:o.value,"is-monitoring":!J(B),"show-mandatory-caption":!0,onOnClose:b,onOnDelete:L},null,8,["images","show-delete-button","visibility","is-monitoring"])):E("",!0),R(Dl,{visibility:F.value,caption:"The photo successfully taken, would you like to take another photo?",onOnNoConfirm:x,onOnYesConfirm:p},null,8,["visibility"])],6))}}),Jg={class:"p-2"},Yg={class:"form-check checkbox-success item-checkbox"},ro=Ue({__name:"CheckBox",props:{item:{type:Object,required:!0},task:{type:Object},generalStyle:{type:Boolean,default:!0}},setup(n){const s=n,e=Xa(),o=rt(),t=Me(s,"item"),r=Me(s,"task"),g=i({get:()=>JSON.parse(s.item.value),set:async c=>{t.value.value=="false"?t.value.value="true":t.value.value="false",console.log("perubahan status radio",t.value.value),e.updateValidationValue({key:t.value.key,value:t.value.value});const k={keyValue:t.value.key,propertyParams:[{propertyName:"value",propertyValue:t.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};t.value.value?e.addUpdateParams(k):e.deleteParams(t.value.key);const P={keyValue:r.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:t.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};t.value.isTaskValue&&(t.value.value?e.addUpdateParams(P):e.deleteParams(r.value.key))}}),u=i(()=>!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col"),_=i(()=>{let c="";return s.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(c=`col-md-${t.value.style.potraitBreakPoint}`,c=`${c} col-lg-${t.value.style.breakPoint}`):(c=`col-md-${t.value.style.potraitBreakPoint}`,c=`${c} col-lg-${t.value.style.breakPoint}`)),c}),C=i(()=>{var x,p,K,X;const c=!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; `:"",k=!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:"",P=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",B=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let m=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((x=s.task)==null?void 0:x.isShowAdjustmentRow)&&((p=s.task)!=null&&p.isShowAdjustmentRow))m="";else{let W=0;(K=s.task)==null||K.items.forEach(w=>{var D;a.isUndefined(w.style)||(a.isUndefined(w.style.border)?a.isUndefined(w.style.border)&&(W=W+Number(w.style.breakPoint)):((w.style.border.right=="none"||a.isUndefined(w.style.border.right))&&(W=W+Number(w.style.breakPoint)),a.isEqual(w,a.last((D=s.task)==null?void 0:D.items))&&(W=W+Number(w.style.breakPoint))))}),W==12&&(m=!((X=s.task.updatedBy)!=null&&X.name)&&!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const b=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",S=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",L=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",H=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",F=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";return`${c}${k}${P}${B}${m}${b}${S}${L}${H}${F}`}),v=i(()=>{let c="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(c=""),c});return(c,k)=>(d(),h("div",{class:$e([[_.value,u.value,v.value],"pt-2 px-2 d-flex align-items-center d-flex justify-content-center"]),style:Se(C.value)},[l("div",Jg,[l("div",Yg,[Nt(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=P=>g.value=P)},null,512),[[Ya,g.value]])])])],6))}}),no=Ue({__name:"InteractiveButton",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(n){const s=n,e=Me(s,"item"),o=Me(s,"task"),t=i(()=>s.generalStyle?!a.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),r=i(()=>!a.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:""),g=i(()=>!a.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; border-color: ${e.value.style.bgColor};`:""),u=es(),_=i(()=>{let m="";return s.task.isShowAdjustmentRow&&(m="opacity: 50%;"),C.value&&(m="opacity: 50%;"),m}),C=i(()=>{const m=s.task.taskValue=="",b=s.task.taskValue=="A"||s.task.taskValue=="B";let S=!0;return!a.isUndefined(s.task.updatedBy)&&!a.isUndefined(s.task.updatedBy.id)&&(u.employee.id==s.task.updatedBy.id?S=!0:S=!1),m||b||s.task.isShowAdjustmentRow||!S}),v=i(()=>{let m="";return s.generalStyle&&!a.isUndefined(e.value.style)&&(!a.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(m=`col-md-${e.value.style.potraitBreakPoint}`,m=`${m} col-lg-${e.value.style.breakPoint}`):(m=`col-md-${e.value.style.potraitBreakPoint}`,m=`${m} col-lg-${e.value.style.breakPoint}`)),m}),c=i(()=>a.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),k=i(()=>{var K,X,W,w;const m=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",b=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let S=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((K=s.task)==null?void 0:K.isShowAdjustmentRow)&&((X=s.task)!=null&&X.isShowAdjustmentRow))S="";else{let D=0;(W=s.task)==null||W.items.forEach(U=>{var I;a.isUndefined(U.style)||(a.isUndefined(U.style.border)?a.isUndefined(U.style.border)&&(D=D+Number(U.style.breakPoint)):((U.style.border.right=="none"||a.isUndefined(U.style.border.right))&&(D=D+Number(U.style.breakPoint)),a.isEqual(U,a.last((I=s.task)==null?void 0:I.items))&&(D=D+Number(U.style.breakPoint))))}),D==12&&(S=!((w=s.task.updatedBy)!=null&&w.name)&&!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const L=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",H=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",F=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",x=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",p=!a.isUndefined(e.value.style)&&!a.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${m}${b}${S}${L}${H}${F}${x}${p}`}),P=()=>{e.value.value=="Adjustment"&&(o.value.isShowAdjustmentRow=!0)},B=i(()=>{let m="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(m=""),m});return(m,b)=>{const S=ce("el-button");return d(),h("div",{class:$e([[t.value,c.value,v.value,B.value],"px-2 pt-2"]),style:Se(k.value)},[!J(a.isUndefined)(n.item.style)&&n.item.style.visibility!="hidden"?(d(),re(S,{key:0,style:Se([r.value,g.value,_.value]),size:"small",type:"success",onClick:P,class:"item-button w-100",disabled:C.value},{default:ee(()=>[Ee(ue(n.item.value),1)]),_:1},8,["style","disabled"])):E("",!0)],6)}}}),zg={class:"row w-100"},Xg=l("div",{class:"col-1 pb-1 px-2"},null,-1),Qg={key:0,class:"d-flex align-items-center"},Zg=l("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[l("span",{class:"sr-only"},"Loading...")],-1),eb=l("span",null,"Loading...",-1),tb=[Zg,eb],ab={class:"row justify-content-center"},sb={class:"px-0 col-6 d-flex justify-content-center"},lb=["disabled"],ob=["src"],rb={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},nb={class:"text-white"},ib={key:0,class:"row w-100"},ub=Ue({__name:"TaskAdjustment",props:{task:{type:Object,required:!0}},setup(n){const s=n,e=async U=>{const I=o.value.adjustment.pictures;o.value.adjustment.pictures=I.filter(z=>z!=U),b.setCurrent(`${o.value.key}-adjustment`),b.clearCurrent(),await B.addCBMAdjustmentPictures(o.value),o.value.adjustment.pictures.length==0},o=Me(s,"task"),t=f(!1),r=qa(),g=i(()=>o.value.adjustment.pictures),u=i(()=>{let U=!0;return!a.isUndefined(o.value.updatedBy)&&!a.isUndefined(o.value.updatedBy.id)&&(B.employee.id==o.value.updatedBy.id?U=!0:U=!1),!U}),_=()=>{t.value=!1},C=()=>{t.value=!0},v=i(()=>{let U="";return s.task.items.forEach(I=>{!a.isUndefined(I.style)&&!a.isUndefined(I.style.border)&&I.style.border.left!="none"&&(U=I.style.border.left)}),U}),c=i(()=>{let U="",I=!1;return o.value.items.forEach(z=>{!a.isUndefined(z.style)&&!a.isUndefined(z.style.border)&&z.style.border.bottom!="none"&&(I=!0)}),(o.value.adjustment.updatedBy.name==""||a.isUndefined(o.value.adjustment.updatedBy.name)&&I)&&(U=`border-bottom: ${v.value}`),U}),k=i(()=>{let U=!1;o.value.items.forEach(z=>{!a.isUndefined(z.style)&&!a.isUndefined(z.style.border)&&z.style.border.bottom!="none"&&(U=!0)});let I="";return o.value.adjustment.updatedBy.name!=""&&U&&(I=`border-bottom: ${v.value}`),I}),P=U=>{let I=U.keyCode?U.keyCode:U.which;(I<48||I>57)&&I!=46&&U.preventDefault()},B=es(),m=f(!1),b=_s(),S=f(!1),L=()=>{var I,z;let U="/media/svg/dma/camera/e-form/png/cam-active.png";return a.isUndefined((I=s.task.adjustment.updatedBy)==null?void 0:I.id)||((z=s.task.adjustment.updatedBy)==null?void 0:z.id)==B.employee.id&&o.value.adjustment.pictures.length>0&&(U="/media/svg/dma/camera/e-form/png/cam-user.png"),u.value&&(U="/media/svg/dma/camera/e-form/png/cam-read.png"),U},H=async U=>{let I=U.target.value;if(!u.value){if(!r.stateConnectionStatus){r.setSubmitConnectionError(!0),o.value.adjustment.measurement=w.value;return}if(console.log("val",I,"value old",w.value),I&&I!=w.value){S.value=!0,o.value.adjustment.measurement=I;const z=await B.getAdjusmentRating(o.value);S.value=!1,(z=="C"||z=="X")&&(m.value=!0),w.value=I}}},F=()=>{b.toggleIsVisible(!0,`${o.value.key}-adjustment`),m.value=!1},x=async()=>{if(o.value.adjustment.measurement){const U=Xe.service({lock:!0,text:"Deleting Adjustment",background:"rgba(0, 0, 0, 0.7)"});await B.deleteAdjusmentTask(o.value),U.close(),b.setCurrent(`${o.value.key}-adjustment`),b.clearCurrent()}o.value.isShowAdjustmentRow=!1},p=i(()=>{const U=o.value.adjustment.rating;let I;return U=="A"?I="a":U=="B"?I="b":U=="C"?I="c":U=="X"&&(I="x"),I}),K=i(()=>a.cloneDeep(b.ImageObjects.find(U=>U.Id===`${o.value.key}-adjustment`))),X=f(!1),W=()=>{const U=K.value.ImageInfos,I=o.value.adjustment.pictures,z=U.filter(oe=>!I.includes(oe));o.value.adjustment.pictures=[...o.value.adjustment.pictures,...z],B.addCBMAdjustmentPictures(o.value),X.value=!0};be(K,async(U,I)=>{!a.isUndefined(U)&&U.ImageInfos.length>0&&U.ImageInfos.length!=(I==null?void 0:I.ImageInfos.length)&&await W()},{deep:!0});const w=f(""),D=f("");return Mt(()=>{w.value=o.value.adjustment.measurement,D.value=o.value.adjustment.measurement}),(U,I)=>{const z=ce("el-input"),oe=ce("el-button");return d(),h(we,null,[l("div",zg,[Xg,l("div",{class:"col-1 pb-1 px-2",style:Se([`border-left: ${v.value}`,c.value])},null,4),l("div",{class:"col-4 col-md-3 pb-1 px-2",style:Se([c.value])},ue(n.task.adjustment.description),5),l("div",{class:"col-2 pb-1 px-2",style:Se([c.value])},[R(z,{modelValue:o.value.adjustment.measurement,"onUpdate:modelValue":I[0]||(I[0]=me=>o.value.adjustment.measurement=me),modelModifiers:{lazy:!0},size:"small",placeholder:"Please Input",onKeypress:P,onFocusout:H,inputmode:"numeric",readonly:u.value},null,8,["modelValue","readonly"]),S.value?(d(),h("div",Qg,tb)):E("",!0)],4),l("div",{class:"col-1 pb-1 px-2",style:Se([c.value])},ue(n.task.adjustment.uom),5),l("div",{class:"col-1 col-md-1 pb-1 px-2 input-eform-status",style:Se([c.value])},[R(z,{modelValue:o.value.adjustment.rating,"onUpdate:modelValue":I[1]||(I[1]=me=>o.value.adjustment.rating=me),modelModifiers:{lazy:!0},size:"small",disabled:"",class:$e(p.value)},null,8,["modelValue","class"])],4),l("div",{class:"col-1 col-md-1 pb-1 px-2",style:Se([c.value])},[l("div",ab,[l("div",sb,[l("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:F,disabled:u.value},[l("img",{src:L(),style:{height:"12px",width:"14px"}},null,8,ob)],8,lb)]),o.value.adjustment.pictures.length>0?(d(),h("div",rb,[l("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:C,style:{"background-color":"#18AF4A"}},[l("label",nb,"+"+ue(o.value.adjustment.pictures.length),1)])])):E("",!0)])],4),l("div",{class:"col-2 pb-1 px-2",style:Se([`border-right: ${v.value}`,c.value])},[R(oe,{disabled:u.value,type:"danger",size:"small",class:"item-button w-100",onClick:x},{default:ee(()=>[Ee("Delete")]),_:1},8,["disabled"])],4)]),n.task.adjustment.updatedBy.name?(d(),h("div",ib,[l("div",{class:"d-flex justify-content-end py-1 col-11 offset-1 timestamp-task",style:Se([`border-left: ${v.value}; border-right: ${v.value}`,k.value])},ue(n.task.adjustment.updatedBy.name)+", "+ue(n.task.adjustment.updatedDate),5)])):E("",!0),t.value?(d(),re(Ma,{key:1,images:g.value,visibility:t.value,showDeleteButton:!u.value,onHandleClose:_,onHandleDelete:e},null,8,["images","visibility","showDeleteButton"])):E("",!0)],64)}}}),db=n=>(Yt("data-v-e2e15a46"),n=n(),zt(),n),cb={class:"px-2 w-100"},mb={class:"form-check checkbox-success item-checkbox w-100 ps-0 d-flex"},fb={class:"ms-1 d-flex align-items-center"},vb={key:0,class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},pb=db(()=>l("span",{class:"sr-only"},"Loading...",-1)),yb=[pb],gb={key:1},bb={class:"ms-2 flex-fill text-start"},kb=Ue({__name:"RadioButtonWithStatus",props:{item:{type:Object,required:!0},task:{type:Object},generalStyle:{type:Boolean,default:!0}},setup(n){const s=n,e=Xa(),o=rt(),t=Me(s,"item"),r=Me(s,"task"),g=f(!1),u=()=>{t.value.value?t.value.value="":t.value.value="true",console.log("perubahan status radio",t.value.value),e.updateValidationValue({key:t.value.key,value:t.value.value});const P={keyValue:t.value.key,propertyParams:[{propertyName:"value",propertyValue:t.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};t.value.value?e.addUpdateParams(P):e.deleteParams(t.value.key);const B={keyValue:r.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:t.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};t.value.isTaskValue&&(t.value.value?e.addUpdateParams(B):e.deleteParams(r.value.key))},_=i(()=>!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col"),C=i(()=>{let P="";return s.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(P=`col-md-${t.value.style.potraitBreakPoint}`,P=`${P} col-lg-${t.value.style.breakPoint}`):(P=`col-md-${t.value.style.potraitBreakPoint}`,P=`${P} col-lg-${t.value.style.breakPoint}`)),P}),v=i(()=>{var K,X,W,w;const P=!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; `:"",B=!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:"",m=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",b=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let S=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((K=s.task)==null?void 0:K.isShowAdjustmentRow)&&((X=s.task)!=null&&X.isShowAdjustmentRow))S="";else{let D=0;(W=s.task)==null||W.items.forEach(U=>{var I;a.isUndefined(U.style)||(a.isUndefined(U.style.border)?a.isUndefined(U.style.border)&&(D=D+Number(U.style.breakPoint)):((U.style.border.right=="none"||a.isUndefined(U.style.border.right))&&(D=D+Number(U.style.breakPoint)),a.isEqual(U,a.last((I=s.task)==null?void 0:I.items))&&(D=D+Number(U.style.breakPoint))))}),D==12&&(S=!((w=s.task.updatedBy)!=null&&w.name)&&!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const L=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",H=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",F=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",x=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",p=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";return`${P}${B}${m}${b}${S}${L}${H}${F}${x}${p}`}),c=i(()=>{let P="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(P=""),P}),k=i(()=>{let P="Not Complete";return t.value.value=="true"&&(P="Complete"),P});return(P,B)=>(d(),h("div",{class:$e([[_.value,C.value,c.value],"pt-2 px-2 d-flex d-flex justify-content-center"]),style:Se(v.value)},[l("div",cb,[l("div",mb,[l("div",{class:$e(["little-box rounded-circle d-flex flex-column justify-content-center cbm-confirm-checkbox","dot"])},[t.value.value?(d(),h("img",{key:1,src:hr,style:{width:"28px"},onClick:B[1]||(B[1]=m=>u()),alt:""})):(d(),h("div",{key:0,class:"little-dot",onClick:B[0]||(B[0]=m=>u())})),l("div",fb,[g.value?(d(),h("div",vb,yb)):E("",!0),g.value?(d(),h("span",gb,"Loading...")):E("",!0)])]),l("span",bb,ue(k.value),1)])])],6))}}),hb=Ct(kb,[["__scopeId","data-v-e2e15a46"]]),_b=Ue({__name:"TextAreaInput",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},setup(n){const s=n,e=rt(),o=Xa(),t=Me(s,"item"),r=Me(s,"task"),g=f(""),u=i({get:()=>t.value.value,set:async m=>{t.value.value=m,_()}}),_=()=>{if(!t.value.value)o.deleteParams(t.value.key);else{const m={keyValue:t.value.key,propertyParams:[{propertyName:"value",propertyValue:t.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(e.employee)},{propertyName:"updatedDate",propertyValue:Ua()}]};o.addUpdateParams(m)}},C=i(()=>{let m="";return s.generalStyle&&!a.isUndefined(t.value.style)&&(!a.isUndefined(t.value.style.potraitBreakPoint)&&t.value.style.breakPoint!="none"?(m=`col-md-${t.value.style.potraitBreakPoint}`,m=`${m} col-lg-${t.value.style.breakPoint}`):(m=`col-md-${t.value.style.potraitBreakPoint}`,m=`${m} col-lg-${t.value.style.breakPoint}`)),m}),v=i(()=>{const m=t.value.categoryItemType=="targetRating";let b=!0;!a.isUndefined(r.value.updatedBy)&&!a.isUndefined(r.value.updatedBy.id)&&(e.employee.id==r.value.updatedBy.id?b=!0:b=!1);let S=!0;!a.isUndefined(t.value.updatedBy)&&!a.isUndefined(t.value.updatedBy.id)&&(e.employee.id==t.value.updatedBy.id?S=!0:S=!1);let L=!1;!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.visibility)&&t.value.style.visibility=="readonly"&&(L=!0);let H=!0,F;return t.value.category=="cbmCalculateAvg"&&(e.stateSelectedSubGroups.find(x=>x.taskGroup.some(p=>p.task.some(K=>K.items.some(X=>(X.key==t.value.targetCalculateKeyId&&(F=X),X.key==t.value.targetCalculateKeyId))))),!a.isUndefined(F.updatedBy)&&!a.isUndefined(F.updatedBy.id)&&(e.employee.id==F.updatedBy.id?H=!0:H=!1)),m||!b||L||!S||!H}),c=i(()=>s.generalStyle?!a.isUndefined(t.value.style)&&t.value.style.breakPoint!="none"?`col-${t.value.style.breakPoint}`:"col":""),k=i(()=>{let m="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(m=""),m}),P=i(()=>{var W,w,D,U;const m=!a.isUndefined(t.value.style)&&t.value.style.bgColor!="none"?`background-color: ${t.value.style.bgColor}; `:"",b=!a.isUndefined(t.value.style)&&t.value.style.fontColor!="none"?`color: ${t.value.style.fontColor}; `:"",S=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.top!="none"?`border-top: ${t.value.style.border.top}; `:"",L=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.right!="none"?`border-right: ${t.value.style.border.right}; `:"";let H=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((W=s.task)==null?void 0:W.isShowAdjustmentRow)&&((w=s.task)!=null&&w.isShowAdjustmentRow))H="";else{let I=0;(D=s.task)==null||D.items.forEach(z=>{var oe;a.isUndefined(z.style)||(a.isUndefined(z.style.border)?a.isUndefined(z.style.border)&&(I=I+Number(z.style.breakPoint)):((z.style.border.right=="none"||a.isUndefined(z.style.border.right))&&(I=I+Number(z.style.breakPoint)),a.isEqual(z,a.last((oe=s.task)==null?void 0:oe.items))&&(I=I+Number(z.style.breakPoint))))}),I==12&&(H=!((U=s.task.updatedBy)!=null&&U.name)&&!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.bottom!="none"?`border-bottom: ${t.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const F=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.border)&&t.value.style.border.left!="none"?`border-left: ${t.value.style.border.left}; `:"",x=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${t.value.style.borderRadius.topRight}; `:"",p=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${t.value.style.borderRadius.bottomRight}; `:"",K=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${t.value.style.borderRadius.topLeft}; `:"",X=!a.isUndefined(t.value.style)&&!a.isUndefined(t.value.style.borderRadius)&&t.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${t.value.style.borderRadius.bottomLeft}; `:"";return`${m}${b}${S}${L}${H}${F}${x}${p}${K}${X}`}),B=m=>{if(v.value)return;const b=m.target.value;t.value.value=b};return Mt(async()=>{g.value=t.value.value,u.value=t.value.value}),(m,b)=>{const S=ce("el-input");return d(),h("div",{class:$e([[c.value,C.value,k.value],"px-2 pt-2 input-eform-status"]),style:Se(P.value)},[R(S,{modelValue:u.value,"onUpdate:modelValue":b[0]||(b[0]=L=>u.value=L),rows:5,type:"textarea",placeholder:"Please input",onFocusout:B},null,8,["modelValue"])],6)}}}),wb={class:"form-floating"},Sb=Ue({__name:"InputWithPlaceholder",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},setup(n){const s=n,e=es(),o=Me(s,"item"),t=Me(s,"task"),r=f(""),g=i({get:()=>o.value.value,set:async k=>{o.value.value=k}}),u=i(()=>{let k="";return s.generalStyle&&!a.isUndefined(o.value.style)&&(!a.isUndefined(o.value.style.potraitBreakPoint)&&o.value.style.breakPoint!="none"?(k=`col-md-${o.value.style.potraitBreakPoint}`,k=`${k} col-lg-${o.value.style.breakPoint}`):(k=`col-md-${o.value.style.potraitBreakPoint}`,k=`${k} col-lg-${o.value.style.breakPoint}`)),k});i(()=>{const k=o.value.categoryItemType=="targetRating";let P=!0;!a.isUndefined(t.value.updatedBy)&&!a.isUndefined(t.value.updatedBy.id)&&(e.employee.id==t.value.updatedBy.id?P=!0:P=!1);let B=!0;!a.isUndefined(o.value.updatedBy)&&!a.isUndefined(o.value.updatedBy.id)&&(e.employee.id==o.value.updatedBy.id?B=!0:B=!1);let m=!1;!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.visibility)&&o.value.style.visibility=="readonly"&&(m=!0);let b=!0,S;return o.value.category=="cbmCalculateAvg"&&(e.stateSelectedSubGroups.find(L=>L.taskGroup.some(H=>H.task.some(F=>F.items.some(x=>(x.key==o.value.targetCalculateKeyId&&(S=x),x.key==o.value.targetCalculateKeyId))))),!a.isUndefined(S.updatedBy)&&!a.isUndefined(S.updatedBy.id)&&(e.employee.id==S.updatedBy.id?b=!0:b=!1)),k||!P||m||!B||!b});const _=i(()=>s.generalStyle?!a.isUndefined(o.value.style)&&o.value.style.breakPoint!="none"?`col-${o.value.style.breakPoint}`:"col":""),C=i(()=>{let k="pb-2";return!a.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(k=""),k}),v=i(()=>{var p,K,X,W;const k=!a.isUndefined(o.value.style)&&o.value.style.bgColor!="none"?`background-color: ${o.value.style.bgColor}; `:"",P=!a.isUndefined(o.value.style)&&o.value.style.fontColor!="none"?`color: ${o.value.style.fontColor}; `:"",B=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.border)&&o.value.style.border.top!="none"?`border-top: ${o.value.style.border.top}; `:"",m=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.border)&&o.value.style.border.right!="none"?`border-right: ${o.value.style.border.right}; `:"";let b=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.border)&&o.value.style.border.bottom!="none"?`border-bottom: ${o.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!a.isUndefined((p=s.task)==null?void 0:p.isShowAdjustmentRow)&&((K=s.task)!=null&&K.isShowAdjustmentRow))b="";else{let w=0;(X=s.task)==null||X.items.forEach(D=>{var U;a.isUndefined(D.style)||(a.isUndefined(D.style.border)?a.isUndefined(D.style.border)&&(w=w+Number(D.style.breakPoint)):((D.style.border.right=="none"||a.isUndefined(D.style.border.right))&&(w=w+Number(D.style.breakPoint)),a.isEqual(D,a.last((U=s.task)==null?void 0:U.items))&&(w=w+Number(D.style.breakPoint))))}),w==12&&(b=!((W=s.task.updatedBy)!=null&&W.name)&&!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.border)&&o.value.style.border.bottom!="none"?`border-bottom: ${o.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const S=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.border)&&o.value.style.border.left!="none"?`border-left: ${o.value.style.border.left}; `:"",L=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${o.value.style.borderRadius.topRight}; `:"",H=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${o.value.style.borderRadius.bottomRight}; `:"",F=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${o.value.style.borderRadius.topLeft}; `:"",x=!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${o.value.style.borderRadius.bottomLeft}; `:"";return`${k}${P}${B}${m}${b}${S}${L}${H}${F}${x}`}),c=i(()=>{let k="Please Input";return!a.isUndefined(o.value.style)&&!a.isUndefined(o.value.style.placeholder)&&(k=o.value.style.placeholder),k});return Mt(async()=>{r.value=o.value.value,g.value=o.value.value}),(k,P)=>(d(),h("div",{class:$e([[_.value,u.value,C.value],"px-2 pt-2 input-eform-status"]),style:Se(v.value)},[l("div",wb,[Nt(l("input",{type:"text",class:"form-control",disabled:"","onUpdate:modelValue":P[0]||(P[0]=B=>g.value=B)},null,512),[[ss,g.value]]),l("label",null,ue(c.value),1)])],6))}}),Cb={key:1,class:"row w-100",style:{height:"25px"}},Rb=l("div",{class:"col-1"},null,-1),Tb=Ue({__name:"InlineTask",props:{task:{type:Object,required:!0},taskIndex:{type:Number,required:!0},taskGroup:{type:Array,required:!0}},setup(n){const s=n,e=i(()=>{let m=12,b=0;return s.task.items.every(S=>!a.isUndefined(S.style)&&S.style.visibility=="hidden"?(m=Number(m)-Number(S.style.breakPoint),b=Number(b)+Number(S.style.breakPoint),!0):!1),`col-${m} offset-${b}`}),o=f(""),t=f(""),r=i(()=>{let m=0;return s.task.items.forEach((b,S)=>{if(S+1==s.task.items.length&&b.itemType=="dropDown"){const L=s.task.items[S-1];!a.isUndefined(L.style)&&!a.isUndefined(L.style.border)&&L.style.border.right!="none"&&(s.task.items.length==3?m=Number(L.style.breakPoint)-1:s.task.items.forEach((H,F)=>{if(F>1&&F<=S-1){let x=0;if(!a.isUndefined(H.style.potraitBreakPoint))x=H.style.potraitBreakPoint;else{let p=0;H.style.breakPoint=="none"?(s.task.items.forEach((K,X)=>{K.style.breakPoint!="none"&&(p+=Number(K.style.breakPoint))}),x=12-p):x=H.style.breakPoint-p}m+=Number(x)}}))}}),m}),g=i(()=>{let m=0;return s.task.items.forEach((b,S)=>{if(S+1==s.task.items.length&&b.itemType=="dropDown"){const L=s.task.items[S-1];!a.isUndefined(L.style)&&!a.isUndefined(L.style.border)&&L.style.border.right!="none"&&(s.task.items.length==3?m=Number(L.style.breakPoint)-1:s.task.items.forEach((H,F)=>{if(F>1&&F<=S-1){let x=0,p=0;H.style.breakPoint=="none"?(s.task.items.forEach((K,X)=>{K.style.breakPoint!="none"&&(p+=Number(K.style.breakPoint))}),x=12-p):x=H.style.breakPoint-p,m+=Number(x)}}))}}),m}),u=i(()=>{let m=!1,b=!1,S=!1;return s.task.items.forEach((L,H)=>{if(H==1&&!a.isUndefined(L.style)&&!a.isUndefined(L.style.border)&&L.style.border.left!="none"&&(m=!0,o.value=L.style.border.left,!a.isUndefined(L.style)&&!a.isUndefined(L.style.border)&&L.style.border.bottom!="none"&&(S=!0)),H+1==s.task.items.length&&L.itemType=="dropDown"){const F=s.task.items[H-1];!a.isUndefined(F.style)&&!a.isUndefined(F.style.border)&&F.style.border.right!="none"&&(b=!0,t.value=F.style.border.right)}}),m&&b&&!S}),_=f(!1),C=m=>{_.value=m},v=i(()=>{let m=40;return _.value&&(m=60),m}),c=i(()=>{const m=s.task.items.find(F=>F.style.visibility!="hidden"),b=a.last(s.task.items),S=!a.isUndefined(b.style)&&!a.isUndefined(b.style.border)&&b.style.border.right!="none"?`border-right: ${b.style.border.right}; `:"",L=!a.isUndefined(m.style)&&!a.isUndefined(m.style.border)&&m.style.border.left!="none"?`border-left: ${m.style.border.left}; `:"",H=s.task.updatedBy.name&&!a.isUndefined(b.style)&&!a.isUndefined(b.style.border)&&b.style.border.bottom!="none"?"margin-bottom: 1rem; ":"";return S?`${S}${L}${H}`:`${H}`}),k=i(()=>{var S,L;let m="";const b=a.last(s.task.items);return!a.isUndefined((S=s.task)==null?void 0:S.isShowAdjustmentRow)&&((L=s.task)!=null&&L.isShowAdjustmentRow)?m="":m=s.task.updatedBy.name&&!a.isUndefined(b.style)&&!a.isUndefined(b.style.border)&&b.style.border.bottom!="none"?`border-bottom: ${b.style.border.bottom}; `:"",m}),P=i(()=>{let m="";return a.isUndefined(s.task.generalStyle)||(m=s.task.generalStyle),m}),B=i(()=>{let m="";const b=s.task.customStyle;return a.isUndefined(b)||b.split(" | ").forEach(L=>{L.includes("noteStyle")&&!a.isUndefined(s.taskGroup[s.taskIndex-1].updatedBy.name)&&s.taskGroup[s.taskIndex-1].updatedBy.name&&(m=`${m} ${L.split(" = ")[1]}`)}),m});return(m,b)=>(d(),h(we,null,[l("div",{class:"row w-100",style:Se([P.value,B.value])},[(d(!0),h(we,null,tt(s.task.items,S=>(d(),h(we,{key:S.key},[S.itemType==="image"?(d(),re(to,{key:0,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="label"?(d(),re(ao,{key:1,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="dropDown"?(d(),re(so,{key:2,item:S,task:n.task,onSetLoading:C},null,8,["item","task"])):E("",!0),S.itemType==="input"?(d(),re(lo,{key:3,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="smallCamera"?(d(),re(oo,{key:4,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="checkbox"?(d(),re(ro,{key:5,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="html"?(d(),re(Yl,{key:6,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="button"?(d(),re(no,{key:7,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="statusInfo"?(d(),re(hs,{key:8,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="radioButtonWithStatus"?(d(),re(hb,{key:9,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="textAreaInput"?(d(),re(_b,{key:10,item:S,task:n.task},null,8,["item","task"])):E("",!0),S.itemType==="inputWithPlaceholder"?(d(),re(Sb,{key:11,item:S,task:n.task},null,8,["item","task"])):E("",!0)],64))),128))],4),n.task.updatedBy.name?(d(),h("div",{key:0,class:"row w-100 position-absolute pe-3",style:Se(`top: ${v.value}px;`)},[l("div",{class:$e(["d-flex justify-content-end pb-1 my-0 timestamp-task",e.value]),style:Se([c.value,k.value])},null,6)],4)):E("",!0),n.task.updatedBy.name?(d(),h("div",Cb,[u.value?(d(),h(we,{key:1},[Rb,l("div",{class:"col-1",style:Se(`border-left: ${o.value}`)},null,4),l("div",{class:$e(`col-md-${r.value} col-lg-${g.value}`),style:Se(`border-right: ${t.value}`)},null,6)],64)):(d(),h("div",{key:0,style:Se(c.value),class:$e(e.value)},null,6))])):E("",!0),n.task.isShowAdjustmentRow?(d(),re(ub,{key:2,task:n.task},null,8,["task"])):E("",!0)],64))}}),Ub=Ue({__name:"TableRow",props:{item:{type:Object,required:!0},task:{type:Object},itemLoading:{type:Boolean,default:!1}},setup(n){const s=n,e=i(t=>{const r=[];for(const g in s.item)r.push(s.item[g]);return r}),o=t=>{let r="";return!a.isUndefined(t.style)&&!a.isUndefined(t.style.textvAlign)&&(r=`align-self-${t.style.textvAlign}`),r};return(t,r)=>(d(!0),h(we,null,tt(e.value,g=>(d(),h("div",{class:$e([o(g),"eform-table-row col px-0"]),key:g.key},[g.itemType==="image"?(d(),re(to,{key:0,item:g,task:n.task},null,8,["item","task"])):E("",!0),g.itemType==="label"?(d(),re(ao,{key:1,item:g,task:n.task},null,8,["item","task"])):E("",!0),g.itemType==="input"?(d(),re(lo,{key:2,item:g,task:n.task,"item-loading":n.itemLoading},null,8,["item","task","item-loading"])):E("",!0),g.itemType==="dropDown"?(d(),re(so,{key:3,item:g,task:n.task,"item-loading":n.itemLoading},null,8,["item","task","item-loading"])):E("",!0),g.itemType==="smallCamera"?(d(),re(oo,{key:4,item:n.item,task:n.task},null,8,["item","task"])):E("",!0),n.item.itemType==="checkbox"?(d(),re(ro,{key:5,item:n.item,task:n.task},null,8,["item","task"])):E("",!0),g.itemType==="html"?(d(),re(Bl,{key:6,item:g,task:n.task},null,8,["item","task"])):E("",!0),n.item.itemType==="button"?(d(),re(no,{key:7,item:n.item,task:n.task},null,8,["item","task"])):E("",!0),n.item.itemType==="statusInfo"?(d(),re(hs,{key:8,item:n.item,task:n.task},null,8,["item","task"])):E("",!0)],2))),128))}}),Ib={class:"row w-100 mx-0 mb-5"},$b={key:0,class:"col-1 px-2"},Pb={class:"row text-center task-table__header py-2 w-100"},Db=Ue({__name:"TableTask",props:{task:{type:Object,required:!0}},setup(n){const s=n,e=i(()=>s.task.header.replaceAll("'","").replace("[","").replace("]","").split(", ")),o=C=>{let v="";return!a.isUndefined(s.task.style)&&!a.isUndefined(s.task.style.borderBottom)&&s.task.style.borderBottom=="none"?v="":v="border-bottom-table",C+1==s.task.items.length&&(v="border-bottom-table"),v},t=es(),r=i(()=>s.task),g=f(!1),u=i(()=>{let C="";if(a.isUndefined(s.task.disabledByItemKey))return C;const v=t.stateStoredDisableKeyValue.find(c=>c.key==s.task.disabledByItemKey);return a.isUndefined(v)||(C=v.value),C});be(u,async C=>{C=="3"&&_()},{deep:!0});const _=async()=>{if(!a.isUndefined(s.task.disabledByItemKey)){let C=t.stateStoredDisableKeyValue.find(v=>v.key==s.task.disabledByItemKey);if(a.isUndefined(C)){const v=await t.getValueFromItemKey(s.task.disabledByItemKey);t.pushStoredDisabledItems({key:s.task.disabledByItemKey,value:v})}if(C=t.stateStoredDisableKeyValue.find(v=>v.key==s.task.disabledByItemKey),(C==null?void 0:C.value)=="3"){const v=[];s.task.items.forEach(c=>{for(var k in c){const P=c[k];if(!a.isUndefined(P.disabledByItemKey)&&P.value){const B={keyValue:P.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]};v.push(B)}}}),v.length>0&&(g.value=!0,await t.updateItemFromTask(v),g.value=!1)}}};return(C,v)=>(d(),h("div",Ib,[!J(a.isUndefined)(r.value.style)&&r.value.style.category=="taskTable"?(d(),h("div",$b)):E("",!0),l("div",{class:$e(["task-table",!J(a.isUndefined)(r.value.style)&&r.value.style.category=="taskTable"?"col-11 px-0":"col-12 pe-0"])},[l("label",null,ue(r.value.description),1),l("div",Pb,[(d(!0),h(we,null,tt(e.value,c=>(d(),h("div",{class:"col font-weight-normal task-table__header__item",key:c},ue(c),1))),128))]),(d(!0),h(we,null,tt(r.value.items,(c,k)=>(d(),h("div",{key:c.key,class:$e(["row w-100 task-table__body d-flex align-items-start",o(k)])},[R(Ub,{item:c,task:r.value,"item-loading":g.value},null,8,["item","task","item-loading"])],2))),128))],2)]))}}),io=Ct(Db,[["__scopeId","data-v-167177d4"]]),Vb={class:"row w-100 mt-3 mb-3"},Bb={key:0,class:"col-1 px-2"},Ab={class:"small-hyperlink-text-style"},Nb=Ue({__name:"CollapsibleTableTask",props:{task:{type:Object,required:!0}},setup(n){const s=n,e=f("open"),o=i(()=>{let t="";return!a.isUndefined(s.task.style)&&!a.isUndefined(s.task.style.defaultCollapse)&&(t=s.task.style.defaultCollapse),t});return(t,r)=>{const g=ce("el-collapse-item"),u=ce("el-collapse");return d(),h("div",Vb,[!J(a.isUndefined)(n.task.style)&&n.task.style.collapseCategory=="taskTable"?(d(),h("div",Bb)):E("",!0),l("div",{class:$e(["task-table collapsible-table-container",!J(a.isUndefined)(n.task.style)&&n.task.style.collapseCategory=="taskTable"?"col-11 px-0":"col-12 pe-0"])},[R(u,{class:"task-group general-accordion py-1 px-5",modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=_=>e.value=_)},{default:ee(()=>[R(g,{name:o.value},{title:ee(()=>[l("span",Ab,ue(n.task.triggerCaption),1)]),default:ee(()=>[R(io,{task:n.task},null,8,["task"])]),_:1},8,["name"])]),_:1},8,["modelValue"])],2)])}}}),xb=Ue({__name:"TaskGroup",props:{taskGroup:{type:Object,required:!0}},setup(n){const s=n,e=Ye(()=>s.taskGroup.key);return(o,t)=>{const r=ce("el-collapse-item"),g=ce("el-collapse");return d(),re(g,{modelValue:J(e),"onUpdate:modelValue":t[0]||(t[0]=u=>Fa(e)?e.value=u:null),class:"task-group e-form-only py-1 px-5 mb-3"},{default:ee(()=>[R(r,{title:n.taskGroup.name,name:n.taskGroup.key},{default:ee(()=>[(d(!0),h(we,null,tt(s.taskGroup.task,(u,_)=>(d(),h("div",{key:u.key,class:"ps-3 position-relative"},[u.taskType=="inline"?(d(),re(Tb,{key:0,task:u,"task-index":_,"task-group":n.taskGroup.task},null,8,["task","task-index","task-group"])):E("",!0),u.taskType==="table"?(d(),re(io,{key:1,task:u},null,8,["task"])):E("",!0),u.taskType=="collapsibleTable"?(d(),re(Nb,{key:2,task:u},null,8,["task"])):E("",!0)]))),128))]),_:1},8,["title","name"])]),_:1},8,["modelValue"])}}}),Ob={class:"ps-0 mt-5"},Lb={class:"card"},Eb=Ue({__name:"SubGroup",props:{subGroup:{type:Object,required:!0}},setup(n){const s=n;return(e,o)=>(d(),h("div",Ob,[l("div",Lb,[(d(!0),h(we,null,tt(s.subGroup.taskGroup,t=>(d(),re(xb,{key:t.key,"task-group":t},null,8,["task-group"]))),128))])]))}}),Fb={class:"el-dialog__title"},Mb={class:"row text-center pt-5 justify-content-end",style:{"word-break":"normal"}},jb={class:"row px-2"},Hb={class:"col-2"},Kb=Ue({__name:"Index",props:{show:{type:Boolean,required:!0}},emits:["close","onConfrimSubmit"],setup(n,{emit:s}){const e=n,o=s,t=Xa(),r=Ye(()=>e.show),g=Ye(()=>{let C=!1;return t.stateValidation.forEach(v=>{if(!v.value||v.value=="false"){console.log("item",v),C=!0;return}}),C}),u=async()=>{const C=Xe.service({lock:!0,text:"Loading the page",background:"rgba(0, 0, 0, 0.7)"});await t.submitForm(),_(),C.close(),await o("onConfrimSubmit")},_=()=>{o("close")};return(C,v)=>{const c=ce("el-button"),k=ce("el-dialog");return d(),re(k,{modelValue:J(r),"onUpdate:modelValue":v[0]||(v[0]=P=>Fa(r)?r.value=P:null),width:"90%","custom-class":"el-defect-crack-form-custom",onClosed:_,"destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},{title:ee(()=>[l("span",Fb,ue(J(t).stateSCCalibration.subGroup[0].name),1)]),default:ee(()=>[l("div",Mb,[l("div",jb,[(d(!0),h(we,null,tt(J(t).stateSCCalibration.subGroup,P=>(d(),re(Eb,{key:P.key,subGroup:P},null,8,["subGroup"]))),128))]),l("div",Hb,[R(c,{type:"success",disabled:J(g),class:"ok-button",onClick:u},{default:ee(()=>[Ee("Submit")]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"])}}}),Rs=n=>(Yt("data-v-707972be"),n=n(),zt(),n),Gb={class:"navbar navbar-light bg-light"},qb={class:"container-fluid"},Wb={class:"d-flex"},Jb={class:"me-2"},Yb=Rs(()=>l("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasNavbar","aria-controls":"offcanvasNavbar"},[l("span",{class:"navbar-toggler-icon"})],-1)),zb={class:"offcanvas offcanvas-end",tabindex:"-1",id:"offcanvasNavbar","aria-labelledby":"offcanvasNavbarLabel"},Xb=Rs(()=>l("div",{class:"offcanvas-header"},[l("h5",{class:"offcanvas-title",id:"offcanvasNavbarLabel"}),l("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1)),Qb={class:"offcanvas-body"},Zb={class:"d-flex flex-column align-items-center"},ek={class:"d-flex flex-column align-items-center avatar"},tk=["src"],ak={key:1,class:"symbol symbol-circle firstname-placeholder text-center d-flex flex-row justify-content-center align-items-center"},sk={class:"col text-center mt-4"},lk={class:"name"},ok={class:"position"},rk=Rs(()=>l("br",null,null,-1)),nk={key:0,class:"h-100 w-100",style:{"background-color":"white"}},ik={key:1,class:"row m-0 mt-25 p-5 bg-white e-form-container"},uk={class:"p-2 flex-fill mt-6"},dk={class:"form-check checkbox-success"},ck=["disabled"],mk=Rs(()=>l("label",{class:"fw-bolder",style:{color:"black !important","font-size":"15px"},for:"agreement"}," I have read and understood all safety precautions listed above ",-1)),fk={class:"p-2 py-5 d-flex justify-content-end mt-20 border-top border-top-2"},vk=["disabled"],pk=["disabled"],yk=["disabled"],gk=Ue({__name:"Index",setup(n){const s=Da(),e=Jt(),o=rt(),t=za(),r=Ks(),g=Os(),u=ts(),_=Al(),C=sr(),v=Ll(),c=Ls(),k=qa(),P=Xa(),B=po(),m=ja(),b=f(!1),S=f("Out of network, data cannot be retrieved."),L=f(!1),H=i(()=>j.value?j.value.name:""),F=i(()=>s.generalUpdated),x=i(()=>o.stateShowSCConfirmToSPC),p=i(()=>o.stateShowConfirmToCalibrateSC),K=i(()=>o.stateShowSCAdjustmentWarning),X=i(()=>o.stateShowPreTaskNotComplete),W=i(()=>{const de=localStorage.getItem("currentModel");if(de){const ye=JSON.parse(de);return`Sorry, service sheet for model ${ye.model} and service size ${ye.psType} is not available`}else return"Form is not available yet"}),w=de=>{o.toggleShowSCConfirmToSPV(de)},D=()=>{o.toggleShowPreTaskNotComplete(!1),o.handleScrollToUnfilledTask()},U=de=>{o.toggleShowSCdjustmentWarning(de)},I=de=>{o.toggleShowConfirmToCalibrateSC(de)},z=async()=>{const de={modelId:o.stateGeneralForm.modelId,psTypeId:o.stateGeneralForm.psTypeId,unitNumber:o.stateGeneralForm.equipment,workOrder:o.stateGeneralForm.workOrder,employee:{id:e.stateUser.EmployeeId,name:e.stateUser.Name}};_e()?await P.getSuspensionCalibrationTemplateFromLocalDB(de.workOrder):await P.getSuspensionCalibrationTemplate(de),P.generateValidateInput(),P.generatePreAnsweredInput(),P.stateSCHeader.status!="Submitted"?P.toggleShowSuspensionCylinderHeightForm(!0):Y.value=!0},oe=i(()=>k.stateSubmitConnectionError),me=()=>{k.setSubmitConnectionError(!1)},M=i(()=>o.stateIsFormSelectedByOtherSupervisor),te=()=>{o.changeIsFormSelectedByOtherSupervisor(!1),at.value=!0,ea.push({name:"ironforms"})},T=async()=>{const de=Xe.service({lock:!0,text:"Loading the page",background:"rgba(0, 0, 0, 0.7)"});s.updateGeneralUpdated(!0),m.getDefectsData(v.selectedForm.workOrder);const ye=o.groups.find(Te=>{if((a.isUndefined(Te.isDisable)||Te.isDisable=="false")&&Te.groupName!="General")return!0});o.setSelectedGroup(ye.id),await o.updateGroupByParam(ye.groupName),window.scrollTo({top:0,behavior:"smooth"}),de.close()},$=i(()=>o.percentageTaskProgressAllTab),ae=i(()=>o.taskErrorDialog),G=i(()=>o.errorMessageTaskErrorDialog),Z=i(()=>o.formAlreadyClose),ie=i(()=>{let de="";return!a.isUndefined(o.generalForm)&&!a.isUndefined(o.generalForm.releasedDate)&&(de=o.generalForm.releasedDate),de}),Ce=i(()=>t.DefectYesVisible),st=i(()=>u.Visible),Ke=i(()=>u.ViewVisible),$t=i(()=>m.ViewDefectVisible),kt=i(()=>g.CrackYesVisible),V=i(()=>m.ViewCrackVisible),q=i(()=>o.groups),fe=i(()=>e.user),Re=i(()=>e.userPic),Ne=i(()=>a.isUndefined(e.user.Name)?"":e.user.Name[0]),Ae=i(()=>!a.isUndefined(o.generalForm)&&!a.isUndefined(o.generalForm.status)&&o.generalForm.status=="Submited"?!1:!a.isEmpty(o.employee.id)),ut=i(()=>o.ratingNotMapped),mt=()=>{o.toggleNotMapped(!1)},ct=f(!1),se=f(!1),ke=f(!1),De=f(!1),He=f(!1),at=f(!1),gt=f(!1),ft=f(!1),dt=f("00:00:00"),St=f(),it=f(),Le=f(!1),xt=f(!1),Ht=_r(),Ge=f(""),Rt=f(null),pt=i(()=>o.formAlreadySubmitted),Ot=de=>{St.value.timer.reset(),dt.value=de,St.value.timer.updateCLock(de),St.value.continueTimer()},Xt=i(()=>a.isUndefined(s.generalForm.hmOffset)||s.generalForm.hmOffset==""?s.HmOffset==""||s.HmOffset=="Not Applicable"?0:Number(s.HmOffset):s.generalForm.hmOffset),Kt=i(()=>{const de=s.smuActual,ye=s.smuTolerance;return Number(Number(de)+Number(ye.min))}),Tt=i(()=>{const de=s.smuActual,ye=s.smuTolerance;return Number(Number(de)+Number(ye.max))}),vt=i(()=>{let de="";if(!a.isUndefined(o.generalForm.smu))de=o.generalForm.smu;else if(!a.isUndefined(s.payload.updateParams)){const It=s.payload.updateParams.find(ht=>ht.keyValue=="GENERAL");if(!a.isUndefined(It)){const ht=It.propertyParams.find(_t=>_t.propertyName=="smu");a.isUndefined(ht)||(de=ht.propertyValue)}}let ye=da(a.cloneDeep(de));const Te=Number(ye)+Number(Xt.value)>=Kt.value,ot=Number(ye)+Number(Xt.value)<=Tt.value;return!!(de!=""&&Te&&ot)}),Gt=i(()=>{var It,ht;let de=!1,ye=!1,Te=!0,ot=!0;if(!vt.value&&!a.isUndefined(o.generalForm.imageEquipment)&&(o.generalForm.imageEquipment==""||o.generalForm.imageEquipment.length==0)&&(ot=!1),!a.isUndefined(o.generalForm.smu)&&o.generalForm.smu!="")de=!0;else if(!a.isUndefined(s.payload.updateParams)){const _t=s.payload.updateParams.find(Je=>Je.keyValue=="GENERAL");if(!a.isUndefined(_t)){const Je=_t.propertyParams.find(Bt=>Bt.propertyName=="smu");a.isUndefined(Je)||Je.propertyValue!=""&&(de=!0)}}if(!a.isUndefined(s.payload.updateParams)){const _t=s.payload.updateParams.find(Je=>Je.keyValue=="GENERAL");if(!a.isUndefined(_t)){const Je=_t.propertyParams.find(Bt=>Bt.propertyName=="servicePersonnels");a.isUndefined(Je)||Je.propertyValue!=""&&(ye=!0)}}return a.isUndefined(j.value.id)||j.value.id==""?ye=!1:ye=!0,de&&ye&&ot&&(Te=!1),(It=it.value)!=null&&It.imageValues&&((ht=it.value)==null?void 0:ht.imageValues.length)==2&&(Te=!1),Le.value&&(Te=!0),Te}),ea=cr(),Ia=()=>{St.value.timer.reset(),St.value.startTimer()},ga=i(()=>o.taskAlreadyUpdated),Ba=i(()=>s.stateIsTruckAlreadyCheckedByOtherFitter),Aa=i(()=>!s.generalUpdated),Sa=de=>{dt.value=de},ta=de=>{dt.value=de},Na=f(!1),xa=de=>{dt.value=de,se.value=!0},Ca=async()=>{se.value=!1;const de=Xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{const ye=s.CurrentPersoneel;ye.serviceEnd="<<ServerDateTime>>";const Te={propertyName:"servicePersonnels",propertyValue:JSON.stringify(ye)};await s.UpdateServiceEndMechanic(Te),ke.value=!0,at.value=!0}catch(ye){console.log("error filtering service personnel on closing eform",ye)}de.close()},Ra=()=>{ke.value=!1,ea.push({name:"ironforms"})},A=f(!1),Q=i(()=>o.isAllTaskDone),le=async()=>{const de=Xe.service({lock:!0,text:"Loading E-Form",background:"rgba(0, 0, 0, 0.7)"});s.addUpdatedByAndDate(e.user.EmployeeId,e.user.Name),ct.value=!1;const ye=await s.updateGeneralForm();if(m.getDefectsData(o.generalForm.workOrder),ye)gt.value=!0,window.scrollTo({top:0,behavior:"smooth"}),de.close();else{To("submitted","true");const Te=o.groups.find(ot=>{if((a.isUndefined(ot.isDisable)||ot.isDisable=="false")&&ot.groupName!="General")return!0});o.setSelectedGroup(Te.id),await o.updateGroupByParam(Te.groupName),window.scrollTo({top:0,behavior:"smooth"}),A.value=!0,de.close()}Ht.updateSelectedWO(o.generalForm.workOrder,o.generalForm.modelId,o.generalForm.equipment,o.generalForm.psTypeId)},ge=()=>{se.value=!1},Pe=ya(),Ie=()=>{Pe.setShowCloseButton(!1),it.value.triggerCamera(),s.setFitterInfoIsIHaveReadChecked(!0),ct.value=!1,Le.value=!0},Fe=()=>{ct.value=!1,Le.value=!1},Qe=i(()=>{let de="";return a.isUndefined(o.generalForm)||a.isUndefined(o.generalForm.form)||(de=o.generalForm.form),de.replace("e-Form","")}),qe=i(()=>{let de=!0,ye=!1,Te=!1,ot=!0,It=!1,ht=!1,_t=!1,Je=!1;if(!a.isUndefined(o.generalForm.smu)&&o.generalForm.smu!="")ye=!0;else if(!a.isUndefined(s.payload.updateParams)){const At=s.payload.updateParams.find(wt=>wt.keyValue=="GENERAL");if(!a.isUndefined(At)){const wt=At.propertyParams.find($a=>$a.propertyName=="smu");a.isUndefined(wt)||wt.propertyValue!=""&&(ye=!0)}}if(s.IsFitterLoggedInExist)Te=!0;else if(!a.isUndefined(s.payload.updateParams)){const At=s.payload.updateParams.find(wt=>wt.keyValue=="GENERAL");if(!a.isUndefined(At)){const wt=At.propertyParams.find($a=>$a.propertyName=="servicePersonnels");a.isUndefined(wt)||wt.propertyValue!=""&&(Te=!0)}}if(s.IsFitterLoggedInExist?j.value.id==s.FitterInfo.employee.id&&s.FitterInfo.riskPhotos.length>0&&(ht=!0):s.IsSelectedFitterAlreadyLoggedIn?ht=!0:ht=s.IsRiskAssesmentPhotoTaken,(s.SkipWash=="false"||s.SkipWash=="")&&o.generalForm.checkBeforeTruck&&o.generalForm.checkBeforeTruck.items.forEach(At=>{At.category!="skipOtherWash"&&(At.value=="false"||At.value=="")&&(ot=!1)}),a.isUndefined(o.generalForm.swingHour))_t=!0;else if(!a.isUndefined(o.generalForm.swingHour)&&o.generalForm.swingHour!="")_t=!0;else if(!a.isUndefined(s.payload.updateParams)){const At=s.payload.updateParams.find(wt=>wt.keyValue=="GENERAL");if(!a.isUndefined(At)){const wt=At.propertyParams.find($a=>$a.propertyName=="swingHour");a.isUndefined(wt)||wt.propertyValue!=""&&(_t=!0)}}if(a.isUndefined(o.generalForm.travelHour))Je=!0;else if(!a.isUndefined(o.generalForm.travelHour)&&o.generalForm.travelHour!="")Je=!0;else if(!a.isUndefined(s.payload.updateParams)){const At=s.payload.updateParams.find(wt=>wt.keyValue=="GENERAL");if(!a.isUndefined(At)){const wt=At.propertyParams.find($a=>$a.propertyName=="travelHour");a.isUndefined(wt)||wt.propertyValue!=""&&(Je=!0)}}let Bt=!1;(a.isUndefined(o.generalForm.isSwingTravelRequired)||o.generalForm.isSwingTravelRequired=="true"&&_t&&Je||o.generalForm.isSwingTravelRequired=="false"||o.generalForm.isSwingTravelRequired=="")&&(Bt=!0);let ia=!1;(a.isUndefined(o.generalForm.isTravelRequired)||o.generalForm.isTravelRequired=="true"&&Je||o.generalForm.isTravelRequired=="false"||o.generalForm.isTravelRequired=="")&&(ia=!0);let pa=!1;return(a.isUndefined(o.generalForm.isSwingRequired)||o.generalForm.isSwingRequired=="true"&&_t||o.generalForm.isSwingRequired=="false"||o.generalForm.isSwingRequired=="")&&(pa=!0),Le.value&&(It=!0),ye&&Te&&ot&&It&&ht&&Bt&&pa&&ia&&(de=!1),de}),Ze=i(()=>o.selectedSubGroups),Ve=i(()=>o.generalForm),ze=()=>{Ge.value="Take <strong>back page</strong> photo of your completed pre-task risk assessment.",ct.value=!0},Pt=()=>{let de=[];if(!Array.isArray(s.generalForm.riskAssesment[0].value))return de;const ye=o.employee;return de=s.generalForm.riskAssesment[0].value.filter(Te=>{const ot=Te;if(ot.updatedBy.id==ye.id)return ot}),de.slice(0,2)},O=()=>{var de,ye,Te,ot;if(Le.value){let It=!1,ht=!1,_t=!1,Je=!1,Bt=!1;if(a.isUndefined(Ve.value.swingHour))It=!0;else if(Ve.value.swingHour===""){const ia=o.generalForm.isSwingTravelRequired,pa=o.generalForm.isSwingRequired,At=ia&&String(ia)==="true",wt=pa&&String(pa)==="true";At||wt?(de=Rt.value)==null||de.showSwingRequired():(ye=Rt.value)==null||ye.hideSwingRequired()}else It=!0;if(a.isUndefined(Ve.value.travelHour))ht=!0;else if(Ve.value.travelHour===""){const ia=o.generalForm.isSwingTravelRequired,pa=o.generalForm.isTravelRequired,At=ia&&String(ia)==="true",wt=pa&&String(pa)==="true";At||wt?(Te=Rt.value)==null||Te.showTravelRequired():(ot=Rt.value)==null||ot.hideTravelRequired()}else ht=!0;if((a.isUndefined(o.generalForm.isSwingTravelRequired)||o.generalForm.isSwingTravelRequired=="false")&&(_t=!0),(a.isUndefined(o.generalForm.isTravelRequired)||o.generalForm.isTravelRequired=="false")&&(Je=!0),(a.isUndefined(o.generalForm.isSwingRequired)||o.generalForm.isSwingRequired=="false")&&(Bt=!0),o.generalForm.isSwingTravelRequired&&o.generalForm.isSwingTravelRequired=="true"&&It&&ht&&(_t=!0),o.generalForm.isTravelRequired&&o.generalForm.isTravelRequired=="true"&&ht&&(Je=!0),o.generalForm.isSwingRequired&&o.generalForm.isSwingRequired=="true"&&It&&(Bt=!0),!_t||!Je||!Bt){Le.value=!1,Ns("travel-swing");return}s.IsSelectedFitterAlreadyLoggedIn||(Pt().length==0?Ge.value="Take <strong>front page</strong> photo of your completed pre-task risk assessment.":Ge.value="Take <strong>back page</strong> photo of your completed pre-task risk assessment.",ct.value=!0)}},Y=f(!1),Be=async()=>{L.value=!1,Dt()},Ut=async()=>{_e()?L.value=!0:Dt()},Dt=async()=>{const de=Xe.service({lock:!0,text:"Submitting e-form",background:"rgba(0, 0, 0, 0.7)"});Y.value=!1,await o.submitEform(),de.close(),ke.value=!0,at.value=!0},qt=()=>{Y.value=!1},la=async()=>{const de=Xe.service({lock:!0,text:"Opening Calibration form",background:"rgba(0, 0, 0, 0.7)"});await z(),de.close()},oa=async de=>{de&&(o.stateStoredSuspensionCylinderValue.filter(Te=>Te.value=="Out of spec"||Te.value=="Out Spec").length>0&&o.stateStoredAdjustedSuspensionCylinderValue.length>0&&(o.stateStoredAdjustmentOptionValue=="2"||o.stateStoredAdjustmentOptionValue=="Yes")?await la():Y.value=!0)},ba=async de=>{if(_e()){b.value=!0;return}document.getElementsByClassName("btn-close")[0].click();const ye=Xe.service({lock:!0,text:"Loading Historical e-Form",background:"rgba(0, 0, 0, 0.7)"});C.setModelAndPsTypeId(de.equipmentModelDescription,de.psTypeId,de.workOrder,de.equipmentNumber),await C.postGenerateServiceSheet(e.user.EmployeeId,e.user.Name,e.user.SiteId),C.setSerialNumberGeneral(t.SerialNumber),ye.close(),De.value=!0},Qt=()=>{De.value=!1},ve=async()=>{if(_e()){b.value=!0;return}document.getElementsByClassName("btn-close")[0].click();const de=Xe.service({lock:!0,text:"Loading Historical e-Form Defects",background:"rgba(0, 0, 0, 0.7)"});await m.getDefectsData(v.selectedForm.workOrder),de.close(),He.value=!0},y=()=>{He.value=!1},N=f(!1),he=()=>{N.value=!1,window.location.href.includes("#!")||(window.location.href+="#!",ea.currentRoute.value.hash="#!")},lt=()=>{const de=s.generalForm.status,ye=Xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});de.toLowerCase()=="open"&&(_e()||s.updateServiceSheetHeaderToTrue()),N.value=!1,ye.close(),ea.push({name:"ironforms"})},et=()=>{const de=ea.currentRoute.value,ye=window.location.href,Te=de.hash;ye.includes("#!")||(window.location.href+="#!"),Te.includes("#!")||(ea.currentRoute.value.hash="#!");const ot=de.path;window.onpopstate=It=>{ot=="/ironforms/e-form-v2"&&!ea.currentRoute.value.hash.includes("#")&&It.state&&(N.value=!0)}},We=f(!1),Wt=de=>{We.value=de,va.value&&We.value&&setTimeout(()=>{va.value&&(We.value=!1)},3e3)};i(()=>t.ApprovalDefect);let Lt=f(!0);Mt(async()=>{s.toggleIsSmuCameraDisabled(!1),t.resetInstance(),g.resetInstance(),u.resetInstance(),s.resetGeneral(),o.resetMechanic(),t.resetList(),Co("submitted");const de=document.getElementById("offcanvasNavbar");de!=null&&de.addEventListener("show.bs.offcanvas",async()=>{if(xt.value===!1){Lt.value=!0;const ye=Xe.service({lock:!0,text:"Loading historical data",background:"rgba(0, 0, 0, 0.7)",target:de});_e()?Lt.value=!1:(await c.getHistoricalFormData(o.statePsTypeId,o.stateModelId,o.stateUnitNumber),await c.getHistoricalDefectData(o.statePsTypeId,o.stateModelId,o.stateUnitNumber),xt.value=!0),ye.close()}}),o.clearTruckCheckBoxes(),et()});const Zt=async()=>{s.setIsFitterLoggedInExist(!1)},j=i(()=>o.employee);be(j,async de=>{s.IsFitterLoggedInExist&&s.FitterInfo.employee.id==de.id?Le.value=s.FitterInfo.isIHaveReadChecked:Le.value=!1},{deep:!0});const ne=f(),Oe=async()=>{o.updateSkipPreServiceReasonOptions(),await s.getSMUTolerance(),await _.getPersonalLabours(),await o.checkCurrentWoPendingOfflineTask()?(ne.value=await na.serviceSheetDetail.where("id").equals(o.stateWorkOrder).first(),o.postGenerateFromLocalDB(ne.value)):ne.value=await o.postGenerateServiceSheet(e.user.EmployeeId,e.user.Name,e.user.SiteId),await o.getEhmsRating(),await o.getOilTolerance(),await s.getShiftListData(),await t.getOwnershipDefectForm(o.stateUnitNumber)},pe=async()=>{if(o.updateSkipPreServiceReasonOptionsFromLocalDB(),await s.getSMUToleranceFromLocalDB(),await _.setPersonalLaboursLocal(),ne.value=await na.serviceSheetDetail.where("id").equals(o.stateWorkOrder).first(),o.postGenerateFromLocalDB(ne.value),!a.isUndefined(ne.value.general)){const de=await na.cbmMapping.where({model:B.SelectedDailySchedule.equipmentModelName,psType:B.SelectedDailySchedule.psType}).first();de&&o.updateCBMRatingFromLocalDB(de.detail),s.getHmOffsetValueFromLocalDB()}await o.getOilToleranceFromLocalDB(),await s.getShiftFromLocalDB(),await t.getOwnershipDefectFormFromLocalDB(o.stateUnitNumber)},xe=f();gs(async()=>{var de,ye;if(o.toggleSetSelectedUOMToolTaskKey(""),xe.value=Xe.service({lock:!0,text:"Loading e-Form",background:"rgba(0, 0, 0, 0.7)"}),at.value=!0,Pe.reset(),o.toggleIsShowCalibrationConfirm(!1),o.getGroups(),o.getSubGroups(),_e()?await pe():await Oe(),o.setSerialNumberGeneral(t.SerialNumber),o.stateGroups.forEach(Te=>{Te.groupName=="MECHANICAL_SERVICE"&&Te.subGroup.forEach(ot=>{ot.key=="MECHANICAL_SERVICE"&&ot.taskGroup.forEach(It=>{if(It.key=="MECHANICAL_SERVICE_SUSPENSION"){let ht=[],_t=[];It.task.forEach(Je=>{Je.items.forEach(Bt=>{Bt.categoryItemType=="suspensionTargetRating"&&ht.push({key:Bt.key,value:Bt.value}),Bt.categoryItemType=="adjustmentSuspensionTargetRating"&&_t.push({key:Bt.key,value:Bt.value})}),a.isUndefined(Je.showParameter)||Je.showParameter=="suspensionCylinder"&&o.updateStoredAdjustmentOptionValue(Je.taskValue)}),o.pushDataToAdjustedSuspensionCylinderStoredValue(_t),o.pushDataToSuspensionCylinderStoredValue(ht)}})})}),o.updateStoredDisableKeyValue([]),!ne.value&&!o.stateIsFormSelectedByOtherSupervisor)return(de=xe.value)==null||de.close(),xe.value=void 0,at.value=!0,ft.value=!0,setTimeout(()=>{fa()},5e3),!1;if(s.setGeneralForm(o.generalForm),_e()||await s.getHmOffsetValue(e.user.SiteId),await Zt(),c.reset(),at.value=!1,s.setPayloadId(Ve.value.id,e.user.EmployeeId,e.user.Name),(ye=xe.value)==null||ye.close(),xe.value=void 0,va.value||Wt(!0),!_e()){const Te={general:o.stateGeneralForm,serviceSheet:o.stateServiceSheets};await o.getCrackBulkData(),await B.saveDefectServiceFormToLocalDB(o.stateWorkOrder),await B.dumpAttachmentEachServiceDetail(Te),await B.dumpImagesEachServiceDetail(Te.general,Te.serviceSheet);const ot=await na.serviceSheetHeader.get({workOrder:o.stateWorkOrder});await B.getpayloadCalibration({employee:{id:e.user.EmployeeId,name:e.user.Name},modelId:Te.general.modelId,psTypeId:Te.general.psTypeId,unitNumber:Te.general.equipment,workOrder:Te.general.workOrder}),await o.handleGetAndUpdatePreviousTandem(Te),await o.handleGetAndUpdatePreviousReplacement(Te),await o.handleGetAndUpdatePreviousBrakePack(Te),await o.getReplacementDefaultBulk({modelId:Te.general.modelId,psTypeId:Te.general.psTypeId},Te.general.workOrder),ot&&(ot.syncStatus="Updated",await na.serviceSheetHeader.put(ot)),B.updateDailyScheduleSyncStatus(o.stateWorkOrder),await B.formatDailyScheduleOptions()}await t.getPartReference(o.stateGeneralForm.equipment),await r.getPartReference(o.stateGeneralForm.equipment)});const Et=()=>{o.toggleFormAlreadySubmitted(!1),Ca()},fa=()=>{ft.value=!1,ea.push({name:"ironforms"})},Vt=async()=>{s.toggleIsTruckAlreadyCheckedByOtherFitter(!1)},aa=()=>{o.toggleFormAlreadyClose(!1)},sa=async()=>{var ye;o.toggleTaskAlreadyUpdatedStatus(!1),o.toogleTaskErrorDialog(!1);const de=Xe.service({lock:!0,text:"Reloading e-Form",background:"rgba(0, 0, 0, 0.7)"});await o.updateGroupByParam((ye=o.selectedGroup)==null?void 0:ye.groupName),o.getTaskProgress(),de.close()},ra=()=>{N.value=!0},va=i(()=>!_e());return be(va,()=>{Wt(!0)},{deep:!0}),mo(()=>{wo.closeAll()}),Ja(()=>{o.resetMechanic(),t.resetList(),o.toogleTaskErrorDialog(!1),localStorage.removeItem("currentModel")}),(de,ye)=>{var It,ht,_t;const Te=ce("NwImg"),ot=ce("el-dialog");return d(),h(we,null,[l("nav",Gb,[l("div",qb,[l("div",{class:"logo-wrapper d-flex align-items-center ms-1",onClick:ra},[R(Te,{style:{cursor:"pointer"},src:"/media/logos/logo-whitebg.png",class:"h-40px logo"})]),l("div",Wb,[l("div",Jb,[R(yr)]),Yb]),l("div",zb,[Xb,l("div",Qb,[l("div",Zb,[l("div",ek,[Re.value!=""?(d(),h("img",{key:0,class:"px-0",style:{height:"100px",width:"100px","border-radius":"28px"},src:Re.value,alt:""},null,8,tk)):(d(),h("div",ak,[l("span",null,ue(Ne.value),1)])),l("div",sk,[l("h4",lk,ue((It=fe.value)==null?void 0:It.Name),1),l("span",ok,ue((ht=fe.value)==null?void 0:ht.Position),1),Ee(),rk])]),R(Fy,{onShowHistory:ve,isHitOnline:J(Lt)},null,8,["isHitOnline"]),R(Jy,{onShowHistory:ba,isHitOnline:J(Lt)},null,8,["isHitOnline"])])])])])]),at.value?(d(),h("div",nk)):(d(),h("div",ik,[R(Ro,{formName:`${Qe.value} (Rel. ${ie.value})`,"form-status":Ve.value&&Ve.value.status,"percentage-progress":$.value,mechanicName:H.value,isGeneralUpdated:F.value},null,8,["formName","form-status","percentage-progress","mechanicName","isGeneralUpdated"]),R(Ir,{groups:q.value},null,8,["groups"]),R(Qo,{ref_key:"timer",ref:St,onOnStart:Sa,onOnChange:ta,onOnStop:xa,visibility:Ae.value,"is-disabled":Aa.value},null,8,["visibility","is-disabled"]),(d(!0),h(we,null,tt(Ze.value,Je=>(d(),h(we,{key:Je.key},[R(dd,{subGroup:Je},null,8,["subGroup"]),!J(a.isUndefined)(J(o).stateSelectedGroup)&&J(o).stateSelectedGroup.groupName!="DEFECT_IDENTIFIED_SERVICE"?(d(),re(hl,{key:0,onSubmit:oa})):E("",!0)],64))),128)),!J(a.isUndefined)(J(o).stateSelectedGroup)&&J(o).stateSelectedGroup.groupName=="DEFECT_IDENTIFIED_SERVICE"?(d(),h(we,{key:0},[R(mg),R(hl,{onSubmit:oa})],64)):E("",!0),!J(a.isUndefined)(J(o).stateSelectedGroup)&&J(o).stateSelectedGroup.groupName==="General"&&J(o).isSet?(d(),h(we,{key:1},[R(Gc,{ref_key:"cardEquipment",ref:Rt,data:Ve.value,timer:St.value,onOnPersonelSelected:Ia,onUpdateTimer:Ot},null,8,["data","timer"]),R(zc,{data:Ve.value.safetyPrecaution},null,8,["data"]),l("div",uk,[l("div",dk,[Nt(l("input",{class:"form-check-input",disabled:Gt.value,type:"checkbox","onUpdate:modelValue":ye[0]||(ye[0]=Je=>Le.value=Je),id:"agreement",onChange:O},null,40,ck),[[Ya,Le.value]]),mk])]),R(vf,{ref_key:"riskAssesmet",ref:it,ready:J(o).isSet,onOnFrontPageTaken:ze},null,8,["ready"]),R(Nm,{data:Ve.value.checkBeforeTruck,isAggrementChecked:Le.value},null,8,["data","isAggrementChecked"]),l("div",fk,[R(Zo,{clock:dt.value},null,8,["clock"]),J(o).generalForm.status=="Submited"?(d(),h("button",{key:0,class:"btn btn-success",disabled:qe.value,style:{background:"#18af4a","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},onClick:T}," Enter ",8,vk)):(d(),h(we,{key:1},[!Q.value||!A.value?(d(),h("button",{key:0,class:"btn btn-success",disabled:qe.value,style:{background:"#18af4a","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},onClick:le}," Enter ",8,pk)):E("",!0)],64)),A.value&&Q.value?(d(),h("button",{key:2,type:"button",class:"btn btn-success",disabled:qe.value,style:{background:"#18af4a","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},onClick:oa}," Submit ",8,yk)):E("",!0)])],64)):E("",!0)])),We.value?(d(),re(rr,{key:2,onOnToggleIndicator:Wt})):E("",!0),((_t=q.value.find(Je=>Je.isSelected))==null?void 0:_t.groupName)!="DEFECT_IDENTIFIED_SERVICE"?(d(),h(we,{key:3},[R(xf,{visibility:Ke.value},null,8,["visibility"]),R(Wf,{visibility:st.value},null,8,["visibility"]),R(ho,{status:J(m).GeneralStatus,visibility:$t.value,"defect-data":J(m).DefectFormData,"header-id":"","work-order":"","view-only":!0,"fitter-id":"","task-id":"",plannerApprove:!0,"is-form":!1,"is-complete":J(m).CompleteStatus,onCloseForm:ye[1]||(ye[1]=()=>J(m).setViewDefectVisible(!1))},null,8,["status","visibility","defect-data","is-complete"]),R(_o,{status:J(m).GeneralStatus,visibility:V.value,"header-id":"","work-order":"","view-only":!0,"fitter-id":"","task-id":"",plannerApprove:!0,"is-complete":J(m).CompleteStatus,"crack-data":J(m).CrackFormData,onCloseForm:ye[2]||(ye[2]=()=>J(m).setViewCrackVisible(!1))},null,8,["status","visibility","is-complete","crack-data"]),R(jo,{visibility:Ce.value,"asset-number":J(o).unitNumber,"predefined-priority":J(t).PredefinedPriority,workorder:J(o).stateGeneralForm.workOrder,"defect-data":J(t).defectInfo},null,8,["visibility","asset-number","predefined-priority","workorder","defect-data"]),R(Iy,{visibility:kt.value,"asset-number":J(o).unitNumber,"predefined-priority":J(g).PredefinedPriority,workorder:J(o).stateGeneralForm.workOrder,"crack-data":J(g).crackInfo},null,8,["visibility","asset-number","predefined-priority","workorder","crack-data"]),R(Vo)],64)):E("",!0),R(Nl,{visibility:ct.value,caption:Ge.value,"yes-label":"Take a Photo","no-label":"Cancel",onOnNoConfirm:Fe,onOnYesConfirm:Ie,yesButtonBackroundColor:"#18AF4A"},null,8,["visibility","caption"]),R(ca,{visibility:se.value,caption:"Is your work finished?",onOnNoConfirm:ge,onOnYesConfirm:Ca},null,8,["visibility"]),R(ca,{visibility:Y.value,caption:"Are you sure want to submit this form?",onOnNoConfirm:qt,onOnYesConfirm:Ut},null,8,["visibility"]),R(er,{show:ke.value,onClose:Ra,time:dt.value,isTimerStopped:Na.value},null,8,["show","time","isTimerStopped"]),R(Ea,{"modal-type":"alreadySubmitted",show:pt.value,onClose:Et},null,8,["show"]),R(Ea,{"modal-type":"notReady",show:ft.value,message:W.value,onClose:fa},null,8,["show","message"]),R(Ea,{"modal-type":"alreadyUpdated",show:ga.value,onClose:sa},null,8,["show"]),R(Ea,{"modal-type":"alreadyUpdated",show:Ba.value,onClose:Vt},null,8,["show"]),R(pg,{show:M.value,onClose:te},null,8,["show"]),R(Ea,{"modal-type":"taskError",show:ae.value,onClose:sa,message:G.value},null,8,["show","message"]),R(Ea,{"modal-type":"alreadyClose",show:Z.value,onClose:aa},null,8,["show"]),R(ot,{modelValue:De.value,"onUpdate:modelValue":ye[3]||(ye[3]=Je=>De.value=Je),"destroy-on-close":!0,fullscreen:!0,onClosed:Qt},{default:ee(()=>[R(fr,{title:"Historical e-Form",hideBackBtn:!0})]),_:1},8,["modelValue"]),R(Xy,{show:ut.value,onClose:mt},null,8,["show"]),R(ot,{modelValue:He.value,"onUpdate:modelValue":ye[4]||(ye[4]=Je=>He.value=Je),"destroy-on-close":!0,fullscreen:!0,"custom-class":"dialog-header-noborder",onClosed:y},{default:ee(()=>[R(mr)]),_:1},8,["modelValue"]),R(ca,{visibility:N.value,caption:"Are you sure want to leave this page?",onOnNoConfirm:he,onOnYesConfirm:lt},null,8,["visibility"]),R(xs,{show:oe.value,onClose:me,"title-pop-up":"No internet connection"},null,8,["show"]),R(ms,{show:x.value,onClose:ye[5]||(ye[5]=Je=>w(!1)),"title-pop-up":"Please confirm with supervisor if a suspension cylinder adjustment is required.",confirmLabel:"Continue"},null,8,["show"]),R(ms,{show:K.value,onClose:ye[6]||(ye[6]=Je=>U(!1)),"title-pop-up":"Suspension has defect, please confirm to supervisor and reliability engineer.",confirmLabel:"Continue"},null,8,["show"]),R(ms,{show:X.value,onClose:D,"title-pop-up":"All Pre Service Operational check must be completed prior to continuing on to the next section.",confirmLabel:"Ok"},null,8,["show"]),R(ms,{show:p.value,onClose:ye[7]||(ye[7]=Je=>I(!1)),"title-pop-up":"Please ensure you complete a payload calibration at the end of the service, before the unit returns to work.",confirmLabel:"Confirm"},null,8,["show"]),J(P).ShowSuspensionCylinderHeightForm?(d(),re(Kb,{key:4,show:J(P).ShowSuspensionCylinderHeightForm,onClose:ye[8]||(ye[8]=()=>J(P).toggleShowSuspensionCylinderHeightForm(!1)),onOnConfrimSubmit:Ut},null,8,["show"])):E("",!0),R(Wa,{visibility:b.value,caption:S.value,onOnClose:ye[9]||(ye[9]=()=>{b.value=!1})},null,8,["visibility","caption"]),R(or,{error:!1,"work-order":J(o).stateGeneralForm.workOrder,visibility:L.value,onClose:Be},null,8,["work-order","visibility"])],64)}}}),Z_=Ct(gk,[["__scopeId","data-v-707972be"]]);export{Z_ as default};

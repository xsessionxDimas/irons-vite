import{u as Ct}from"./vuex-BbOKrtVp.js";import{a as Lt}from"./breadcrumb-BYmEOf4C.js";import{c as M,a as lt,J as W,I as it,z as J,A as Vt}from"./index-BuVmIl8K.js";import{P as Dt}from"./Pagination-D-xfdYmn.js";import{F as It}from"./FilterIconButton-Bj0WTbms.js";import{h as Ot,A as Mt,U as xt}from"./excel-generator-DMHRo93s.js";import{D as $t}from"./DownloadIconButton-CIQp-YG7.js";import{_ as T,b as gt}from"./element-plus-BeWdvTRa.js";import{q as k,w as z,x as Z,y as At}from"./date-format-8-IvfSl3.js";import{P as tt}from"./Pagination-BiobnanQ.js";import{d as dt}from"./pinia-BjOS2_Ao.js";import{m as j,a as Rt}from"./mapOption-CeGMwmH0.js";import{L as Bt}from"./urls-w1X_96ba.js";import{L as Ht}from"./urls-BUxQAIma.js";import{L as Nt}from"./urls-DTUjp4BB.js";import{k as N,bL as qt,r as G,u as s,y as H,p as b,aa as Q,q as C,x as m,Y as st,R as V,s as a,aB as h,C as B,a0 as ot,c as x,B as L,A as rt,T as vt,bd as zt,bb as jt,a7 as Kt,L as Gt,F as Yt}from"./@vue-BypzYtbH.js";import{a as Jt,b as Xt,d as Qt}from"./table-sort-Bpdq_Uwn.js";import{_ as ft}from"./NumberInput.vue_vue_type_script_setup_true_lang-DQgMY3Op.js";import{_ as et}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CCwjwK39.js";import{_ as K}from"./AutoComplete.vue_vue_type_script_setup_true_lang-DJ43pGTI.js";import{a as yt}from"./vee-validate-C_msoaAA.js";import{c as Tt,a as R,b as at,d as _t}from"./yup-C6P98bvY.js";import"./property-expr-DEi1ZLzV.js";import{E as St}from"./ErrorAlert-CMKGfwAi.js";import{e as Wt}from"./lodash-DrHMlsdo.js";import{_ as Zt}from"./FileDropZone.vue_vue_type_style_index_0_lang-C5PyimC7.js";import{m as te}from"./map-anything-abi6NY2Z.js";import{_ as ee}from"./nw-img-vue-CR837WER.js";import{_ as X}from"./AutoComplete.vue_vue_type_style_index_0_lang-DrAAOf71.js";import{_ as mt}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CJ7rJST9.js";import{F as ae}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./useMenuStore-CD5Gmvif.js";import"./PageEnum-DUtfSNQS.js";import"./xlsx-C4maHrMm.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-NSxIV7Fb.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";const q="https://digital-bumaau-dev-apm-001.azure-api.net/amadm/api/master_data/planned_duration",se=`${q}/bulk`,oe=`${q}/validate_upload`,re=`${q}/export`,ne=`${q}/lookup`,le=`${q}/update`,nt={Model:"",ModelTo:"",PsType:"",PsTypeTo:"",Value:"",ValueTo:"",Uom:"",UomTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},ut=dt({id:"PlannedDuration",state:()=>({stateFilterData:{...nt},stateLastUsedFilterData:{...nt},statePageName:"plannedDuration",stateDisplayData:[],statePagination:new tt,stateLoading:!1,statePaginationLoading:!1,stateModelOption:[],statePsTypeOption:[],stateValueOption:[],stateUomOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,modelOption:t=>t.stateModelOption,psTypeOption:t=>t.statePsTypeOption,valueOption:t=>t.stateValueOption,uomOption:t=>t.stateUomOption},actions:{async getData(t=!0){const o={Model:this.stateFilterData.Model,ModelTo:this.stateFilterData.ModelTo,PsType:this.stateFilterData.PsType,PsTypeTo:this.stateFilterData.PsTypeTo,Value:this.stateFilterData.Value,ValueTo:this.stateFilterData.ValueTo,Uom:this.stateFilterData.Uom,UomTo:this.stateFilterData.UomTo,StartDate:this.stateFilterData.StartDate?k(this.stateFilterData.StartDate):"",StartDateTo:this.stateFilterData.StartDateTo?k(this.stateFilterData.StartDateTo):"",EndDate:this.stateFilterData.EndDate?k(this.stateFilterData.EndDate):"",EndDateTo:this.stateFilterData.EndDateTo?k(this.stateFilterData.EndDateTo):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await M.get(q,"",new URLSearchParams(o).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const o=await M.get(ne,"",new URLSearchParams(t).toString());this.stateModelOption=j(o.data.result.content.model),this.statePsTypeOption=j(o.data.result.content.psType),this.stateValueOption=j(o.data.result.content.value),this.stateUomOption=j(o.data.result.content.uom)}catch(o){console.log(o)}},async export(){const t={Model:this.stateFilterData.Model,ModelTo:this.stateFilterData.ModelTo,PsType:this.stateFilterData.PsType,PsTypeTo:this.stateFilterData.PsTypeTo,Value:this.stateFilterData.Value,ValueTo:this.stateFilterData.ValueTo,Uom:this.stateFilterData.Uom,UomTo:this.stateFilterData.UomTo,StartDate:this.stateFilterData.StartDate?k(this.stateFilterData.StartDate):"",StartDateTo:this.stateFilterData.StartDateTo?k(this.stateFilterData.StartDateTo):"",EndDate:this.stateFilterData.EndDate?k(this.stateFilterData.EndDate):"",EndDateTo:this.stateFilterData.EndDateTo?k(this.stateFilterData.EndDateTo):"",ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await M.getBlob(re,"",new URLSearchParams(t).toString())).data}catch(o){console.log(o)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:o}){if(!t&&!o)this.stateFilterData.Order="";else{const e=o=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setModel(t){this.stateFilterData.Model=t},setModelTo(t){this.stateFilterData.ModelTo=t},setPsType(t){this.stateFilterData.PsType=t},setPsTypeTo(t){this.stateFilterData.PsTypeTo=t},setValue(t){this.stateFilterData.Value=t},setValueTo(t){this.stateFilterData.ValueTo=t},setUom(t){this.stateFilterData.Uom=t},setUomTo(t){this.stateFilterData.UomTo=t},setStartDate(t){this.stateFilterData.StartDate=t},setStartDateTo(t){this.stateFilterData.StartDateTo=t},setEndDate(t){this.stateFilterData.EndDate=t},setEndDateTo(t){this.stateFilterData.EndDateTo=t},async resetFilter(){this.stateFilterData.Model="",this.stateFilterData.ModelTo="",this.stateFilterData.PsType="",this.stateFilterData.PsTypeTo="",this.stateFilterData.Value="",this.stateFilterData.ValueTo="",this.stateFilterData.Uom="",this.stateFilterData.UomTo="",this.stateFilterData.StartDate="",this.stateFilterData.StartDateTo="",this.stateFilterData.EndDate="",this.stateFilterData.EndDateTo="";const t=this.stateLastUsedFilterData.Model!=="",o=this.stateLastUsedFilterData.ModelTo!=="",e=this.stateLastUsedFilterData.PsType!=="",D=this.stateLastUsedFilterData.PsTypeTo!=="",r=this.stateLastUsedFilterData.Value!=="",l=this.stateLastUsedFilterData.ValueTo!=="",p=this.stateLastUsedFilterData.Uom!=="",d=this.stateLastUsedFilterData.UomTo!=="",f=this.stateLastUsedFilterData.StartDate!=="",y=this.stateLastUsedFilterData.StartDateTo!=="",_=this.stateLastUsedFilterData.EndDate!=="",F=this.stateLastUsedFilterData.EndDateTo!=="";(t||o||e||D||r||l||p||d||f||y||_||F)&&await this.getData()},resetState(){this.stateFilterData={...nt},this.stateDisplayData=[],this.statePagination=new tt,this.stateLoading=!1,this.statePaginationLoading=!1}}}),ht={plannedDurationId:0,model:"",psType:"",value:"",uom:"",startDate:z(new Date),endDate:z(new Date("12/31/9999"))},Y=dt({id:"PlannedDurationForm",state:()=>({stateFormData:{...ht},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1,stateModelOption:[],statePsTypeOption:[],stateUomOption:[]}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uomOption:t=>t.stateUomOption,psTypeOption:t=>t.statePsTypeOption,modelOption:t=>t.stateModelOption},actions:{async getPsTypeLookUp(){const t={ver:"v1"};try{const o=await M.get(Ht,"",new URLSearchParams(t).toString());this.statePsTypeOption=j(o.data.result.content.psType)}catch(o){console.log(o)}},async getModelLookUp(){const t={ver:"v1",isEquipmentModel:"true"};try{const o=await M.get(Nt,"",new URLSearchParams(t).toString());this.stateModelOption=Rt(o.data.result.content,"characteristicValue","characteristicValueDescription")}catch(o){console.log(o)}},async getUomLookUp(){const t={ver:"v1"};try{const o=await M.get(Bt,"",new URLSearchParams(t).toString());this.stateUomOption=j(o.data.result.content.uom)}catch(o){console.log(o)}},async insertData(t){try{this.stateLoading=!0;const o={userAccount:t,ver:"v1"},e={plannedDurationId:0,model:this.stateFormData.model,psType:this.stateFormData.psType,value:this.stateFormData.value,uom:this.stateFormData.uom,startDate:k(z(new Date(this.stateFormData.startDate))),endDate:k(z(new Date(this.stateFormData.endDate)))},D=await M.post(`${q}?${new URLSearchParams(o).toString()}`,e);D.data.title==="Error"?(this.stateErrors.push(D.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(o){this.stateError=o,this.stateErrors.push(o.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const o={userAccount:t,ver:"v1"},e={plannedDurationId:this.stateFormData.plannedDurationId,model:this.stateFormData.model,psType:this.stateFormData.psType,value:this.stateFormData.value,uom:this.stateFormData.uom,startDate:k(z(new Date(this.stateFormData.startDate))),endDate:k(z(new Date(this.stateFormData.endDate)))},D=await M.post(`${le}?${new URLSearchParams(o).toString()}`,e);D.data.title==="Error"?(this.stateErrors.push(D.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(o){this.stateError=o,this.stateErrors.push(o.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.plannedDurationId=t.plannedDurationId||0,this.stateFormData.model=t.model||"",this.stateFormData.psType=t.psType||"",this.stateFormData.value=t.value||"",this.stateFormData.uom=t.uom||"",this.stateFormData.startDate=t.startDate||"",this.stateFormData.endDate=t.endDate||""},resetState(){this.stateFormData={...ht},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),ie={key:0,style:{height:"100px"}},de={key:0,class:"row justify-content-center"},ue={key:1,class:"row justify-content-center"},ce={class:"row justify-content-center"},pe=["onClick"],me=N({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:o}){const e=t,D=ut(),r=Y(),l=o,p=qt(()=>(e.page-1)*10+1),d=G(""),f=v=>{d.value=v.order;const P={prop:v.prop,order:v.order};D.setSort(P)},y=(v,P,S)=>Jt(v[S],P[S],d.value),_=()=>Xt(d.value),F=v=>{r.setFormData(v),l("show-dialog",null)};return(v,P)=>{const S=V("inline-svg"),U=V("el-tooltip"),g=st("loading");return s(D).loading?H((b(),Q("div",ie,null,512)),[[g,s(D).loading]]):H((b(),C(s(gt),{key:1,data:e.listData,style:{width:"100%"},onSortChange:f,"empty-text":"No Data"},{default:m(()=>[a(s(T),{label:"No",width:"90",align:"center"},{default:m(u=>[h("span",null,B(s(p)+u.$index),1)]),_:1}),a(s(T),{prop:"model",label:"Model",width:"200",sortable:"","sort-method":(u,c)=>y(u,c,"model")},null,8,["sort-method"]),a(s(T),{prop:"psType",label:"PS Type",width:"200",sortable:"","sort-method":()=>_()},null,8,["sort-method"]),a(s(T),{prop:"value",label:"Value",width:"110",sortable:"","sort-method":(u,c)=>y(u,c,"value")},null,8,["sort-method"]),a(s(T),{prop:"uom",label:"UOM",width:"100",sortable:"","sort-method":(u,c)=>y(u,c,"uom")},null,8,["sort-method"]),a(s(T),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:m(u=>[h("span",null,B(s(Z)(u.row.startDate)),1)]),_:1}),a(s(T),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:m(u=>[h("span",null,B(s(Z)(u.row.endDate)),1)]),_:1}),a(s(T),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:m(u=>[u.row.isActive?(b(),Q("div",de,[a(S,{src:"/media/svg/tables/rows/check.svg"})])):(b(),Q("div",ue,[a(S,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),a(s(T),{prop:"changedOn",label:"Changed on",align:"center",width:"150",sortable:""},{default:m(u=>[h("span",null,B(s(At)(u.row.changedOn)),1)]),_:1}),a(s(T),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(u,c)=>y(u,c,"ChangedBy")},null,8,["sort-method"]),a(s(T),{label:"",width:"80"},{default:m(u=>[h("div",ce,[a(U,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:m(()=>[h("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:c=>F(u.row)},[a(S,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,pe)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[g,s(D).loading]])}}}),he={class:"col-md-6 fv-row fv-plugins-icon-container"},De={class:"col-md-6 fv-row fv-plugins-icon-container"},ge={class:"dialog-footer"},ve=N({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:o}){const e=t,D=o,r=Y(),l=lt(),p=ot(e,"visibility"),d=x(()=>r.formData),f=x(()=>r.errors),y=x(()=>r.isError),_=Tt().shape({psType:R().required("PS Type is mandatory"),model:R().required("Model is mandatory"),uom:R().required("UOM is mandatory"),value:R().required("Value is mandatory"),startDate:at().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:at().required("End Date is mandatory").min(_t("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),F=()=>{P(""),S(""),U(""),g(""),u(""),c("")},v=(i=!1)=>{w(),F(),r.resetState(),D("handle-close",i)},P=i=>{d.value.uom=i},S=i=>{d.value.model=i},U=i=>{d.value.psType=i},g=i=>{d.value.value=i},u=i=>{d.value.startDate=i},c=i=>{d.value.endDate=i},$=async()=>{w(),await _.validate(d.value,{abortEarly:!1}).catch(i=>{r.setErrors(i.errors)}),!y.value&&W("Are you sure you want to submit ?").then(async i=>{i.isConfirmed&&r.insertData(l.user.Name).then(()=>{r.isError||it("Form has been successfully submitted!","Ok").then(()=>{v(!0)})})})},w=()=>{r.setErrors([])};return(i,n)=>{const E=V("el-button"),I=V("el-dialog"),A=st("loading");return H((b(),C(I,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=O=>p.value=O),title:"New Data",width:"40%",onClose:n[1]||(n[1]=O=>v())},{footer:m(()=>[h("span",ge,[a(E,{type:"primary",onClick:$,disabled:s(r).loading},{default:m(()=>[L("Submit")]),_:1},8,["disabled"]),a(E,{type:"secondary",onClick:v,disabled:s(r).loading},{default:m(()=>[L("Close")]),_:1},8,["disabled"])])]),default:m(()=>[a(vt,{name:"fade"},{default:m(()=>[y.value?(b(),C(St,{key:0,errorMessages:f.value,onResetForm:w},null,8,["errorMessages"])):rt("",!0)]),_:1}),H((b(),C(s(yt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:m(()=>[a(K,{value:d.value.model,placeholder:"Add Model",label:"Model",name:"model",onHandleChange:S,options:s(r).modelOption},null,8,["value","options"]),a(K,{value:d.value.psType,placeholder:"Add PS Type",label:"PS Type",name:"psType",onHandleChange:U,options:s(r).psTypeOption},null,8,["value","options"]),a(ft,{value:d.value.value,placeholder:"Add Value",label:"Value",name:"value",max:10,onHandleChange:g},null,8,["value"]),a(K,{value:d.value.uom,placeholder:"Add UOM",label:"UOM",name:"uom",onHandleChange:P,options:s(r).uomOption},null,8,["value","options"]),h("div",he,[a(et,{value:d.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:u},null,8,["value"])]),h("div",De,[a(et,{value:d.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:c},null,8,["value"])])]),_:1})),[[A,s(r).loading]])]),_:1},8,["modelValue"])),[[A,s(r).loading]])}}}),fe={class:"col-md-6 fv-row fv-plugins-icon-container"},ye={class:"col-md-6 fv-row fv-plugins-icon-container"},Te={class:"dialog-footer"},_e=N({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:o}){const e=t,D=o,r=Y(),l=lt(),p=ot(e,"visibility"),d=x(()=>r.formData),f=x(()=>r.errors),y=x(()=>r.isError),_=Tt().shape({psType:R().required("PS Type is mandatory"),model:R().required("Model is mandatory"),uom:R().required("UOM is mandatory"),value:R().required("Value is mandatory"),startDate:at().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:at().required("End Date is mandatory").min(_t("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),F=()=>{d.value.plannedDurationId=0,P(""),S(""),U(""),g(""),u(""),c("")},v=(i=!1)=>{F(),r.resetState(),w(),D("handle-close",i)},P=i=>{d.value.uom=i},S=i=>{d.value.model=i},U=i=>{d.value.psType=i},g=i=>{d.value.value=i},u=i=>{d.value.startDate=i},c=i=>{d.value.endDate=i},$=async()=>{w(),await _.validate(d.value,{abortEarly:!1}).catch(i=>{r.setErrors(i.errors)}),!y.value&&W("Are you sure you want to submit ?").then(async i=>{i.isConfirmed&&r.updateData(l.user.Name).then(()=>{r.isError||it("Form has been successfully submitted!","Ok").then(()=>{v(!0)})})})},w=()=>{r.setErrors([])};return(i,n)=>{const E=V("el-button"),I=V("el-dialog"),A=st("loading");return H((b(),C(I,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=O=>p.value=O),title:"Update Data",width:"40%",onClose:n[1]||(n[1]=O=>v())},{footer:m(()=>[h("span",Te,[a(E,{type:"primary",onClick:$,disabled:s(r).loading},{default:m(()=>[L("Submit")]),_:1},8,["disabled"]),a(E,{type:"secondary",onClick:v,disabled:s(r).loading},{default:m(()=>[L("Close")]),_:1},8,["disabled"])])]),default:m(()=>[a(vt,{name:"fade"},{default:m(()=>[y.value?(b(),C(St,{key:0,errorMessages:f.value,onResetForm:w},null,8,["errorMessages"])):rt("",!0)]),_:1}),H((b(),C(s(yt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:m(()=>[a(K,{value:d.value.model,placeholder:"Add Model",label:"Model",name:"model",onHandleChange:S,options:s(r).modelOption},null,8,["value","options"]),a(K,{value:d.value.psType,placeholder:"Add PS Type",label:"PS Type",name:"psType",onHandleChange:U,options:s(r).psTypeOption},null,8,["value","options"]),a(ft,{value:d.value.value,placeholder:"Add Value",label:"Value",name:"value",max:10,onHandleChange:g},null,8,["value"]),a(K,{value:d.value.uom,placeholder:"Add UOM",label:"UOM",name:"uom",onHandleChange:P,options:s(r).uomOption},null,8,["value","options"]),h("div",fe,[a(et,{value:d.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:u},null,8,["value"])]),h("div",ye,[a(et,{value:d.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:c},null,8,["value"])])]),_:1})),[[A,s(r).loading]])]),_:1},8,["modelValue"])),[[A,s(r).loading]])}}}),ct=dt({id:"PlannedDurationBulk",state:()=>({statePagination:new tt,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const o={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const e=await M.post(`${se}?${new URLSearchParams(o).toString()}`,this.stateBulkData);this.stateError=e.data.result.isError?e.data.result.message:"",this.stateIsError=e.data.result.isError}catch(e){console.log(e)}this.stateLoading=!1},async upload({userAccount:t,excelFile:o}){const e={userAccount:t,ver:"v1"},D=`${oe}?${new URLSearchParams(e).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const r=await M.postImages(D,o);r.data.statusCode==200?r.data.result.isError?(this.stateIsError=!0,this.stateError=r.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=r.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=Wt.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=r.data.result.isError,this.stateError=r.data.result.message)}catch(r){console.log(r),this.stateIsError=!0,this.stateError=r.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(Qt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new tt,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),Se={class:"icon"},Pe=N({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const o=t,e=ct(),D=x(()=>(o.page-1)*10+1),r=l=>{const p={prop:l.prop,order:l.order};e.setSort(p)};return(l,p)=>{const d=V("inline-svg");return b(),C(s(gt),{data:o.listData,style:{width:"100%"},onSortChange:r,"empty-text":"No Data"},{default:m(()=>[a(s(T),{label:"No",width:"60",align:"center"},{default:m(f=>[h("span",null,B(D.value+f.$index),1)]),_:1}),a(s(T),{prop:"model",label:"Model",width:"200",sortable:""}),a(s(T),{prop:"psType",label:"PS Type",width:"200",sortable:""}),a(s(T),{prop:"value",label:"Value",width:"150",sortable:""}),a(s(T),{prop:"uom",label:"UOM",width:"150",sortable:""}),a(s(T),{prop:"startDate",label:"Start Date",width:"120",sortable:""},{default:m(f=>[h("span",null,B(s(Z)(f.row.startDate)),1)]),_:1}),a(s(T),{prop:"endDate",label:"End Date",width:"100",sortable:""},{default:m(f=>[h("span",null,B(s(Z)(f.row.endDate)),1)]),_:1}),a(s(T),{prop:"validationReason",label:"Remark",width:"200",sortable:""}),a(s(T),{prop:"isValid",label:"Status","min-width":"100",align:"center",sortable:""},{default:m(f=>[h("div",Se,[a(d,{src:f.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),pt=t=>(zt("data-v-18a83fff"),t=t(),jt(),t),be=pt(()=>h("div",{class:"text-center"},null,-1)),Fe=pt(()=>h("div",{class:"mb-3"},[h("span",null,[L(" Download template "),h("a",{href:"documents/MasterDataPlannedDuration.xlsx",target:"_blank",id:"link-download"},"here"),L(" before uploading file ")])],-1)),Ee=pt(()=>h("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[h("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),Ue={class:"card"},we={class:"card-body grid-padding"},ke={class:"dialog-footer"},Ce=N({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:o}){const e=t,D=o,r=lt(),l=ct(),p=ot(e,"visibility"),d=()=>{const g=te(l.validatedData,u=>{console.log(u);const c=u;return{plannedDurationId:0,model:c.model,psType:c.psType,value:c.value,uom:c.uom,startDate:c.startDate,endDate:c.endDate}});return Object.values(g)},f=()=>{const g=document.getElementById("link-download");g&&g.click()},y=()=>{l.validatedData.length>0?W("Cancel Upload Data?","Confirm").then(u=>{u.isConfirmed&&F()}):F()},_=async g=>{await l.upload({userAccount:r.user.Name,excelFile:g}),l.stateError&&J(l.error)},F=(g=!1)=>{l.resetState(),D("handle-close",g)},v=g=>{l.setIsUploadedState(g)},P=g=>{l.setPage(g)},S=()=>{if(l.validatedData.length<1){f();return}const g=["MODEL","PS TYPE","VALUE","UOM","START DATE","END DATE","REMARK","STATUS"],u=l.validatedData.map(c=>({model:c.model,psType:c.psType,value:String(c.value),uom:c.uom,startDate:c.startDate,endDate:c.endDate,remark:c.validationReason,status:c.isValid?"OK":"Error"}));Ot("PlannedDuration",g,u)},U=async()=>{if(l.displayData.length<1){J("There is no data to submit");return}if(l.isError){J("There is still invalid row(s)");return}W("Are you sure you want to submit ?").then(async g=>{if(g.isConfirmed){const u=d();if(l.setBulkData(u),await l.bulkInsert(r.user.Name),l.isError){J(l.stateError);return}it("Form has been successfully submitted!","Ok").then(()=>{F(!0)})}})};return(g,u)=>{const c=V("el-button"),$=V("el-dialog"),w=st("loading");return b(),C($,{title:"Upload Bulk Data",modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=i=>p.value=i),"before-close":y,width:"70%","custom-class":"upload-modal"},{footer:m(()=>[h("div",null,[h("span",ke,[a(c,{type:"success",onClick:S},{default:m(()=>[L("Download")]),_:1}),a(c,{type:"primary",onClick:U},{default:m(()=>[L("Upload")]),_:1}),a(c,{type:"success",onClick:y},{default:m(()=>[L("Cancel")]),_:1})])])]),default:m(()=>[be,Fe,H(a(Zt,{isSubmissionUploadSuccess:s(l).isUploaded,onHandleCloseUploadedFile:y,onHandleUpload:_,onHandleSetIsExcelFileUploaded:v},null,8,["isSubmissionUploadSuccess"]),[[w,s(l).uploadLoading]]),Ee,h("div",Ue,[h("div",we,[a(Pe,{"list-data":s(l).displayData,page:s(l).pagination.currentPage},null,8,["list-data","page"])])]),s(l).displayData.length>0?(b(),C(Dt,{key:0,onRaisePageChange:u[0]||(u[0]=i=>P(i)),currentPage:s(l).pagination.currentPage,totalPage:s(l).pagination.totalPage,totalPageSize:s(l).pagination.totalPageSize,startPaginationIndex:s(l).pagination.startPaginationIndex,endPaginationIndex:s(l).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):rt("",!0)]),_:1},8,["modelValue"])}}}),Le=ee(Ce,[["__scopeId","data-v-18a83fff"]]),Ve={class:"row g-9 my-4"},Ie={class:"dialog-footer"},Oe=N({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:o}){const e=ut();Y();const D=t,r=o,l=ot(D,"visibility"),p=x(()=>e.filterData),d=()=>{f(),e.resetFilter()},f=()=>{r("handle-close",!1)},y=n=>{e.setModel(n)},_=n=>{e.setModelTo(n)},F=n=>{e.setPsType(n)},v=n=>{e.setPsTypeTo(n)},P=n=>{e.setValue(n)},S=n=>{e.setValueTo(n)},U=n=>{e.setUom(n)},g=n=>{e.setUomTo(n)},u=n=>{e.setStartDate(n)},c=n=>{e.setStartDateTo(n)},$=n=>{e.setEndDate(n)},w=n=>{e.setEndDateTo(n)},i=()=>{const n=e.lastUsedFilterData.Model!==e.filterData.Model,E=e.lastUsedFilterData.ModelTo!==e.filterData.ModelTo,I=e.lastUsedFilterData.PsType!==e.filterData.PsType,A=e.lastUsedFilterData.PsTypeTo!==e.filterData.PsTypeTo,O=e.lastUsedFilterData.Value!==e.filterData.Value,Pt=e.lastUsedFilterData.ValueTo!==e.filterData.ValueTo,bt=e.lastUsedFilterData.Uom!==e.filterData.Uom,Ft=e.lastUsedFilterData.UomTo!==e.filterData.UomTo,Et=e.lastUsedFilterData.StartDate!==e.filterData.StartDate,Ut=e.lastUsedFilterData.StartDateTo!==e.filterData.StartDateTo,wt=e.lastUsedFilterData.EndDate!==e.filterData.EndDate,kt=e.lastUsedFilterData.EndDateTo!==e.filterData.EndDateTo;r("handle-close",n||E||I||A||O||Pt||bt||Ft||Et||Ut||wt||kt)};return(n,E)=>{const I=V("el-button"),A=V("el-dialog");return b(),C(A,{modelValue:l.value,"onUpdate:modelValue":E[0]||(E[0]=O=>l.value=O),title:"Filter",width:"60%",onClose:E[1]||(E[1]=O=>f())},{footer:m(()=>[h("span",Ie,[a(I,{type:"secondary",onClick:d},{default:m(()=>[L("Reset")]),_:1}),a(I,{type:"primary",onClick:i},{default:m(()=>[L("Filter")]),_:1})])]),default:m(()=>[h("div",Ve,[a(X,{"value-from":p.value.Model,"value-to":p.value.ModelTo,label:"Model",options:s(e).modelOption,onHandleChangeFrom:y,onHandleChangeTo:_},null,8,["value-from","value-to","options"]),a(X,{"value-from":p.value.PsType,"value-to":p.value.PsTypeTo,label:"PS Type",options:s(e).psTypeOption,onHandleChangeFrom:F,onHandleChangeTo:v},null,8,["value-from","value-to","options"]),a(X,{"value-from":p.value.Value,"value-to":p.value.ValueTo,label:"Value",name:"Value",options:s(e).valueOption,onHandleChangeFrom:P,onHandleChangeTo:S},null,8,["value-from","value-to","options"]),a(X,{"value-from":p.value.Uom,"value-to":p.value.UomTo,label:"UOM",name:"Uom",options:s(e).uomOption,onHandleChangeFrom:U,onHandleChangeTo:g},null,8,["value-from","value-to","options"]),a(mt,{"value-from":p.value.StartDate?p.value.StartDate.toString():"","value-to":p.value.StartDateTo?p.value.StartDateTo.toString():"",label:"Start Date",name:"StartDate",placeholder:"Pick a date",onHandleChangeFrom:u,onHandleChangeTo:c},null,8,["value-from","value-to"]),a(mt,{"value-from":p.value.EndDate?p.value.EndDate.toString():"","value-to":p.value.EndDateTo?p.value.EndDateTo.toString():"",label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChangeFrom:$,onHandleChangeTo:w},null,8,["value-from","value-to"])])]),_:1},8,["modelValue"])}}}),Me={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},xe=h("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),$e={class:"d-flex justify-content-between align-items-center"},Ae={class:"card"},Re={class:"card-body grid-padding"},Be={class:"my-5"},as=N({__name:"Index",setup(t){const o=Ct(),e=ut(),D=Y(),r=ct(),l=G(!1),p=G(!1),d=G(!1),f=G(!1),y=x(()=>e.displayData),_=x(()=>e.pagination),F=n=>{e.setPage(n)};Kt(async()=>{o[Vt.ACTIVE_PAGE]("IronLake"),Lt("Planned Duration",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Parameter",pageRoute:"plannedduration"},{pageName:"Planned Duration",pageRoute:"plannedduration"}]),e.setPage(1),e.getLookup(),D.getUomLookUp(),D.getPsTypeLookUp(),D.getModelLookUp()}),Gt(async()=>{e.resetState(),D.resetState(),r.resetState()});const v=async()=>{await e.setPage(1),await e.getLookup(),await D.getUomLookUp(),await D.getPsTypeLookUp(),await D.getModelLookUp()},P=()=>{l.value=!0},S=async n=>{l.value=!1,n&&await v()},U=()=>{p.value=!0},g=async n=>{p.value=!1,n&&await v()},u=()=>{d.value=!0},c=async n=>{d.value=!1,n&&await v()},$=async()=>{const n=await e.export();ae.saveAs(new Blob([n],{type:"application/octet-stream"}),"Planned Duration.xlsx")},w=()=>{f.value=!0},i=async n=>{f.value=!1,n&&await v()};return(n,E)=>(b(),Q(Yt,null,[h("div",Me,[xe,h("div",$e,[a(Mt,{onShowDialog:P}),a(It,{onShowDialog:u}),a($t,{onHandleDownload:$}),a(xt,{onShowDialog:w})])]),h("div",Ae,[h("div",Re,[a(me,{"list-data":y.value,page:_.value.currentPage,onShowDialog:U},null,8,["list-data","page"])])]),h("div",Be,[s(e).paginationLoading?rt("",!0):(b(),C(Dt,{key:0,onRaisePageChange:E[0]||(E[0]=I=>F(I)),currentPage:_.value.currentPage,totalPage:_.value.totalPage,totalPageSize:_.value.totalPageSize,startPaginationIndex:_.value.startPaginationIndex,endPaginationIndex:_.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),a(ve,{visibility:l.value,onHandleClose:S},null,8,["visibility"]),a(_e,{visibility:p.value,onHandleClose:g},null,8,["visibility"]),a(Oe,{visibility:d.value,onHandleClose:c},null,8,["visibility"]),a(Le,{visibility:f.value,onHandleClose:i},null,8,["visibility"])],64))}});export{as as default};

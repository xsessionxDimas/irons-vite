import{u as vt}from"./vuex-BbOKrtVp.js";import{a as _t}from"./breadcrumb-D-Q4Tk9w.js";import{b as B,u as nt,i as K,h as st,j as M,A as St}from"./index-BCnwA6yE.js";import{P as ut}from"./Pagination-CVDIvnOM.js";import{F as yt}from"./FilterIconButton-Bj0WTbms.js";import{h as bt,A as Et,U as It}from"./excel-generator-CRLIz6fw.js";import{D as wt}from"./DownloadIconButton-CIQp-YG7.js";import{_ as S,b as pt}from"./element-plus-C5R56mia.js";import{n as x,f as U,a as G,b as Ct}from"./date-format-BASVuupi.js";import{a as V}from"./urls-SoFki2RW.js";import{d as lt}from"./pinia-BjOS2_Ao.js";import{P as W,d as Ft,a as kt}from"./table-sort-VnBD5Hfa.js";import{b as Tt}from"./mapOption-sP4IrA4W.js";import{k as N,c as L,r as O,u as l,y as q,p as E,aa as j,q as C,x as g,Y as Q,R as T,s as n,aB as u,C as $,a0 as X,B as k,A as Z,T as ht,bd as xt,bb as Lt,a7 as Ut,L as At,F as $t}from"./@vue-BypzYtbH.js";import{_ as Y}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-DQfguttb.js";import{_ as H}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{a as mt}from"./vee-validate-C_msoaAA.js";import{c as Dt,a as R,b as J,d as Pt}from"./yup-BRaPd8dh.js";import"./property-expr-DEi1ZLzV.js";import{E as ft}from"./ErrorAlert-CMKGfwAi.js";import{e as Bt}from"./lodash-Cr9vlq0V.js";import{_ as Vt}from"./FileDropZone.vue_vue_type_style_index_0_lang-Ct77XTnP.js";import{m as Nt}from"./map-anything-abi6NY2Z.js";import{_ as Ht}from"./nw-img-vue-CR837WER.js";import{_ as Ot}from"./AutoComplete.vue_vue_type_style_index_0_lang-CRR6Z--K.js";import{_ as ct}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-DO0pIl2P.js";import{F as Rt}from"./file-saver-DhbZvGod.js";import"./vue-router-iNp9kJ0K.js";import"./object-path-BACu75q6.js";import"./attr-accept-BWI1aNlo.js";import"./crypto-js-BZehCumu.js";import"./cron-Ci8nYs3o.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-N3crNZ6y.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-DK0FVkv3.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./dayjs-C7SXsQPH.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-xcxZ5rdH.js";import"./mitt-C1xD_ZTF.js";import"./@popperjs-WhmJkuoZ.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./vue-i18n-CE6bnohq.js";import"./@intlify-CjZh8qSI.js";import"./PageEnum-BoOqFyRq.js";import"./xlsx-CpbwoZfi.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-CalJriC0.js";import"./vue3-dropzone-DPWU9yJt.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";const gt={PlanningPlantKeyId:0,PlanningPlantId:"",PlanningPlantCode:"",PlanningPlantDescription:"",StartDate:x(new Date),EndDate:x(new Date("12/31/9999"))},tt=lt({id:"planningPlantForm",state:()=>({stateFormData:{...gt},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading},actions:{async insertData(t){try{this.stateLoading=!0;const o={userAccount:t,ver:"v1"},a={PlanningPlantId:this.stateFormData.PlanningPlantId,PlanningPlantCode:this.stateFormData.PlanningPlantCode,PlanningPlantDescription:this.stateFormData.PlanningPlantDescription,StartDate:U(x(new Date(this.stateFormData.StartDate))),EndDate:U(x(new Date(this.stateFormData.EndDate)))},h=await B.post(`${V.insertItem}?${new URLSearchParams(o).toString()}`,a);h.data.title==="Error"?(this.stateErrors.push(h.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(o){this.stateError=o,this.stateErrors.push(o.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const o={userAccount:t,ver:"v1"},a={PlanningPlantKeyId:this.stateFormData.PlanningPlantKeyId,PlanningPlantId:this.stateFormData.PlanningPlantId,PlanningPlantCode:this.stateFormData.PlanningPlantCode,PlanningPlantDescription:this.stateFormData.PlanningPlantDescription,StartDate:U(x(new Date(this.stateFormData.StartDate))),EndDate:U(x(new Date(this.stateFormData.EndDate)))},h=await B.post(`${V.updateItem}?${new URLSearchParams(o).toString()}`,a);h.data.title==="Error"?(this.stateErrors.push(h.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(o){this.stateError=o,this.stateErrors.push(o.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.PlanningPlantKeyId=t.planningPlantKeyId||0,this.stateFormData.PlanningPlantId=t.planningPlantId||"",this.stateFormData.PlanningPlantCode=t.planningPlantCode||"",this.stateFormData.PlanningPlantDescription=t.planningPlantDescription||"",this.stateFormData.StartDate=t.startDate||"",this.stateFormData.EndDate=t.endDate||""},resetState(){this.stateFormData={...gt},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),et={PlanningPlantId:"",PlanningPlantIdTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},ot=lt({id:"planningPlantList",state:()=>({stateFilterData:{...et},stateLastUsedFilterData:{...et},statePageName:"planningPlant",stateDisplayData:[],statePagination:new W,stateLoading:!1,statePaginationLoading:!1,statePlanningPlantIdOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,planningPlantIdOption:t=>t.statePlanningPlantIdOption},actions:{async getData(t=!0){const o={PlanningPlantId:this.stateFilterData.PlanningPlantId,PlanningPlantIdTo:this.stateFilterData.PlanningPlantIdTo,StartDate:this.stateFilterData.StartDate?U(x(new Date(this.stateFilterData.StartDate))):"",StartDateTo:this.stateFilterData.StartDateTo?U(x(new Date(this.stateFilterData.StartDateTo))):"",EndDate:this.stateFilterData.EndDate?U(x(new Date(this.stateFilterData.EndDate))):"",EndDateTo:this.stateFilterData.EndDateTo?U(x(new Date(this.stateFilterData.EndDateTo))):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const a=await B.get(V.getList,"",new URLSearchParams(o).toString());this.stateDisplayData=a.data.result.content,this.setTotalPage(a.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(a){console.log(a)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const o=await B.get(V.getLookup,"",new URLSearchParams(t).toString());this.statePlanningPlantIdOption=Tt(o.data.result.content,"planningPlantId","planningPlantCode","planningPlantDescription")}catch(o){console.log(o)}},async export(){const t={ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await B.getBlob(V.exportData,"",new URLSearchParams(t).toString())).data}catch(o){console.log(o)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:o}){if(!t&&!o)this.stateFilterData.Order="";else{const a=o=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${a}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setPlanningPlantId(t){this.stateFilterData.PlanningPlantId=t},setPlanningPlantIdTo(t){this.stateFilterData.PlanningPlantIdTo=t},setStartDate(t){this.stateFilterData.StartDate=t},setStartDateTo(t){this.stateFilterData.StartDateTo=t},setEndDate(t){this.stateFilterData.EndDate=t},setEndDateTo(t){this.stateFilterData.EndDateTo=t},async resetFilter(){this.stateFilterData.PlanningPlantId="",this.stateFilterData.PlanningPlantIdTo="",this.stateFilterData.StartDate="",this.stateFilterData.StartDateTo="",this.stateFilterData.EndDate="",this.stateFilterData.EndDateTo="";const t=this.stateLastUsedFilterData.PlanningPlantId!=="",o=this.stateLastUsedFilterData.PlanningPlantIdTo!=="",a=this.stateLastUsedFilterData.StartDate!=="",h=this.stateLastUsedFilterData.StartDateTo!=="",d=this.stateLastUsedFilterData.EndDate!=="",s=this.stateLastUsedFilterData.EndDateTo!=="";(t||o||a||h||d||s)&&await this.getData()},resetState(){this.stateFilterData={...et},this.stateDisplayData=[],this.statePagination=new W,this.stateLoading=!1,this.statePaginationLoading=!1}}}),qt={key:0,style:{height:"100px"}},zt={key:0,class:"row justify-content-center"},Mt={key:1,class:"row justify-content-center"},jt={class:"row justify-content-center"},Kt=["onClick"],Gt=N({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:o}){const a=t,h=ot(),d=tt(),s=o,D=L(()=>(a.page-1)*10+1),i=O(""),P=v=>{i.value=v.order;const _={prop:v.prop,order:v.order};h.setSort(_)},f=(v,_,y)=>Ft(v[y],_[y],i.value),F=v=>{d.setFormData(v),s("show-dialog",null)};return(v,_)=>{const y=T("inline-svg"),w=T("el-tooltip"),I=Q("loading");return l(h).loading?q((E(),j("div",qt,null,512)),[[I,l(h).loading]]):q((E(),C(l(pt),{key:1,data:a.listData,style:{width:"100%"},onSortChange:P,"empty-text":"No Data",class:"fixed-height-table"},{default:g(()=>[n(l(S),{label:"No",width:"90",align:"center"},{default:g(e=>[u("span",null,$(D.value+e.$index),1)]),_:1}),n(l(S),{prop:"planningPlantId",label:"Planning Plant ID",width:"150",sortable:"","sort-method":(e,c)=>f(e,c,"planningPlantId")},null,8,["sort-method"]),n(l(S),{prop:"planningPlantCode",label:"Planning Plant Code",width:"200",sortable:"","sort-method":(e,c)=>f(e,c,"planningPlantCode")},null,8,["sort-method"]),n(l(S),{prop:"planningPlantDescription",label:"Planning Plant Desc.","min-width":"200",sortable:"","sort-method":(e,c)=>f(e,c,"planningPlantDescription")},null,8,["sort-method"]),n(l(S),{prop:"startDate",label:"Start Date",align:"center",width:"120",sortable:""},{default:g(e=>[u("span",null,$(l(G)(e.row.startDate)),1)]),_:1}),n(l(S),{prop:"endDate",label:"End Date",align:"center",width:"100",sortable:""},{default:g(e=>[u("span",null,$(l(G)(e.row.endDate)),1)]),_:1}),n(l(S),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:g(e=>[e.row.isActive?(E(),j("div",zt,[n(y,{src:"/media/svg/tables/rows/check.svg"})])):(E(),j("div",Mt,[n(y,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),n(l(S),{prop:"changedOn",label:"Changed on",align:"center",width:"170",sortable:""},{default:g(e=>[u("span",null,$(l(Ct)(e.row.changedOn)),1)]),_:1}),n(l(S),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(e,c)=>f(e,c,"changeBy")},null,8,["sort-method"]),n(l(S),{label:"",width:"80"},{default:g(e=>[u("div",jt,[n(w,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:g(()=>[u("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:c=>F(e.row)},[n(y,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,Kt)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[I,l(h).loading]])}}}),Wt={class:"col-md-6 fv-row fv-plugins-icon-container"},Yt={class:"col-md-6 fv-row fv-plugins-icon-container"},Jt={class:"dialog-footer"},Qt=N({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:o}){const a=t,h=o,d=tt(),s=nt(),D=X(a,"visibility"),i=L(()=>d.formData),P=L(()=>d.errors),f=L(()=>d.isError),F=()=>{y(""),w(""),I(""),e(""),c("")},v=Dt().shape({PlanningPlantId:R().required("Planning Plant ID is mandatory"),PlanningPlantCode:R().required("Planning Plant Code is mandatory"),PlanningPlantDescription:R().required("Planning Plant Description is mandatory"),StartDate:J().required("Start Date is mandatory").typeError("Start Date is mandatory"),EndDate:J().required("End Date is mandatory").min(Pt("StartDate"),"End date must be later than start date").typeError("End date must be later than start date")}),_=(r=!1)=>{m(),F(),d.resetState(),h("handle-close",r)},y=r=>{i.value.PlanningPlantId=r},w=r=>{i.value.PlanningPlantCode=r},I=r=>{i.value.PlanningPlantDescription=r},e=r=>{i.value.StartDate=r},c=r=>{i.value.EndDate=r},p=async()=>{m(),await v.validate(i.value,{abortEarly:!1}).catch(r=>{d.setErrors(r.errors)}),!f.value&&K("Are you sure you want to submit ?").then(async r=>{r.isConfirmed&&d.insertData(s.user.Name).then(()=>{d.isError||st("Form has been successfully submitted!","Ok").then(()=>{_(!0)})})})},m=()=>{d.setErrors([])};return(r,b)=>{const A=T("el-button"),at=T("el-dialog"),z=Q("loading");return E(),C(at,{modelValue:D.value,"onUpdate:modelValue":b[0]||(b[0]=dt=>D.value=dt),title:"New Data",width:"40%",onClose:b[1]||(b[1]=dt=>_())},{footer:g(()=>[u("span",Jt,[n(A,{type:"primary",onClick:p,disabled:l(d).loading},{default:g(()=>[k("Submit")]),_:1},8,["disabled"]),n(A,{type:"secondary",onClick:_,disabled:l(d).loading},{default:g(()=>[k("Close")]),_:1},8,["disabled"])])]),default:g(()=>[n(ht,{name:"fade"},{default:g(()=>[f.value?(E(),C(ft,{key:0,errorMessages:P.value,onResetForm:m},null,8,["errorMessages"])):Z("",!0)]),_:1}),q((E(),C(l(mt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:g(()=>[n(H,{value:i.value.PlanningPlantId,margin:!1,placeholder:"Add Planning Plant ID",label:"Planning Plant ID",name:"PlanningPlantId",max:4,onHandleChange:y},null,8,["value"]),n(H,{value:i.value.PlanningPlantCode,margin:!1,placeholder:"Add Planning Plant Code",label:"Planning Plant Code",name:"PlanningPlantCode",max:4,onHandleChange:w},null,8,["value"]),n(H,{value:i.value.PlanningPlantDescription,placeholder:"Add Planning Plant Description",label:"Planning Plant Desc.",name:"PlanningPlantDescription",max:30,onHandleChange:I},null,8,["value"]),u("div",Wt,[n(Y,{value:i.value.StartDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:e},null,8,["value"])]),u("div",Yt,[n(Y,{value:i.value.EndDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:c},null,8,["value"])])]),_:1})),[[z,l(d).loading]])]),_:1},8,["modelValue"])}}}),Xt={class:"col-md-6 fv-row fv-plugins-icon-container"},Zt={class:"col-md-6 fv-row fv-plugins-icon-container"},ta={class:"dialog-footer"},aa=N({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:o}){const a=t,h=o,d=tt(),s=nt(),D=X(a,"visibility"),i=L(()=>d.formData),P=L(()=>d.errors),f=L(()=>d.isError),F=Dt().shape({PlanningPlantCode:R().required("Planning Plant Code is mandatory"),PlanningPlantDescription:R().required("Planning Plant Description is mandatory"),StartDate:J().required("Start Date is mandatory").typeError("Start Date is mandatory"),EndDate:J().required("End Date is mandatory").min(Pt("StartDate"),"End date must be later than start date").typeError("End date must be later than start date")}),v=()=>{i.value.PlanningPlantKeyId=0,i.value.PlanningPlantId="",i.value.PlanningPlantCode="",i.value.PlanningPlantDescription="",i.value.StartDate="",i.value.EndDate=""},_=(m=!1)=>{v(),d.resetState(),p(),h("handle-close",m)},y=m=>{i.value.PlanningPlantCode=m},w=m=>{i.value.PlanningPlantDescription=m},I=m=>{i.value.StartDate=m},e=m=>{i.value.EndDate=m},c=async()=>{p(),await F.validate(i.value,{abortEarly:!1}).catch(m=>{d.setErrors(m.errors)}),!f.value&&K("Are you sure you want to submit ?").then(async m=>{m.isConfirmed&&d.updateData(s.user.Name).then(()=>{d.isError||st("Form has been successfully submitted!","Ok").then(()=>{_(!0)})})})},p=()=>{d.setErrors([])};return(m,r)=>{const b=T("el-button"),A=T("el-dialog"),at=Q("loading");return E(),C(A,{modelValue:D.value,"onUpdate:modelValue":r[0]||(r[0]=z=>D.value=z),title:"Update Data",width:"40%",onClose:r[1]||(r[1]=z=>_())},{footer:g(()=>[u("span",ta,[n(b,{type:"primary",onClick:c,disabled:l(d).loading},{default:g(()=>[k("Submit")]),_:1},8,["disabled"]),n(b,{type:"secondary",onClick:_,disabled:l(d).loading},{default:g(()=>[k("Close")]),_:1},8,["disabled"])])]),default:g(()=>[n(ht,{name:"fade"},{default:g(()=>[f.value?(E(),C(ft,{key:0,errorMessages:P.value,onResetForm:p},null,8,["errorMessages"])):Z("",!0)]),_:1}),q((E(),C(l(mt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:g(()=>[n(H,{value:i.value.PlanningPlantId,margin:!1,placeholder:"Add Planning Plant Id",label:"Planning Plant Id",name:"planningPlantId",max:4,disabled:!0},null,8,["value"]),n(H,{value:i.value.PlanningPlantCode,margin:!1,placeholder:"Add Planning Plant Code",label:"Planning Plant Code",name:"PlanningPlantCode",max:30,onHandleChange:y},null,8,["value"]),n(H,{value:i.value.PlanningPlantDescription,margin:!1,placeholder:"Add Planning Plant Description",label:"Planning Plant Desc.",name:"PlanningPlantDescription",max:30,onHandleChange:w},null,8,["value"]),u("div",Xt,[n(Y,{value:i.value.StartDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:I},null,8,["value"])]),u("div",Zt,[n(Y,{value:i.value.EndDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:e},null,8,["value"])])]),_:1})),[[at,l(d).loading]])]),_:1},8,["modelValue"])}}}),it=lt({id:"planningPlantBulk",state:()=>({statePagination:new W,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const o={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const a=await B.post(`${V.uploadBulk}?${new URLSearchParams(o).toString()}`,this.stateBulkData);this.stateError=a.data.result.isError?a.data.result.message:"",this.stateIsError=a.data.result.isError}catch(a){console.log(a)}this.stateLoading=!1},async upload({userAccount:t,excelFile:o}){var d;const a={userAccount:t,ver:"v1"},h=`${V.validateUpload}?${new URLSearchParams(a).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const s=await B.postImages(h,o);s.data.statusCode==200?s.data.result.isError?(this.stateIsError=!0,this.stateError=s.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=s.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=Bt.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=s.data.result.isError??!1,this.stateError=(d=s.data.result)==null?void 0:d.message)}catch(s){console.log(s),this.stateIsError=!0,this.stateError=s.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(kt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new W,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),ea={class:"icon"},na=N({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const o=t,a=it(),h=L(()=>(o.page-1)*10+1),d=s=>{const D={prop:s.prop,order:s.order};a.setSort(D)};return(s,D)=>{const i=T("inline-svg");return E(),C(l(pt),{data:o.listData,style:{width:"100%"},onSortChange:d,"empty-text":"No Data"},{default:g(()=>[n(l(S),{label:"No",width:"60",align:"center"},{default:g(P=>[u("span",null,$(h.value+P.$index),1)]),_:1}),n(l(S),{prop:"planningPlantId",label:"Planning Plant ID",width:"170",sortable:""}),n(l(S),{prop:"planningPlantCode",label:"Planning Plant Code",width:"170",sortable:""}),n(l(S),{prop:"planningPlantDescription",label:"Planning Plant Desc.",sortable:""}),n(l(S),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:g(P=>[u("span",null,$(l(G)(P.row.startDate)),1)]),_:1}),n(l(S),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:g(P=>[u("span",null,$(l(G)(P.row.endDate)),1)]),_:1}),n(l(S),{prop:"validationReason",label:"Remark","min-width":"300",sortable:""}),n(l(S),{prop:"isValid",label:"Status",width:"100",sortable:""},{default:g(P=>[u("div",ea,[n(i,{src:P.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),rt=t=>(xt("data-v-3a949812"),t=t(),Lt(),t),sa=rt(()=>u("div",{class:"text-center"},null,-1)),la=rt(()=>u("div",{class:"mb-3"},[u("span",null,[k(" Download template "),u("a",{href:"/documents/MasterDataPlanningPlant.xlsx",target:"_blank",id:"link-download"},"here"),k(" before uploading file ")])],-1)),oa=rt(()=>u("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[u("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),ia={class:"card"},ra={class:"card-body grid-padding"},da={class:"dialog-footer"},ca=N({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:o}){const a=t,h=o,d=nt(),s=it(),D=X(a,"visibility"),i=()=>{const e=Nt(s.validatedData,c=>{const p=c;return{planningPlantId:p.planningPlantId,planningPlantCode:p.planningPlantCode,planningPlantDescription:p.planningPlantDescription,startDate:p.startDate,endDate:p.endDate}});return Object.values(e)},P=()=>{const e=document.getElementById("link-download");e&&e.click()},f=()=>{s.validatedData.length>0?K("Cancel Upload Data?","Confirm").then(c=>{c.isConfirmed&&v()}):v()},F=async e=>{await s.upload({userAccount:d.user.Name,excelFile:e}),s.stateError&&M(s.error)},v=(e=!1)=>{s.resetState(),h("handle-close",e)},_=e=>{s.setIsUploadedState(e)},y=e=>{s.setPage(e)},w=()=>{if(s.validatedData.length<1){P();return}const e=["PLANNING PLANT ID","PLANNING PLANT CODE","PLANNING PLANT DESC","START DATE","END DATE","REMARK","STATUS"],c=s.validatedData.map(p=>({planningPlantId:p.planningPlantId,planningPlantCode:p.planningPlantCode,planningPlantDescription:p.planningPlantDescription,startDate:p.startDate,endDate:p.endDate,remark:p.validationReason,status:p.isValid?"OK":"Error"}));bt("Planning Plant",e,c)},I=async()=>{if(s.displayData.length<1){M("There is no data to submit");return}if(s.isError){M("There is still invalid row(s)");return}K("Are you sure you want to submit ?").then(async e=>{if(e.isConfirmed){const c=i();if(s.setBulkData(c),await s.bulkInsert(d.user.Name),s.isError){M(s.stateError);return}st("Form has been successfully submitted!","Ok").then(()=>{v(!0)})}})};return(e,c)=>{const p=T("el-button"),m=T("el-dialog"),r=Q("loading");return E(),C(m,{title:"Upload Bulk Data",modelValue:D.value,"onUpdate:modelValue":c[1]||(c[1]=b=>D.value=b),"before-close":f,width:"70%","custom-class":"upload-modal"},{footer:g(()=>[u("div",null,[u("span",da,[n(p,{type:"success",onClick:w},{default:g(()=>[k("Download")]),_:1}),n(p,{type:"primary",onClick:I},{default:g(()=>[k("Upload")]),_:1}),n(p,{type:"success",onClick:f},{default:g(()=>[k("Cancel")]),_:1})])])]),default:g(()=>[sa,la,q(n(Vt,{isSubmissionUploadSuccess:l(s).isUploaded,onHandleCloseUploadedFile:f,onHandleUpload:F,onHandleSetIsExcelFileUploaded:_},null,8,["isSubmissionUploadSuccess"]),[[r,l(s).uploadLoading]]),oa,u("div",ia,[u("div",ra,[n(na,{"list-data":l(s).displayData,page:l(s).pagination.currentPage},null,8,["list-data","page"])])]),l(s).displayData.length>0?(E(),C(ut,{key:0,onRaisePageChange:c[0]||(c[0]=b=>y(b)),currentPage:l(s).pagination.currentPage,totalPage:l(s).pagination.totalPage,totalPageSize:l(s).pagination.totalPageSize,startPaginationIndex:l(s).pagination.startPaginationIndex,endPaginationIndex:l(s).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):Z("",!0)]),_:1},8,["modelValue"])}}}),ga=Ht(ca,[["__scopeId","data-v-3a949812"]]),ua={class:"row g-9 my-4"},pa={class:"dialog-footer"},ha=N({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:o}){const a=ot(),h=t,d=o,s=X(h,"visibility"),D=L(()=>a.filterData),i=()=>{P(),a.resetFilter()},P=()=>{d("handle-close",!1)},f=e=>{a.setPlanningPlantId(e)},F=e=>{a.setPlanningPlantIdTo(e)},v=e=>{a.setStartDate(e)},_=e=>{a.setStartDateTo(e)},y=e=>{a.setEndDate(e)},w=e=>{a.setEndDateTo(e)},I=()=>{const e=a.lastUsedFilterData.PlanningPlantId!==a.filterData.PlanningPlantId,c=a.lastUsedFilterData.PlanningPlantIdTo!==a.filterData.PlanningPlantIdTo,p=a.lastUsedFilterData.StartDate!==a.filterData.StartDate,m=a.lastUsedFilterData.StartDateTo!==a.filterData.StartDateTo,r=a.lastUsedFilterData.EndDate!==a.filterData.EndDate,b=a.lastUsedFilterData.EndDateTo!==a.filterData.EndDateTo;d("handle-close",e||c||p||m||r||b)};return(e,c)=>{const p=T("el-button"),m=T("el-dialog");return E(),C(m,{modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=r=>s.value=r),title:"Filter",width:"60%",onClose:c[1]||(c[1]=r=>P())},{footer:g(()=>[u("span",pa,[n(p,{type:"secondary",onClick:i},{default:g(()=>[k("Reset")]),_:1}),n(p,{type:"primary",onClick:I},{default:g(()=>[k("Filter")]),_:1})])]),default:g(()=>[u("div",ua,[n(Ot,{"value-from":D.value.PlanningPlantId,"value-to":D.value.PlanningPlantIdTo,label:"PlanningPlant ID",name:"PlanningPlantId",options:l(a).planningPlantIdOption,onHandleChangeFrom:f,onHandleChangeTo:F},null,8,["value-from","value-to","options"]),n(ct,{"value-from":D.value.StartDate,"value-to":D.value.StartDateTo,label:"Start Date",name:"StartDate",placeholder:"Pick a date",onHandleChangeFrom:v,onHandleChangeTo:_},null,8,["value-from","value-to"]),n(ct,{"value-from":D.value.EndDate,"value-to":D.value.EndDateTo,label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChangeFrom:y,onHandleChangeTo:w},null,8,["value-from","value-to"])])]),_:1},8,["modelValue"])}}}),ma={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},Da=u("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),Pa={class:"d-flex justify-content-between align-items-center"},fa={class:"card"},va={class:"card-body grid-padding"},_a={class:"my-5"},we=N({__name:"Index",setup(t){const o=vt(),a=ot(),h=tt(),d=it(),s=O(!1),D=O(!1),i=O(!1),P=O(!1);Ut(async()=>{o.dispatch(St.ACTIVE_PAGE,"IronLake"),_t("Planning Plant",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Business Partner",pageRoute:"planningplant"},{pageName:"Planning Plant",pageRoute:"planningplant"}]),await a.setPage(1),await a.getLookup()}),At(()=>{a.resetState(),h.resetState(),d.resetState()});const f=async()=>{await a.setPage(1),await a.getLookup()},F=r=>{a.setPage(r)},v=()=>{s.value=!0},_=async r=>{s.value=!1,r&&await f()},y=()=>{D.value=!0},w=async r=>{D.value=!1,r&&await f()},I=()=>{i.value=!0},e=async r=>{i.value=!1,r&&await f()},c=async()=>{const r=await a.export();Rt.saveAs(new Blob([r],{type:"application/octet-stream"}),"Planning Plant.xlsx")},p=()=>{P.value=!0},m=async r=>{P.value=!1,r&&await f()};return(r,b)=>(E(),j($t,null,[u("div",ma,[Da,u("div",Pa,[n(Et,{onShowDialog:v}),n(yt,{onShowDialog:I}),n(wt,{onHandleDownload:c}),n(It,{onShowDialog:p})])]),u("div",fa,[u("div",va,[n(Gt,{"list-data":l(a).displayData,page:l(a).pagination.currentPage,onShowDialog:y},null,8,["list-data","page"])])]),u("div",_a,[l(a).paginationLoading?Z("",!0):(E(),C(ut,{key:0,onRaisePageChange:b[0]||(b[0]=A=>F(A)),currentPage:l(a).pagination.currentPage,totalPage:l(a).pagination.totalPage,totalPageSize:l(a).pagination.totalPageSize,startPaginationIndex:l(a).pagination.startPaginationIndex,endPaginationIndex:l(a).pagination.endPaginationIndex,isPageSizeChange:!1},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),n(Qt,{visibility:s.value,onHandleClose:_},null,8,["visibility"]),n(aa,{visibility:D.value,onHandleClose:w},null,8,["visibility"]),n(ha,{visibility:i.value,onHandleClose:e},null,8,["visibility"]),n(ga,{visibility:P.value,onHandleClose:m},null,8,["visibility"])],64))}});export{we as default};

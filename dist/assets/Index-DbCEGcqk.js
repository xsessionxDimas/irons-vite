import{_ as he}from"./logo-whitebg-DE6C9hWQ.js";import{k as C,r as x,c as L,p as c,aa as D,aB as u,b4 as H,A as R,C as ee,u as $,b6 as K,y as A,a5 as ve,z as Q,F as q,$ as E,bd as N,bb as j,R as P,q as I,s as o,a0 as ge,o as be,d as W,x as f,Y as te,B as Y,a7 as ae,L as se}from"./@vue-BypzYtbH.js";import{u as le,b as oe}from"./vue-router-iNp9kJ0K.js";import{u as fe}from"./authentication-handler-Pueb_EI7.js";import{c as O,s as B,j as ye,f as De}from"./index-BuVmIl8K.js";import{e as G}from"./lodash-DrHMlsdo.js";import{d as ie}from"./pinia-BjOS2_Ao.js";import{_ as V}from"./nw-img-vue-CR837WER.js";import{V as _e}from"./vue-pdf-embed-Dz5iqfb8.js";import{P as X}from"./Pagination-BiobnanQ.js";import{P as ke}from"./Pagination-D-xfdYmn.js";import{_ as ne}from"./Icon.vue_vue_type_script_setup_true_lang-DE-yo5DI.js";import{g as z}from"./mapOption-CeGMwmH0.js";import{F as Fe}from"./file-saver-CwTBvle_.js";import{n as Se}from"./navigator-D5io2Cca.js";import{a as Te}from"./element-plus-BeWdvTRa.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./vue-BzYgrL08.js";import"./language-BriOOvyN.js";const Le="/media/svg/dma/version-history/icon-service-sheet.png",we="/media/svg/dma/version-history/icon-service-sheet-hover.png",Ie="https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/version_history/get_side_menu",re=ie({id:"versionHistory",state:()=>({stateTreeData:{label:"Service Sheet Version History",icon:"",children:[]},stateListLoading:!1,stateMenuVersionHistory:[],stateSelectedEquipment:{equipmentModel:"",psType:""},stateSearchString:"",stateDefaultTree:{label:"Service Sheet Version History",icon:"fa fa-code-merge",children:[]},stateDefaultSelectedEquipment:{equipmentModel:"",psType:""}}),getters:{selectedEquipment:e=>e.stateSelectedEquipment,searchString:e=>e.stateSearchString,loading:e=>e.stateListLoading},actions:{async convertResponseToTreeData(e){this.stateTreeData=G.cloneDeep(this.stateDefaultTree),e.forEach((s,i)=>{i==0?s.collapsible=!0:s.collapsible=!1,s.icon="far fa-dot-circle",s.psType.forEach(t=>{t.icon="fa fa-circle",t.model=s.equipmentModelId?s.equipmentModelId.replaceAll("/","--"):"General",t.label=s.equipmentModelId?`${t.psType} Hr Service`:t.psType}),delete Object.assign(s,{children:s.psType}).psType,delete Object.assign(s,{label:s.menuName}).menuName,delete Object.assign(s,{model:s.equipmentModelId}).equipmentModelId,delete s.equipmentModelId,this.stateTreeData.children&&this.stateTreeData.children.push(s)})},setSelectedEquipment(e,s){this.stateSelectedEquipment={equipmentModel:e,psType:s}},async getMenuVersionHistory(e){this.stateListLoading=!0;const s={ver:"v1",siteId:e};try{const i=await O.get(Ie,"",new URLSearchParams(s).toString());await this.convertResponseToTreeData(i.data.result.content),this.stateMenuVersionHistory=this.stateTreeData.children}catch(i){throw fe(i),B("IRONS",i),i}finally{this.stateListLoading=!1}},setInit(){this.stateMenuVersionHistory[0]&&this.stateMenuVersionHistory[0].children&&this.stateMenuVersionHistory[0].children[0]&&this.setSelectedEquipment(this.stateMenuVersionHistory[0].children[0].model,this.stateMenuVersionHistory[0].children[0].psType)},setCollapse(e){var s;(s=this.stateTreeData.children)==null||s.forEach(i=>{i.model==e&&(i.collapsible=!i.collapsible)}),this.stateTreeData.children&&this.stateTreeData.children[0].children&&this.setSelectedEquipment(this.stateTreeData.children[0].model,this.stateTreeData.children[0].children[0].psType)},setSearchMenu(e){this.stateSearchString=e,e==""?this.stateTreeData.children=this.stateMenuVersionHistory:this.stateTreeData.children=G.cloneDeep(this.stateMenuVersionHistory).filter(s=>s.label.toLowerCase().includes(e.toLowerCase()))},resetInstance(){this.stateTreeData=G.cloneDeep(this.stateDefaultTree),this.stateListLoading=!1,this.stateMenuVersionHistory=[],this.stateSelectedEquipment=this.stateDefaultSelectedEquipment,this.stateSearchString=""}}}),de=e=>(N("data-v-922a9814"),e=e(),j(),e),Pe={class:"left",style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},xe={class:"d-flex justify-content-center"},$e={class:"d-flex justify-content-center align-items-center gap-2"},Ce=["src"],Ve=de(()=>u("span",null," Task Collection ",-1)),Me={class:"d-flex justify-content-center"},Ue={key:0,class:"icon-service-sheet"},qe=de(()=>u("img",{src:Le,alt:"icon"},null,-1)),Ee=C({__name:"MenuItem",props:{children:{type:Array,required:!0},data:{type:Object,required:!0},depth:{type:Number,required:!0}},setup(e){const s=le(),i=oe(),t=re(),a=x(!0),w=x(),g=x(!1),y=L({get:()=>t.searchString,set:T=>{t.setSearchMenu(T)}}),_=L(()=>{var T;return((T=i.params)==null?void 0:T.menu)==="taskcollection"?"btn-taskcollection-active":""}),n=L(()=>{var b;return`/media/svg/dma/side-menu/${((b=i.params)==null?void 0:b.menu)==="taskcollection"||g.value?"active":"inactive"}/collection.png`}),m=()=>{g.value=!0},p=()=>{g.value=!1},v=(T,b)=>{T&&b?s.push(`/ironforms/versionhistory/${b}/${T}`):b&&t.setCollapse(b)},r=(T,b)=>{const M=s.resolve({name:"formpreview",params:{model:T,pstype:b}});window.open(M.href,"_blank")},h=()=>{s.push("/ironforms/versionhistory/taskcollection")};return(T,b)=>{var d,F;const M=P("menu-item",!0);return c(),D("div",{class:H(["menu-item pointer position-relative",{opened:a.value}]),style:K([e.depth==0?"height: calc(100vh - 40px);overflow: auto;":""])},[u("div",{class:H(["label",{link:e.depth==2,active:e.data.model===((d=$(i).params)==null?void 0:d.model)&&e.data.psType==((F=$(i).params)==null?void 0:F.pstype)&&e.depth>0}]),onClick:b[0]||(b[0]=k=>v(e.data.psType,e.data.model)),style:K({paddingLeft:e.depth*20+20+"px"})},[u("div",Pe,[e.data.icon?(c(),D("em",{key:0,class:H(e.data.icon)},null,2)):R("",!0),u("span",{style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},class:H({bold:e.depth==0})},ee(e.data.label),3)])],6),u("div",xe,[e.depth==0?(c(),D("button",{key:0,class:H(["btn-taskcollection py-2 fw-bolder",_.value]),onMouseover:m,onMouseleave:p,onClick:b[1]||(b[1]=k=>h())},[u("div",$e,[u("img",{src:n.value,alt:"icon",style:{width:"18px",height:"16px"}},null,8,Ce),Ve])],34)):R("",!0)]),u("div",Me,[e.depth==0?A((c(),D("input",{key:0,type:"text",style:{width:"90%",background:"white"},class:"form-control form-control-solid rounded search-placeholder-label",placeholder:"Search","onUpdate:modelValue":b[2]||(b[2]=k=>y.value=k)},null,512)),[[ve,y.value]]):R("",!0)]),A(u("div",{class:"items-container",style:{height:"fit-content",overflow:"visible"},ref_key:"container",ref:w},[(c(!0),D(q,null,E(e.children,(k,S)=>(c(),I(M,{key:S,children:k.children||[],data:k,depth:e.depth+1},null,8,["children","data","depth"]))),128))],512),[[Q,e.depth==0||e.data.collapsible]]),e.depth>1?A((c(),D("div",Ue,[qe,u("img",{src:we,alt:"icon",class:"icon-hover",onClick:b[3]||(b[3]=k=>r(e.data.model,e.data.psType))})],512)),[[Q,e.data.model!="General"]]):R("",!0)],6)}}}),ze=V(Ee,[["__scopeId","data-v-922a9814"]]),Re={class:"menu overflow-auto"},Ae=C({__name:"Menu",props:{dataMenu:{required:!0,type:Object}},setup(e){return(s,i)=>(c(),D("div",Re,[o(ze,{data:e.dataMenu,children:e.dataMenu.children,depth:0},null,8,["data","children"])]))}}),He=V(Ae,[["__scopeId","data-v-443ef62d"]]),Oe={class:"version-wrapper overflow-auto"},Be=C({__name:"Content",props:{model:{type:String,required:!0},psType:{type:String,required:!0},blobUrl:{type:String,required:!0}},setup(e){const s=e,i=x(""),t=x(!0),a=ge(s,"blobUrl"),w=x(""),g=x(!1),y=n=>{n.preventDefault()},_=async()=>{if(i.value="",t.value=!0,g.value=!1,a.value!=""){const n=`ver=v1&fileUrl=${a.value}`;try{const m=`https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_attachment/download_by_url?${n}`;console.log(m);const v=(await O.getBlob(m)).data,r=new Blob([v]),h=window.URL||window.webkitURL;i.value=h.createObjectURL(r)}catch(m){console.log("error show pdf",m),g.value=!0,a.value.includes("#")?w.value="PDF not yet attached":w.value=`${m}`}}t.value=!1};return be(async()=>{await _()}),W([a.value],n=>{n&&_()}),W(()=>s.blobUrl,()=>{_()}),(n,m)=>(c(),D("div",Oe,[t.value?R("",!0):(c(),I($(_e),{key:0,onClick:y,source:i.value,class:"w-100 h-100"},null,8,["source"]))]))}}),Ne=V(Be,[["__scopeId","data-v-bf58b0fa"]]),je="https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/version_history/get_task_collection",Ge="https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/version_history/export_task_collection",We="https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/version_history/get_filter_task_collection",Z={modelId:"",psTypeId:"",version:"",releaseDate:"",category:"",description:"",subTask:"",status:"Active",page:1,pageSize:20},J=ie({id:"taskCollection",state:()=>({stateLoading:!1,stateLoadingFilter:!1,stateLoadingExport:!1,stateFilterData:{modelId:"",psTypeId:"",version:"",releaseDate:"",category:"",description:"",subTask:"",status:"Active",page:1,pageSize:20},stateDisplayData:[],stateFilterLookupParams:{modelId:"",psTypeId:"",category:"",version:"",releaseDate:"",description:"",subTask:"",status:""},stateFilterLookupData:{},statePaginationLoading:!1,statePagination:new X,stateFilterVisibility:!1,stateLastUsedFilterData:{...Z},stateSearchValue:""}),getters:{loading:e=>e.stateLoading,pagination:e=>e.statePagination,displayData:e=>e.stateDisplayData,paginationLoading:e=>e.statePaginationLoading,filterVisibility:e=>e.stateFilterVisibility,loadingFilter:e=>e.stateLoadingFilter,loadingExport:e=>e.stateLoadingExport},actions:{async getData(){this.stateLoading=!0,this.stateLastUsedFilterData={...this.stateFilterData};const e={ver:"v1",modelId:this.stateFilterData.modelId,psTypeId:this.stateFilterData.psTypeId,version:this.stateFilterData.version,releaseDate:this.stateFilterData.releaseDate,category:this.stateFilterData.category,description:this.stateFilterData.description,subTask:this.stateFilterData.subTask,status:this.stateFilterData.status,page:this.stateFilterData.page.toString(),pageSize:this.stateFilterData.pageSize.toString()};try{const s=await O.get(`${je}?${new URLSearchParams(e).toString()}`);s.data.title==="Error"?ye("Failed to Fetch Data",s.data.result.message,"Ok"):(this.stateDisplayData=s.data.result.content,this.setTotalPage(parseInt(s.data.result.total.toString())))}catch(s){B("IRONS",s),console.log(s)}this.stateLoading=!1},async setPage(e){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(e),this.statePagination.totalPageSize=this.stateFilterData.pageSize,this.stateFilterData.page=this.statePagination.currentPage,await this.getData(),setTimeout(()=>{this.statePaginationLoading=!1},200)},async getLookupFilter(){this.stateLoadingFilter=!0,this.stateLastUsedFilterData={...this.stateFilterData};const e={ver:"v1",modelId:this.stateFilterLookupParams.modelId,psTypeId:this.stateFilterLookupParams.psTypeId,version:this.stateFilterLookupParams.version,releaseDate:this.stateFilterLookupParams.releaseDate,category:this.stateFilterLookupParams.category,description:this.stateFilterLookupParams.description,subTask:this.stateFilterLookupParams.subTask,status:this.stateFilterLookupParams.status};try{const s=await O.get(`${We}?${new URLSearchParams(e).toString()}`);this.stateFilterLookupData=s.data.result.content}catch(s){B("IRONS",s),console.log(s)}this.stateLoadingFilter=!1},async export(){const e={ver:"v1",modelId:this.stateFilterData.modelId,psTypeId:this.stateFilterData.psTypeId,version:this.stateFilterData.version,releaseDate:this.stateFilterData.releaseDate,category:this.stateFilterData.category,description:this.stateFilterData.description,subTask:this.stateFilterData.subTask,status:this.stateFilterData.status};try{return(await O.getBlob(`${Ge}?${new URLSearchParams(e).toString()}`)).data}catch(s){B("IRONS",s),console.log(s)}},setTotalPage(e){this.pagination.totalPage=e,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},setFilterVisibility(e){this.stateFilterVisibility=e},async setPageSize(e){this.statePaginationLoading=!0,this.stateFilterData.pageSize=e,this.statePagination.totalPageSize=this.stateFilterData.pageSize,this.stateFilterData.page=this.statePagination.currentPage,await this.getData(),setTimeout(()=>{this.statePaginationLoading=!1},200)},resetState(){this.stateFilterData={...Z},this.stateDisplayData=[],this.statePagination=new X,this.stateLoading=!1,this.statePaginationLoading=!1},async setFilterData(e){this.stateLoading=!0,this.stateFilterData=e,await this.getData()},setLastActiveFilter(e){this.stateLastUsedFilterData=e}}}),Ye={key:0,style:{height:"100px"}},Je=["innerHTML"],Ke=C({__name:"Grid",props:{listData:{required:!0,type:Array}},emits:["show-errors","delete-draft","show-dialog"],setup(e,{emit:s}){const i=e,t=J(),a=x(""),w=y=>{a.value=y.order},g=(y,_)=>{const n=y.toLocaleLowerCase(),m=_.toLocaleLowerCase();return n===null?1:m===null?-1:n===null&&m===null?0:n.localeCompare(m)};return(y,_)=>{const n=P("el-table-column"),m=P("el-tag"),p=P("el-table"),v=te("loading");return $(t).loading?A((c(),D("div",Ye,null,512)),[[v,$(t).loading]]):A((c(),I(p,{key:1,data:i.listData,style:{width:"100%"},"empty-text":"No Data","header-cell-class-name":"ironlake-table-cell-header","cell-class-name":"ironlake-table-cell",onSortChange:w},{default:f(()=>[o(n,{label:"Model",prop:"modelId","min-width":"100",sortable:"","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.modelId,h.modelId)},null,8,["sort-method"]),o(n,{label:"Service Size",prop:"psTypeId","min-width":"100",sortable:"","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.psTypeId,h.psTypeId)},null,8,["sort-method"]),o(n,{label:"Version",prop:"version",sortable:"","min-width":"100","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.version,h.version)},null,8,["sort-method"]),o(n,{label:"Release Date",prop:"releaseDate",sortable:"","min-width":"100","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.releaseDate,h.releaseDate)},null,8,["sort-method"]),o(n,{label:"Task Category",prop:"category","min-width":"125",sortable:"","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.category,h.category)},null,8,["sort-method"]),o(n,{label:"Task Description",prop:"description","min-width":"150",sortable:"","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.description,h.description)},{default:f(r=>[u("div",{innerHTML:r.row.description},null,8,Je)]),_:1},8,["sort-method"]),o(n,{label:"Sub Task",prop:"subTask","min-width":"80",sortable:"","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.subTask,h.subTask)},null,8,["sort-method"]),o(n,{label:"Task Rating",prop:"rating","min-width":"125",sortable:"","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.rating,h.rating)},null,8,["sort-method"]),o(n,{label:"Status",prop:"status",sortable:"","min-width":"80","sort-orders":["ascending","descending"],"sort-method":(r,h)=>g(r.status,h.status),fixed:"right"},{default:f(r=>[o(m,{class:"fw-bolder",type:r.row.status.toLocaleLowerCase()==="active"?"success":"info"},{default:f(()=>[Y(ee(r.row.status),1)]),_:2},1032,["type"])]),_:1},8,["sort-method"])]),_:1},8,["data"])),[[v,$(t).loading]])}}}),Qe=V(Ke,[["__scopeId","data-v-cba87f2b"]]),Xe=C({__name:"DownloadButton",emits:["handleDownload"],setup(e,{emit:s}){const i=s,t=()=>{i("handleDownload")};return(a,w)=>(c(),D("button",{class:"d-flex gap-2 align-items-center btn btn-btech-outline px-4 py-2",onClick:t},[o(ne,{name:"download",size:"24"}),Y(" Export ")]))}}),Ze=V(Xe,[["__scopeId","data-v-778e7ffb"]]),et=e=>(N("data-v-9e681416"),e=e(),j(),e),tt={class:"p-2 d-flex flex-column gap-8"},at={class:"employee-filter-header d-flex gap-2 align-items-center"},st=et(()=>u("p",{class:"m-0 fw-700 text-large"},"Filter Data",-1)),lt={style:{height:"30px"}},ot={class:"d-flex flex-column gap-8"},it=C({__name:"FilterButton",emits:["applyFilter","loadFilterData"],setup(e,{expose:s,emit:i}){const t=J(),a=x({modelId:"",psTypeId:"",version:"",releaseDate:"",category:"",description:"",subTask:"",status:"Active",page:1,pageSize:20});s({data:a});const w=i,g=L(()=>z(t.stateFilterLookupData.listModelId)),y=L(()=>z(t.stateFilterLookupData.listPsTypeid)),_=L(()=>z(t.stateFilterLookupData.listVersion,"Latest Version")),n=L(()=>z(t.stateFilterLookupData.listReleaseDate)),m=L(()=>z(t.stateFilterLookupData.listSubtask)),p=L(()=>z(t.stateFilterLookupData.listCategroy)),v=()=>{t.stateFilterLookupParams.category=a.value.category,t.stateFilterLookupParams.psTypeId=a.value.psTypeId,t.stateFilterLookupParams.modelId=a.value.modelId,t.stateFilterLookupParams.status=a.value.status,t.stateFilterLookupParams.subTask=a.value.subTask,t.stateFilterLookupParams.version=a.value.version,t.stateFilterLookupParams.releaseDate=a.value.releaseDate,t.stateFilterLookupParams.description=a.value.description,w("loadFilterData")},r=()=>{w("applyFilter",a)},h=()=>{a.value.description=t.stateLastUsedFilterData.description,a.value.modelId=t.stateLastUsedFilterData.modelId,a.value.psTypeId=t.stateLastUsedFilterData.psTypeId,a.value.version=t.stateLastUsedFilterData.version,a.value.releaseDate=t.stateLastUsedFilterData.releaseDate,a.value.category=t.stateLastUsedFilterData.category,a.value.subTask=t.stateLastUsedFilterData.subTask,a.value.status=t.stateLastUsedFilterData.status,t.setFilterVisibility(!t.filterVisibility),v()},T=()=>{a.value.description=t.stateLastUsedFilterData.description,a.value.modelId=t.stateLastUsedFilterData.modelId,a.value.psTypeId=t.stateLastUsedFilterData.psTypeId,a.value.version=t.stateLastUsedFilterData.version,a.value.releaseDate=t.stateLastUsedFilterData.releaseDate,a.value.category=t.stateLastUsedFilterData.category,a.value.subTask=t.stateLastUsedFilterData.subTask,a.value.status=t.stateLastUsedFilterData.status,t.setFilterVisibility(!t.filterVisibility),v()},b=()=>{a.value.description="",a.value.modelId="",a.value.psTypeId="",a.value.version="",a.value.releaseDate="",a.value.category="",a.value.subTask="",a.value.status="Active",a.value.page=1,a.value.pageSize=20,v(),t.setPage(1)};return(M,d)=>{const F=P("el-option"),k=P("el-select"),S=P("el-form-item"),U=P("el-input"),ce=P("el-form"),pe=P("el-popover"),me=te("loading");return c(),I(pe,{placement:"bottom",width:480,trigger:"click",visible:$(t).filterVisibility},{reference:f(()=>[u("button",{class:"btn btn-outline btn-outline-btech-secondary btn-active-light-btech-secondary btech-md m-0",onClick:h},[o(ne,{name:"filter",size:"24"}),Y(" Filter ")])]),default:f(()=>[u("div",tt,[u("div",at,[st,A(u("div",lt,null,512),[[me,$(t).loadingFilter]])]),u("section",ot,[o(ce,{"label-position":"top",class:"ironlake-form d-flex flex-column gap-6"},{default:f(()=>[o(S,{label:"Model"},{default:f(()=>[o(k,{class:"w-100",modelValue:a.value.modelId,"onUpdate:modelValue":d[0]||(d[0]=l=>a.value.modelId=l),placeholder:"Select Model",clearable:"",filterable:"",onChange:d[1]||(d[1]=l=>v())},{default:f(()=>[(c(!0),D(q,null,E(g.value,l=>(c(),I(F,{key:l.label,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(S,{label:"Service Size"},{default:f(()=>[o(k,{class:"w-100",modelValue:a.value.psTypeId,"onUpdate:modelValue":d[2]||(d[2]=l=>a.value.psTypeId=l),placeholder:"Select Service Size",clearable:"",filterable:"",onChange:d[3]||(d[3]=l=>v())},{default:f(()=>[(c(!0),D(q,null,E(y.value,l=>(c(),I(F,{key:l.label,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(S,{label:"Version"},{default:f(()=>[o(k,{class:"w-100",modelValue:a.value.version,"onUpdate:modelValue":d[4]||(d[4]=l=>a.value.version=l),placeholder:"Select Version",clearable:"",filterable:"",onChange:d[5]||(d[5]=l=>v())},{default:f(()=>[(c(!0),D(q,null,E(_.value,l=>(c(),I(F,{key:l.label,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(S,{label:"Release Date"},{default:f(()=>[o(k,{class:"w-100",modelValue:a.value.releaseDate,"onUpdate:modelValue":d[6]||(d[6]=l=>a.value.releaseDate=l),placeholder:"Select Release Date",clearable:"",filterable:"",onChange:d[7]||(d[7]=l=>v())},{default:f(()=>[(c(!0),D(q,null,E(n.value,l=>(c(),I(F,{key:l.label,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(S,{label:"Task Description"},{default:f(()=>[o(U,{class:"w-100",modelValue:a.value.description,"onUpdate:modelValue":d[8]||(d[8]=l=>a.value.description=l),placeholder:"All"},null,8,["modelValue"])]),_:1}),o(S,{label:"Sub Task"},{default:f(()=>[o(k,{class:"w-100",modelValue:a.value.subTask,"onUpdate:modelValue":d[9]||(d[9]=l=>a.value.subTask=l),placeholder:"Select Sub Task",clearable:"",filterable:"",onChange:d[10]||(d[10]=l=>v())},{default:f(()=>[(c(!0),D(q,null,E(m.value,l=>(c(),I(F,{key:l.label,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(S,{label:"Task Category"},{default:f(()=>[o(k,{class:"w-100",modelValue:a.value.category,"onUpdate:modelValue":d[11]||(d[11]=l=>a.value.category=l),placeholder:"Select Sub Task",clearable:"",filterable:"",onChange:d[12]||(d[12]=l=>v())},{default:f(()=>[(c(!0),D(q,null,E(p.value,l=>(c(),I(F,{key:l.label,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(S,{label:"Status"},{default:f(()=>[o(k,{class:"w-100",modelValue:a.value.status,"onUpdate:modelValue":d[13]||(d[13]=l=>a.value.status=l),placeholder:"Select Sub Task",clearable:"",filterable:"",onChange:d[14]||(d[14]=l=>v())},{default:f(()=>[o(F,{label:"Show all",value:""}),o(F,{label:"Active",value:"Active"}),o(F,{label:"Inactive",value:"Inactive"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),u("div",{class:"d-flex justify-content-between"},[u("div",null,[u("button",{class:"btn btn-outline btn-outline-btech-secondary btn-active-light-btech-secondary btech-md me-auto",onClick:b}," Reset ")]),u("div",{class:"d-flex gap-4 align-items-center"},[u("button",{class:"btn btn-outline btn-outline-btech-secondary btn-active-light-btech-secondary btech-md",onClick:T}," Close "),u("button",{class:"btn btn-btech-secondary btech-md",onClick:r},"Apply")])])])]),_:1},8,["visible"])}}}),nt=V(it,[["__scopeId","data-v-9e681416"]]),ue=e=>(N("data-v-e343fca5"),e=e(),j(),e),rt={class:"version-wrapper overflow-auto"},dt={class:"w-100 h-100"},ut=ue(()=>u("h1",null,"Task Collection",-1)),ct=ue(()=>u("hr",null,null,-1)),pt={class:"card mb-10"},mt={class:"card-body p-3 w-100"},ht={class:"d-flex justify-content-end gap-2 mb-2"},vt=C({__name:"TaskCollection",setup(e){const s=J();x(null);const i=L(()=>s.displayData),t=L(()=>s.pagination),a=()=>{s.getLookupFilter()},w=n=>{s.setPage(n)},g=n=>{s.setPageSize(n)},y=n=>{s.setLastActiveFilter(n),s.setFilterData(n)},_=async()=>{const n=await s.export();Fe.saveAs(new Blob([n],{type:"application/octet-stream"}),"task_collection.xlsx")};return ae(()=>{s.setPage(1)}),se(()=>{s.resetState()}),(n,m)=>(c(),D("div",rt,[u("div",dt,[ut,ct,u("div",pt,[u("div",mt,[u("div",ht,[o(nt,{ref:"",onApplyFilter:m[0]||(m[0]=p=>y(p)),onLoadFilterData:m[1]||(m[1]=p=>a())},null,512),o(Ze,{onHandleDownload:_})]),o(Qe,{"list-data":i.value},null,8,["list-data"]),$(s).paginationLoading?R("",!0):(c(),I(ke,{key:0,onRaisePageChange:m[2]||(m[2]=p=>w(p)),onRaiseSizeChange:m[3]||(m[3]=p=>g(p)),currentPage:t.value.currentPage,totalPage:t.value.totalPage,totalPageSize:t.value.totalPageSize,isPageSizeChange:!0,pageSizes:[50,20,10],startPaginationIndex:t.value.startPaginationIndex,endPaginationIndex:t.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))])])])]))}}),gt=V(vt,[["__scopeId","data-v-e343fca5"]]),bt=e=>(N("data-v-7cfc450c"),e=e(),j(),e),ft={class:"full-page d-flex overflow-hidden vh-100"},yt={style:{width:"300px","border-right":"1px solid #ECECEC"}},Dt=bt(()=>u("img",{style:{cursor:"pointer"},src:he,alt:"",class:"h-40px logo"},null,-1)),_t=[Dt],kt={key:0,class:"d-flex flex-fill p-10"},Ft={key:1,class:"d-flex flex-fill p-10"},St=C({__name:"Index",setup(e){const{redirectByName:s}=Se(),i=oe(),t=re(),a=le(),w=L(()=>t.stateTreeData),g=L(()=>{var p;return((p=i.params)==null?void 0:p.menu)??""}),y=L(()=>{var p;return((p=i.params)==null?void 0:p.model)??""}),_=L(()=>{var p;return((p=i.params)==null?void 0:p.pstype)??""}),n=L(()=>{if(y.value=="General"){const p=t.stateMenuVersionHistory.find(v=>v.label==="General Features");if(p)return p.children[0].fileUrl}else if(y.value&&_.value){const p=y.value.replaceAll("--","/"),v=t.stateMenuVersionHistory.find(r=>r.model==p);if(v){const r=v.children.find(h=>h.psType==_.value);if(r)return r.fileUrl}}return""}),m=()=>{s("ironforms")};return ae(async()=>{var v,r,h,T,b,M,d;const p=Te.service({lock:!0,text:"Loading the page",background:"rgba(0, 0, 0, 0.7)"});try{const F=await De.userInfo.limit(1).first(),k=F==null?void 0:F.SiteId;if(k){await t.getMenuVersionHistory(k);let S,U;if((v=i.params)!=null&&v.menu)return;(r=i.params)!=null&&r.model&&((h=i.params)!=null&&h.pstype)?(S=(T=i.params)==null?void 0:T.model,U=(b=i.params)==null?void 0:b.pstype,t.setSelectedEquipment(S,U),t.setCollapse(S)):(t.setInit(),S=(M=t.selectedEquipment)==null?void 0:M.equipmentModel,U=(d=t.selectedEquipment)==null?void 0:d.psType),S&&U&&a.push(`/ironforms/versionhistory/${S}/${U}`)}else a.push({name:"signindma"})}catch{m()}finally{p.close()}}),W(()=>y.value||_.value||g.value,()=>{g.value!=="taskcollection"&&(y.value&&_.value?a.push(`/ironforms/versionhistory/${y.value}/${_.value}`):(t.setInit(),t.selectedEquipment.equipmentModel&&t.selectedEquipment.psType&&a.push(`/ironforms/versionhistory/${t.selectedEquipment.equipmentModel}/${t.selectedEquipment.psType}`)))},{deep:!0}),se(()=>{t.resetInstance()}),(p,v)=>(c(),D("div",ft,[u("div",yt,[u("div",{class:"logo-wrapper d-flex align-items-center ms-1",onClick:m},_t),o(He,{"data-menu":w.value},null,8,["data-menu"])]),g.value!=="taskcollection"?(c(),D("div",kt,[o(Ne,{model:y.value,"ps-type":_.value,"blob-url":n.value},null,8,["model","ps-type","blob-url"])])):(c(),D("div",Ft,[o(gt)]))]))}}),ga=V(St,[["__scopeId","data-v-7cfc450c"]]);export{ga as default};

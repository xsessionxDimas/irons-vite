import{b as W,u as K}from"./useComponentInterventionHeaderStore-CbC-c2Z5.js";import{k as V,p as i,aa as _,aB as e,F as P,$ as G,bd as I,bb as j,C as u,c as X,R as M,q as E,x as L,a0 as H,r as a,s as r,B as S,A as O,a7 as Q,u as T}from"./@vue-BypzYtbH.js";import{_ as N}from"./nw-img-vue-CR837WER.js";import{_ as Z}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{_ as Y}from"./ToastWithIcon.vue_vue_type_style_index_0_lang-wfM94fOM.js";import{h as ee,f as B,e as z,t as q}from"./index-BuVmIl8K.js";import{O as te}from"./OnlineStatus-Bhk3CA8-.js";import{_ as se}from"./GeneralDialog.vue_vue_type_style_index_0_lang-Bvj3I9QR.js";import{_ as oe}from"./ErrorDialog.vue_vue_type_style_index_0_lang-uqoYzc1f.js";import{i as le}from"./internet-connection-CnLQPjRt.js";import{X as $}from"./xlsx-C4maHrMm.js";import"./lodash-DrHMlsdo.js";import"./@popperjs-BaMZbQYT.js";import"./pinia-BjOS2_Ao.js";import"./date-format-8-IvfSl3.js";import"./moment-C5S46NFB.js";import"./urls-RITu66bD.js";import"./@vueuse-DFoNmIyu.js";import"./urls-CvqtYZA-.js";import"./number-format-BdMuQVyW.js";import"./urls-hWHEBXep.js";import"./useGlobalConnectionStore-DV9B81de.js";import"./authentication-handler-Pueb_EI7.js";import"./string-to-imageinfo-converter-Cdr1iOkP.js";import"./object-path-DPahbflh.js";import"./deepmerge-oeePEK50.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./element-plus-BeWdvTRa.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";const J=s=>(I("data-v-4a47df82"),s=s(),j(),s),ne={class:"row"},ae={class:"table sync-table"},ie=J(()=>e("thead",null,[e("tr",null,[e("th",{class:"ps-2 py-5",scope:"col"},"Work Order"),e("th",{class:"ps-2 py-5",scope:"col"},"Form"),e("th",{class:"ps-2 py-5",scope:"col"},"Equipment"),e("th",{class:"ps-2 py-5",scope:"col"},"PS Type"),e("th",{class:"px-2 py-5",scope:"col"},"Waiting for Syncronization")])],-1)),ce={key:0},re=J(()=>e("td",{class:"ps-2 text-center fs-3",colspan:"5",scope:"row"},[e("div",{class:"d-flex justify-content-center"},[e("div",{class:"badge-finished"},"All data already syncronized")])],-1)),de=[re],pe={class:"ps-2",scope:"row"},ue={class:"ps-2"},_e={class:"ps-2"},me={class:"ps-2"},he={class:"px-2"},fe=V({__name:"PendingTaskTable",props:{records:{required:!0,type:Array}},setup(s){return(t,m)=>(i(),_("div",ne,[e("table",ae,[ie,e("tbody",null,[s.records.length==0?(i(),_("tr",ce,de)):(i(!0),_(P,{key:1},G(s.records,l=>(i(),_("tr",{key:l.id},[e("th",pe,u(l.workOrder),1),e("td",ue,u(l.form),1),e("td",_e,u(l.equipment),1),e("td",me,u(l.psType?l.psType:"-"),1),e("td",he,u(l.pendingTask),1)]))),128))])])]))}}),be=N(fe,[["__scopeId","data-v-4a47df82"]]),ye=V({__name:"PayloadModal",props:{visibility:{required:!0,type:Boolean},caption:{required:!0,type:String}},emits:["closeModal"],setup(s,{emit:t}){const m=s,l=t,d=X(()=>m.visibility),b=()=>{l("closeModal")};return(h,g)=>{const v=M("el-dialog");return i(),E(v,{modelValue:d.value,"onUpdate:modelValue":g[0]||(g[0]=y=>d.value=y),"show-close":!0,onClose:b,"custom-class":"dma-toast-offline py-7","append-to-body":"",width:"70%"},{default:L(()=>[e("pre",null,u(JSON.stringify(JSON.parse(s.caption),null,2)),1)]),_:1},8,["modelValue"])}}}),ge={class:"row d-flex flex-column"},ve={class:"photo-wrapper"},we={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center"}},xe={class:"d-flex justify-content-center"},ke={style:{position:"relative",width:"fit-content"}},$e=e("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"},null,-1),Ce=e("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Te=e("g",{id:"SVGRepo_iconCarrier"},[e("g",null,[e("polygon",{style:{fill:"#E8E8E8"},points:"219.821,0 32.842,0 32.842,303.188 270.346,303.188 270.346,50.525 "}),S(),e("path",{style:{fill:"#FB3449"},d:"M230.013,149.935c-3.643-6.493-16.231-8.533-22.006-9.451c-4.552-0.724-9.199-0.94-13.803-0.936 c-3.615-0.024-7.177,0.154-10.693,0.354c-1.296,0.087-2.579,0.199-3.861,0.31c-1.314-1.36-2.584-2.765-3.813-4.202 c-7.82-9.257-14.134-19.755-19.279-30.664c1.366-5.271,2.459-10.772,3.119-16.485c1.205-10.427,1.619-22.31-2.288-32.251 c-1.349-3.431-4.946-7.608-9.096-5.528c-4.771,2.392-6.113,9.169-6.502,13.973c-0.313,3.883-0.094,7.776,0.558,11.594 c0.664,3.844,1.733,7.494,2.897,11.139c1.086,3.342,2.283,6.658,3.588,9.943c-0.828,2.586-1.707,5.127-2.63,7.603 c-2.152,5.643-4.479,11.004-6.717,16.161c-1.18,2.557-2.335,5.06-3.465,7.507c-3.576,7.855-7.458,15.566-11.815,23.02 c-10.163,3.585-19.283,7.741-26.857,12.625c-4.063,2.625-7.652,5.476-10.641,8.603c-2.822,2.952-5.69,6.783-5.941,11.024 c-0.141,2.394,0.807,4.717,2.768,6.137c2.697,2.015,6.271,1.881,9.4,1.225c10.25-2.15,18.121-10.961,24.824-18.387 c4.617-5.115,9.872-11.61,15.369-19.465c0.012-0.018,0.024-0.036,0.037-0.054c9.428-2.923,19.689-5.391,30.579-7.205 c4.975-0.825,10.082-1.5,15.291-1.974c3.663,3.431,7.621,6.555,11.939,9.164c3.363,2.069,6.94,3.816,10.684,5.119 c3.786,1.237,7.595,2.247,11.528,2.886c1.986,0.284,4.017,0.413,6.092,0.335c4.631-0.175,11.278-1.951,11.714-7.57 C231.127,152.765,230.756,151.257,230.013,149.935z M119.144,160.245c-2.169,3.36-4.261,6.382-6.232,9.041 c-4.827,6.568-10.34,14.369-18.322,17.286c-1.516,0.554-3.512,1.126-5.616,1.002c-1.874-0.11-3.722-0.937-3.637-3.065 c0.042-1.114,0.587-2.535,1.423-3.931c0.915-1.531,2.048-2.935,3.275-4.226c2.629-2.762,5.953-5.439,9.777-7.918 c5.865-3.805,12.867-7.23,20.672-10.286C120.035,158.858,119.587,159.564,119.144,160.245z M146.366,75.985 c-0.602-3.514-0.693-7.077-0.323-10.503c0.184-1.713,0.533-3.385,1.038-4.952c0.428-1.33,1.352-4.576,2.826-4.993 c2.43-0.688,3.177,4.529,3.452,6.005c1.566,8.396,0.186,17.733-1.693,25.969c-0.299,1.31-0.632,2.599-0.973,3.883 c-0.582-1.601-1.137-3.207-1.648-4.821C147.945,83.048,146.939,79.482,146.366,75.985z M163.049,142.265 c-9.13,1.48-17.815,3.419-25.979,5.708c0.983-0.275,5.475-8.788,6.477-10.555c4.721-8.315,8.583-17.042,11.358-26.197 c4.9,9.691,10.847,18.962,18.153,27.214c0.673,0.749,1.357,1.489,2.053,2.22C171.017,141.096,166.988,141.633,163.049,142.265z M224.793,153.959c-0.334,1.805-4.189,2.837-5.988,3.121c-5.316,0.836-10.94,0.167-16.028-1.542 c-3.491-1.172-6.858-2.768-10.057-4.688c-3.18-1.921-6.155-4.181-8.936-6.673c3.429-0.206,6.9-0.341,10.388-0.275 c3.488,0.035,7.003,0.211,10.475,0.664c6.511,0.726,13.807,2.961,18.932,7.186C224.588,152.585,224.91,153.321,224.793,153.959z"}),S(),e("polygon",{style:{fill:"#FB3449"},points:"227.64,25.263 32.842,25.263 32.842,0 219.821,0 "}),S(),e("g",null,[e("path",{style:{fill:"#A4A9AD"},d:"M126.841,241.152c0,5.361-1.58,9.501-4.742,12.421c-3.162,2.921-7.652,4.381-13.472,4.381h-3.643 v15.917H92.022v-47.979h16.606c6.06,0,10.611,1.324,13.652,3.971C125.321,232.51,126.841,236.273,126.841,241.152z M104.985,247.387h2.363c1.947,0,3.495-0.546,4.644-1.641c1.149-1.094,1.723-2.604,1.723-4.529c0-3.238-1.794-4.857-5.382-4.857 h-3.348C104.985,236.36,104.985,247.387,104.985,247.387z"}),S(),e("path",{style:{fill:"#A4A9AD"},d:"M175.215,248.864c0,8.007-2.205,14.177-6.613,18.509s-10.606,6.498-18.591,6.498h-15.523v-47.979 h16.606c7.701,0,13.646,1.969,17.836,5.907C173.119,235.737,175.215,241.426,175.215,248.864z M161.76,249.324 c0-4.398-0.87-7.657-2.609-9.78c-1.739-2.122-4.381-3.183-7.926-3.183h-3.773v26.877h2.888c3.939,0,6.826-1.143,8.664-3.43 C160.841,257.523,161.76,254.028,161.76,249.324z"}),S(),e("path",{style:{fill:"#A4A9AD"},d:"M196.579,273.871h-12.766v-47.979h28.355v10.403h-15.589v9.156h14.374v10.403h-14.374 L196.579,273.871L196.579,273.871z"})]),S(),e("polygon",{style:{fill:"#D1D3D3"},points:"219.821,50.525 270.346,50.525 219.821,0 "})])],-1),Se=[$e,Ce,Te],Le=["src"],Fe=V({__name:"FilePreview",props:{visibility:{type:Boolean,required:!1},blob:{type:Blob,required:!0},originalFilename:{type:String,required:!1}},emits:["onClose"],setup(s,{emit:t}){const m=s,l=t,d=H(m,"visibility"),b=a(!1),h=a(!1),g=X(()=>"70%"),v=()=>{b.value=!0;const c=URL.createObjectURL(m.blob);return b.value=!1,c},y=()=>{h.value=!m.blob.name,console.log(h.value)},C=()=>{const c=document.createElement("a");c.href=URL.createObjectURL(m.blob),c.download=m.originalFilename??"download.pdf",document.body.append(c),c.click(),c.remove(),setTimeout(()=>URL.revokeObjectURL(c.href),7e3)},R=()=>{d.value=!1,h.value=!1,l("onClose",null)};return(c,F)=>{const D=M("el-skeleton-item"),k=M("el-skeleton"),f=M("el-dialog");return i(),E(f,{modelValue:d.value,"onUpdate:modelValue":F[0]||(F[0]=o=>d.value=o),title:"File Preview",width:g.value,onOpened:y,onClose:R},{default:L(()=>[e("div",ge,[e("div",ve,[r(k,{loading:b.value,animated:""},{template:L(()=>[r(D,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:L(()=>[e("div",we,[e("div",xe,[e("div",ke,[h.value?(i(),_("svg",{key:0,onClick:C,height:"200px",width:"200px",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 303.188 303.188","xml:space":"preserve",fill:"#000000"},Se)):(i(),_("img",{key:1,src:v(),style:{height:"auto","max-width":"700px"},alt:"images"},null,8,Le))])])])]),_:1},8,["loading"])])])]),_:1},8,["modelValue","width"])}}}),w=s=>(I("data-v-b6f50b3d"),s=s(),j(),s),Me={class:"row"},Re={class:"table sync-table"},De=w(()=>e("th",{class:"ps-2 py-5",scope:"col"},"Work Order",-1)),Be=w(()=>e("th",{class:"ps-2 py-5",scope:"col"},"Form",-1)),Ve=w(()=>e("th",{class:"ps-2 py-5",scope:"col"},"Type",-1)),Ae=w(()=>e("th",{class:"ps-2 py-5",scope:"col"},"Key",-1)),Pe={class:"ps-2 py-5",scope:"col"},Oe=w(()=>e("th",{class:"ps-2 py-5",scope:"col"},"Error Message",-1)),Ie=w(()=>e("th",{class:"px-2 py-5",scope:"col"},"Action",-1)),je={key:0},Ee=w(()=>e("td",{class:"ps-2 text-center fs-3",colspan:"7",scope:"row"},[e("div",{class:"d-flex justify-content-center"},[e("div",{class:"badge-finished"},"No data found")])],-1)),Ne=[Ee],ze={class:"ps-2",scope:"row"},qe={class:"ps-2"},Ue={class:"ps-2"},We={class:"ps-2"},Ge={class:"ps-2"},Xe={class:"ps-2"},Ye={class:"px-2"},Je=["onClick"],Ke=w(()=>e("i",{class:"fas fa-trash-alt"},null,-1)),He=[Ke],Qe=["onClick"],Ze=w(()=>e("i",{class:"fas fa-eye fa-xl"},null,-1)),et=[Ze],tt=V({__name:"RetryTaskTable",props:{records:{required:!0,type:Array},isTask:{required:!1,type:Boolean,default:!0}},setup(s){const t=s,m=W(),l=a(!1),d=a(""),b=a(new Blob),h=a(""),g=a(!1),v=a(),y=a(!1),C=a(!1),R=o=>{d.value=o.payload,v.value=o,t.isTask?l.value=!0:(b.value=o.blob,h.value=o.originalFilename,C.value=!0)},c=o=>{k(!0),v.value=o},F=async()=>{var n;k(!1);const o=t.isTask?"pendingTask":"pendingTaskFile";await ee(B,o,(n=v.value)==null?void 0:n.id),D(),await m.getTaskList()},D=()=>{y.value=!0,setTimeout(()=>{y.value=!1},1e3)},k=o=>{g.value=o},f=()=>{d.value="",l.value=!1};return(o,n)=>(i(),_(P,null,[e("div",Me,[e("table",Re,[e("thead",null,[e("tr",null,[De,Be,Ve,Ae,e("th",Pe,u(s.isTask?"Section":"Name"),1),Oe,Ie])]),e("tbody",null,[s.records.length==0?(i(),_("tr",je,Ne)):(i(!0),_(P,{key:1},G(s.records,p=>(i(),_("tr",{key:p.workOrder},[e("th",ze,u(p.workorder),1),e("td",qe,u(p.module),1),e("td",Ue,u(s.isTask?p.type:p.fileType),1),e("td",We,u(p.key),1),e("td",Ge,u(s.isTask?p.section:p.originalFilename),1),e("td",Xe,u(p.errorMessage),1),e("td",Ye,[e("button",{onClick:A=>c(p),class:"btn btn-sm btn-bg-danger me-1 text-white mb-1 hide"},He,8,Je),e("button",{onClick:A=>R(p),class:"btn btn-sm btn-bg-primary me-1"},et,8,Qe)])]))),128))])])]),l.value?(i(),E(ye,{key:0,visibility:l.value,caption:d.value,onCloseModal:f},null,8,["visibility","caption"])):O("",!0),r(Z,{visibility:g.value,caption:"Are you sure want to delete this data?",onOnNoConfirm:n[0]||(n[0]=p=>k(!1)),onOnYesConfirm:F},null,8,["visibility"]),r(Y,{show:y.value,message:"Data succesfully deleted."},null,8,["show"]),r(Fe,{blob:b.value,"original-filename":h.value,visibility:C.value,onOnClose:n[1]||(n[1]=()=>{C.value=!1})},null,8,["blob","original-filename","visibility"])],64))}}),U=N(tt,[["__scopeId","data-v-b6f50b3d"]]),x=s=>(I("data-v-59ae00a8"),s=s(),j(),s),st={class:"wrapper d-flex flex-column flex-fill"},ot={class:"d-flex justify-content-between align-items-center"},lt=x(()=>e("p",{class:"page-title"},"Offline Sync Monitoring",-1)),nt={class:"col-12 w-100% bg-white"},at={class:"row ms-2 mb-10"},it={class:"row mx-2 justify-content-end mb-2"},ct=x(()=>e("span",{class:"text-center flex-fill"}," Export Data ",-1)),rt=[ct],dt={class:"col-3 col-lg-2 col-xl-1 pe-1 hide"},pt=["disabled"],ut=x(()=>e("span",{class:"text-center flex-fill"}," Delete All ",-1)),_t=[ut],mt={class:"col-3 col-lg-2 col-xl-1 ps-1"},ht={key:0,class:"spinner-border spinner-border-sm",role:"status"},ft=x(()=>e("span",{class:"visually-hidden"},"Loading...",-1)),bt=[ft],yt=x(()=>e("span",{class:"text-center flex-fill"}," Retry Sync ",-1)),gt={class:"row ms-2"},vt={class:"row mx-2 justify-content-end mb-2"},wt=x(()=>e("span",{class:"text-center flex-fill"}," Export Data ",-1)),xt=[wt],kt={class:"col-3 col-lg-2 col-xl-1 pe-1 hide"},$t=["disabled"],Ct=x(()=>e("span",{class:"text-center flex-fill"}," Delete All ",-1)),Tt=[Ct],St={class:"col-3 col-lg-2 col-xl-1 ps-1"},Lt={key:0,class:"spinner-border spinner-border-sm",role:"status"},Ft=x(()=>e("span",{class:"visually-hidden"},"Loading...",-1)),Mt=[Ft],Rt=x(()=>e("span",{class:"text-center flex-fill"}," Retry Sync ",-1)),Dt={class:"row ms-2"},Bt=V({__name:"Index",setup(s){const t=W(),m=K(),l=a("data"),d=a(!1),b=a(!1),h=a(!1),g=a("Please export the data using the 'Export' button and send the file to your supervisor. Additionally, ask your supervisor to contact us at support@bukittechnology.com and jacob.staader@buma.com.au for further assistance."),v=a('<span style="font-weight: normal">This action will <b>delete all data include pending synced data</b>. Are you sure want to proceed?</span>');Q(async()=>{await t.getPendingTaskList(),await t.getPendingFileTaskList(),await t.getTaskList(),await t.getFileTaskList(),t.getpendingList()});const y=()=>{c(!0)},C=async()=>{const f=await q(B,"pendingTask"),o=$.utils.json_to_sheet(f),n=$.utils.book_new();$.utils.book_append_sheet(n,o,"data"),$.writeFile(n,"sync data.xlsx")},R=async()=>{const f=await q(B,"pendingTaskFile"),o=$.utils.json_to_sheet(f),n=$.utils.book_new();$.utils.book_append_sheet(n,o,"data"),$.writeFile(n,"sync data.xlsx")},c=f=>{b.value=f},F=async()=>{c(!1),await z(B,"pendingTask"),await z(B,"pendingTaskFile"),D(),await t.getPendingTaskList(),await t.getPendingFileTaskList(),await t.getTaskList(),await t.getFileTaskList()},D=()=>{d.value=!0,setTimeout(()=>{d.value=!1},1e3)},k=async()=>{if(le())return;t.toggleLoadingRetry(!0);const f=await m.RetrySyncData();t.toggleLoadingRetry(!1),await t.getTaskList(),await t.getFileTaskList(),f&&(h.value=!0)};return(f,o)=>{const n=M("el-tab-pane"),p=M("el-tabs");return i(),_(P,null,[e("div",st,[e("div",ot,[lt,e("div",null,[r(te)])]),e("div",nt,[e("div",at,[r(be,{records:T(t).statePendingListNew},null,8,["records"])]),r(p,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=A=>l.value=A),type:"border-card",class:"sync-tabs"},{default:L(()=>[r(n,{label:"Data",name:"data"},{default:L(()=>[e("div",it,[e("div",{class:"col-3 col-lg-2 col-xl-1 pe-1"},[e("button",{onClick:C,class:"btn btn-sm btn-bg-primary text-white custom-retry-button d-flex text-center w-100"},rt)]),e("div",dt,[e("button",{disabled:T(t).statePendingList.length==0,onClick:y,class:"btn btn-sm btn-bg-danger text-white custom-retry-button d-flex text-center w-100"},_t,8,pt)]),e("div",mt,[e("button",{onClick:k,class:"btn btn-sm btn-bg-light custom-retry-button d-flex text-center w-100"},[T(t).stateLoadingRetry?(i(),_("div",ht,bt)):O("",!0),yt])])]),e("div",gt,[r(U,{records:T(t).dataTasks},null,8,["records"])])]),_:1}),r(n,{label:"Files",name:"files"},{default:L(()=>[e("div",vt,[e("div",{class:"col-3 col-lg-2 col-xl-1 pe-1"},[e("button",{onClick:R,class:"btn btn-sm btn-bg-primary text-white custom-retry-button d-flex text-center w-100"},xt)]),e("div",kt,[e("button",{disabled:T(t).statePendingList.length==0,onClick:y,class:"btn btn-sm btn-bg-danger text-white custom-retry-button d-flex text-center w-100"},Tt,8,$t)]),e("div",St,[e("button",{onClick:k,class:"btn btn-sm btn-bg-light custom-retry-button d-flex text-center w-100"},[T(t).stateLoadingRetry?(i(),_("div",Lt,Mt)):O("",!0),Rt])])]),e("div",Dt,[r(U,{records:T(t).fileTasks,"is-task":!1},null,8,["records"])])]),_:1})]),_:1},8,["modelValue"])])]),r(oe,{visibility:b.value,caption:v.value,"yes-label":"Yes","no-label":"No",onOnNoConfirm:o[1]||(o[1]=A=>c(!1)),onOnYesConfirm:F},null,8,["visibility","caption"]),S(" /> "),r(se,{"modal-type":"errorSync","word-breaker":!0,show:h.value,message:g.value,onClose:o[2]||(o[2]=()=>{h.value=!1})},null,8,["show","message"]),r(Y,{show:d.value,message:"All data succesfully deleted."},null,8,["show"])],64)}}}),Ds=N(Bt,[["__scopeId","data-v-59ae00a8"]]);export{Ds as default};

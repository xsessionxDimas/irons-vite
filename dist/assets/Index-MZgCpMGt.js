import{u as ft}from"./vuex-BbOKrtVp.js";import{a as Tt}from"./breadcrumb-BYmEOf4C.js";import{c as R,a as st,J as j,I as rt,z,A as vt}from"./index-BuVmIl8K.js";import{P as pt}from"./Pagination-D-xfdYmn.js";import{F as _t}from"./FilterIconButton-Bj0WTbms.js";import{h as bt,A as St,U as Ct}from"./excel-generator-DMHRo93s.js";import{D as wt}from"./DownloadIconButton-CIQp-YG7.js";import{_ as C,b as ht}from"./element-plus-BeWdvTRa.js";import{q as I,w as E,x as G,y as Et}from"./date-format-8-IvfSl3.js";import{P as K}from"./Pagination-BiobnanQ.js";import{d as it}from"./pinia-BjOS2_Ao.js";import{a as Ft}from"./mapOption-CeGMwmH0.js";import{a as Pt,d as kt}from"./table-sort-Bpdq_Uwn.js";import{k as H,c as U,r as q,u as i,y as N,p as w,aa as M,q as L,x as d,Y as W,R as $,s,aB as p,C as V,a0 as Z,B as x,A as tt,T as ut,bd as It,bb as Ut,a7 as Lt,L as xt,F as $t}from"./@vue-BypzYtbH.js";import{a as Dt}from"./vee-validate-C_msoaAA.js";import{c as mt,a as J,b as X,d as gt}from"./yup-C6P98bvY.js";import"./property-expr-DEi1ZLzV.js";import{E as yt}from"./ErrorAlert-CMKGfwAi.js";import{_ as Y}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{_ as Q}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CCwjwK39.js";import{e as At}from"./lodash-DrHMlsdo.js";import{_ as Bt}from"./FileDropZone.vue_vue_type_style_index_0_lang-C5PyimC7.js";import{m as Vt}from"./map-anything-abi6NY2Z.js";import{_ as Rt}from"./nw-img-vue-CR837WER.js";import{_ as Ht}from"./AutoComplete.vue_vue_type_style_index_0_lang-DrAAOf71.js";import{_ as ct}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CJ7rJST9.js";import{F as Ot}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./useMenuStore-CD5Gmvif.js";import"./PageEnum-DUtfSNQS.js";import"./xlsx-C4maHrMm.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-NSxIV7Fb.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";const O="https://digital-bumaau-dev-apm-001.azure-api.net/amadm/api/master_data/characteristic_type",Nt=`${O}/bulk`,qt=`${O}/validate_upload`,zt=`${O}/export`,Mt=`${O}/lookup`,jt=`${O}/update`,et={characteristicType:"",characteristicTypeTo:"",startDate:"",startDateTo:"",endDate:"",endDateTo:"",ver:"v1",page:1,pageSize:10,order:""},ot=it({id:"characteristicTypeList",state:()=>({stateFilterData:{...et},stateLastUsedFilterData:{...et},statePageName:"characteristicType",stateDisplayData:[],statePagination:new K,stateLoading:!1,statePaginationLoading:!1,stateCharacteristicTypeOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,characteristicTypeOption:t=>t.stateCharacteristicTypeOption},actions:{async getData(t=!0){const n={characteristicType:this.stateFilterData.characteristicType,characteristicTypeTo:this.stateFilterData.characteristicTypeTo,startDate:this.stateFilterData.startDate?I(E(new Date(this.stateFilterData.startDate))):"",startDateTo:this.stateFilterData.startDateTo?I(E(new Date(this.stateFilterData.startDateTo))):"",endDate:this.stateFilterData.endDate?I(E(new Date(this.stateFilterData.endDate))):"",endDateTo:this.stateFilterData.endDateTo?I(E(new Date(this.stateFilterData.endDateTo))):"",page:this.stateFilterData.page.toString(),pageSize:this.stateFilterData.pageSize.toString(),order:this.stateFilterData.order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const a=await R.get(O,"",new URLSearchParams(n).toString());this.stateDisplayData=a.data.result.content,this.setTotalPage(a.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(a){console.log(a)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const n=await R.get(Mt,"",new URLSearchParams(t).toString());this.stateCharacteristicTypeOption=Ft(n.data.result.content,"characteristicType","characteristicTypeDesc")}catch(n){console.log(n)}},async export(){const t={characteristicType:this.stateFilterData.characteristicType,characteristicTypeTo:this.stateFilterData.characteristicTypeTo,startDate:this.stateFilterData.startDate?I(E(new Date(this.stateFilterData.startDate))):"",startDateTo:this.stateFilterData.startDateTo?I(E(new Date(this.stateFilterData.startDateTo))):"",endDate:this.stateFilterData.endDate?I(E(new Date(this.stateFilterData.endDate))):"",endDateTo:this.stateFilterData.endDateTo?I(E(new Date(this.stateFilterData.endDateTo))):"",ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await R.getBlob(zt,"",new URLSearchParams(t).toString())).data}catch(n){console.log(n)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:n}){if(!t&&!n)this.stateFilterData.order="";else{const a=n=="ascending"?"asc":"desc";this.stateFilterData.order=`${t}_${a}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.page=this.statePagination.currentPage,await this.getData(!1)},setCharacteristicType(t){this.stateFilterData.characteristicType=t},setCharacteristicTypeTo(t){this.stateFilterData.characteristicTypeTo=t},setStartDate(t){this.stateFilterData.startDate=t},setStartDateTo(t){this.stateFilterData.startDateTo=t},setEndDate(t){this.stateFilterData.endDate=t},setEndDateTo(t){this.stateFilterData.endDateTo=t},async resetFilter(){this.stateFilterData.characteristicType="",this.stateFilterData.characteristicTypeTo="",this.stateFilterData.startDate="",this.stateFilterData.startDateTo="",this.stateFilterData.endDate="",this.stateFilterData.endDateTo="";const t=this.stateLastUsedFilterData.characteristicType!=="",n=this.stateLastUsedFilterData.characteristicTypeTo!=="",a=this.stateLastUsedFilterData.startDate!=="",m=this.stateLastUsedFilterData.startDateTo!=="",r=this.stateLastUsedFilterData.endDate!=="",o=this.stateLastUsedFilterData.endDateTo!=="";(t||n||a||m||r||o)&&await this.getData()},resetState(){this.stateFilterData={...et},this.stateDisplayData=[],this.statePagination=new K,this.stateLoading=!1,this.statePaginationLoading=!1}}}),dt={characteristicTypeId:0,characteristicType:"",characteristicTypeDescription:"",startDate:E(new Date),endDate:E(new Date("12/31/9999"))},at=it({id:"characteristicTypeForm",state:()=>({stateFormData:{...dt},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading},actions:{async insertData(t){try{this.stateLoading=!0;const n={userAccount:t,ver:"v1"},a={characteristicTypeId:this.stateFormData.characteristicTypeId,characteristicType:this.stateFormData.characteristicType,characteristicTypeDescription:this.stateFormData.characteristicTypeDescription,startDate:I(E(new Date(this.stateFormData.startDate))),endDate:I(E(new Date(this.stateFormData.endDate)))},m=await R.post(`${O}?${new URLSearchParams(n).toString()}`,a);m.data.title==="Error"?(this.stateErrors.push(m.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(n){this.stateError=n,this.stateErrors.push(n.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const n={userAccount:t,ver:"v1"},a={characteristicTypeId:this.stateFormData.characteristicTypeId,characteristicType:this.stateFormData.characteristicType,characteristicTypeDescription:this.stateFormData.characteristicTypeDescription,startDate:I(E(new Date(this.stateFormData.startDate))),endDate:I(E(new Date(this.stateFormData.endDate)))},m=await R.post(`${jt}?${new URLSearchParams(n).toString()}`,a);m.data.title==="Error"?(this.stateErrors.push(m.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(n){this.stateError=n,this.stateErrors.push(n.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.characteristicTypeId=t.characteristicTypeId||0,this.stateFormData.characteristicType=t.characteristicType||"",this.stateFormData.characteristicTypeDescription=t.characteristicTypeDescription||"",this.stateFormData.startDate=t.startDate||"",this.stateFormData.endDate=t.endDate||""},resetState(){this.stateFormData={...dt},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),Gt={key:0,style:{height:"100px"}},Kt={key:0,class:"row justify-content-center"},Jt={key:1,class:"row justify-content-center"},Xt={class:"row justify-content-center"},Yt=["onClick"],Qt=H({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:n}){const a=t,m=ot(),r=at(),o=n,D=U(()=>(a.page-1)*10+1),l=q(""),g=f=>{l.value=f.order;const y={prop:f.prop,order:f.order};m.setSort(y)},v=(f,y,_)=>Pt(f[_],y[_],l.value),S=f=>{r.setFormData(f),o("show-dialog",null)};return(f,y)=>{const _=$("inline-svg"),k=$("el-tooltip"),F=W("loading");return i(m).loading?N((w(),M("div",Gt,null,512)),[[F,i(m).loading]]):N((w(),L(i(ht),{key:1,data:a.listData,style:{width:"100%"},onSortChange:g,"empty-text":"No Data"},{default:d(()=>[s(i(C),{label:"No",width:"90",align:"center"},{default:d(e=>[p("span",null,V(D.value+e.$index),1)]),_:1}),s(i(C),{prop:"characteristicType",label:"Characteristic Type","min-width":"200",sortable:"","sort-method":(e,h)=>v(e,h,"characteristicType")},null,8,["sort-method"]),s(i(C),{prop:"characteristicTypeDescription",label:"Characteristic Type Description","min-width":"300",sortable:"","sort-method":(e,h)=>v(e,h,"characteristicTypeDescription")},null,8,["sort-method"]),s(i(C),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:d(e=>[p("span",null,V(i(G)(e.row.startDate)),1)]),_:1}),s(i(C),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:d(e=>[p("span",null,V(i(G)(e.row.endDate)),1)]),_:1}),s(i(C),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:d(e=>[e.row.isActive?(w(),M("div",Kt,[s(_,{src:"/media/svg/tables/rows/check.svg"})])):(w(),M("div",Jt,[s(_,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),s(i(C),{prop:"changedOn",label:"Changed on",align:"center",width:"170",sortable:""},{default:d(e=>[p("span",null,V(i(Et)(e.row.changedOn)),1)]),_:1}),s(i(C),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(e,h)=>v(e,h,"ChangedBy")},null,8,["sort-method"]),s(i(C),{label:"",width:"80"},{default:d(e=>[p("div",Xt,[s(k,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:d(()=>[p("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:h=>S(e.row)},[s(_,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,Yt)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[F,i(m).loading]])}}}),Wt={class:"col-md-6 fv-row fv-plugins-icon-container"},Zt={class:"col-md-6 fv-row fv-plugins-icon-container"},ta={class:"dialog-footer"},aa=H({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:n}){const a=t,m=n,r=at(),o=st(),D=Z(a,"visibility"),l=U(()=>r.formData),g=U(()=>r.errors),v=U(()=>r.isError),S=mt().shape({characteristicType:J().required("Characteristic Type is mandatory"),characteristicTypeDescription:J().required("Characteristic Type Description is mandatory"),startDate:X().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:X().required("End Date is mandatory").min(gt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),f=()=>{_(""),k(""),F(""),e("")},y=(c=!1)=>{u(),f(),r.resetState(),m("handle-close",c)},_=c=>{l.value.characteristicType=c},k=c=>{l.value.characteristicTypeDescription=c},F=c=>{l.value.startDate=c},e=c=>{l.value.endDate=c},h=async()=>{u(),await S.validate(l.value,{abortEarly:!1}).catch(c=>{r.setErrors(c.errors)}),!v.value&&j("Are you sure you want to submit ?").then(async c=>{c.isConfirmed&&r.insertData(o.user.Name).then(()=>{r.isError||rt("Form has been successfully submitted!","Ok").then(()=>{y(!0)})})})},u=()=>{r.setErrors([])};return(c,T)=>{const P=$("el-button"),b=$("el-dialog"),A=W("loading");return N((w(),L(b,{modelValue:D.value,"onUpdate:modelValue":T[0]||(T[0]=B=>D.value=B),title:"New Data",width:"40%",onClose:T[1]||(T[1]=B=>y())},{footer:d(()=>[p("span",ta,[s(P,{type:"primary",onClick:h,disabled:i(r).loading},{default:d(()=>[x("Submit")]),_:1},8,["disabled"]),s(P,{type:"secondary",onClick:y,disabled:i(r).loading},{default:d(()=>[x("Close")]),_:1},8,["disabled"])])]),default:d(()=>[s(ut,{name:"fade"},{default:d(()=>[v.value?(w(),L(yt,{key:0,errorMessages:g.value,onResetForm:u},null,8,["errorMessages"])):tt("",!0)]),_:1}),N((w(),L(i(Dt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:d(()=>[s(Y,{value:l.value.characteristicType,margin:!1,placeholder:"Add Characteristic Type",label:"Characteristic Type",name:"CharacteristicType",max:40,onHandleChange:_},null,8,["value"]),s(Y,{value:l.value.characteristicTypeDescription,margin:!1,placeholder:"Add Characteristic Type Description",label:"Characteristic Type Description",name:"CharacteristicTypeDescription",max:255,onHandleChange:k},null,8,["value"]),p("div",Wt,[s(Q,{value:l.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:F},null,8,["value"])]),p("div",Zt,[s(Q,{value:l.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:e},null,8,["value"])])]),_:1})),[[A,i(r).loading]])]),_:1},8,["modelValue"])),[[A,i(r).loading]])}}}),ea={class:"col-md-6 fv-row fv-plugins-icon-container"},sa={class:"col-md-6 fv-row fv-plugins-icon-container"},ra={class:"dialog-footer"},ia=H({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:n}){const a=t,m=n,r=at(),o=st(),D=Z(a,"visibility"),l=U(()=>r.formData),g=U(()=>r.errors),v=U(()=>r.isError),S=mt().shape({characteristicType:J().required("Characteristic Type is mandatory"),characteristicTypeDescription:J().required("Characteristic Type Description is mandatory"),startDate:X().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:X().required("End Date is mandatory").min(gt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),f=()=>{l.value.characteristicTypeId=0,l.value.characteristicType="",l.value.characteristicTypeDescription="",l.value.startDate="",l.value.endDate=""},y=(c=!1)=>{f(),r.resetState(),u(),m("handle-close",c)},_=c=>{l.value.characteristicType=c},k=c=>{l.value.characteristicTypeDescription=c},F=c=>{l.value.startDate=c},e=c=>{l.value.endDate=c},h=async()=>{u(),await S.validate(l.value,{abortEarly:!1}).catch(c=>{r.setErrors(c.errors)}),!v.value&&j("Are you sure you want to submit ?").then(async c=>{c.isConfirmed&&r.updateData(o.user.Name).then(()=>{r.isError||rt("Form has been successfully submitted!","Ok").then(()=>{y(!0)})})})},u=()=>{r.setErrors([])};return(c,T)=>{const P=$("el-button"),b=$("el-dialog"),A=W("loading");return N((w(),L(b,{modelValue:D.value,"onUpdate:modelValue":T[0]||(T[0]=B=>D.value=B),title:"Update Data",width:"40%",onClose:T[1]||(T[1]=B=>y())},{footer:d(()=>[p("span",ra,[s(P,{type:"primary",onClick:h,disabled:i(r).loading},{default:d(()=>[x("Submit")]),_:1},8,["disabled"]),s(P,{type:"secondary",onClick:y,disabled:i(r).loading},{default:d(()=>[x("Close")]),_:1},8,["disabled"])])]),default:d(()=>[s(ut,{name:"fade"},{default:d(()=>[v.value?(w(),L(yt,{key:0,errorMessages:g.value,onResetForm:u},null,8,["errorMessages"])):tt("",!0)]),_:1}),s(i(Dt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:d(()=>[s(Y,{value:l.value.characteristicType,margin:!1,placeholder:"Add Characteristic Type",label:"Characteristic Type",name:"CharacteristicType",max:40,onHandleChange:_},null,8,["value"]),s(Y,{value:l.value.characteristicTypeDescription,margin:!1,placeholder:"Add Characteristic Type Description",label:"Characteristic Type Description",name:"CharacteristicTypeDescription",max:255,onHandleChange:k},null,8,["value"]),p("div",ea,[s(Q,{value:l.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:F},null,8,["value"])]),p("div",sa,[s(Q,{value:l.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:e},null,8,["value"])])]),_:1})]),_:1},8,["modelValue"])),[[A,i(r).loading]])}}}),nt=it({id:"characteristicTypeBulk",state:()=>({statePagination:new K,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const n={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const a=await R.post(`${Nt}?${new URLSearchParams(n).toString()}`,this.stateBulkData);this.stateError=a.data.result.isError?a.data.result.message:"",this.stateIsError=a.data.result.isError}catch(a){console.log(a)}this.stateLoading=!1},async upload({userAccount:t,excelFile:n}){const a={userAccount:t,ver:"v1"},m=`${qt}?${new URLSearchParams(a).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const r=await R.postImages(m,n);r.data.statusCode==200?r.data.result.isError?(this.stateIsError=!0,this.stateError=r.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=r.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=At.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=r.data.result.isError,this.stateError=r.data.result.message)}catch(r){console.log(r),this.stateIsError=!0,this.stateError=r.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(kt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new K,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),oa={class:"icon"},na=H({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const n=t,a=nt(),m=U(()=>(n.page-1)*10+1),r=o=>{const D={prop:o.prop,order:o.order};a.setSort(D)};return(o,D)=>{const l=$("inline-svg");return w(),L(i(ht),{data:n.listData,style:{width:"100%"},onSortChange:r,"empty-text":"No Data"},{default:d(()=>[s(i(C),{label:"No",width:"60",align:"center"},{default:d(g=>[p("span",null,V(m.value+g.$index),1)]),_:1}),s(i(C),{prop:"characteristicType",label:"Characteristic Type",width:"300",sortable:""}),s(i(C),{prop:"characteristicTypeDescription",label:"Characteristic Type Description",width:"300",sortable:""}),s(i(C),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:d(g=>[p("span",null,V(i(G)(g.row.startDate)),1)]),_:1}),s(i(C),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:d(g=>[p("span",null,V(i(G)(g.row.endDate)),1)]),_:1}),s(i(C),{prop:"validationReason",label:"Remark","min-width":"300",sortable:""}),s(i(C),{prop:"isValid",label:"Status",width:"100",sortable:""},{default:d(g=>[p("div",oa,[s(l,{src:g.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),lt=t=>(It("data-v-28933c72"),t=t(),Ut(),t),la=lt(()=>p("div",{class:"text-center"},null,-1)),ca=lt(()=>p("div",{class:"mb-3"},[p("span",null,[x(" Download template "),p("a",{href:"documents/MasterDataCharacteristicType.xlsx",target:"_blank",id:"link-download"},"here"),x(" before uploading file ")])],-1)),da=lt(()=>p("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[p("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),pa={class:"card"},ha={class:"card-body grid-padding"},ua={class:"dialog-footer"},Da=H({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:n}){const a=t,m=n,r=st(),o=nt(),D=Z(a,"visibility"),l=()=>{const e=Vt(o.validatedData,h=>{const u=h;return{characteristicType:u.characteristicType,characteristicTypeDescription:u.characteristicTypeDescription,startDate:u.startDate,endDate:u.endDate}});return Object.values(e)},g=()=>{const e=document.getElementById("link-download");e&&e.click()},v=()=>{o.validatedData.length>0?j("Cancel Upload Data?","Confirm").then(h=>{h.isConfirmed&&f()}):f()},S=async e=>{await o.upload({userAccount:r.user.Name,excelFile:e}),o.stateError&&z(o.error)},f=(e=!1)=>{o.resetState(),m("handle-close",e)},y=e=>{o.setIsUploadedState(e)},_=e=>{o.setPage(e)},k=()=>{if(o.validatedData.length<1){g();return}const e=["Characteristic Type","Characteristic Type DESCRIPTION","START DATE","END DATE","REMARK","STATUS"],h=o.validatedData.map(u=>({characteristicType:u.characteristicType,characteristicTypeDescription:u.characteristicTypeDescription,startDate:u.startDate,endDate:u.endDate,remark:u.validationReason,status:u.isValid?"OK":"Error"}));bt("Characteristic Type",e,h)},F=async()=>{if(o.displayData.length<1){z("There is no data to submit");return}if(o.isError){z("There is still invalid row(s)");return}j("Are you sure you want to submit ?").then(async e=>{if(e.isConfirmed){const h=l();if(o.setBulkData(h),await o.bulkInsert(r.user.Name),o.isError){z(o.stateError);return}rt("Form has been successfully submitted!","Ok").then(()=>{f(!0)})}})};return(e,h)=>{const u=$("el-button"),c=$("el-dialog"),T=W("loading");return w(),L(c,{title:"Upload Bulk Data",modelValue:D.value,"onUpdate:modelValue":h[1]||(h[1]=P=>D.value=P),"before-close":v,width:"70%","custom-class":"upload-modal"},{footer:d(()=>[p("div",null,[p("span",ua,[s(u,{type:"success",onClick:k},{default:d(()=>[x("Download")]),_:1}),s(u,{type:"primary",onClick:F},{default:d(()=>[x("Upload")]),_:1}),s(u,{type:"success",onClick:v},{default:d(()=>[x("Cancel")]),_:1})])])]),default:d(()=>[la,ca,N(s(Bt,{isSubmissionUploadSuccess:i(o).isUploaded,onHandleCloseUploadedFile:v,onHandleUpload:S,onHandleSetIsExcelFileUploaded:y},null,8,["isSubmissionUploadSuccess"]),[[T,i(o).uploadLoading]]),da,p("div",pa,[p("div",ha,[s(na,{"list-data":i(o).displayData,page:i(o).pagination.currentPage},null,8,["list-data","page"])])]),i(o).displayData.length>0?(w(),L(pt,{key:0,onRaisePageChange:h[0]||(h[0]=P=>_(P)),currentPage:i(o).pagination.currentPage,totalPage:i(o).pagination.totalPage,totalPageSize:i(o).pagination.totalPageSize,startPaginationIndex:i(o).pagination.startPaginationIndex,endPaginationIndex:i(o).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):tt("",!0)]),_:1},8,["modelValue"])}}}),ma=Rt(Da,[["__scopeId","data-v-28933c72"]]),ga={class:"row g-9 my-4"},ya={class:"dialog-footer"},fa=H({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:n}){const a=ot(),m=t,r=n,o=Z(m,"visibility"),D=U(()=>a.filterData),l=()=>{g(),a.resetFilter()},g=()=>{r("handle-close",!1)},v=e=>{a.setCharacteristicType(e)},S=e=>{a.setCharacteristicTypeTo(e)},f=e=>{a.setStartDate(e)},y=e=>{a.setStartDateTo(e)},_=e=>{a.setEndDate(e)},k=e=>{a.setEndDateTo(e)},F=()=>{const e=a.lastUsedFilterData.characteristicType!==a.filterData.characteristicType,h=a.lastUsedFilterData.characteristicTypeTo!==a.filterData.characteristicTypeTo,u=a.lastUsedFilterData.startDate!==a.filterData.startDate,c=a.lastUsedFilterData.startDateTo!==a.filterData.startDateTo,T=a.lastUsedFilterData.endDate!==a.filterData.endDate,P=a.lastUsedFilterData.endDateTo!==a.filterData.endDateTo;r("handle-close",e||h||u||c||T||P)};return(e,h)=>{const u=$("el-button"),c=$("el-dialog");return w(),L(c,{modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=T=>o.value=T),title:"Filter",width:"60%",onClose:h[1]||(h[1]=T=>g())},{footer:d(()=>[p("span",ya,[s(u,{type:"secondary",onClick:l},{default:d(()=>[x("Reset")]),_:1}),s(u,{type:"primary",onClick:F},{default:d(()=>[x("Filter")]),_:1})])]),default:d(()=>[p("div",ga,[s(Ht,{"value-from":D.value.characteristicType,"value-to":D.value.characteristicTypeTo,label:"Characteristic Type",name:"CharacteristicType",options:i(a).characteristicTypeOption,onHandleChangeFrom:v,onHandleChangeTo:S},null,8,["value-from","value-to","options"]),s(ct,{"value-from":D.value.startDate?D.value.startDate.toString():"","value-to":D.value.startDateTo?D.value.startDateTo.toString():"",label:"Start Date",name:"StartDate",placeholder:"Pick a date",onHandleChangeFrom:f,onHandleChangeTo:y},null,8,["value-from","value-to"]),s(ct,{"value-from":D.value.endDate?D.value.endDate.toString():"","value-to":D.value.endDateTo?D.value.endDateTo.toString():"",label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChangeFrom:_,onHandleChangeTo:k},null,8,["value-from","value-to"])])]),_:1},8,["modelValue"])}}}),Ta={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},va=p("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),_a={class:"d-flex justify-content-between align-items-center"},ba={class:"card"},Sa={class:"card-body grid-padding"},Ca={class:"my-5"},Ae=H({__name:"Index",setup(t){const n=ft(),a=ot(),m=at(),r=nt(),o=q(!1),D=q(!1),l=q(!1),g=q(!1),v=U(()=>a.displayData),S=U(()=>a.pagination),f=b=>{a.setPage(b)};Lt(async()=>{n[vt.ACTIVE_PAGE]("IronLake"),Tt("Characteristic Type",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Equipment",pageRoute:"CharacteristicType"},{pageName:"Characteristic Type",pageRoute:"CharacteristicType"}]),a.setPage(1),await a.getLookup()}),xt(()=>{a.resetState(),m.resetState(),r.resetState()});const y=async()=>{await a.setPage(1),await a.getLookup()},_=()=>{o.value=!0},k=async b=>{o.value=!1,b&&await y()},F=()=>{D.value=!0},e=async b=>{D.value=!1,b&&await y()},h=()=>{l.value=!0},u=async b=>{l.value=!1,b&&await y()},c=async()=>{const b=await a.export();Ot.saveAs(new Blob([b],{type:"application/octet-stream"}),"CharacteristicType.xlsx")},T=()=>{g.value=!0},P=async b=>{g.value=!1,b&&await y()};return(b,A)=>(w(),M($t,null,[p("div",Ta,[va,p("div",_a,[s(St,{onShowDialog:_}),s(_t,{onShowDialog:h}),s(wt,{onHandleDownload:c}),s(Ct,{onShowDialog:T})])]),p("div",ba,[p("div",Sa,[s(Qt,{"list-data":v.value,page:S.value.currentPage,onShowDialog:F},null,8,["list-data","page"])])]),p("div",Ca,[i(a).paginationLoading?tt("",!0):(w(),L(pt,{key:0,onRaisePageChange:A[0]||(A[0]=B=>f(B)),currentPage:S.value.currentPage,totalPage:S.value.totalPage,totalPageSize:S.value.totalPageSize,startPaginationIndex:S.value.startPaginationIndex,endPaginationIndex:S.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),s(aa,{visibility:o.value,onHandleClose:k},null,8,["visibility"]),s(ia,{visibility:D.value,onHandleClose:e},null,8,["visibility"]),s(fa,{visibility:l.value,onHandleClose:u},null,8,["visibility"]),s(ma,{visibility:g.value,onHandleClose:P},null,8,["visibility"])],64))}});export{Ae as default};

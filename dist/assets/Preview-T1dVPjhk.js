import{a as ut}from"./index-BuVmIl8K.js";import{d as ze,j as dt,g as ct}from"./date-format-8-IvfSl3.js";import{a as mt}from"./useDefectsFormStore-41UTMhiG.js";import{c as vt}from"./get-user-info-DjfNX8-X.js";import{u as Je}from"./useSosStore-DEF7qS5a.js";import{n as pt}from"./navigator-D5io2Cca.js";import{u as ft}from"./useMsal-BbsBYoof.js";import{s as gt}from"./@progress-DBKeVTWA.js";import{u as ht}from"./vue-router-iNp9kJ0K.js";import{a as xe}from"./element-plus-BeWdvTRa.js";import{e as Re}from"./lodash-DrHMlsdo.js";import{O as bt}from"./OnlineStatus-Bhk3CA8-.js";import{_ as _t}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{k as ae,R as Y,p as n,aa as u,s as v,aB as e,C as _,bd as Ee,bb as Ve,c,r as f,o as Qe,A as T,b6 as yt,M as xt,d as wt,y as S,a5 as I,u as V,K as $e,bB as He,F as U,$ as J,Z as P,P as B,b4 as pe,q as le,B as D,bL as ve,x as A,a0 as Ct,a7 as kt,n as We,L as St}from"./@vue-BypzYtbH.js";import{_ as De}from"./nw-img-vue-CR837WER.js";import{b as $t}from"./qrcode-SHonoxyK.js";import"./pinia-BjOS2_Ao.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./moment-C5S46NFB.js";import"./DefectNoClass-BqGKOkzR.js";import"./urls-CvqtYZA-.js";import"./number-format-BdMuQVyW.js";import"./urls-CPQ2HRXU.js";import"./prev-val-handler-DvA3D_kF.js";import"./helpers-wUOLw-dU.js";import"./webp-converter-browser-C3MD88Lp.js";import"./compressorjs-Cmz8Y9J9.js";import"./file-saver-CwTBvle_.js";import"./urls-B0Rq9QQ3.js";import"./urls-hWHEBXep.js";import"./urls-D8F5Tyyp.js";import"./authentication-handler-Pueb_EI7.js";import"./string-to-imageinfo-converter-Cdr1iOkP.js";import"./useGlobalConnectionStore-DV9B81de.js";import"./useCameraStore-BwXVJhPe.js";import"./useAttachmentStore-DqM3autD.js";import"./useBodyStore-L-idhAYV.js";import"./useMasterStore-CzSO06fn.js";import"./internet-connection-CnLQPjRt.js";import"./@vueuse-DFoNmIyu.js";import"./vue-BzYgrL08.js";import"./dijkstrajs-D_NXgYpA.js";const Dt="/media/svg/buttons/save.svg",Tt="/media/svg/buttons/edit.svg",Lt="/media/svg/buttons/print.svg",Ot={class:"d-flex flex-row align-items-center justify-content-between mb-3 mt-1"},Ft={class:"d-flex flex-column align-items-end pe-3"},It={class:"service-no"},Mt={class:"service-title"},qt=ae({__name:"HeaderLabel",props:{title:{type:String,required:!0},compartment:{type:String,required:!0}},setup(l){return(s,p)=>{const i=Y("NwImg");return n(),u("div",Ot,[v(i,{src:"/media/logos/bumaau/buma-logo.png",class:"logo"}),e("div",Ft,[e("p",It,_(l.compartment),1),e("p",Mt,_(l.title),1)])])}}}),Xe=De(qt,[["__scopeId","data-v-ad251069"]]),Et=l=>(Ee("data-v-888f59f7"),l=l(),Ve(),l),Vt={class:"col-title"},Gt={class:"col-value"},Pt={class:"d-flex flex-row align-items-center"},Bt=Et(()=>e("p",{class:"colon"},":",-1)),Nt={class:"value ms-1"},At=ae({__name:"ColumnLabel",props:{title:{type:String,required:!0},value:{type:String,required:!1}},setup(l){const s=l;return(p,i)=>(n(),u("tr",null,[e("td",Vt,[e("p",null,_(s.title),1)]),e("td",Gt,[e("div",Pt,[Bt,e("p",Nt,_(s.value),1)])])]))}}),$=De(At,[["__scopeId","data-v-888f59f7"]]),Ge=l=>(Ee("data-v-d66a8f14"),l=l(),Ve(),l),Ut={class:"service-label d-flex flex-column justify-content-around prevent-split"},Ht={class:"row gx-2"},Kt={class:"col-4"},jt={class:"w-100"},Yt=Ge(()=>e("th",null,null,-1)),Rt={class:"col-4"},Wt={class:"w-100"},Zt=Ge(()=>e("th",null,null,-1)),zt={class:"col-4"},Jt={class:"w-100"},Qt=Ge(()=>e("th",null,null,-1)),Xt={class:"d-flex flex-row justify-content-end align-items-end w-100"},el={key:0,class:"d-flex flex-column me-auto"},tl=["src"],ll={class:"print-data mx-auto"},al={class:"print-data"},sl={class:"dash-line"},ol={key:0,width:"750",height:"11"},nl=Ge(()=>e("line",{x1:"0",y1:"10",x2:"750",y2:"10",stroke:"#E0E0E0","stroke-width":"1","stroke-dasharray":"5, 3"},null,-1)),il=[nl],rl=ae({__name:"Label",props:{labelData:{type:Object,required:!0},detail:{type:Object,required:!0},printData:{type:String,required:!0},indexCompartment:{type:Number,required:!0},qrCode:{type:String,required:!1}},setup(l){const s=l,p=c(()=>s.detail.lubricantType!="Oil"),i=c(()=>s.detail.sampleDate==""?"-":s.detail.sampleDate.length==8?s.detail.sampleDate:ze(s.detail.sampleDate,"DD/MM/YY HH:mm:ss (Z)","DD/MM/YYYY")),h=d=>d=="-"||d==""?"-":d.toLowerCase()=="true"?"Yes":"No",x=f(""),N=async()=>{await $t.toDataURL(s.qrCode,function(d,y){d&&console.log(d),x.value=y})};return Qe(async()=>{s.qrCode&&await N()}),(d,y)=>(n(),u("div",Ut,[v(Xe,{title:p.value?"SOS Coolant Analysis":"SOS Oil Analysis",compartment:`${l.labelData.equipment} - ${l.detail.compartmentLubricant}`},null,8,["title","compartment"]),e("div",Ht,[e("div",Kt,[e("table",jt,[Yt,v($,{title:"Customer",value:l.labelData.customerName},null,8,["value"]),v($,{title:"Serial Number",value:l.labelData.equipmentSerialNumber||"-"},null,8,["value"]),v($,{title:"Unit Number",value:l.labelData.equipment},null,8,["value"]),v($,{title:"Machine SMU",value:l.detail.lastMeterHrs},null,8,["value"]),v($,{title:"Sample Date",value:i.value},null,8,["value"]),v($,{title:"Service Interval",value:l.labelData.psTypeId},null,8,["value"])])]),e("div",Rt,[e("table",Wt,[Zt,v($,{title:"Fuel Burn",value:l.detail.fuelBurn||"-"},null,8,["value"]),v($,{title:"Job Site",value:l.labelData.jobSite},null,8,["value"]),v($,{title:"Compartment",value:l.detail.compartmentLubricant},null,8,["value"]),v($,{title:"Component Hours",value:l.detail.componentHours||"-"},null,8,["value"]),v($,{title:"Fluid Hours",value:l.detail.fluidHours||"-"},null,8,["value"]),v($,{title:"Fluid Added",value:`${l.detail.volume} ${l.detail.uoM}`},null,8,["value"])])]),e("div",zt,[e("table",Jt,[Qt,v($,{title:"Fluid Changed",value:h(l.detail.fluidChanged??"")},null,8,["value"]),v($,{title:"Filter Changed",value:h(l.detail.filterChanged??"")},null,8,["value"]),v($,{title:"Oil Type",value:l.detail.oilType||"-"},null,8,["value"]),v($,{title:"Oil Grade",value:l.detail.oilGrade||"-"},null,8,["value"]),v($,{title:"Coolant",value:l.detail.coolant||"-"},null,8,["value"]),v($,{title:"Fuel Type",value:l.detail.fuelType||"-"},null,8,["value"])])])]),e("div",Xt,[l.qrCode?(n(),u("div",el,[(n(),u("img",{ref:"qrImage",src:x.value,key:x.value,class:"qr-image",alt:"QR Code"},null,8,tl)),e("p",ll,_(l.qrCode),1)])):T("",!0),e("p",al,_(l.printData),1)]),e("div",sl,[(l.indexCompartment+1)%3!=0?(n(),u("svg",ol,il)):T("",!0)])]))}}),Ze=De(rl,[["__scopeId","data-v-d66a8f14"]]),ul="/media/svg/dma/calendar.svg",dl="/media/svg/dma/close.svg",cl={class:"d-flex flex-row align-items-center"},ml=["src"],vl={class:"mb-0 ms-2 me-auto"},et=ae({__name:"Alert",props:{type:{type:String,required:!1,default:"success"},message:{type:String,required:!0},closable:{type:Boolean,required:!1,default:!0},width:{type:String,required:!1,default:"595px"}},emits:["close"],setup(l,{emit:s}){const p=l,i=s,h=c(()=>{switch(p.type){case"error":return"#FFEDEC";case"warning":return"#FFF3CD";default:return"#DDF7D5"}}),x=c(()=>{switch(p.type){case"error":return"#FF918E";case"warning":return"#FFDA6A";default:return"#74CF92"}}),N=c(()=>{switch(p.type){case"error":return"/media/svg/dma/error.svg";case"warning":return"/media/svg/dma/warning.svg";default:return"/media/svg/dma/green-checklist.svg"}}),d=c(()=>({"background-color":h.value,border:`1px solid ${x.value}`,width:`${p.width}`})),y=()=>{i("close",!0)};return(w,Q)=>(n(),u("div",{class:"custom-alert mb-3",style:yt(d.value)},[e("div",cl,[e("img",{src:N.value,class:"me-2",style:{height:"18px"},alt:"icon"},null,8,ml),e("p",vl,_(l.message),1),l.closable?(n(),u("img",{key:0,src:dl,class:"ms-4 pointer",style:{height:"11px"},alt:"icon",onClick:y})):T("",!0)])],4))}}),b=l=>(Ee("data-v-fa69dede"),l=l(),Ve(),l),pl={class:"service-label d-flex flex-column justify-content-around prevent-split"},fl=b(()=>e("p",null,[D("Field with asterisk ("),e("span",{class:"text-danger"},"*"),D(") means mandatory")],-1)),gl={class:"row g-2 mb-3"},hl={class:"col-6 col-md-3 col-lg-3"},bl={class:"form-floating"},_l=b(()=>e("label",{for:"floatingInput"},[D("Customer"),e("span",{class:"text-danger"},"*")],-1)),yl={class:"col-6 col-md-3 col-lg-3"},xl={class:"custom-date-picker"},wl={class:"form-floating sample-date"},Cl=["readonly","disabled"],kl=b(()=>e("label",{for:"floatingInput"},[D("Sample Date"),e("span",{class:"text-danger"},"*")],-1)),Sl=b(()=>e("img",{src:ul,class:"me-2 input-icon",style:{height:"18px"},alt:"icon"},null,-1)),$l={key:0,class:"text-danger mt-1 mb-0"},Dl={class:"col-6 col-md-3 col-lg-3"},Tl={class:"form-floating"},Ll=b(()=>e("label",{for:"floatingInput"},[D("Unit Number"),e("span",{class:"text-danger"},"*")],-1)),Ol={class:"col-6 col-md-3 col-lg-3"},Fl={class:"form-floating"},Il=["disabled"],Ml=["value"],ql=b(()=>e("label",{for:"floatingSelect"},"Service Interval",-1)),El={class:"col-6 col-md-3 col-lg-3"},Vl={class:"form-floating"},Gl=b(()=>e("label",{for:"floatingInput"},[D("Serial Number"),e("span",{class:"text-danger"},"*")],-1)),Pl={class:"col-6 col-md-3 col-lg-3"},Bl={class:"form-floating"},Nl=["disabled"],Al=b(()=>e("label",{for:"floatingInput"},[D("Fuel Burn"),e("span",{class:"text-danger"},"*")],-1)),Ul={key:0,class:"text-danger mt-1 mb-0"},Hl={class:"col-6 col-md-3 col-lg-3"},Kl={class:"form-floating"},jl=["disabled"],Yl=b(()=>e("label",{for:"floatingInput"},[D("Machine SMU"),e("span",{class:"text-danger"},"*")],-1)),Rl={key:0,class:"text-danger mt-1 mb-0"},Wl={class:"col-6 col-md-3 col-lg-3"},Zl={class:"form-floating"},zl=b(()=>e("label",{for:"floatingInput"},[D("Job Site"),e("span",{class:"text-danger"},"*")],-1)),Jl=b(()=>e("div",{class:"dash-line"},[e("svg",{width:"1500",height:"20"},[e("line",{x1:"0",y1:"5",x2:"1500",y2:"5",stroke:"#E0E0E0","stroke-width":"1","stroke-dasharray":"17, 5"})])],-1)),Ql={class:"row gx-2 gy-4 mb-3"},Xl={class:"col-6 col-md-3 col-lg-3"},ea={class:"form-floating"},ta=b(()=>e("label",{for:"floatingInput"},[D("Compartment"),e("span",{class:"text-danger"},"*")],-1)),la={class:"col-6 col-md-3 col-lg-3"},aa={class:"form-floating"},sa=["disabled"],oa=b(()=>e("label",{for:"floatingInput"},"Component Hours",-1)),na={class:"col-6 col-md-3 col-lg-3"},ia={class:"form-floating"},ra=["disabled"],ua=b(()=>e("label",{for:"floatingInput"},"Fluid Hours",-1)),da={class:"col-6 col-md-3 col-lg-3"},ca={class:"form-floating"},ma=["disabled"],va=b(()=>e("label",{for:"floatingInput"},"Fluid Added",-1)),pa={class:"col-6 col-md-3 col-lg-3"},fa={class:"form-floating"},ga=["disabled"],ha=b(()=>e("option",{value:"1"},"Yes",-1)),ba=b(()=>e("option",{value:"2"},"No",-1)),_a=[ha,ba],ya=b(()=>e("label",{for:"floatingSelect"},"Fluid Changed",-1)),xa={class:"col-6 col-md-3 col-lg-3"},wa={class:"form-floating"},Ca=["disabled"],ka=b(()=>e("option",{value:""},"-",-1)),Sa=b(()=>e("option",{value:"1"},"Yes",-1)),$a=b(()=>e("option",{value:"2"},"No",-1)),Da=[ka,Sa,$a],Ta=b(()=>e("label",{for:"floatingSelect"},"Filter Change",-1)),La={class:"col-6 col-md-3 col-lg-3"},Oa={class:"form-floating"},Fa=["disabled","onKeydown"],Ia=b(()=>e("label",{for:"floatingInput"},"Oil Type",-1)),Ma={key:0,class:"list-group position-absolute autocomplete-list"},qa=["onMousedown","onMouseover"],Ea={class:"col-6 col-md-3 col-lg-3"},Va={class:"form-floating"},Ga=["disabled","onKeydown"],Pa=b(()=>e("label",{for:"floatingInput"},"Oil Grade",-1)),Ba={key:0,class:"list-group position-absolute autocomplete-list"},Na=["onMousedown","onMouseover"],Aa={class:"col-6 col-md-3 col-lg-3"},Ua={class:"form-floating"},Ha=["disabled","onKeydown"],Ka=b(()=>e("label",{for:"floatingInput"},"Coolant",-1)),ja={key:0,class:"list-group position-absolute autocomplete-list"},Ya=["onMousedown","onMouseover"],Ra={class:"col-6 col-md-3 col-lg-3"},Wa={class:"form-floating"},Za=["disabled","onKeydown"],za=b(()=>e("label",{for:"floatingInput"},"Fuel Type",-1)),Ja={key:0,class:"list-group position-absolute autocomplete-list"},Qa=["onMousedown","onMouseover"],Xa=ae({__name:"EditLabel",props:{labelData:{type:Object,required:!0},detail:{type:Object,required:!0},printData:{type:String,required:!0},indexCompartment:{type:Number,required:!0}},setup(l){const s=l,{customerName:p,equipmentSerialNumber:i,equipment:h,jobSite:x,details:N}=xt(s.labelData),d=Je(),y=c(()=>d.SosEditErrors),w=c(()=>s.detail.label!=""&&s.detail.label!=null&&s.detail.label!=null),Q=f(["250","500","1000","2000","4000","5000"]),q=c({get:()=>s.labelData.psTypeId,set:a=>{d.stateSosLabel.psTypeId=a,d.updatePayloadGeneralData("psTypeId",a)}}),X=c({get:()=>s.detail.sampleDate==""?"":s.detail.sampleDate.length==8?s.detail.sampleDate:ze(s.detail.sampleDate,"DD/MM/YY HH:mm:ss (Z)","DD/MM/YYYY"),set:a=>{d.updateSosData("sampleDate",s.indexCompartment,a)}}),ee=c({get:()=>d.stateSosLabel.details[s.indexCompartment].fuelBurn,set:a=>{d.updateSosData("fuelBurn",s.indexCompartment,a)}}),we=a=>{let t=a.target.value;t=t.replace(/[^0-9.]/g,"");const F=t.split(".");F.length>2&&(t=F[0]+"."+F.slice(1).join("")),F[0].length>5&&(F[0]=F[0].substring(0,5)),F[1]&&F[1].length>2&&(F[1]=F[1].substring(0,2)),ee.value=F.join("."),Ue("fuelBurn")},se=c({get:()=>s.detail.lastMeterHrs,set:a=>{d.updateSosData("lastMeterHrs",s.indexCompartment,a)}}),fe=c({get:()=>s.detail.componentHours,set:a=>{d.updateSosData("componentHours",s.indexCompartment,a)}}),Te=c({get:()=>s.detail.fluidHours,set:a=>{d.updateSosData("fluidHours",s.indexCompartment,a)}}),G=c({get:()=>s.detail.volume,set:a=>{d.updateSosData("volume",s.indexCompartment,a)}}),Ce=c({get:()=>{switch(s.detail.fluidChanged){case"True":return"1";case"False":return"2";default:return""}},set:a=>{let t="";switch(a){case"1":t="True";break;case"2":t="False";break;default:t="";break}d.updateSosData("fluidChanged",s.indexCompartment,t)}}),ge=c({get:()=>{switch(s.detail.filterChanged){case"True":return"1";case"False":return"2";case"":return"-";default:return"-"}},set:a=>{let t="";switch(a){case"1":t="True";break;case"2":t="False";break;case"-":t="";break;default:t="";break}d.updateSosData("filterChanged",s.indexCompartment,t)}}),H=f(),R=f("");wt(()=>R.value,a=>{X.value=dt(a),Ue("sampleDate")});const oe=()=>{s.detail.label||H.value.focus()},ne=c(()=>s.detail.lubricantType!="Oil"),W=a=>{let t=a.keyCode?a.keyCode:a.which;t!=46&&(t<48||t>57)&&a.preventDefault()},he=["Aviation Gasoline (Leaded Petrol)","Bio-Diesel","Bio/Sewer Gas","Diesel","Ethanol","Ethanol Biended ULP","Gas Oil","Hydrogen Injection","Kerosine Jet A1","Landfill Gas","Liquid Natural Gas","MDO/MGO Marine Distillate Oil","Methanol","Natural Gas","Unleaded Petrol"],K=c({get:()=>s.detail.fuelType,set:a=>{d.updateSosData("fuelType",s.indexCompartment,a)}}),Z=f(he),L=f(0),be=f(!1),Be=async()=>{K.value&&K.value.length>2?setTimeout(()=>{Z.value=he},1e3):Z.value=[]},_e=a=>{L.value=a},Ne=()=>{L.value<Z.value.length-1&&L.value++},Ae=()=>{L.value>0&&L.value--},Le=a=>{K.value=Z.value[a],be.value=!1},ke=()=>{setTimeout(()=>{K.value&&!Z.value.includes(K.value)&&(K.value=""),be.value=!1},100)},E=c({get:()=>s.detail.oilType,set:a=>{d.updateSosData("oilType",s.indexCompartment,a)}}),ie=c(()=>d.OilTypeList),ye=c(()=>E.value?ie.value.filter(t=>E.value!=null?t.oilType.toLowerCase().includes(E.value.toLowerCase()):[]).map(t=>t.oilType):ie.value.map(a=>a.oilType)),j=f(0),te=f(!1),Oe=a=>{j.value=a},Fe=()=>{j.value<ye.value.length-1&&j.value++},Ie=()=>{j.value>0&&j.value--},re=f(),ue=f(""),r=async a=>{E.value=ye.value[a];const t=ie.value.find(F=>F.oilType==E.value);ue.value=t?t.oilTypeId:"",te.value=!1,re.value=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await d.getOilGradeList(ue.value),re.value.close()},g=()=>{const a=ie.value.map(t=>t.oilType);setTimeout(()=>{E.value&&!a.includes(E.value)&&(E.value=""),te.value=!1},100)},m=c({get:()=>s.detail.oilGrade,set:a=>{d.updateSosData("oilGrade",s.indexCompartment,a)}}),O=c(()=>d.OilGradeList),de=c(()=>m.value?O.value.filter(t=>m.value!=null?t.oilGrade.toLowerCase().includes(m.value.toLowerCase()):[]).map(t=>t.oilGrade):O.value.map(a=>a.oilGrade)),M=async()=>{if(ue.value==""){const a=ie.value.find(t=>t.oilType==E.value);ue.value=a?a.oilTypeId:"",te.value=!1,re.value=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await d.getOilGradeList(ue.value),re.value.close()}Me.value=!0},k=f(0),Me=f(!1),tt=a=>{k.value=a},lt=()=>{k.value<de.value.length-1&&k.value++},at=()=>{k.value>0&&k.value--},Ke=a=>{m.value=de.value[a],Me.value=!1},st=()=>{setTimeout(()=>{m.value&&!de.value.includes(m.value)&&(m.value=""),Me.value=!1},100)},z=c({get:()=>s.detail.coolant,set:a=>{d.updateSosData("coolant",s.indexCompartment,a)}}),je=c(()=>d.CoolantList),Se=c(()=>z.value?je.value.filter(t=>z.value!=null?t.coolant.toLowerCase().includes(z.value.toLowerCase()):[]).map(t=>t.coolant):je.value.map(a=>a.coolant)),ce=f(0),qe=f(!1),ot=a=>{ce.value=a},nt=()=>{ce.value<Se.value.length-1&&ce.value++},it=()=>{ce.value>0&&ce.value--},Ye=a=>{z.value=Se.value[a],qe.value=!1},rt=()=>{setTimeout(()=>{z.value&&!Se.value.includes(z.value)&&(z.value=""),qe.value=!1},100)},Ue=a=>{switch(a){case"sampleDate":d.stateErrorField[0].items[s.indexCompartment].message="";break;case"machineSmu":d.stateErrorField[1].items[s.indexCompartment].message="";break;case"fuelBurn":d.stateErrorField[2].items[s.indexCompartment].message="";break}};return(a,t)=>{const F=Y("el-date-picker");return n(),u("div",pl,[v(Xe,{title:ne.value?"SOS Coolant Analysis":"SOS Oil Analysis",compartment:`${l.labelData.equipment} - ${l.detail.compartmentLubricant}`},null,8,["title","compartment"]),fl,e("div",gl,[e("div",hl,[e("div",bl,[S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>$e(p)?p.value=o:null),type:"text",class:"form-control",disabled:""},null,512),[[I,V(p)]]),_l])]),e("div",yl,[e("div",xl,[e("div",wl,[S(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>X.value=o),readonly:!w.value,disabled:w.value,type:"text",class:"form-control",onClick:oe},null,8,Cl),[[I,X.value]]),kl,Sl]),v(F,{modelValue:R.value,"onUpdate:modelValue":t[2]||(t[2]=o=>R.value=o),ref_key:"sampleDatePicker",ref:H,type:"date",class:"form-control el-date-picker",style:{visibility:"hidden"},size:"small",clearable:!1},null,8,["modelValue"])]),y.value[0].items[l.indexCompartment]&&y.value[0].items[l.indexCompartment].message?(n(),u("p",$l,_(y.value[0].items[l.indexCompartment].message),1)):T("",!0)]),e("div",Dl,[e("div",Tl,[S(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>$e(h)?h.value=o:null),type:"text",class:"form-control",disabled:""},null,512),[[I,V(h)]]),Ll])]),e("div",Ol,[e("div",Fl,[S(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>q.value=o),class:"form-select",id:"floatingSelect","aria-label":"Floating label select example",disabled:w.value},[(n(!0),u(U,null,J(Q.value,(o,C)=>(n(),u("option",{key:C,value:o},_(o),9,Ml))),128))],8,Il),[[He,q.value]]),ql])]),e("div",El,[e("div",Vl,[S(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>$e(i)?i.value=o:null),type:"text",class:"form-control",disabled:""},null,512),[[I,V(i)]]),Gl])]),e("div",Pl,[e("div",Bl,[S(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>ee.value=o),type:"text",class:"form-control",disabled:w.value,onKeypress:W,onInput:we},null,40,Nl),[[I,ee.value]]),Al]),y.value[2].items[l.indexCompartment]&&y.value[2].items[l.indexCompartment].message?(n(),u("p",Ul,_(y.value[2].items[l.indexCompartment].message),1)):T("",!0)]),e("div",Hl,[e("div",Kl,[S(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>se.value=o),disabled:w.value,type:"text",class:"form-control",onKeypress:W,onInput:t[8]||(t[8]=o=>Ue("machineSmu"))},null,40,jl),[[I,se.value]]),Yl]),y.value[1].items[l.indexCompartment]&&y.value[1].items[l.indexCompartment].message?(n(),u("p",Rl,_(y.value[1].items[l.indexCompartment].message),1)):T("",!0)]),e("div",Wl,[e("div",Zl,[S(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>$e(x)?x.value=o:null),type:"text",class:"form-control",disabled:""},null,512),[[I,V(x)]]),zl])])]),Jl,e("div",Ql,[e("div",Xl,[e("div",ea,[S(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>V(N)[l.indexCompartment].compartmentLubricant=o),type:"text",class:"form-control",disabled:""},null,512),[[I,V(N)[l.indexCompartment].compartmentLubricant]]),ta])]),e("div",la,[e("div",aa,[S(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>fe.value=o),disabled:w.value,type:"text",class:"form-control",onKeypress:W},null,40,sa),[[I,fe.value]]),oa])]),e("div",na,[e("div",ia,[S(e("input",{"onUpdate:modelValue":t[12]||(t[12]=o=>Te.value=o),disabled:w.value,type:"text",class:"form-control",onKeypress:W},null,40,ra),[[I,Te.value]]),ua])]),e("div",da,[e("div",ca,[S(e("input",{"onUpdate:modelValue":t[13]||(t[13]=o=>G.value=o),disabled:w.value,type:"text",class:"form-control",onKeypress:W},null,40,ma),[[I,G.value]]),va])]),e("div",pa,[e("div",fa,[S(e("select",{"onUpdate:modelValue":t[14]||(t[14]=o=>Ce.value=o),disabled:w.value,class:"form-select",id:"floatingSelect","aria-label":"Floating label select example"},_a,8,ga),[[He,Ce.value]]),ya])]),e("div",xa,[e("div",wa,[S(e("select",{"onUpdate:modelValue":t[15]||(t[15]=o=>ge.value=o),disabled:w.value,class:"form-select",id:"floatingSelect","aria-label":"Floating label select example"},Da,8,Ca),[[He,ge.value]]),Ta])]),e("div",La,[e("div",Oa,[S(e("input",{"onUpdate:modelValue":t[16]||(t[16]=o=>E.value=o),type:"text",class:"form-control",id:"floatingInput",autocomplete:"off",disabled:w.value,onFocus:t[17]||(t[17]=o=>te.value=!0),onBlur:g,onKeydown:[P(B(Fe,["prevent"]),["down"]),P(B(Ie,["prevent"]),["up"]),t[18]||(t[18]=P(B(o=>r(j.value),["prevent"]),["enter"]))]},null,40,Fa),[[I,E.value]]),Ia,te.value&&ye.value.length?(n(),u("ul",Ma,[(n(!0),u(U,null,J(ye.value,(o,C)=>(n(),u("li",{key:C,class:pe(["list-group-item option",{active:C===j.value}]),onMousedown:me=>r(C),onMouseover:me=>Oe(C)},_(o),43,qa))),128))])):T("",!0)])]),e("div",Ea,[e("div",Va,[S(e("input",{"onUpdate:modelValue":t[19]||(t[19]=o=>m.value=o),type:"text",class:"form-control",id:"floatingInput",autocomplete:"off",disabled:w.value,onFocus:M,onBlur:st,onKeydown:[P(B(lt,["prevent"]),["down"]),P(B(at,["prevent"]),["up"]),t[20]||(t[20]=P(B(o=>Ke(k.value),["prevent"]),["enter"]))]},null,40,Ga),[[I,m.value]]),Pa,Me.value&&de.value.length?(n(),u("ul",Ba,[(n(!0),u(U,null,J(de.value,(o,C)=>(n(),u("li",{key:C,class:pe(["list-group-item option",{active:C===k.value}]),onMousedown:me=>Ke(C),onMouseover:me=>tt(C)},_(o),43,Na))),128))])):T("",!0)])]),e("div",Aa,[e("div",Ua,[S(e("input",{"onUpdate:modelValue":t[21]||(t[21]=o=>z.value=o),type:"text",class:"form-control",id:"floatingInput",autocomplete:"off",disabled:w.value,onFocus:t[22]||(t[22]=o=>qe.value=!0),onBlur:rt,onKeydown:[P(B(nt,["prevent"]),["down"]),P(B(it,["prevent"]),["up"]),t[23]||(t[23]=P(B(o=>Ye(ce.value),["prevent"]),["enter"]))]},null,40,Ha),[[I,z.value]]),Ka,qe.value&&Se.value.length?(n(),u("ul",ja,[(n(!0),u(U,null,J(Se.value,(o,C)=>(n(),u("li",{key:C,class:pe(["list-group-item option",{active:C===ce.value}]),onMousedown:me=>Ye(C),onMouseover:me=>ot(C)},_(o),43,Ya))),128))])):T("",!0)])]),e("div",Ra,[e("div",Wa,[S(e("input",{"onUpdate:modelValue":t[24]||(t[24]=o=>K.value=o),type:"text",class:"form-control",id:"floatingInput",autocomplete:"off",disabled:w.value,onInput:Be,onFocus:t[25]||(t[25]=o=>be.value=!0),onBlur:ke,onKeydown:[P(B(Ne,["prevent"]),["down"]),P(B(Ae,["prevent"]),["up"]),t[26]||(t[26]=P(B(o=>Le(L.value),["prevent"]),["enter"]))]},null,40,Za),[[I,K.value]]),za,be.value&&Z.value.length?(n(),u("ul",Ja,[(n(!0),u(U,null,J(Z.value,(o,C)=>(n(),u("li",{key:C,class:pe(["list-group-item option",{active:C===L.value}]),onMousedown:me=>Le(C),onMouseover:me=>_e(C)},_(o),43,Qa))),128))])):T("",!0)])])]),l.detail.label?(n(),le(et,{key:0,type:"warning",message:"This data cannot be edited anymore, because label number has already been generated!",width:"auto",class:"mx-auto",closable:!1})):T("",!0)])}}}),es=De(Xa,[["__scopeId","data-v-fa69dede"]]),ts={class:"row text-center pt-5"},ls=ae({__name:"ErrorDialog",props:{show:{type:Boolean,required:!0},modalType:{type:String,required:!0},message:{type:String,required:!1}},emits:["close"],setup(l,{emit:s}){const p=l,i=s,h=ve(()=>p.show),x=ve(()=>p.message||"Form is not available yet"),N=()=>{i("close")},d=ve(()=>{switch(p.modalType){case"notReady":return x.value;case"taskError":return p.message;default:return""}}),y=ve(()=>{if(p.modalType=="notReady")return!1}),w=ve(()=>p.modalType=="notReady"?"Go To Home":"Ok"),Q=ve(()=>{if(["notMapped","alreadyUpdated","taskError"].includes(p.modalType))return"modal-title"}),q=ve(()=>{if(p.modalType=="notReady")return"text-message"});return(X,ee)=>{const we=Y("el-button"),se=Y("el-dialog");return n(),le(se,{modelValue:V(h),"onUpdate:modelValue":ee[0]||(ee[0]=fe=>$e(h)?h.value=fe:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0,"close-on-click-modal":V(y),"close-on-press-escape":V(y)},{default:A(()=>[e("div",{class:pe(["row text-center pt-3 pb-3 text-dark",V(Q)])},[e("h3",{class:pe(V(q))},_(V(d)),3)],2),e("div",ts,[v(we,{type:"success",class:"ok-button",onClick:N},{default:A(()=>[D(_(V(w)),1)]),_:1})])]),_:1},8,["modelValue","close-on-click-modal","close-on-press-escape"])}}}),as={class:"row text-center pb-5 pt-5 text-dark processing-time-container"},ss={class:"icon mb-4"},os=e("h3",{class:"mb-2"},"Successfully downloaded",-1),ns={class:"d-flex flex-column label-list mx-auto"},is={class:"col-6"},rs={class:"mb-0"},us={class:"col-3"},ds={class:"mb-0"},cs={class:"col-3 d-flex justify-content-end"},ms={key:0,class:"printed mb-2"},vs=e("p",{class:"mb-0"},"Printed",-1),ps=[vs],fs={key:1,class:"not-printed mb-2"},gs=e("p",{class:"mb-0"},"Not Printed",-1),hs=[gs],bs={class:"d-flex text-center pt-5"},_s=ae({__name:"SuccessPrintDialog",props:{show:{type:Boolean,required:!0},labelData:{type:Object,required:!0}},emits:["close","leftButtonAction"],setup(l,{emit:s}){const p=l,i=s,h=()=>{i("close")},x=Ct(p,"show");return(N,d)=>{const y=Y("inline-svg"),w=Y("el-button"),Q=Y("el-dialog");return n(),le(Q,{modelValue:x.value,"onUpdate:modelValue":d[0]||(d[0]=q=>x.value=q),width:"45%","show-close":!1,"custom-class":"message-box-custom oil-not-in-range__header p-0 success-box",top:"20vh",center:!0,"close-on-click-modal":!1,"close-on-press-escape":!1},{default:A(()=>[e("div",as,[e("div",ss,[v(y,{src:"/media/svg/dma/green-checklist.svg"})]),os]),e("div",ns,[(n(!0),u(U,null,J(l.labelData.details,(q,X)=>(n(),u("div",{key:X,class:"row"},[e("div",is,[e("p",rs,_(l.labelData.equipment)+" - "+_(q.compartmentLubricant),1)]),e("div",us,[e("p",ds,_(q.label||"-"),1)]),e("div",cs,[q.label?(n(),u("div",ms,ps)):(n(),u("div",fs,hs))])]))),128))]),e("div",bs,[v(w,{type:"success",class:"mx-auto success-button",onClick:h},{default:A(()=>[D("Close")]),_:1})])]),_:1},8,["modelValue"])}}}),Pe=l=>(Ee("data-v-68970b8f"),l=l(),Ve(),l),ys={class:"row"},xs={key:0,class:"col-12"},ws={class:"header-preview d-flex flex-column px-5 py-5"},Cs={class:"d-flex flex-row align-items-center"},ks=Pe(()=>e("p",{class:"title me-auto"},"Preview SOS Print Label",-1)),Ss={class:"d-flex flex-row align-items-center justify-content-between mt-12"},$s={class:"d-flex flex-row align-items-center"},Ds={key:1,class:"mb-0 mx-3"},Ts={key:2,class:"mb-0 mx-3"},Ls={key:0,class:"d-flex flex-row align-items-center"},Os=Pe(()=>e("img",{src:Dt,class:"me-2",style:{height:"18px"},alt:"icon"},null,-1)),Fs={key:1,class:"d-flex flex-row align-items-center"},Is=Pe(()=>e("img",{src:Tt,class:"me-2",style:{height:"18px"},alt:"icon"},null,-1)),Ms=Pe(()=>e("img",{src:Lt,class:"me-2",style:{height:"18px"},alt:"icon"},null,-1)),qs={class:"body-preview p-8 mt-5 d-flex flex-column"},Es=["id"],Vs=ae({__name:"Preview",setup(l){const{instance:s}=ft(),p=f(),i=Je(),h=c(()=>i.SosLabel),x=f([]),N=c(()=>Math.ceil(x.value.length/3)),d=f(1),y=f(1),w=c(()=>Math.ceil(x.value.length)),{redirectByName:Q}=pt(),q=f(!1),X=()=>{Q("sosprintlabel")},ee=()=>{const r=document.querySelectorAll(".new-page"),g=new IntersectionObserver(m=>{m.forEach(O=>{O.isIntersecting&&(d.value=Array.from(r).indexOf(O.target)+1)})},{threshold:.5});r.forEach(m=>{g.observe(m)})},we=c(()=>i.SosLabel.details.some(r=>r.label===""||r.label===null||r.label===void 0)),se=c(()=>i.SosLabel.details.every(r=>r.label===""||r.label===null||r.label===void 0)),fe=c(()=>{const r=i.SosLabel.details.some(m=>m.label!==""&&m.label!==null&&m.label!==void 0),g=i.SosLabel.details.some(m=>m.label===""||m.label===null||m.label===void 0);return r&&g}),Te=c(()=>i.IsSaveDisabled),G=c(()=>i.SelectedSosHistory),Ce=c(()=>i.SelectedSosCompartment),ge=f(!1),H=c({get:()=>i.AlertVisibility,set:r=>{i.stateAlertVisibility=r}}),R=c({get:()=>i.AlertType,set:r=>{i.stateAlertType=r}}),oe=c({get:()=>i.AlertMessage,set:r=>{i.stateAlertMessage=r}}),ne=ut(),W=mt(),he=c(()=>{const r=ne.user.Name,g=ct(W.stateTimeZone);return`Printed  by ${r} ${g} (${W.stateTimeZoneDesc})`}),K=ht(),Z=()=>{K.go(-1)},L=f(!1),be=()=>{L.value=!0,i.stateSosLabelBefore=Re.cloneDeep(i.stateSosLabel),We(()=>{Be()})},Be=()=>{const r=document.querySelectorAll(".paper-edit"),g=new IntersectionObserver(m=>{m.forEach(O=>{O.isIntersecting&&(y.value=Array.from(r).indexOf(O.target)+1)})},{threshold:.5});r.forEach(m=>{g.observe(m)})},_e=f(!1),Ne=()=>{_e.value=!1},Ae=()=>{let r=Re.cloneDeep(i.stateSosLabelBefore);i.stateSosLabel=r,i.resetPayload(),L.value=!1,_e.value=!1,H.value=!1},Le=()=>{_e.value=!0},ke=r=>{document.getElementById(`label-${r}`).scrollIntoView({behavior:"smooth"})},E=()=>{let r=!0;return i.SosLabel.details.forEach((g,m)=>{g.sampleDate?i.updateErrorWarning(0,m,""):(i.updateErrorWarning(0,m,"This field is required"),ke(m),r=!1),g.lastMeterHrs?i.updateErrorWarning(1,m,""):(i.updateErrorWarning(1,m,"This field is required"),ke(m),r=!1),g.fuelBurn?i.updateErrorWarning(2,m,""):(i.updateErrorWarning(2,m,"This field is required"),ke(m),r=!1)}),r},ie=f(),ye=async()=>{if(!E())return;p.value=xe.service({lock:!0,text:"Saving",background:"rgba(0, 0, 0, 0.7)"}),i.stateEmployeeData={id:ne.user.EmployeeId,name:ne.user.Name};const r=await i.saveLabelDataChanged();r&&r.data.statusCode==200?(L.value=!1,R.value="success",oe.value="All changes has been saved",H.value=!0,await j()):r&&r.data.statusCode!=200&&(R.value="error",oe.value=r.data.result.message,H.value=!0),p.value.close()},j=async()=>{p.value=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});const r={workOrder:G.value.workOrder,eformType:G.value.eformType,oilSampleKey:Ce.value.map(g=>g.value)};await i.getLabelData(r),p.value.close()},te=f(0),Oe=f(0),Fe=async()=>{p.value=xe.service({lock:!0,text:"Generating",background:"rgba(0, 0, 0, 0.7)"}),i.stateEmployeeData={id:ne.user.EmployeeId,name:ne.user.Name};const r={workOrder:G.value.workOrder,taskKey:Ce.value.map(m=>m.value),employee:i.stateEmployeeData},g=await i.generateLabel(r);g&&g.data.statusCode==200?(L.value=!1,R.value="success",oe.value="All label number has been succesfully generated",H.value=!0,await j()):g&&g.data.statusCode!=200&&(R.value="error",oe.value=g.data.result.message,H.value=!0),te.value+=1,Oe.value+=1,p.value.close()},Ie=f(),re=f(!0),ue=async()=>{re.value=!1,gt(Ie.value,{forcePageBreak:".page-break",paperSize:"A4",scale:.9,margin:{top:"1cm",left:"1cm",right:"1cm",bottom:"1cm"},fileName:`${G.value.equipment} - ${G.value.modelId} - ${G.value.psTypeId==null?"":G.value.psTypeId+" Hr Service - "}${G.value.workOrder} - ${G.value.eformType}.pdf`,keepTogether:".prevent-split"},()=>{re.value=!0,ge.value=!0})};return kt(async()=>{await vt(s)}),Qe(async()=>{h.value==null||h.value==null||Object.keys(h.value).length==0?q.value=!0:(p.value=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),W.getServerTimestamp(),x.value=h.value.details,await Promise.allSettled([i.getOilTypeList(),i.getCoolantList()]),p.value.close()),We(()=>{ee()})}),St(()=>{p.value&&p.value.close()}),(r,g)=>{const m=Y("inline-svg"),O=Y("el-button"),de=Y("pdfexport");return n(),u(U,null,[e("div",ys,[h.value!=null&&h.value!=null&&Object.keys(h.value).length!=0?(n(),u("div",xs,[e("div",ws,[e("div",Cs,[ks,v(bt)]),e("div",Ss,[e("div",$s,[L.value?T("",!0):(n(),u("button",{key:0,class:"btn-outline-secondary btn-sm",type:"button",onClick:Z},[v(m,{src:"/media/icons/bootstrap-icon/arrow-left-short.svg",fill:"black",width:"20",height:"20",class:"m-auto"})])),L.value?(n(),u("p",Ds," Page "+_(y.value)+" of "+_(w.value),1)):(n(),u("p",Ts," Page "+_(d.value)+" of "+_(N.value),1))]),L.value?(n(),u("div",Ls,[v(O,{type:"button",class:"edit-button",onClick:Le},{default:A(()=>[D(" Discard Changes ")]),_:1}),v(O,{type:"success",class:"button",disabled:Te.value,onClick:ye},{default:A(()=>[Os,D(" Save ")]),_:1},8,["disabled"])])):(n(),u("div",Fs,[v(O,{type:"button",class:"edit-button",disabled:!we.value,onClick:be},{default:A(()=>[Is,D(" Edit ")]),_:1},8,["disabled"]),se.value?(n(),le(O,{key:0,type:"success",class:"secondary-button",onClick:Fe},{default:A(()=>[D(" Generate Label Number ")]),_:1})):T("",!0),fe.value?(n(),le(O,{key:1,type:"success",class:"secondary-button",onClick:Fe},{default:A(()=>[D(" Regenerate Label Number ")]),_:1})):T("",!0),v(O,{type:"success",class:"button",disabled:se.value,onClick:ue},{default:A(()=>[Ms,D(" Print PDF ")]),_:1},8,["disabled"])]))])]),e("div",qs,[H.value?(n(),le(et,{key:0,type:R.value,message:oe.value,class:"mx-auto",onClose:g[0]||(g[0]=M=>H.value=!1)},null,8,["type","message"])):T("",!0),L.value?(n(),u("div",{key:1,ref_key:"editForm",ref:ie},[(n(!0),u(U,null,J(x.value,(M,k)=>(n(),u("div",{key:k,id:`label-${k}`,class:"paper-edit editing-data py-2 mx-auto mb-6"},[v(es,{"label-data":h.value,detail:M,"index-compartment":k,"print-data":he.value},null,8,["label-data","detail","index-compartment","print-data"])],8,Es))),128))],512)):(n(),u("div",{key:te.value,class:"py-2 mx-auto"},[(n(!0),u(U,null,J(x.value,(M,k)=>(n(),le(Ze,{key:k,"label-data":h.value,detail:M,"print-data":he.value,"index-compartment":k,"qr-code":M.label?M.label:"",class:pe(["paper",k%3==0?"mt-3 new-page":""])},null,8,["label-data","detail","print-data","index-compartment","qr-code","class"]))),128))]))]),(n(),u("div",{key:Oe.value,class:"hiddenContainer"},[v(de,{ref_key:"contentToExport",ref:Ie},{default:A(()=>[(n(!0),u(U,null,J(x.value,(M,k)=>(n(),u(U,{key:k},[M.label?(n(),le(Ze,{key:0,"label-data":h.value,detail:M,"index-compartment":k,"print-data":he.value,"qr-code":M.label?M.label:""},null,8,["label-data","detail","index-compartment","print-data","qr-code"])):T("",!0)],64))),128))]),_:1},512)]))])):T("",!0)]),v(ls,{show:q.value,"modal-type":"notReady",onClose:X},null,8,["show"]),v(_t,{visibility:_e.value,caption:"Are you sure want to discard changes?",onOnNoConfirm:Ne,onOnYesConfirm:Ae},null,8,["visibility"]),v(_s,{show:ge.value,"label-data":h.value,onClose:g[1]||(g[1]=M=>ge.value=!1)},null,8,["show","label-data"])],64)}}}),Qo=De(Vs,[["__scopeId","data-v-68970b8f"]]);export{Qo as default};

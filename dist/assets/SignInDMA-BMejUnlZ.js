import{k as I,r as f,o as y,p as d,aa as h,aB as i,y as S,u as b,s as c,P as x,B as k,F as C,R as A,Y as M}from"./@vue-BypzYtbH.js";import{u as O}from"./vue-router-iNp9kJ0K.js";import{u as U,S as l,g as B}from"./index-BCnwA6yE.js";import{i as _}from"./internet-connection-B91-AJht.js";import{a as E}from"./@vueuse-MfruhCTE.js";import{d as N}from"./get-user-info-ClQf79xP.js";import{_ as D}from"./ErrorBox.vue_vue_type_style_index_0_lang-Bysg_zE3.js";import{_ as L}from"./nw-img-vue-CR837WER.js";import"./vuex-BbOKrtVp.js";import"./object-path-BACu75q6.js";import"./attr-accept-BWI1aNlo.js";import"./pinia-BjOS2_Ao.js";import"./crypto-js-BZehCumu.js";import"./cron-Ci8nYs3o.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./element-plus-C5R56mia.js";import"./dayjs-C7SXsQPH.js";import"./lodash-Cr9vlq0V.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-xcxZ5rdH.js";import"./mitt-C1xD_ZTF.js";import"./@popperjs-WhmJkuoZ.js";import"./async-validator-DK9uouaC.js";import"./axios-N3crNZ6y.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-DK0FVkv3.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./index-CLJyswLZ.js";const T={class:"row"},V={class:"shadow-lg p-4 pb-10 mb-5 bg-white rounded border border-light rounded text-center"},F={class:"row justify-content-center"},j={class:"w-100 justify-content-center",style:{"margin-right":"5px"}},P={style:{display:"none"}},R=I({__name:"SignInDMA",setup(z){const s=U(),r=O(),{isOnline:p}=E(),g=f(0),m=f(!1),w=async()=>{if(_()){if(!await N()){m.value=!0;return}r.push({name:"ironforms"});return}await u()},u=async()=>{const o=l.getInstance(),t=l.getMSALInstance();let e;if(e=await o.getActiveUser(t),e&&(localStorage.getItem("account-info-cache")||localStorage.getItem("account-info-cache")!=="undefined")){r.push({name:"ironforms"});return}let n=!1;try{if(console.log("step 1 msal login"),await s.signIn(),!s.loggedIn)return;localStorage.setItem("login-tracked","false"),console.log("step 2 redirect to ironforms"),r.push({name:"ironforms"})}catch(a){if(console.log("step error",a),!a){n=!1;return}if(a.errorCode=="user_cancelled")return;if(a.errorCode=="interaction_in_progress"){if(g.value<4){v(),await u(),g.value++;return}return}p.value||(console.log("isOnline:",p.value),B("Unable to sign in. Offline connection detected. Please check your internet connection and try signing in again.","Close"))}finally{console.log("step error final",n),s.setLoading(!1),n||r.push({name:"ironforms"})}},v=()=>{const o=document.cookie.split(";");for(var t=1;t<=o.length;t++){var e=o[t-1],n=e.split("=");document.cookie=n[0]+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}window.localStorage.clear(),window.sessionStorage.clear()};return y(async()=>{if(localStorage.setItem("lang","en"),_()){const o=l.getInstance(),t=l.getMSALInstance();let e;if(e=await o.getActiveUser(t),e&&(localStorage.getItem("account-info-cache")||localStorage.getItem("account-info-cache")!=="undefined")){r.push({name:"ironforms"});return}}}),(o,t)=>{const e=A("NwImg"),n=M("loading");return d(),h(C,null,[i("div",T,[S((d(),h("div",V,[c(e,{class:"w-300px my-7",src:"/media/logos/bumaau/buma-logo.png",style:{height:"auto"},alt:"logo"}),i("div",F,[i("div",j,[i("button",{onClick:x(w,["prevent"]),href:"#",class:"w-100 btn btn-lg text-white btn-big",style:{"font-size":"12px","font-weight":"600"}},[c(e,{src:"/media/logos/bumaau/microsoft.png",alt:"microsoft",width:"24"}),k(" Sign in Microsoft ")])])]),i("div",P,[c(e,{src:"/media/icons/bumaau/danger.png"})])])),[[n,b(s).loading]])]),c(D,{visibility:m.value,caption:"Failed to sign in, you need to sign in when you have internet connection first",onOnClose:t[0]||(t[0]=()=>{m.value=!1})},null,8,["visibility"])],64)}}}),be=L(R,[["__scopeId","data-v-5f9412b5"]]);export{be as default};

import{k as ae,r as b,c as u,R as g,p as o,q as se,x as d,aB as a,C as m,aa as n,u as $,s as l,B as N,b4 as me,a0 as fe,F as Y,A as D,P as Z,$ as ve,bd as pe,bb as be}from"./@vue-BypzYtbH.js";import{u as ye}from"./useMasterStore-CzSO06fn.js";import{d as oe}from"./manipulate-html-string-DqTEGh-F.js";import{_ as ne}from"./Textarea.vue_vue_type_style_index_0_lang-v94SEJmi.js";import{p as De}from"./helpers-wUOLw-dU.js";import{a as ee}from"./element-plus-BeWdvTRa.js";import{_ as he}from"./ToastWithIcon.vue_vue_type_style_index_0_lang-wfM94fOM.js";import{_ as le}from"./nw-img-vue-CR837WER.js";import{_ as _e}from"./MessageBox.vue_vue_type_style_index_0_lang-DfpcTVNJ.js";import{N as ge}from"./number-format-BdMuQVyW.js";const ke={class:"el-dialog__title",style:{"word-break":"break-word !important"}},xe=["innerHTML"],we=["innerHTML"],Ce={class:"mt-1 py-2",style:{"word-break":"break-word !important"}},Se={class:"d-flex flex-column"},Ae={class:"row pt-5 justify-content-end"},He={class:"col-md-2 col-2"},Ne={class:"row px-0 justify-content-end px-1"},Re={class:"col-md-3 col-lg-2 col-3"},Be={class:"row px-0 justify-content-end px-1"},Te=ae({__name:"DefectDecline",props:{visibility:{required:!0,type:Boolean},formTitle:{required:!0,type:String},taskTitle:{required:!0,type:String},isIntervention:{required:!1,type:Boolean,default:!1},isGeneric:{required:!1,type:Boolean,default:!1},isApprovalReason:{required:!1,type:Boolean,default:!1}},emits:["closeForm","submitDecline"],setup(e,{emit:I}){const k=e,i=I,y=b(""),f={buttonLabelSubmit:"Decline",buttonClassSubmit:"danger-btn",buttonTypeSubmit:"danger",buttonLabelCancel:"No",textAreaLabel:"Declined Reason <span class='text-danger'>*</span>",textAreaName:"Decline Reason"},v={buttonLabelSubmit:"Approve",buttonClassSubmit:"approval-btn",buttonTypeSubmit:"success",buttonLabelCancel:"No",textAreaLabel:"Approved Reason",textAreaName:"Approve Reason"},r=u(()=>k.isApprovalReason?v:f),R=u(()=>k.isApprovalReason?!1:y.value==""),x=u(()=>k.visibility),w=()=>{i("submitDecline",y.value)},h=()=>{y.value="",i("closeForm",!1)},B=T=>{y.value=T.value};return(T,V)=>{const C=g("el-button"),_=g("el-dialog");return o(),se(_,{modelValue:x.value,"onUpdate:modelValue":V[0]||(V[0]=F=>x.value=F),"custom-class":"defectform el-defect-crack-form-custom",width:"50%",center:"",onClosed:h,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0},{title:d(()=>[a("span",ke,m(e.formTitle),1),e.isGeneric?(o(),n("span",{key:1,class:"el-dialog__title task-title",style:{"word-break":"break-word !important"},innerHTML:e.taskTitle,ref:"defectDetailRef"},null,8,we)):(o(),n("span",{key:0,class:"el-dialog__title task-title",style:{"word-break":"break-word !important"},innerHTML:$(oe)(e.taskTitle,e.isIntervention),ref:"defectDetailRef"},null,8,xe))]),default:d(()=>[a("div",null,[a("div",Ce,[a("div",Se,[l(ne,{value:y.value,label:r.value.textAreaLabel,name:r.value.textAreaName,max:255,onHandleChange:B},null,8,["value","label","name"])])]),a("div",Ae,[a("div",He,[a("div",Ne,[l(C,{type:"success",class:"ok-button",style:{"background-color":"white",color:"black",border:"1px solid gainsboro"},onClick:h},{default:d(()=>[N(m(r.value.buttonLabelCancel),1)]),_:1})])]),a("div",Re,[a("div",Be,[l(C,{disabled:R.value,type:r.value.buttonTypeSubmit,class:me(r.value.buttonClassSubmit),onClick:w},{default:d(()=>[N(m(r.value.buttonLabelSubmit),1)]),_:1},8,["disabled","type","class"])])])])])]),_:1},8,["modelValue"])}}}),te=le(Te,[["__scopeId","data-v-001fbb9f"]]),vt="/media/svg/dma/ic_check.png",q=e=>(pe("data-v-c8834eff"),e=e(),be(),e),Ve={class:"el-dialog__title"},Fe={key:0,class:"status-badge-dialog-header approved-badge p-1"},Ie={key:1,class:"status-badge-dialog-header declined-badge p-1"},Le=["innerHTML"],Me={class:"mt-1 p-2"},$e={class:"d-flex flex-column"},qe=q(()=>a("h4",{class:"title ps-3"},"Reason",-1)),Oe={key:0,class:"mt-1 p-2"},je={key:1,class:"mt-1 py-2"},Ee={class:"row mb-1"},Pe={class:"col"},Ue={class:"form-floating approved-text-box"},We={class:"form-control",style:{"white-space":"break-spaces"}},Ge=q(()=>a("label",null,"Confirmed",-1)),Ke={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},ze={key:2,class:"mt-1 py-2"},Je={class:"row mb-1"},Qe={class:"col"},Xe={class:"form-floating declined-text-box"},Ye={class:"form-control",style:{"white-space":"break-spaces"}},Ze=q(()=>a("label",null,"Declined",-1)),et={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},tt={key:0,class:"dialog-footer",style:{display:"flex","justify-content":"space-around"}},at=ae({__name:"NAForm",props:{visibility:{required:!0,type:Boolean},naDataHeader:{required:!0,type:Object},naDataDetail:{required:!0,type:Object},isIntervention:{required:!1,type:Boolean,default:!1},plannerApprove:{required:!1,type:Boolean,default:!1},viewOnly:{required:!1,type:Boolean,default:!0}},emits:["close","onRefreshData","onSubmitDecline","onSubmitConfirm"],setup(e,{expose:I,emit:k}){const i=e,y=ye(),f=b(!1),v=b(""),r=b(!1),R=b(!1),x=b(!1),w=b(!1),h=u(()=>{var t;return((t=i.naDataDetail)==null?void 0:t.detail.reason)||""}),B=u(()=>h.value.split(":")[0]),T=u(()=>h.value.split(":")[0].includes("Other")),V=u(()=>{const t=h.value.split(":");return t.length>=2?t.slice(1).join(":"):""}),C=u(()=>{var t,s;return((t=i.naDataHeader)==null?void 0:t.cbmNAStatus)=="Decline"||((s=i.naDataHeader)==null?void 0:s.plannerCbmNAStatus)=="Decline"}),_=k,F=fe(i,"visibility"),O=b(),j=async()=>{v.value="",f.value=!1,_("close")},ie=()=>{De(O.value)},L=t=>{R.value=t},M=t=>{x.value=t},re=async t=>{w.value=!0;const s=ee.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});_("onSubmitDecline",{headerId:i.naDataHeader&&i.naDataHeader.id||"",reason:t,afterSubmit:(S,A)=>{s.close(),L(!1),S?(v.value=A,f.value=!0):E()}})},ce=async(t="")=>{w.value=!1;const s=ee.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});_("onSubmitConfirm",{headerId:i.naDataHeader&&i.naDataHeader.id||"",reason:t||"",afterSubmit:(S,A)=>{s.close(),M(!1),S?(v.value=A,f.value=!0):E()}})},E=()=>{r.value=!0,setTimeout(()=>{r.value=!1,P()},1e3)},de=u(()=>{let t="Not Applicable Information Successfully Confirmed";return w.value&&(t="Not Applicable Information Successfully Declined"),t}),P=()=>{f.value=!1,v.value!=ge.NO_NETWORK_VIEW&&(j(),_("onRefreshData"))};return I({handleErrorMessage:(t,s)=>{t&&(v.value=s,f.value=!0)}}),(t,s)=>{const S=g("el-option"),A=g("el-select"),U=g("el-button"),ue=g("el-dialog");return o(),n(Y,null,[l(ue,{modelValue:F.value,"onUpdate:modelValue":s[3]||(s[3]=c=>F.value=c),width:"90%",center:"",onOpened:ie,onClosed:j,"custom-class":"el-defect-crack-form-custom","destroy-on-close":!0},{title:d(()=>{var c,p;return[a("span",Ve,[N("Not Applicable "),((c=e.naDataHeader)==null?void 0:c.cbmNAStatus)=="Confirmed"?(o(),n("span",Fe,"Confirmed")):C.value?(o(),n("span",Ie,"Declined")):D("",!0)]),e.naDataHeader?(o(),n("span",{key:0,class:"el-dialog__title task-title",innerHTML:$(oe)((p=e.naDataHeader)==null?void 0:p.taskDesc,e.isIntervention),ref_key:"defectDetailRef",ref:O},null,8,Le)):D("",!0)]}),footer:d(()=>{var c,p;return[!e.viewOnly&&(!e.plannerApprove&&((c=e.naDataHeader)==null?void 0:c.cbmNAStatus)=="Not-Confirm"||e.plannerApprove&&!((p=e.naDataHeader)!=null&&p.plannerCbmNAStatus))?(o(),n("span",tt,[l(U,{onClick:s[1]||(s[1]=Z(()=>L(!0),["prevent"])),style:{width:"50%",border:"1px solid #FF4842",background:"white","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"#FF4842"}},{default:d(()=>[N("Decline")]),_:1}),l(U,{class:"button-OK-confirmation",type:"success",onClick:s[2]||(s[2]=Z(()=>M(!0),["prevent"])),style:{width:"50%",background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},{default:d(()=>[N("Confirm")]),_:1})])):D("",!0)]}),default:d(()=>{var c,p,W,G,K,z,J,Q,X;return[a("div",Me,[a("div",$e,[qe,l(A,{modelValue:B.value,"onUpdate:modelValue":s[0]||(s[0]=H=>B.value=H),disabled:!0,class:"w-100"},{default:d(()=>[(o(!0),n(Y,null,ve($(y).NAConditions,H=>(o(),se(S,{key:H.id,label:H.naCondition,value:H.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),T.value?(o(),n("div",Oe,[l(ne,{value:V.value,label:"Why not applicable item task?",name:"Reason",disabled:!0},null,8,["value"])])):D("",!0),((c=e.naDataHeader)==null?void 0:c.cbmNAStatus)=="Confirmed"?(o(),n("div",je,[a("div",Ee,[a("div",Pe,[a("div",Ue,[a("div",We,m((p=e.naDataHeader)!=null&&p.approveReason&&e.naDataHeader.approveReason||"This information has been approved"),1),Ge]),e.naDataHeader.approvedBy&&e.naDataHeader.approvedDate?(o(),n("div",Ke,m(e.naDataHeader.approvedBy.name)+", "+m(e.naDataHeader.approvedDate),1)):D("",!0)])])])):C.value?(o(),n("div",ze,[a("div",Je,[a("div",Qe,[a("div",Xe,[a("div",Ye,m((W=e.naDataHeader)==null?void 0:W.declineReason),1),Ze]),(G=e.naDataHeader)!=null&&G.declineBy&&((K=e.naDataHeader)!=null&&K.declineDate)?(o(),n("div",et,m((z=e.naDataHeader)==null?void 0:z.declineBy.name)+", "+m((J=e.naDataHeader)==null?void 0:J.declineDate),1)):D("",!0)])])])):D("",!0),l(te,{visibility:R.value,formTitle:"Are you sure want to decline this defect information?","task-title":((Q=e.naDataHeader)==null?void 0:Q.taskDesc)||"","is-intervention":e.isIntervention,onCloseForm:L,onSubmitDecline:re},null,8,["visibility","task-title","is-intervention"]),l(te,{visibility:x.value,"is-approval-reason":!0,formTitle:"Are you sure want to approve this defect information?","task-title":((X=e.naDataHeader)==null?void 0:X.taskDesc)||"","is-intervention":e.isIntervention,onCloseForm:M,onSubmitDecline:ce},null,8,["visibility","task-title","is-intervention"]),l(he,{show:r.value,message:de.value},null,8,["show","message"])]}),_:1},8,["modelValue"]),l(_e,{show:f.value,onClose:P,message:v.value,icon:"/media/svg/dma/alert.svg"},null,8,["show","message"])],64)}}}),pt=le(at,[["__scopeId","data-v-c8834eff"]]);export{te as D,pt as N,vt as _};

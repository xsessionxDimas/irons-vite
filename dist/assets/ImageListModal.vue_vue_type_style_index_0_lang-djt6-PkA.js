import{a as se}from"./manipulate-html-string-DqTEGh-F.js";import{e as t}from"./lodash-DrHMlsdo.js";import{k as G,a0 as J,c as i,p as c,aa as g,u as le,aB as P,b4 as H,C as ae,A as I,b6 as z,r as m,o as ne,s as q,F as T,d as ie,R as ee,Y as re,x as de,y as ue,$ as ce,q as te}from"./@vue-BypzYtbH.js";import{_ as fe}from"./nw-img-vue-CR837WER.js";import{_ as ve}from"./PDFViewerDialog.vue_vue_type_style_index_0_lang-GWz8s3FD.js";import{_ as ye}from"./InformationPopUp.vue_vue_type_style_index_0_lang-O2xYF9Pq.js";import{c as oe}from"./index-BuVmIl8K.js";import{_ as be}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{_ as me}from"./FullScreenDialog.vue_vue_type_style_index_0_lang-DXRDt27h.js";const ge={key:0,class:"px-0 py-0 mx-0 my-0 d-flex justify-content-start align-items-center"},pe={class:"legend-label mx-3 my-0"},he=G({__name:"statusInfo",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const l=r,e=J(l,"item");i(()=>se(l.item.value));const k=i(()=>l.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),f=i(()=>{let a="";switch(l.item.value){case"Out Spec":a="red";break;case"Out of spec":a="red";break;case"In spec":a="green";break}return a}),R=i(()=>{let a="";return l.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(a=`col-md-${e.value.style.potraitBreakPoint}`,a=`${a} col-lg-${e.value.style.breakPoint}`):(a=`col-md-${e.value.style.potraitBreakPoint}`,a=`${a} col-lg-${e.value.style.breakPoint}`)),a}),C=i(()=>t.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),j=i(()=>{var E,w,B;const a=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",p=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",S=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",_=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let d=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((E=l.task)==null?void 0:E.isShowAdjustmentRow)&&((w=l.task)!=null&&w.isShowAdjustmentRow))d="";else{let n=0;(B=l.task)==null||B.items.forEach(s=>{var v;t.isUndefined(s.style)||(t.isUndefined(s.style.border)?t.isUndefined(s.style.border)&&(n=n+Number(s.style.breakPoint)):((s.style.border.right=="none"||t.isUndefined(s.style.border.right))&&(n=n+Number(s.style.breakPoint)),t.isEqual(s,t.last((v=l.task)==null?void 0:v.items))&&(n=n+Number(s.style.breakPoint))))}),n==12&&(d=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const x=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",A=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",o=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",u=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",h=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let D="";return d&&(D="padding-bottom: 25px; "),`${D}${a}${p}${S}${_}${d}${x}${A}${o}${u}${h}`});i(()=>`${!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.fontWeight)&&e.value.style.fontWeight!="normal"?`font-weight: ${e.value.style.fontWeight}; `:""}`);const M=i(()=>{let a="pb-2";return!t.isUndefined(l.task.updatedBy.name)&&l.task.updatedBy.name&&(a=""),a});return(a,p)=>(c(),g("div",{class:H([[k.value,C.value,R.value,M.value],"px-2 pt-2"]),style:z(j.value)},[!le(t.isUndefined)(r.item.style)&&r.item.style.visibility!="hidden"?(c(),g("div",ge,[P("div",{class:H(["little-box d-flex p-3 justify-content-center align-items-center",[f.value]])},null,2),P("p",pe,ae(r.item.value),1)])):I("",!0)],6))}}),Oe=fe(he,[["__scopeId","data-v-22490999"]]),Ue=["innerHTML"],We=G({__name:"HTML",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object},isShowAdjustment:{type:Boolean}},setup(r){const l=r,e=J(l,"item"),k=m(null),f=m(""),R=i(()=>l.item.value?se(l.item.value).replaceAll("{BLOB_URL}","https://digitaldevbumaausta001.blob.core.windows.net"):""),C=i(()=>l.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),j=i(()=>t.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),M=i(()=>{var W,F,Y,K,Q,X,Z;const o=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",u=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",h=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",D=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"",E=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.padding)&&e.value.style.padding.right!="none"?`padding-right: ${e.value.style.padding.right}; !important `:"";let w=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";const B=!t.isUndefined((W=l.task)==null?void 0:W.isShowReplacementRow)&&((F=l.task)==null?void 0:F.isShowReplacementRow),n=!t.isUndefined((Y=l.task)==null?void 0:Y.isShowAdjustmentRow)&&((K=l.task)==null?void 0:K.isShowAdjustmentRow),s=!t.isUndefined((Q=l.task)==null?void 0:Q.isShowCleanedRow)&&((X=l.task)==null?void 0:X.isShowCleanedRow);if(B||n||s||l.isShowAdjustment)w="";else{let L=0;(Z=l.task)==null||Z.items.forEach($=>{var V;t.isUndefined($.style)||(t.isUndefined($.style.border)?t.isUndefined($.style.border)&&(L=L+Number($.style.breakPoint)):(($.style.border.right=="none"||t.isUndefined($.style.border.right))&&(L=L+Number($.style.breakPoint)),t.isEqual($,t.last((V=l.task)==null?void 0:V.items))&&(L=L+Number($.style.breakPoint))))}),L==12&&(w=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const y=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",U=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",b=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",O=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",N=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${o}${u}${h}${D}${w}${y}${U}${b}${O}${N}${E}`}),a=i(()=>`${!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.fontWeight)&&e.value.style.fontWeight!="normal"?`font-weight: ${e.value.style.fontWeight}; `:""}`),p=m(!1),S=o=>{p.value=o},_=i(()=>{let o="";return l.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(o=`col-md-${e.value.style.potraitBreakPoint}`,o=`${o} col-lg-${e.value.style.breakPoint}`):(o=`col-md-${e.value.style.potraitBreakPoint}`,o=`${o} col-lg-${e.value.style.breakPoint}`)),o});ne(()=>{try{Array.from(k.value.getElementsByClassName("show-pdf")).forEach(u=>{u.onclick=h=>{h.preventDefault(),d.value=!0,f.value=u.href}})}catch(o){console.log(o)}try{Array.from(k.value.getElementsByClassName("spv-print-pdf")).forEach(u=>{u.onclick=h=>{h.preventDefault(),d.value=!0,f.value=u.href,S(!0)}})}catch(o){console.log(o)}});const d=m(!1),x=()=>{d.value=!1},A=i(()=>{let o="pb-2";return!t.isUndefined(l.task.updatedBy.name)&&l.task.updatedBy.name&&(o=""),o});return(o,u)=>(c(),g(T,null,[P("div",{class:H([[C.value,j.value,_.value,A.value],"px-2 pt-2"]),style:z(M.value)},[!le(t.isUndefined)(r.item.style)&&r.item.style.visibility!="hidden"?(c(),g("span",{key:0,ref_key:"html",ref:k,innerHTML:R.value,style:z(a.value)},null,12,Ue)):I("",!0)],6),q(ve,{show:d.value,onHandleCloseModal:x,"blob-url":f.value},null,8,["show","blob-url"]),q(ye,{show:p.value,onClose:S,"title-pop-up":"if required, see your supervisor to print this"},null,8,["show"])],64))}}),$e={key:0,class:"text-center"},ke={style:{height:"100px"}},Re={key:0},_e={class:"row my-4"},we={class:"bg-secondary"},Be=["src","onClick"],Pe={key:0,class:"row mt-7 mb-0"},Ce=P("h5",{style:{"font-size":"15px","font-weight":"900"},class:"font-weight-bold text-dark"},"Mandatory to keep at least one photo as an evidence.",-1),Se=[Ce],Fe=G({__name:"ImageListModal",props:{visibility:{type:Boolean,default:!1},images:{type:Array},showDeleteButton:{type:Boolean,default:!0},showRemainingPhotosMessage:{default:!1,type:Boolean}},emits:["handle-close","handle-delete"],setup(r,{emit:l}){const e=r,k=l,f=m(!1),R=m(!1),C=m(""),j=n=>{const s=o.value.findIndex(y=>y.imgBlob==n),v=o.value[s];if(s>0){const y=o.value.slice(s),U=o.value.slice(0,s);o.value=[...y,...U]}C.value=v.url,R.value=!0},M=()=>{C.value="",R.value=!1},a=J(e,"visibility"),p=i(()=>t.cloneDeep(e.images)),S=m([]),_=m(!1),d=m(""),x=m(!1),A=async()=>{var n;if(u(),f.value=!0,S.value=[],((n=p.value)==null?void 0:n.length)>0){let s=0;o.value.forEach(async v=>{var U;const y={fileUrl:`${v.imgBlob}`,ver:"v1"};try{const b=`https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/attachment/download_by_url?${new URLSearchParams(y).toString()}`,N=(await oe.getBlob(b)).data,W=new Blob([N]),F=window.URL||window.webkitURL;v.url=F.createObjectURL(W),s++,s==((U=p.value)==null?void 0:U.length)&&(f.value=!1)}catch(b){console.log("image",b)}})}},o=m([]),u=()=>{const n=e.images;o.value=n==null?void 0:n.map(s=>({imgBlob:s.filename,url:""}))},h=n=>{!e.images||e.images.length==0||(d.value=e.images[n],_.value=!0)},D=()=>{_.value=!1},E=()=>{_.value=!1,w()},w=async()=>{var y;const n={ver:"v1",fileUrl:d.value},s={},v=`https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/attachment/delete_by_url?${new URLSearchParams(n).toString()}`;try{f.value=!0,x.value=!0,await oe.post(`${v}`,s),k("handle-delete",d.value)}catch(U){console.log("delete image",U)}finally{f.value=!1,x.value=!1,((y=e.images)==null?void 0:y.length)==0&&B()}};ne(async()=>{A()}),ie(p,async(n,s)=>{(n==null?void 0:n.length)==0&&B(),(n==null?void 0:n.length)!=(s==null?void 0:s.length)&&await A()},{deep:!0});const B=()=>{k("handle-close",!1)};return(n,s)=>{const v=ee("inline-svg"),y=ee("el-dialog"),U=re("loading");return c(),g(T,null,[q(y,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=b=>a.value=b),title:"Detailed picture",width:"80%",onClose:s[1]||(s[1]=b=>B())},{default:de(()=>[f.value?(c(),g("div",$e,[ue(P("div",ke,null,512),[[U,f.value]]),x.value?(c(),g("span",Re,"deleting image...")):I("",!0)])):(c(),g(T,{key:1},[P("div",_e,[(c(!0),g(T,null,ce(o.value,(b,O)=>(c(),g("div",{key:b.imgBlob,class:"col-md-3 fv-row fv-plugins-icon-container p-2 rounded position-relative"},[P("div",we,[P("img",{src:b.url,class:"w-100 rounded",style:{height:"200px","object-fit":"contain"},onClick:N=>j(b.imgBlob)},null,8,Be),r.showDeleteButton?(c(),te(v,{key:0,onClick:N=>h(O),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.svg"},null,8,["onClick"])):I("",!0)])]))),128))]),r.showRemainingPhotosMessage?(c(),g("div",Pe,Se)):I("",!0)],64))]),_:1},8,["modelValue"]),q(be,{visibility:_.value,caption:"Are you sure want to delete this image?",onOnNoConfirm:D,onOnYesConfirm:E},null,8,["visibility"]),R.value?(c(),te(me,{key:0,images:r.images,visibility:R.value,image:C.value,onHandleClose:M},null,8,["images","visibility","image"])):I("",!0)],64)}}});export{Oe as S,Fe as _,We as a};

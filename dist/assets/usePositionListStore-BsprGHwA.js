import{P as r}from"./Pagination-BiobnanQ.js";import{c as i,a as P,f as n}from"./index-BuVmIl8K.js";import{G as h,L as c,a as g,E as p}from"./urls-DI_NR_TT.js";import{d}from"./pinia-BjOS2_Ao.js";import{m as D}from"./mapOption-CeGMwmH0.js";import{q as o}from"./date-format-8-IvfSl3.js";import{u}from"./authentication-handler-Pueb_EI7.js";const y=d({id:"positionList",state:()=>({stateFilterData:{Position:"",PositionDescription:"",StartDate:"",EndDate:"",IsDma:null,ver:"v1",Page:1,PageSize:10,Order:""},stateLastUsedFilterData:{Position:"",PositionDescription:"",StartDate:"",EndDate:"",IsDma:null,ver:"v1",Page:1,PageSize:10,Order:""},statePageName:"position",stateDisplayData:[],statePagination:new r,stateLoading:!1,statePaginationLoading:!1,statePositionOption:[],statePositionDescOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,positionOption:t=>t.statePositionOption,positionDescOption:t=>t.statePositionDescOption},actions:{async getData(t=!0){const a={Position:this.stateFilterData.Position,PositionDescription:this.stateFilterData.PositionDescription,Page:this.stateFilterData.Page.toString(),StartDate:this.stateFilterData.StartDate?o(this.stateFilterData.StartDate):"",EndDate:this.stateFilterData.EndDate?o(this.stateFilterData.EndDate):"",IsDma:this.stateFilterData.IsDma,PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await i.post(`${h}?ver=v1`,a);this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:"v1"};try{const a=await i.post(`${c}?${new URLSearchParams(t).toString()}`,{});this.statePositionOption=D(a.data.result.content.position),this.statePositionDescOption=D(a.data.result.content.positionDescription)}catch(a){a.response.data.statusCode==401&&P().setLoggedIn(!1)}},async getPositionDMA(){const t={Position:"",PositionDescription:""};try{const e=(await i.post(`${g}?ver=v1`,t)).data.result.content.position.map(s=>({value:s,label:s}));await n.position.clear(),await n.position.bulkAdd(e),this.statePositionOption=e}catch(a){u(a)}},async setPositionDMALocal(){this.statePositionOption=await n.position.toArray()},async export(){const t={Gmt:new Date().toTimeString().slice(12,17),Position:this.stateFilterData.Position,PositionDescription:this.stateFilterData.PositionDescription,StartDate:this.stateFilterData.StartDate?o(this.stateFilterData.StartDate):"",EndDate:this.stateFilterData.EndDate?o(this.stateFilterData.EndDate):"",IsDma:this.stateFilterData.IsDma,Order:this.stateFilterData.Order};try{return(await i.postBlob(`${p}?ver=v1`,t)).data}catch(a){console.log(a)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:a}){if(!t&&!a)this.stateFilterData.Order="";else{const e=a=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setPosition(t){this.stateFilterData.Position=t},setPositionDescription(t){this.stateFilterData.PositionDescription=t},setStartDate(t){this.stateFilterData.StartDate=t},setEndDate(t){this.stateFilterData.EndDate=t},setIsDma(t){this.stateFilterData.IsDma=t},async resetFilter(){this.stateFilterData.Position="",this.stateFilterData.PositionDescription="",this.stateFilterData.StartDate=null,this.stateFilterData.EndDate=null,this.stateFilterData.IsDma=null;const t=this.stateLastUsedFilterData.Position!=="",a=this.stateLastUsedFilterData.PositionDescription!=="",e=this.stateLastUsedFilterData.StartDate!==null,s=this.stateLastUsedFilterData.EndDate!==null,l=this.stateLastUsedFilterData.IsDma!==null;(t||a||e||s||l)&&await this.getData()},resetState(){this.stateFilterData={Position:"",PositionDescription:"",StartDate:null,EndDate:null,IsDma:null,Page:1,PageSize:10,Order:""},this.stateDisplayData=[],this.statePagination=new r,this.stateLoading=!1,this.statePaginationLoading=!1}}});export{y as u};

import{e as a}from"./lodash-DrHMlsdo.js";import{A as d}from"./urls-CvqtYZA-.js";import{m as u}from"./number-format-BdMuQVyW.js";class k{constructor(){this.smuDefectHeaders=[],this.defectHeaders=[],this.crackHeaders=[],this.cbmHeaders=[],this.defectNAHeaders=[],this.crackNAHeaders=[],this.defectDetails=[],this.crackDetails=[],this.defectNADetails=[],this.crackNADetails=[],this.defectGenericHeaders=[],this.defectGenericDetails=[],this.smuDefectDetails=[]}setDefectHeaders(r){this.defectHeaders=a.filter(r,s=>s.category==="NORMAL"&&s.taskValue=="2"||s.category==="NORMAL"&&s.taskValue=="3"&&s.cbmRatingType=="SERVICE_CLEANED_AND_REPLACED")}setSMUDefectHeaders(r){this.smuDefectHeaders=a.filter(r,s=>s.defectType=="machineSMU")}setDefectGenericHeaders(r){this.defectGenericHeaders=a.filter(r,s=>s.category==="NORMAL"&&s.defectType=="Generic")}setCrackHeaders(r){const s=["2","3"];this.crackHeaders=a.filter(r,e=>e.category==="CRACK"&&s.includes(e.taskValue))}setCBMHeaders(r){this.cbmHeaders=a.filter(r,s=>["CBM","CBM-NORMAL"].includes(s.category)&&isNaN(Number(s.taskValue))),this.cbmHeaders=a.orderBy(this.cbmHeaders,[s=>{let e=0;if(isNaN(Number(s.taskNo))){let t="",i=!0;for(let c=0;c<s.taskNo.length;c++)i&&isNaN(Number(s.taskNo.charAt(c)))&&(t=s.taskNo.charAt(c),i=!1);return Number(s.taskNo.split(t)[0])}else e=Number(s.taskNo);return e},s=>s.taskNo])}setDefectNAHeaders(r){this.defectNAHeaders=a.filter(r,s=>(s.category==="NORMAL"||s.category==="CBM")&&s.taskValue==="3"&&s.cbmRatingType!="SERVICE_CLEANED_AND_REPLACED")}setCrackNAHeaders(r){this.crackNAHeaders=a.filter(r,s=>s.category==="CRACK"&&s.taskValue==="4")}orderDetailTaskCBM(){this.cbmHeaders=this.cbmHeaders.sort((r,s)=>r.taskNo.localeCompare(s.taskNo,"en",{numeric:!0}))}setHeaders(r){this.setSMUDefectHeaders(r),this.setDefectHeaders(r),this.setDefectGenericHeaders(r),this.setCrackHeaders(r),this.setCBMHeaders(r),this.orderDetailTaskCBM(),this.setDefectNAHeaders(r),this.setCrackNAHeaders(r)}setDefectDetails(r){const s=a.keyBy(this.defectHeaders,e=>e.id);this.defectDetails=a.filter(r,e=>s[e.defectHeaderId]!==void 0),this.defectDetails.forEach(e=>{const t=this.defectHeaders.find(i=>i.id===e.defectHeaderId);t&&(t.priority=e.detail.priority,t.assetNumber=e.detail.assetNumber,t.imageAvailable=e.detail.images!="[]",t.status=="Acknowledge"||t.status=="Submited"?(t.numberStatus=1,t.plannerStatus=="Acknowledge"||t.plannerStatus=="Submited"?t.numberStatus=1:t.plannerStatus=="Decline"&&(t.numberStatus=2)):t.status=="Decline"&&(t.numberStatus=2))}),this.defectHeaders=a.orderBy(this.defectHeaders,[e=>e.numberStatus,e=>e.priority,e=>{var t;return Number((t=e.taskNo)==null?void 0:t.replaceAll(/[a-zA-Z]/g,""))},e=>e.taskDesc])}setDefectGenericDetails(r){const s=a.keyBy(this.defectGenericHeaders,e=>e.defectHeaderId);this.defectGenericDetails=a.filter(r,e=>s[e.defectHeaderId]!==void 0),this.defectGenericDetails.forEach(e=>{const t=this.defectGenericHeaders.find(i=>i.defectHeaderId===e.defectHeaderId);t&&(t.priority=e.detail.priority,t.assetNumber=e.detail.assetNumber,t.imageAvailable=e.detail.images!="[]",t.status=="Acknowledge"||t.status=="Submited"?(t.numberStatus=1,t.plannerStatus=="Acknowledge"||t.plannerStatus=="Submited"?t.numberStatus=1:t.plannerStatus=="Decline"&&(t.numberStatus=2)):t.status=="Decline"&&(t.numberStatus=2))}),this.defectGenericHeaders=a.orderBy(this.defectGenericHeaders,[e=>e.numberStatus,e=>e.priority,e=>e.taskDesc])}setSMUDefectDetails(r){const s=a.keyBy(this.smuDefectHeaders,e=>e.id);this.smuDefectDetails=a.filter(r,e=>s[e.defectHeaderId]!==void 0),this.smuDefectDetails.forEach(e=>{const t=this.defectGenericHeaders.find(i=>i.id===e.defectHeaderId);t&&(t.priority=e.detail.priority,t.assetNumber=e.detail.assetNumber,t.imageAvailable=e.detail.images!="[]",t.status=="Acknowledge"||t.status=="Submited"?(t.numberStatus=1,t.plannerStatus=="Acknowledge"||t.plannerStatus=="Submited"?t.numberStatus=1:t.plannerStatus=="Decline"&&(t.numberStatus=2)):t.status=="Decline"&&(t.numberStatus=2))})}setCrackDetails(r){const s=a.keyBy(this.crackHeaders,e=>e.id);this.crackDetails=a.filter(r,e=>s[e.defectHeaderId]!==void 0),this.crackDetails.forEach(e=>{const t=this.crackHeaders.find(i=>i.id===e.defectHeaderId);t&&(t.priority=e.detail.priority,t.assetNumber=e.detail.assetNumber,t.imageAvailable=e.detail.images!="[]",t.status=="Acknowledge"||t.status=="Submited"?(t.numberStatus=1,t.plannerStatus=="Acknowledge"||t.plannerStatus=="Submited"?t.numberStatus=1:t.plannerStatus=="Decline"&&(t.numberStatus=2)):t.status=="Decline"&&(t.numberStatus=2))}),this.crackHeaders=a.orderBy(this.crackHeaders,[e=>e.numberStatus,e=>e.priority,e=>Number(e.taskNo.replaceAll(/[a-zA-Z]/g,"")),e=>e.taskDesc])}setDefectNADetails(r){const s=a.keyBy(this.defectNAHeaders,e=>e.id);this.defectNADetails=a.filter(r,e=>s[e.defectHeaderId]!==void 0),this.defectNADetails.forEach(e=>{const t=this.defectNAHeaders.find(i=>i.id===e.defectHeaderId);t&&(t.cbmNAStatus=="Confirmed"||t.cbmNAStatus=="Not-Confirm"?(t.numberStatus=1,t.plannerCbmNAStatus=="Confirmed"||!t.plannerCbmNAStatus?t.numberStatus=1:t.plannerCbmNAStatus=="Decline"&&(t.numberStatus=2)):t.cbmNAStatus=="Decline"&&(t.numberStatus=2))}),this.defectNAHeaders=a.orderBy(this.defectNAHeaders,[e=>e.numberStatus,e=>Number(e.taskNo.replaceAll(/[a-zA-Z]/g,"")),e=>e.taskDesc])}setCrackNADetails(r){const s=a.keyBy(this.crackNAHeaders,e=>e.id);this.crackNADetails=a.filter(r,e=>s[e.defectHeaderId]!==void 0),this.crackNADetails.forEach(e=>{const t=this.crackNAHeaders.find(i=>i.id===e.defectHeaderId);t&&(t.cbmNAStatus=="Confirmed"||t.cbmNAStatus=="Not-Confirm"?(t.numberStatus=1,t.plannerCbmNAStatus=="Confirmed"||!t.plannerCbmNAStatus?t.numberStatus=1:t.plannerCbmNAStatus=="Decline"&&(t.numberStatus=2)):t.cbmNAStatus=="Decline"&&(t.numberStatus=2))}),this.crackNAHeaders=a.orderBy(this.crackNAHeaders,[e=>e.numberStatus,e=>Number(e.taskNo.replaceAll(/[a-zA-Z]/g,"")),e=>e.taskDesc])}setDetails(r){this.setDefectDetails(r),this.setDefectGenericDetails(r),this.setSMUDefectDetails(r),this.setCrackDetails(r),this.setDefectNADetails(r),this.setCrackNADetails(r)}updateDefectMOU(r,s){const e=this.defectHeaders.find(t=>t.id===r);e&&(e.defectWorkorder=s)}updateDefectRepairedStatus(r){const s=this.defectHeaders.find(e=>e.id===r);s&&(s.repairedStatus="Repaired")}setDefectAcknowledge(r){const s=this.defectHeaders.find(e=>e.id===r);s&&(s.status="Acknowledge")}updateCrackMOU(r,s){const e=this.crackHeaders.find(t=>t.id===r);e&&(e.defectWorkorder=s)}updateCrackRepairedStatus(r){const s=this.crackHeaders.find(e=>e.id===r);s&&(s.repairedStatus="Repaired")}setCrackAcknowledge(r){const s=this.crackHeaders.find(e=>e.id===r);s&&(s.status="Acknowledge")}setCBMAcknowledge(r){const s=this.cbmHeaders.find(e=>e.id===r);s&&(s.status="Acknowledge")}setDefectNAAcknowledge(r){const s=this.defectNAHeaders.find(e=>e.id===r);s&&(s.status="Acknowledge")}setCrackNAAcknowledge(r){const s=this.crackNAHeaders.find(e=>e.id===r);s&&(s.status="Acknowledge")}get DefectHeaders(){return this.defectHeaders}get SMUDefectHeaders(){return this.smuDefectHeaders}get DefectGenericHeaders(){return this.defectGenericHeaders}get CrackHeaders(){return this.crackHeaders}get CBMHeaders(){return this.cbmHeaders}get DefectNAHeaders(){return this.defectNAHeaders}get CrackNAHeaders(){return this.crackNAHeaders}get DefectDetails(){return this.defectDetails}get SMUDefectDetails(){return this.smuDefectDetails}get DefectGenericDetails(){return this.defectGenericDetails}get CrackDetails(){return this.crackDetails}get DefectNADetails(){return this.defectNADetails}get CrackNADetails(){return this.crackNADetails}}class m extends d{constructor(){super(),this.assetNumber="",this.instruction=this.initStringWithValidationType(),this.crackLength=[]}initCracks(r="",s="",e="",t=""){return{locationId:r,locationDesc:s,previousCrack:e,currentCrack:t,isValid:!0,errorMessage:""}}setAssetNumber(r){this.assetNumber=r}setInstruction(r){this.instruction.value=r}setCurrentCrack(r,s){this.crackLength[r].currentCrack=s}importPreviousCrack(...r){this.crackLength=[],r.forEach(s=>{this.crackLength.push(this.initCracks(s.locationId,s.locationDesc,s.previousCrack,s.currentCrack))})}validateInstruction(){let r=!0;return this.instruction.value===""?(this.instruction.isValid=!1,this.instruction.errorMessage="Required",r=!1):(this.instruction.isValid=!0,this.instruction.errorMessage=""),r}validateCurrentCrack(r){let s=!0;return r.currentCrack===""?(r.isValid=!1,r.errorMessage="Required",s=!1):r.currentCrack=="0"||parseFloat(r.currentCrack)==0?(r.isValid=!1,r.errorMessage="Must be greater than 0",s=!1):u(r.currentCrack)?(r.isValid=!0,r.errorMessage=""):(r.isValid=!1,r.errorMessage="Out of range (max 5 digit and 2 fraction)",s=!1),s}validateCrack(){let r=!0;return this.crackLength.forEach(s=>{r=this.validateCurrentCrack(s)}),r}validateDefectForm(){const r=[];r.push(this.validateDescription()),r.push(this.validateInstruction()),r.push(this.validateCrack()),this.isValid=r.every(s=>s==!0)}get AssetNumber(){return this.assetNumber}get Instruction(){return this.instruction}get CrackLength(){return this.crackLength}}export{m as C,k as D};

import{d as i}from"./pinia-BjOS2_Ao.js";import{c as s,s as r}from"./index-BuVmIl8K.js";import{C as p,I as m,G as c}from"./urls-RITu66bD.js";import{u as a}from"./authentication-handler-Pueb_EI7.js";import{a as I}from"./useComponentInterventionEformStore-CMy33xkJ.js";import{g as u,a as C}from"./date-format-8-IvfSl3.js";const D=i({id:"ComponentIntervention",state:()=>({stateComponentInterventions:[],stateComponentInterventionOptions:[],stateComponentInterventionOptionsLocal:[],stateSelectedComponentIntervention:{},stateInterventionForm:{},stateDaysBeforeEst:0}),getters:{ComponentInterventions:e=>e.stateComponentInterventions,ComponentInterventionOptions:e=>e.stateComponentInterventionOptions,ComponentInterventionOptionsLocal:e=>e.stateComponentInterventionOptionsLocal,SelectedComponentIntervention:e=>e.stateSelectedComponentIntervention,CutOffEstimate:e=>{const t=I(),n=u(t.stateTimeZone);return C(n,"DD/MM/YYYY HH:mm:ss",e.stateDaysBeforeEst,"days")}},actions:{async getComponentInterventions(e){const t={ver:"v1",siteId:e};try{const n=await s.get(p,"",new URLSearchParams(t).toString());if(this.stateComponentInterventions=[],!n.data.result.isError)return;n.data.result.content.forEach(o=>{this.stateComponentInterventions.push({id:o.keyPbi,equipment:o.equipment,equipmentDesc:o.equipmentDesc,sampleStatus:o.sampleStatus,componentDescription:o.componentDescription,sapWorkOrder:o.sapWorkOrder,estimationCompletionDate:o.estimationCompletionDate})}),this.stateComponentInterventionOptions=this.formatComponentInterventionOptions(this.stateComponentInterventions)}catch(n){a(n),r("IRONS",n),console.log(n)}},async getInterventionForm(e){const t={id:e,ver:"v1"};try{return(await s.get(`${m}?${new URLSearchParams(t).toString()}`)).data.result.content}catch(n){a(n),r("IRONS",n),console.log(n)}},formatComponentInterventionOptions(e){return e.map(t=>{var n,o;return{label:`${t.equipment} - ${t.equipmentDesc} - <span class="${((n=t.sampleStatus)==null?void 0:n.toLowerCase())=="caution"?"yellow":((o=t.sampleStatus)==null?void 0:o.toLowerCase())=="normal"?"green":"red"}">${t.sampleStatus} Intervention</span> - ${t.componentDescription} - ${t.sapWorkOrder}`,value:t.id}})},setSelectedComponentIntervention(e){const t=this.ComponentInterventions.find(n=>n.id===e);t&&(this.stateSelectedComponentIntervention=t)},setSelectedComponentInterventionItem(e){this.stateSelectedComponentIntervention=e},async getParamDaysBeforeEst(){const e={key:"InterventionMaxEstDate"};try{const t=await s.post(c,e);this.stateDaysBeforeEst=Number(t.data.result.content.value)}catch(t){a(t),r("IRONS",t),console.log(t)}}}});export{D as u};

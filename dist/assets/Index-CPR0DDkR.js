import{u as Ht}from"./useMenuStore-CD5Gmvif.js";import{b as lt}from"./vue-router-iNp9kJ0K.js";import{a as Nt}from"./breadcrumb-BYmEOf4C.js";import{c as M,a as B,s as z,J as et,I as dt,z as tt,A as Vt}from"./index-BuVmIl8K.js";import{P as St}from"./Pagination-D-xfdYmn.js";import{F as qt}from"./FilterIconButton-Bj0WTbms.js";import{h as Mt,A as zt,U as jt}from"./excel-generator-DMHRo93s.js";import{D as Kt}from"./DownloadIconButton-CIQp-YG7.js";import{k as K,a0 as ot,r as j,c as U,a7 as Ft,R as A,Y as it,p as g,aa as G,aB as D,C as $,b4 as ft,s as a,x as m,y as X,q as w,F as ut,$ as Yt,u as o,T as _t,A as nt,P as vt,B as V,bd as Jt,bb as Xt,L as Qt}from"./@vue-BypzYtbH.js";import{_ as C,b as wt}from"./element-plus-BeWdvTRa.js";import{q as x,w as k,x as Pt}from"./date-format-8-IvfSl3.js";import{P as at}from"./Pagination-BiobnanQ.js";import{G as Wt,L as Zt,E as te,a as ee,I as ae,U as re,B as se,b as oe}from"./urls-cnAouliv.js";import{d as ct}from"./pinia-BjOS2_Ao.js";import{m as Y}from"./mapOption-CeGMwmH0.js";import{e as mt}from"./lodash-DrHMlsdo.js";import{b as Q,d as ie,a as ne}from"./table-sort-Bpdq_Uwn.js";import{c as Et,a as J,b as rt,d as It}from"./yup-C6P98bvY.js";import"./property-expr-DEi1ZLzV.js";import{E as Ct}from"./ErrorAlert-CMKGfwAi.js";import{_ as st}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CCwjwK39.js";import{_ as q}from"./ElementTextInput.vue_vue_type_style_index_0_lang-kzHysIyZ.js";import{a as le}from"./vee-validate-C_msoaAA.js";import{_ as pe}from"./FileDropZone.vue_vue_type_style_index_0_lang-C5PyimC7.js";import{m as de}from"./map-anything-abi6NY2Z.js";import{_ as ue}from"./nw-img-vue-CR837WER.js";import{_ as W}from"./AutoComplete.vue_vue_type_style_index_0_lang-DrAAOf71.js";import{_ as Tt}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CJ7rJST9.js";import{F as ce}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./PageEnum-DUtfSNQS.js";import"./xlsx-C4maHrMm.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-NSxIV7Fb.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";const pt={type:"",typeTo:"",typeDescription:"",typeDescriptionTo:"",parameter:"",parameterTo:"",parameterDescription:"",parameterDescriptionTo:"",parameterGroup:"",parameterGroupTo:"",startDate:"",startDateTo:"",endDate:"",endDateTo:"",ver:"v1",page:1,pageSize:10,order:""},Dt=ct({id:"typeList",state:()=>({stateFilterData:{...pt},stateLastUsedFilterData:{...pt},statePageName:"type",stateDisplayData:[],statePagination:new at,stateLoading:!1,statePaginationLoading:!1,stateTypeOption:[],stateTypeDescriptionOption:[],stateParameterOption:[],stateParameterDescriptionOption:[],stateParameterGroupOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,typeOption:t=>t.stateTypeOption,typeDescriptionOption:t=>t.stateTypeDescriptionOption,parameterOption:t=>t.stateParameterOption,parameterDescriptionOption:t=>t.stateParameterDescriptionOption,parameterGroupOption:t=>t.stateParameterGroupOption},actions:{async getData(t=!0){const r={type:this.stateFilterData.type,typeTo:this.stateFilterData.typeTo,typeDescription:this.stateFilterData.typeDescription,typeDescriptionTo:this.stateFilterData.typeDescriptionTo,parameter:this.stateFilterData.parameter,parameterTo:this.stateFilterData.parameterTo,parameterDescription:this.stateFilterData.parameterDescription,parameterDescriptionTo:this.stateFilterData.parameterDescriptionTo,parameterGroup:this.stateFilterData.parameterGroup,parameterGroupTo:this.stateFilterData.parameterGroupTo,startDate:this.stateFilterData.startDate?x(k(new Date(this.stateFilterData.startDate))):"",startDateTo:this.stateFilterData.startDateTo?x(k(new Date(this.stateFilterData.startDateTo))):"",endDate:this.stateFilterData.endDate?x(k(new Date(this.stateFilterData.endDate))):"",endDateTo:this.stateFilterData.endDateTo?x(k(new Date(this.stateFilterData.endDateTo))):"",page:this.stateFilterData.page.toString(),pageSize:this.stateFilterData.pageSize.toString(),order:this.stateFilterData.order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await M.get(Wt,"",new URLSearchParams(r).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){e.response.data.statusCode==401&&B().setLoggedIn(!1),z("IRONS",e),console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const r=await M.get(Zt,"",new URLSearchParams(t).toString());this.stateTypeOption=Y(r.data.result.content.type),this.stateTypeDescriptionOption=Y(r.data.result.content.typeDescription),this.stateParameterOption=Y(r.data.result.content.parameter),this.stateParameterDescriptionOption=Y(r.data.result.content.parameterDescription),this.stateParameterGroupOption=Y(r.data.result.content.parameterGroup)}catch(r){r.response.data.statusCode==401&&B().setLoggedIn(!1),z("IRONS",r),console.log(r)}},async export(){const t={type:this.stateFilterData.type,typeTo:this.stateFilterData.typeTo,typeDescription:this.stateFilterData.typeDescription,typeDescriptionTo:this.stateFilterData.typeDescriptionTo,parameter:this.stateFilterData.parameter,parameterTo:this.stateFilterData.parameterTo,parameterDescription:this.stateFilterData.parameterDescription,parameterDescriptionTo:this.stateFilterData.parameterDescriptionTo,parameterGroup:this.stateFilterData.parameterGroup,parameterGroupTo:this.stateFilterData.parameterGroupTo,startDate:this.stateFilterData.startDate?x(k(new Date(this.stateFilterData.startDate))):"",startDateTo:this.stateFilterData.startDateTo?x(k(new Date(this.stateFilterData.startDateTo))):"",endDate:this.stateFilterData.endDate?x(k(new Date(this.stateFilterData.endDate))):"",endDateTo:this.stateFilterData.endDateTo?x(k(new Date(this.stateFilterData.endDateTo))):"",order:this.stateFilterData.order,ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await M.getBlob(te,"",new URLSearchParams(t).toString())).data}catch(r){z("IRONS",r),console.log(r)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:r}){if(!t&&!r)this.stateFilterData.order="";else{const e=r=="ascending"?"asc":"desc";this.stateFilterData.order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.page=this.statePagination.currentPage,await this.getData(!1)},setType(t){this.stateFilterData.type=t},setTypeTo(t){this.stateFilterData.typeTo=t},setTypeDescription(t){this.stateFilterData.typeDescription=t},setTypeDescriptionTo(t){this.stateFilterData.typeDescriptionTo=t},setParameter(t){this.stateFilterData.parameter=t},setParameterTo(t){this.stateFilterData.parameterTo=t},setParameterDescription(t){this.stateFilterData.parameterDescription=t},setParameterDescriptionTo(t){this.stateFilterData.parameterDescriptionTo=t},setParameterGroup(t){this.stateFilterData.parameterGroup=t},setParameterGroupTo(t){this.stateFilterData.parameterGroupTo=t},setStartDate(t){this.stateFilterData.startDate=t},setStartDateTo(t){this.stateFilterData.startDateTo=t},setEndDate(t){this.stateFilterData.endDate=t},setEndDateTo(t){this.stateFilterData.endDateTo=t},async resetFilter(){this.stateFilterData.type="",this.stateFilterData.typeTo="",this.stateFilterData.typeDescription="",this.stateFilterData.typeDescriptionTo="",this.stateFilterData.parameter="",this.stateFilterData.parameterTo="",this.stateFilterData.parameterDescription="",this.stateFilterData.parameterDescriptionTo="",this.stateFilterData.parameterGroup="",this.stateFilterData.parameterGroupTo="",this.stateFilterData.startDate="",this.stateFilterData.startDateTo="",this.stateFilterData.endDate="",this.stateFilterData.endDateTo="";const t=this.stateLastUsedFilterData.type!=="",r=this.stateLastUsedFilterData.typeTo!=="",e=this.stateLastUsedFilterData.typeDescription!=="",f=this.stateLastUsedFilterData.typeDescriptionTo!=="",n=this.stateLastUsedFilterData.parameter!=="",s=this.stateLastUsedFilterData.parameterTo!=="",l=this.stateLastUsedFilterData.parameterDescription!=="",u=this.stateLastUsedFilterData.parameterDescriptionTo!=="",S=this.stateLastUsedFilterData.parameterGroup!=="",y=this.stateLastUsedFilterData.parameterGroupTo!=="",h=this.stateLastUsedFilterData.startDate!=="",v=this.stateLastUsedFilterData.startDateTo!=="",i=this.stateLastUsedFilterData.endDate!=="",E=this.stateLastUsedFilterData.endDateTo!=="";(t||r||e||f||n||s||l||u||S||y||h||v||i||E)&&await this.getData()},resetState(){this.stateFilterData={...pt},this.stateDisplayData=[],this.statePagination=new at,this.stateLoading=!1,this.statePaginationLoading=!1}}}),bt={typeId:0,type:"",typeDescription:"",parameter:"",parameterDescription:"",parameterGroup:"",startDate:k(new Date),endDate:k(new Date("12/31/9999")),typeParameterGroupId:""},ht=ct({id:"typeForm",state:()=>({stateFormData:{...bt},stateIsError:!1,stateError:"",stateErrors:[],stateIsEdit:!1,stateLoading:!1,stateParameterGroupOption:[]}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading,isEdit:t=>t.stateIsEdit,parameterGroupOption:t=>t.stateParameterGroupOption},actions:{async getLookup(){const t={ver:"v1"};try{const r=await M.get(ee,"",new URLSearchParams(t).toString());this.stateParameterGroupOption=mt.sortBy(Y(r.data.result.content.parameterGroup),[e=>e.label==="Others",e=>e.label.toLowerCase()])}catch(r){r.response.data.statusCode==401&&B().setLoggedIn(!1),z("IRONS",r),console.log(r)}},async insertData(t){try{this.stateLoading=!0;const r={userAccount:t,ver:"v1"},e={typeId:0,type:this.stateFormData.type,typeDescription:this.stateFormData.typeDescription,parameter:this.stateFormData.parameter,parameterDescription:this.stateFormData.parameterDescription,parameterGroup:this.stateFormData.parameterGroup,startDate:x(k(new Date(this.stateFormData.startDate))),endDate:x(k(new Date(this.stateFormData.endDate)))},f=await M.post(`${ae}?${new URLSearchParams(r).toString()}`,e);f.data.title==="Error"?(this.stateErrors.push(f.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(r){r.response.data.statusCode==401&&B().setLoggedIn(!1),this.stateError=r,this.stateErrors.push(r.response.data.result.message),this.stateIsError=!0,z("IRONS",r)}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const r={userAccount:t,ver:"v1"},e={typeId:this.stateFormData.typeId,type:this.stateFormData.type,typeDescription:this.stateFormData.typeDescription,parameter:this.stateFormData.parameter,parameterDescription:this.stateFormData.parameterDescription,parameterGroup:this.stateFormData.parameterGroup,startDate:x(k(new Date(this.stateFormData.startDate))),endDate:x(k(new Date(this.stateFormData.endDate))),typeParameterGroupId:this.stateFormData.typeParameterGroupId},f=await M.post(`${re}?${new URLSearchParams(r).toString()}`,e);f.data.title==="Error"?(this.stateErrors.push(f.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(r){r.response.data.statusCode==401&&B().setLoggedIn(!1),this.stateError=r,this.stateErrors.push(r.response.data.result.message),this.stateIsError=!0,z("IRONS",r)}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.typeId=t.typeId,this.stateFormData.type=t.type,this.stateFormData.typeDescription=t.typeDescription,this.stateFormData.parameter=t.parameter,this.stateFormData.parameterDescription=t.parameterDescription,this.stateFormData.parameterGroup=t.parameterGroup,this.stateFormData.startDate=t.startDate,this.stateFormData.endDate=t.endDate,this.stateFormData.typeParameterGroupId=t.typeParameterGroupId},setIsEdit(t){this.stateIsEdit=t},resetState(){this.stateFormData={...bt},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),kt=K({__name:"SelectInputSearch",props:{value:{required:!0,type:String},gridClass:{required:!1,type:String,default:""},name:{required:!0,type:String},label:{required:!1,type:String},options:{required:!0,type:Array},placeholder:{required:!1,type:String,default:"Please Select"},isDisabled:{required:!1,type:Boolean,default:!1},labelClass:{required:!1,type:String,default:"text-dark"},isLoading:{required:!1,type:Boolean,default:!1},popperClass:{required:!1,type:String,default:""},allowCreate:{required:!1,type:Boolean,default:!1},defaultFirstOption:{required:!1,type:Boolean,default:!1}},emits:["handleChange"],setup(t,{emit:r}){const e=t,f=r,n=ot(e,"options"),s=j([]),l=U({get:()=>e.value,set:u=>{f("handleChange",u)}});return Ft(()=>{const u=n.value.filter(S=>S.label.toString().toLowerCase());s.value=mt.uniqBy(u,"label")}),(u,S)=>{const y=A("el-option"),h=A("el-select"),v=A("el-form-item"),i=it("loading");return g(),G("div",{class:ft(["fv-row",t.gridClass])},[D("label",{class:ft(`form-label fs-6 fw-bolder ${t.labelClass||"text-dark"}`)},$(t.label),3),a(v,{class:"col"},{default:m(()=>[X((g(),w(h,{modelValue:l.value,"onUpdate:modelValue":S[0]||(S[0]=E=>l.value=E),class:"w-100",placeholder:t.placeholder,clearable:"",filterable:"",disabled:t.isDisabled,"popper-class":t.popperClass,"allow-create":t.allowCreate,"default-first-option":t.defaultFirstOption},{default:m(()=>[(g(!0),G(ut,null,Yt(s.value,E=>(g(),w(y,{key:E,label:E.label,value:E.value,selected:t.value&&t.value.includes(E.value)},null,8,["label","value","selected"]))),128))]),_:1},8,["modelValue","placeholder","disabled","popper-class","allow-create","default-first-option"])),[[i,t.isLoading]])]),_:1})],2)}}}),me={key:0,style:{height:"100px"}},De={key:1},he={key:1},ge={key:1},ye={key:1},fe={key:1},ve={key:0,class:"d-flex align-items-center"},Pe=D("span",{class:"mx-1 w-20"},"to",-1),Te={key:1,class:"row justify-content-center"},be={key:0,class:"d-flex justify-content-end"},Se=["disabled","onClick"],Fe=["onClick"],_e={key:1,class:"d-flex"},we=K({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["fetch-data","duplicateData"],setup(t,{emit:r}){const e=t,f=B(),n=Dt(),s=ht(),l=r,u=U(()=>s.isEdit),S=U(()=>(e.page-1)*10+1),y=j(""),h=b=>{y.value=b.order;const p={prop:b.prop,order:b.order};n.setSort(p)},v=j({typeId:0,type:"",typeDescription:"",parameter:"",parameterDescription:"",parameterGroup:"",startDate:k(new Date),endDate:k(new Date("12/31/9999")),typeParameterGroupId:""}),i=j({typeId:0,type:"",typeDescription:"",parameter:"",parameterDescription:"",parameterGroup:"",startDate:k(new Date),endDate:k(new Date("12/31/9999")),typeParameterGroupId:""}),E=b=>{P(),i.value={...b}},R=()=>{s.setIsEdit(!1),s.resetState(),P(),setTimeout(()=>{i.value=Object.assign({},v.value)},300)},H=Et().shape({type:J().required("Type is mandatory"),typeDescription:J().required("Type Description is mandatory"),parameter:J().required("Parameter is mandatory"),startDate:rt().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:rt().required("End Date is mandatory").min(It("startDate"),"End date must be later than start date").typeError("End date must be later than start date")}),P=()=>{s.setErrors([])},_=U(()=>s.isError),T=U(()=>s.errors),N=async()=>{s.setIsEdit(!0),P(),await H.validate(i.value,{abortEarly:!1}).catch(b=>{s.setErrors(b.errors),window&&window.scrollTo(0,0)}),!_.value&&et("Are you sure you want to submit ?").then(async b=>{b.isConfirmed&&(s.setFormData(i.value),s.updateData(f.user.Name).then(()=>{s.isError||dt("Form has been successfully submitted!","Ok").then(()=>{R(),l("fetch-data",null)})}))})},I=async b=>{s.setFormData(b),l("duplicateData",!0)};return(b,p)=>{const L=A("inline-svg"),c=A("el-tooltip"),O=it("loading");return o(n).loading?X((g(),G("div",me,null,512)),[[O,o(n).loading]]):(g(),G(ut,{key:1},[a(_t,{name:"fade"},{default:m(()=>[_.value&&u.value?(g(),w(Ct,{key:0,errorMessages:T.value,onResetForm:P},null,8,["errorMessages"])):nt("",!0)]),_:1}),X((g(),w(o(wt),{data:e.listData,style:{width:"100%"},onSortChange:h,"empty-text":"No Data"},{default:m(()=>[a(o(C),{label:"No",width:"90",align:"center"},{default:m(d=>[D("span",null,$(S.value+d.$index),1)]),_:1}),a(o(C),{prop:"type",label:"Type","min-width":"170",sortable:"","sort-method":o(Q)(y.value)},{default:m(d=>[d.row.typeId===i.value.typeId&&d.row.typeParameterGroupId===i.value.typeParameterGroupId?(g(),w(q,{key:0,value:i.value.type,placeholder:"Add Type",name:"Type",max:30,onHandleChange:p[0]||(p[0]=F=>i.value.type=F)},null,8,["value"])):(g(),G("span",De,$(d.row.type),1))]),_:1},8,["sort-method"]),a(o(C),{prop:"typeDescription",label:"Type Description","min-width":"170",sortable:"","sort-method":o(Q)(y.value)},{default:m(d=>[d.row.typeId===i.value.typeId&&d.row.typeParameterGroupId===i.value.typeParameterGroupId?(g(),w(q,{key:0,value:i.value.typeDescription,placeholder:"Add Type Description",name:"TypeDescription",max:80,onHandleChange:p[1]||(p[1]=F=>i.value.typeDescription=F)},null,8,["value"])):(g(),G("span",he,$(d.row.typeDescription),1))]),_:1},8,["sort-method"]),a(o(C),{prop:"parameter",label:"Parameter","min-width":"170",sortable:"","sort-method":o(Q)(y.value)},{default:m(d=>[d.row.typeId===i.value.typeId&&d.row.typeParameterGroupId===i.value.typeParameterGroupId?(g(),w(q,{key:0,value:i.value.parameter,placeholder:"Add Parameter",name:"Parameter",max:80,onHandleChange:p[2]||(p[2]=F=>i.value.parameter=F)},null,8,["value"])):(g(),G("span",ge,$(d.row.parameter),1))]),_:1},8,["sort-method"]),a(o(C),{prop:"parameterDescription",label:"Parameter Description","min-width":"200",sortable:"","sort-method":o(Q)(y.value)},{default:m(d=>[d.row.typeId===i.value.typeId&&d.row.typeParameterGroupId===i.value.typeParameterGroupId?(g(),w(q,{key:0,value:i.value.parameterDescription,placeholder:"Add Parameter Description",name:"ParameterDescription",max:20,onHandleChange:p[3]||(p[3]=F=>i.value.parameterDescription=F)},null,8,["value"])):(g(),G("span",ye,$(d.row.parameterDescription),1))]),_:1},8,["sort-method"]),a(o(C),{prop:"parameterGroup",label:"Parameter Group","min-width":"200",sortable:"","sort-method":o(Q)(y.value)},{default:m(d=>[d.row.typeId===i.value.typeId&&d.row.typeParameterGroupId===i.value.typeParameterGroupId?(g(),w(kt,{key:0,value:i.value.parameterGroup,placeholder:"Add Parameter Group",name:"ParameterGroup",allowCreate:!0,defaultFirstOption:!0,options:o(s).parameterGroupOption,onHandleChange:p[4]||(p[4]=F=>i.value.parameterGroup=F)},null,8,["value","options"])):(g(),G("span",fe,$(d.row.parameterGroup),1))]),_:1},8,["sort-method"]),a(o(C),{prop:"isActive",label:"Is Active",width:i.value.typeId!=0?350:100,sortable:"",align:"center"},{default:m(d=>[d.row.typeId===i.value.typeId&&d.row.typeParameterGroupId===i.value.typeParameterGroupId?(g(),G("div",ve,[a(st,{value:i.value.startDate,placeholder:"Add Start Date",name:"StartDate",onHandleChange:p[5]||(p[5]=F=>i.value.startDate=F)},null,8,["value"]),Pe,a(st,{value:i.value.endDate,placeholder:"Add End Date",name:"EndDate",onHandleChange:p[6]||(p[6]=F=>i.value.endDate=F)},null,8,["value"])])):(g(),G("div",Te,[d.row.isActive?(g(),w(L,{key:0,src:"/media/svg/tables/rows/check.svg"})):(g(),w(L,{key:1,src:"/media/svg/tables/rows/minus.svg"}))]))]),_:1},8,["width"]),a(o(C),{label:"",width:"100"},{default:m(d=>[d.row.typeId!==i.value.typeId||d.row.typeParameterGroupId!==i.value.typeParameterGroupId?(g(),G("div",be,[a(c,{class:"box-item",effect:"dark",content:d.row.isActive?"Edit":"Inactive data cannot be edited",placement:"top"},{default:m(()=>[D("div",null,[D("button",{disabled:!d.row.isActive,class:"btn btn-sm btn-icon btn-bg-light me-3",onClick:F=>E(d.row)},[a(L,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,Se)])]),_:2},1032,["content"]),a(c,{class:"box-item",effect:"dark",content:"Add new data based on table rows",placement:"top"},{default:m(()=>[D("div",null,[D("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:F=>I(d.row)},[a(L,{src:"/media/svg/tables/rows/paste-icon-button-blue.svg",width:"12",height:"12"})],8,Fe)])]),_:2},1024)])):(g(),G("div",_e,[a(c,{class:"box-item",effect:"dark",content:"Save",placement:"top"},{default:m(()=>[D("button",{class:"btn btn-sm btn-icon btn-bg-light me-3",onClick:vt(N,["prevent"])},[a(L,{src:"/media/svg/tables/rows/save.svg",width:"12",height:"12"})])]),_:1}),a(c,{class:"box-item",effect:"dark",content:"Cancel",placement:"top"},{default:m(()=>[D("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:vt(R,["prevent"])},[a(L,{src:"/media/svg/tables/rows/valid-false.svg",width:"12",height:"12"})])]),_:1})]))]),_:1})]),_:1},8,["data"])),[[O,o(n).loading]])],64))}}}),Ee={class:"col-md-6 fv-row fv-plugins-icon-container"},Ie={class:"col-md-6 fv-row fv-plugins-icon-container"},Ce={class:"dialog-footer"},ke=K({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:r}){const e=t,f=r,n=ht(),s=B(),l=ot(e,"visibility"),u=U(()=>n.formData),S=U(()=>n.errors),y=U(()=>n.isError),h=U(()=>n.isEdit),v=Et().shape({type:J().required("Type is mandatory"),typeDescription:J().required("Type Description is mandatory"),parameter:J().required("Parameter is mandatory"),startDate:rt().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:rt().required("End Date is mandatory").min(It("startDate"),"End date must be later than start date").typeError("End date must be later than start date")}),i=(p=!1)=>{b(),n.resetState(),f("handle-close",p)},E=p=>{u.value.type=p},R=p=>{u.value.typeDescription=p},H=p=>{u.value.parameter=p},P=p=>{u.value.parameterDescription=p},_=p=>{u.value.parameterGroup=p},T=p=>{u.value.startDate=p},N=p=>{u.value.endDate=p},I=async()=>{b(),await v.validate(u.value,{abortEarly:!1}).catch(p=>{n.setErrors(p.errors)}),!y.value&&et("Are you sure you want to submit ?").then(async p=>{p.isConfirmed&&n.insertData(s.user.Name).then(()=>{n.isError||dt("Form has been successfully submitted!","Ok").then(()=>{i(!0)})})})},b=()=>{n.setErrors([])};return(p,L)=>{const c=A("el-button"),O=A("el-dialog"),d=it("loading");return X((g(),w(O,{modelValue:l.value,"onUpdate:modelValue":L[0]||(L[0]=F=>l.value=F),title:"New Data",width:"40%",onClose:L[1]||(L[1]=F=>i())},{footer:m(()=>[D("span",Ce,[a(c,{type:"primary",onClick:I,disabled:o(n).loading},{default:m(()=>[V("Submit")]),_:1},8,["disabled"]),a(c,{type:"secondary",onClick:i,disabled:o(n).loading},{default:m(()=>[V("Close")]),_:1},8,["disabled"])])]),default:m(()=>[a(_t,{name:"fade"},{default:m(()=>[y.value&&!h.value?(g(),w(Ct,{key:0,errorMessages:S.value,onResetForm:b},null,8,["errorMessages"])):nt("",!0)]),_:1}),X((g(),w(o(le),{id:"kt_filter_form",class:"row g-9 my-4"},{default:m(()=>[a(q,{value:u.value.type,placeholder:"Add Type",label:"Type",name:"Type",max:30,onHandleChange:E},null,8,["value"]),a(q,{value:u.value.typeDescription,placeholder:"Add Type Description",label:"Type Description",name:"TypeDescription",max:80,onHandleChange:R},null,8,["value"]),a(q,{value:u.value.parameter,placeholder:"Add Parameter",label:"Parameter",name:"Parameter",max:80,onHandleChange:H},null,8,["value"]),a(q,{value:u.value.parameterDescription,placeholder:"Add Parameter Description",label:"Parameter Description",name:"ParameterDescription",max:80,onHandleChange:P},null,8,["value"]),a(kt,{value:u.value.parameterGroup,placeholder:"Add Parameter Group",label:"Parameter Group",name:"ParameterGroup",allowCreate:!0,defaultFirstOption:!0,options:o(n).parameterGroupOption,onHandleChange:_},null,8,["value","options"]),D("div",Ee,[a(st,{value:u.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:T},null,8,["value"])]),D("div",Ie,[a(st,{value:u.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:N},null,8,["value"])])]),_:1})),[[d,o(n).loading]])]),_:1},8,["modelValue"])),[[d,o(n).loading]])}}}),gt=ct({id:"typeBulk",state:()=>({statePagination:new at,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const r={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const e=await M.post(`${se}?${new URLSearchParams(r).toString()}`,this.stateBulkData);this.stateError=e.data.result.isError?e.data.result.message:"",this.stateIsError=e.data.result.isError}catch(e){e.response.data.statusCode==401&&B().setLoggedIn(!1),z("IRONS",e),console.log(e)}this.stateLoading=!1},async upload({userAccount:t,excelFile:r}){const e={userAccount:t,ver:"v1"},f=`${oe}?${new URLSearchParams(e).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const n=await M.postImages(f,r);n.data.statusCode==200?n.data.result.isError?(this.stateIsError=!0,this.stateError=n.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=n.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=mt.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=n.data.result.isError,this.stateError=n.data.result.message)}catch(n){n.response.data.statusCode==401&&B().setLoggedIn(!1),console.log(n),this.stateIsError=!0,this.stateError=n.response.data.result.message,z("IRONS",n)}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(ie(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new at,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),Ge={class:"icon"},Le=K({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const r=t,e=gt(),f=U(()=>(r.page-1)*10+1),n=j(""),s=u=>{n.value=u.order;const S={prop:u.prop,order:u.order};e.setSort(S)},l=(u,S,y)=>ne(u[y],S[y],n.value);return(u,S)=>{const y=A("inline-svg");return g(),w(o(wt),{data:r.listData,style:{width:"100%"},onSortChange:s,"empty-text":"No Data"},{default:m(()=>[a(o(C),{label:"No",width:"60",align:"center"},{default:m(h=>[D("span",null,$(f.value+h.$index),1)]),_:1}),a(o(C),{prop:"type",label:"Type",width:"300",sortable:"","sort-method":(h,v)=>l(h,v,"type")},null,8,["sort-method"]),a(o(C),{prop:"typeDescription",label:"Type Description",width:"300",sortable:"","sort-method":(h,v)=>l(h,v,"typeDescription")},null,8,["sort-method"]),a(o(C),{prop:"parameter",label:"Parameter",width:"300",sortable:"","sort-method":(h,v)=>l(h,v,"parameter")},null,8,["sort-method"]),a(o(C),{prop:"parameterDescription",label:"Parameter Description",width:"300",sortable:"","sort-method":(h,v)=>l(h,v,"parameterDescription")},null,8,["sort-method"]),a(o(C),{prop:"parameterGroup",label:"Parameter Group",width:"300",sortable:"","sort-method":(h,v)=>l(h,v,"parameterGroup")},null,8,["sort-method"]),a(o(C),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:m(h=>[D("span",null,$(o(Pt)(h.row.startDate)),1)]),_:1}),a(o(C),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:m(h=>[D("span",null,$(o(Pt)(h.row.endDate)),1)]),_:1}),a(o(C),{prop:"validationReason",label:"Remark","min-width":"300",sortable:"","sort-method":(h,v)=>l(h,v,"validationReason")},null,8,["sort-method"]),a(o(C),{prop:"isValid",label:"Status",width:"100",sortable:""},{default:m(h=>[D("div",Ge,[a(y,{src:h.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),yt=t=>(Jt("data-v-4caedbf5"),t=t(),Xt(),t),Ue=yt(()=>D("div",{class:"text-center"},null,-1)),xe=yt(()=>D("div",{class:"mb-3"},[D("span",null,[V(" Download template "),D("a",{href:"documents/MasterDataCbmParameterName.xlsx",target:"_blank",id:"link-download"},"here"),V(" before uploading file ")])],-1)),Ae=yt(()=>D("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[D("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),Oe={class:"card"},Re={class:"card-body grid-padding"},$e={class:"dialog-footer"},Be=K({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:r}){const e=t,f=r,n=B(),s=gt(),l=ot(e,"visibility"),u=()=>{const P=de(s.validatedData,_=>{const T=_;return{typeId:0,type:T.type,typeDescription:T.typeDescription,parameter:T.parameter,parameterDescription:T.parameterDescription,parameterGroup:T.parameterGroup,startDate:T.startDate,endDate:T.endDate}});return Object.values(P)},S=()=>{const P=document.getElementById("link-download");P&&P.click()},y=()=>{s.validatedData.length>0?et("Cancel Upload Data?","Confirm").then(_=>{_.isConfirmed&&v()}):v()},h=async P=>{await s.upload({userAccount:n.user.Name,excelFile:P}),s.stateError&&tt(s.error)},v=(P=!1)=>{s.resetState(),f("handle-close",P)},i=P=>{s.setIsUploadedState(P)},E=P=>{s.setPage(P)},R=()=>{if(s.validatedData.length<1){S();return}const P=["TYPE","TYPE DESCRIPTION","PARAMETER","PARAMETER DESCRIPTION","PARAMETER GROUP","START DATE","END DATE","REMARK","STATUS"],_=s.validatedData.map(T=>({type:T.type,typeDescription:T.typeDescription,parameter:T.parameter,parameterDescription:T.parameterDescription,parameterGroup:T.parameterGroup,startDate:T.startDate,endDate:T.endDate,remark:T.validationReason,status:T.isValid?"OK":"Error"}));Mt("CBMParameterName",P,_)},H=async()=>{if(s.displayData.length<1){tt("There is no data to submit");return}if(s.isError){tt("There is still invalid row(s)");return}et("Are you sure you want to submit ?").then(async P=>{if(P.isConfirmed){const _=u();if(s.setBulkData(_),await s.bulkInsert(n.user.Name),s.isError){tt(s.stateError);return}dt("Form has been successfully submitted!","Ok").then(()=>{v(!0)})}})};return(P,_)=>{const T=A("el-button"),N=A("el-dialog"),I=it("loading");return g(),w(N,{title:"Upload Bulk Data",modelValue:l.value,"onUpdate:modelValue":_[1]||(_[1]=b=>l.value=b),"before-close":y,width:"70%","custom-class":"upload-modal"},{footer:m(()=>[D("div",null,[D("span",$e,[a(T,{type:"success",onClick:R},{default:m(()=>[V("Download")]),_:1}),a(T,{type:"primary",onClick:H},{default:m(()=>[V("Upload")]),_:1}),a(T,{type:"success",onClick:y},{default:m(()=>[V("Cancel")]),_:1})])])]),default:m(()=>[Ue,xe,X(a(pe,{isSubmissionUploadSuccess:o(s).isUploaded,onHandleCloseUploadedFile:y,onHandleUpload:h,onHandleSetIsExcelFileUploaded:i},null,8,["isSubmissionUploadSuccess"]),[[I,o(s).uploadLoading]]),Ae,D("div",Oe,[D("div",Re,[a(Le,{"list-data":o(s).displayData,page:o(s).pagination.currentPage},null,8,["list-data","page"])])]),o(s).displayData.length>0?(g(),w(St,{key:0,onRaisePageChange:_[0]||(_[0]=b=>E(b)),currentPage:o(s).pagination.currentPage,totalPage:o(s).pagination.totalPage,totalPageSize:o(s).pagination.totalPageSize,startPaginationIndex:o(s).pagination.startPaginationIndex,endPaginationIndex:o(s).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):nt("",!0)]),_:1},8,["modelValue"])}}}),He=ue(Be,[["__scopeId","data-v-4caedbf5"]]),Ne={class:"row g-9 my-4"},Ve={class:"dialog-footer"},qe=K({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:r}){const e=Dt(),f=t,n=r,s=ot(f,"visibility"),l=U(()=>e.filterData),u=()=>{S(),e.resetFilter()},S=()=>{n("handle-close",!1)},y=c=>{e.setType(c)},h=c=>{e.setTypeTo(c)},v=c=>{e.setTypeDescription(c)},i=c=>{e.setTypeDescriptionTo(c)},E=c=>{e.setParameter(c)},R=c=>{e.setParameterTo(c)},H=c=>{e.setParameterDescription(c)},P=c=>{e.setParameterDescriptionTo(c)},_=c=>{e.setParameterGroup(c)},T=c=>{e.setParameterGroupTo(c)},N=c=>{e.setStartDate(c)},I=c=>{e.setStartDateTo(c)},b=c=>{e.setEndDate(c)},p=c=>{e.setEndDateTo(c)},L=()=>{const c=e.lastUsedFilterData.type!==e.filterData.type,O=e.lastUsedFilterData.typeTo!==e.filterData.typeTo,d=e.lastUsedFilterData.typeDescription!==e.filterData.typeDescription,F=e.lastUsedFilterData.typeDescriptionTo!==e.filterData.typeDescriptionTo,Z=e.lastUsedFilterData.parameter!==e.filterData.parameter,Gt=e.lastUsedFilterData.parameterTo!==e.filterData.parameterTo,Lt=e.lastUsedFilterData.parameterDescription!==e.filterData.parameterDescription,Ut=e.lastUsedFilterData.parameterDescriptionTo!==e.filterData.parameterDescriptionTo,xt=e.lastUsedFilterData.parameterGroup!==e.filterData.parameterGroup,At=e.lastUsedFilterData.parameterGroupTo!==e.filterData.parameterGroupTo,Ot=e.lastUsedFilterData.startDate!==e.filterData.startDate,Rt=e.lastUsedFilterData.startDateTo!==e.filterData.startDateTo,$t=e.lastUsedFilterData.endDate!==e.filterData.endDate,Bt=e.lastUsedFilterData.endDateTo!==e.filterData.endDateTo;n("handle-close",c||O||d||F||Z||Gt||Lt||Ut||xt||At||Ot||Rt||$t||Bt)};return(c,O)=>{const d=A("el-button"),F=A("el-dialog");return g(),w(F,{modelValue:s.value,"onUpdate:modelValue":O[0]||(O[0]=Z=>s.value=Z),title:"Filter",width:"60%",onClose:O[1]||(O[1]=Z=>S())},{footer:m(()=>[D("span",Ve,[a(d,{type:"secondary",onClick:u},{default:m(()=>[V("Reset")]),_:1}),a(d,{type:"primary",onClick:L},{default:m(()=>[V("Filter")]),_:1})])]),default:m(()=>[D("div",Ne,[a(W,{"value-from":l.value.type,"value-to":l.value.typeTo,label:"Type",name:"Type",options:o(e).typeOption,onHandleChangeFrom:y,onHandleChangeTo:h},null,8,["value-from","value-to","options"]),a(W,{"value-from":l.value.typeDescription,"value-to":l.value.typeDescriptionTo,label:"Type Description",name:"TypeDescription",options:o(e).typeDescriptionOption,onHandleChangeFrom:v,onHandleChangeTo:i},null,8,["value-from","value-to","options"]),a(W,{"value-from":l.value.parameter,"value-to":l.value.parameterTo,label:"Parameter",name:"Parameter",options:o(e).parameterOption,onHandleChangeFrom:E,onHandleChangeTo:R},null,8,["value-from","value-to","options"]),a(W,{"value-from":l.value.parameterDescription,"value-to":l.value.parameterDescriptionTo,label:"Parameter Description",name:"ParameterDescription",options:o(e).parameterDescriptionOption,onHandleChangeFrom:H,onHandleChangeTo:P},null,8,["value-from","value-to","options"]),a(W,{"value-from":l.value.parameterGroup,"value-to":l.value.parameterGroupTo,label:"Parameter Group",name:"ParameterGroup",options:o(e).parameterGroupOption,onHandleChangeFrom:_,onHandleChangeTo:T},null,8,["value-from","value-to","options"]),a(Tt,{"value-from":l.value.startDate?l.value.startDate.toString():"","value-to":l.value.startDateTo?l.value.startDateTo.toString():"",label:"Start Date",name:"StartDate",placeholder:"Pick a date",onHandleChangeFrom:N,onHandleChangeTo:I},null,8,["value-from","value-to"]),a(Tt,{"value-from":l.value.endDate?l.value.endDate.toString():"","value-to":l.value.endDateTo?l.value.endDateTo.toString():"",label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChangeFrom:b,onHandleChangeTo:p},null,8,["value-from","value-to"])])]),_:1},8,["modelValue"])}}}),Me={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},ze=D("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),je={class:"d-flex justify-content-between align-items-center"},Ke={class:"card"},Ye={class:"card-body grid-padding"},Je={class:"my-5"},lr=K({__name:"Index",setup(t){const r=Ht(),e=Dt(),f=ht(),n=gt(),s=j(!1),l=j(!1),u=j(!1),S=U(()=>e.displayData),y=U(()=>e.pagination),h=I=>{e.setPage(I)};Ft(async()=>{r[Vt.ACTIVE_PAGE](lt().meta.parentMenu),Nt("CBM Parameter Name",[{pageName:lt().meta.parentMenu,pageRoute:lt().meta.parentMenu.toLowerCase()},{pageName:"IronPortal Configuration",pageRoute:"ironlake-config-type"},{pageName:"CBM Parameter Name",pageRoute:"ironlake-config-type"}]),e.setPage(1),await e.getLookup(),await f.getLookup()}),Qt(async()=>{e.resetState(),f.resetState(),n.resetState()});const v=async()=>{await e.setPage(1),await e.getLookup(),await f.getLookup()},i=()=>{s.value=!0,f.setIsEdit(!1),f.setErrors([])},E=async I=>{s.value=!1,I&&await v()},R=()=>{l.value=!0},H=async I=>{l.value=!1,I&&await v()},P=async()=>{const I=await e.export();ce.saveAs(new Blob([I],{type:"application/octet-stream"}),"CBMParameterName.xlsx")},_=()=>{u.value=!0},T=async I=>{u.value=!1,I&&await v()},N=()=>{s.value=!0,f.setErrors([])};return(I,b)=>(g(),G(ut,null,[D("div",Me,[ze,D("div",je,[a(zt,{onShowDialog:i}),a(qt,{onShowDialog:R}),a(Kt,{onHandleDownload:P}),a(jt,{onShowDialog:_})])]),D("div",Ke,[D("div",Ye,[a(we,{"list-data":S.value,page:y.value.currentPage,onFetchData:v,onDuplicateData:N},null,8,["list-data","page"])])]),D("div",Je,[o(e).paginationLoading?nt("",!0):(g(),w(St,{key:0,onRaisePageChange:b[0]||(b[0]=p=>h(p)),currentPage:y.value.currentPage,totalPage:y.value.totalPage,totalPageSize:y.value.totalPageSize,startPaginationIndex:y.value.startPaginationIndex,endPaginationIndex:y.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),a(ke,{visibility:s.value,onHandleClose:E},null,8,["visibility"]),a(qe,{visibility:l.value,onHandleClose:H},null,8,["visibility"]),a(He,{visibility:u.value,onHandleClose:T},null,8,["visibility"])],64))}});export{lr as default};

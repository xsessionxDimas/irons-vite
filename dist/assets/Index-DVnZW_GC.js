import{u as q}from"./useMenuStore-CD5Gmvif.js";import{a as G}from"./breadcrumb-BYmEOf4C.js";import{c as I,A as M}from"./index-BuVmIl8K.js";import{P as j}from"./Pagination-D-xfdYmn.js";import{F as K}from"./FilterIconButton-Bj0WTbms.js";import{D as X}from"./DownloadIconButton-CIQp-YG7.js";import{_ as L,b as Y}from"./element-plus-BeWdvTRa.js";import{q as P,y as J}from"./date-format-8-IvfSl3.js";import{P as U}from"./Pagination-BiobnanQ.js";import{d as Q}from"./pinia-BjOS2_Ao.js";import{a as W,m as Z}from"./mapOption-CeGMwmH0.js";import{k as E,bL as tt,r as A,u as n,y as x,p as S,aa as B,q as w,x as h,Y as et,s as r,aB as d,C,a0 as at,c as O,R as $,B as R,a7 as ot,L as it,A as st,F as nt}from"./@vue-BypzYtbH.js";import{a as rt}from"./table-sort-Bpdq_Uwn.js";import{_ as N}from"./AutoComplete.vue_vue_type_style_index_0_lang-DrAAOf71.js";import{_ as lt}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CJ7rJST9.js";import{F as ct}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./nw-img-vue-CR837WER.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./lodash-DrHMlsdo.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./moment-C5S46NFB.js";const b="https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/user_login",dt=`${b}/paging`,pt=`${b}/lookup`,gt=`${b}/export`,k=Q({id:"userLoginList",state:()=>({stateFilterData:{EmployeeId:"",Section:"",LogOnDate:"",EmployeeIdTo:"",SectionTo:"",LogOnDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},stateLastUsedFilterData:{EmployeeId:"",Section:"",LogOnDate:"",EmployeeIdTo:"",SectionTo:"",LogOnDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},statePageName:"userLogin",stateDisplayData:[],statePagination:new U,stateLoading:!1,statePaginationLoading:!1,stateEmployeeIdOption:[],stateSectionOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,employeeIdOption:t=>t.stateEmployeeIdOption,sectionOption:t=>t.stateSectionOption},actions:{async getData(t=!0){const a={EmployeeId:this.stateFilterData.EmployeeId,Section:this.stateFilterData.Section,LogOnDate:this.stateFilterData.LogOnDate?P(this.stateFilterData.LogOnDate):"",EmployeeIdTo:this.stateFilterData.EmployeeIdTo,SectionTo:this.stateFilterData.SectionTo,LogOnDateTo:this.stateFilterData.LogOnDateTo?P(this.stateFilterData.LogOnDateTo):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t?this.stateLoading=!0:this.stateDisplayData=[];const e=await I.get(dt,"",new URLSearchParams(a).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const a=await I.get(pt,"",new URLSearchParams(t).toString());this.stateEmployeeIdOption=W(a.data.result.content,"employeeId","employeeName"),this.stateSectionOption=Z(a.data.result.content.section)}catch(a){console.log(a)}},async export(){const t={EmployeeId:this.stateFilterData.EmployeeId,Section:this.stateFilterData.Section,LogOnDate:this.stateFilterData.LogOnDate?P(this.stateFilterData.LogOnDate):"",EmployeeIdTo:this.stateFilterData.EmployeeIdTo,SectionTo:this.stateFilterData.SectionTo,LogOnDateTo:this.stateFilterData.LogOnDateTo?P(this.stateFilterData.LogOnDateTo):"",ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await I.getBlob(gt,"",new URLSearchParams(t).toString())).data}catch(a){console.log(a)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:a}){if(!t&&!a)this.stateFilterData.Order="";else{const e=a=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setEmployeeId(t){this.stateFilterData.EmployeeId=t},setSection(t){this.stateFilterData.Section=t},setLogOnDate(t){this.stateFilterData.LogOnDate=t},setEmployeeIdTo(t){this.stateFilterData.EmployeeIdTo=t},setSectionTo(t){this.stateFilterData.SectionTo=t},setLogOnDateTo(t){this.stateFilterData.LogOnDateTo=t},async resetFilter(){this.stateFilterData.EmployeeId="",this.stateFilterData.Section="",this.stateFilterData.LogOnDate="",this.stateFilterData.EmployeeIdTo="",this.stateFilterData.SectionTo="",this.stateFilterData.LogOnDateTo="";const t=this.stateLastUsedFilterData.EmployeeId!=="",a=this.stateLastUsedFilterData.Section!=="",e=this.stateLastUsedFilterData.LogOnDate!=="",g=this.stateLastUsedFilterData.EmployeeIdTo!=="",m=this.stateLastUsedFilterData.SectionTo!=="",l=this.stateLastUsedFilterData.LogOnDateTo!=="";(t||a||e||g||m||l)&&await this.getData()},resetState(){this.stateFilterData={EmployeeId:"",Section:"",LogOnDate:"",EmployeeIdTo:"",SectionTo:"",LogOnDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},this.stateDisplayData=[],this.statePagination=new U,this.stateLoading=!1,this.statePaginationLoading=!1}}}),mt={key:0,style:{height:"100px"}},Dt=E({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const a=t,e=k(),g=tt(()=>(a.page-1)*10+1),m=A(""),l=p=>{m.value=p.order;const D={prop:p.prop,order:p.order};e.setSort(D)},c=(p,D,u)=>rt(p[u],D[u],m.value);return(p,D)=>{const u=et("loading");return n(e).loading?x((S(),B("div",mt,null,512)),[[u,n(e).loading]]):x((S(),w(n(Y),{key:1,data:a.listData,style:{width:"100%"},onSortChange:l,"empty-text":"No Data"},{default:h(()=>[r(n(L),{label:"No",width:"90",align:"center"},{default:h(i=>[d("span",null,C(n(g)+i.$index),1)]),_:1}),r(n(L),{prop:"EmployeeId",label:"Employee Id",sortable:"","sort-method":(i,o)=>c(i,o,"EmployeeId")},null,8,["sort-method"]),r(n(L),{prop:"EmployeeName",label:"Name",sortable:"","sort-method":(i,o)=>c(i,o,"EmployeeName")},null,8,["sort-method"]),r(n(L),{prop:"Section",label:"Section",sortable:"","sort-method":(i,o)=>c(i,o,"Section")},null,8,["sort-method"]),r(n(L),{prop:"LoginDate",label:"Login Date",sortable:"","sort-method":(i,o)=>c(i,o,"LoginDate")},{default:h(i=>[d("span",null,C(n(J)(i.row.LoginDate)),1)]),_:1},8,["sort-method"])]),_:1},8,["data"])),[[u,n(e).loading]])}}}),ut={class:"row g-9 my-4"},ht={class:"w-100 fv-row fv-plugins-icon-container"},yt={class:"w-100 fv-row fv-plugins-icon-container"},Lt={class:"w-100 fv-row fv-plugins-icon-container"},St={class:"dialog-footer"},ft=E({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:a}){const e=k(),g=t,m=a,l=at(g,"visibility"),c=O(()=>e.filterData),p=()=>{D(),e.resetFilter()},D=()=>{m("handle-close",!1)},u=s=>{e.setEmployeeId(s)},i=s=>{e.setSection(s)},o=s=>{e.setLogOnDate(s)},f=s=>{e.setEmployeeIdTo(s)},_=s=>{e.setSectionTo(s)},V=s=>{e.setLogOnDateTo(s)},z=()=>{const s=e.lastUsedFilterData.EmployeeId!==e.filterData.EmployeeId,y=e.lastUsedFilterData.Section!==e.filterData.Section,v=e.lastUsedFilterData.LogOnDate!==e.filterData.LogOnDate,T=e.lastUsedFilterData.EmployeeIdTo!==e.filterData.EmployeeIdTo,F=e.lastUsedFilterData.SectionTo!==e.filterData.SectionTo,H=e.lastUsedFilterData.LogOnDateTo!==e.filterData.LogOnDateTo;m("handle-close",s||y||v||T||F||H)};return(s,y)=>{const v=$("el-button"),T=$("el-dialog");return S(),w(T,{modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=F=>l.value=F),title:"Filter",width:"50%",onClose:y[1]||(y[1]=F=>D())},{footer:h(()=>[d("span",St,[r(v,{type:"secondary",onClick:p},{default:h(()=>[R("Reset")]),_:1}),r(v,{type:"primary",onClick:z},{default:h(()=>[R("Filter")]),_:1})])]),default:h(()=>[d("div",ut,[d("div",ht,[r(N,{"value-from":c.value.EmployeeId,"value-to":c.value.EmployeeIdTo,label:"Employee Id",options:n(e).employeeIdOption,onHandleChangeFrom:u,onHandleChangeTo:f},null,8,["value-from","value-to","options"])]),d("div",yt,[r(N,{"value-from":c.value.Section,"value-to":c.value.SectionTo,label:"Section",options:n(e).sectionOption,onHandleChangeFrom:i,onHandleChangeTo:_},null,8,["value-from","value-to","options"])]),d("div",Lt,[r(lt,{"value-from":c.value.LogOnDate,"value-to":c.value.LogOnDateTo,placeholder:"Select Login Date",label:"Login Date To",onHandleChangeFrom:o,onHandleChangeTo:V},null,8,["value-from","value-to"])])])]),_:1},8,["modelValue"])}}}),vt={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},Ft=d("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),Pt={class:"d-flex justify-content-between align-items-center"},_t={class:"card"},Tt={class:"card-body grid-padding"},It={class:"my-5"},Fe=E({__name:"Index",setup(t){const a=q(),e=k(),g=A(!1),m=O(()=>e.displayData),l=O(()=>e.pagination),c=o=>{e.setPage(o)};ot(async()=>{a[M.ACTIVE_PAGE]("IronLake"),G("User Login",[{pageName:"Ironlake",pageRoute:"ironlake"},{pageName:"Role Management",pageRoute:"ironlake-rolemanagement-userlogin"},{pageName:"User Login",pageRoute:"ironlake-rolemanagement-userlogin"}]),e.setPage(1),await e.getLookup()}),it(async()=>{e.resetState()});const p=async()=>{await e.setPage(1),await e.getLookup()},D=()=>{g.value=!0},u=async o=>{g.value=!1,o&&await p()},i=async()=>{const o=await e.export();ct.saveAs(new Blob([o],{type:"application/octet-stream"}),"User Login.xlsx")};return(o,f)=>(S(),B(nt,null,[d("div",vt,[Ft,d("div",Pt,[r(K,{onShowDialog:D}),r(X,{onHandleDownload:i})])]),d("div",_t,[d("div",Tt,[r(Dt,{"list-data":m.value,page:l.value.currentPage},null,8,["list-data","page"])])]),d("div",It,[n(e).paginationLoading?st("",!0):(S(),w(j,{key:0,onRaisePageChange:f[0]||(f[0]=_=>c(_)),currentPage:l.value.currentPage,totalPage:l.value.totalPage,totalPageSize:l.value.totalPageSize,startPaginationIndex:l.value.startPaginationIndex,endPaginationIndex:l.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),r(ft,{visibility:g.value,onHandleClose:u},null,8,["visibility"])],64))}});export{Fe as default};

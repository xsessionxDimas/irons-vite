import{u as v}from"./authentication-handler-Pueb_EI7.js";import{a as F,c as h,s as g}from"./index-BuVmIl8K.js";import{d as B}from"./pinia-BjOS2_Ao.js";import{u as D,g as J,a as ee,f as A,G as te,e as se,U as ae}from"./useInterimEngineStore-Ctq4w8Oq.js";import{D as G}from"./DefectNoClass-BqGKOkzR.js";import{D as x}from"./urls-CvqtYZA-.js";import{u as U}from"./useCameraStore-BwXVJhPe.js";import{u as re}from"./useAttachmentStore-DqM3autD.js";import{t as ie,m as oe,u as ne,p as le}from"./helpers-wUOLw-dU.js";import{M as b}from"./MachineSMUEnum-CgiCo9nf.js";import{a as ce,u as Y}from"./useInterimDefectsStore-DCjj_hjG.js";import{u as L}from"./useGlobalConnectionStore-DV9B81de.js";import{S as _}from"./number-format-BdMuQVyW.js";import{u as de}from"./useDailyScheduleStore-B3ZQzhxq.js";import{u as ue}from"./useMasterStore-CzSO06fn.js";import{_ as me}from"./Textarea.vue_vue_type_style_index_0_lang-v94SEJmi.js";import{k as pe,r as fe,a0 as he,c as V,p as S,q,x as M,R as $,aB as m,B as ge,aa as N,A as T,s as W,$ as ye,u as Ie,F as Se,C as k,bd as De,bb as be}from"./@vue-BypzYtbH.js";import{_ as Ne}from"./nw-img-vue-CR837WER.js";const ve=B({id:"InterimdefectsForm",state:()=>({stateIsYes:void 0,stateLoading:!1,stateCancelled:!1,stateDefectYesVisible:!1,stateDefectNoVisible:!1,stateViewYesVisible:!1,stateViewtNoVisible:!1,stateIsValid:!0,stateItemKey:"",stateTask:{},stateDefectInfo:{},statePayload:{updateParams:[]},stateItem:{},stateErrorMessage:""}),getters:{Loading:e=>e.stateLoading,Cancelled:e=>e.stateCancelled,DefectYesVisible:e=>e.stateDefectYesVisible,DefectNoVisible:e=>e.stateDefectNoVisible,ViewYesVisible:e=>e.stateViewYesVisible,ViewNoVisible:e=>e.stateViewtNoVisible,ItemKey:e=>e.stateItemKey,isValid:e=>e.stateIsValid,isYes:e=>e.stateIsYes,defectInfo:e=>e.stateDefectInfo,selectedGroup:()=>D().selectedGroup,selectedFitter:()=>D().employee,supervisor:()=>{const e=F();return{id:e.user.EmployeeId,name:e.user.Name}},images:()=>U().ImageObjects.find(s=>s.Id==="defect"),globalConnectionStore:()=>L(),dailyScheduleStore:()=>de()},actions:{setItem(e){this.stateItem=e},setItemKey(e){this.stateItemKey=e},setCancelledState(e){this.stateCancelled=e},cretateInstance(e=!0){this.stateDefectInfo=e?new x:new G,this.stateIsYes=e},setTask(e){this.stateTask=e},toggleYesVisible(e){this.stateDefectYesVisible=e,this.stateDefectNoVisible=!1,this.stateCancelled=!1},toggleNoVisible(e){this.stateDefectNoVisible=e,this.stateDefectYesVisible=!1,this.stateCancelled=!1},toggleViewNoVisible(e){this.stateViewtNoVisible=e,this.stateViewYesVisible=!1},toggleViewYesVisible(e){this.stateViewYesVisible=e,this.stateViewtNoVisible=!1},createYesPayload(e){var a;const s=this.stateDefectInfo,r=((a=this.images)==null?void 0:a.ImageInfos)??[],o=s.Resources.filter(t=>t.value!=="");this.statePayload.defectDetail={type:"YES",title:e,assetNumber:s.AssetNumber,description:s.Description.value,raisedBy:this.selectedFitter.name,date:"<<ServerDateTime>>",plannedDuration:s.PlannedDuration.value,instruction:s.Instruction.value,priority:s.Priority,parts:JSON.stringify(s.Parts),labours:JSON.stringify(s.Labours),resources:JSON.stringify(o.map(t=>t.value)),symptoms:JSON.stringify(s.Symptoms.map(t=>t.value)),causes:JSON.stringify(s.Causes.map(t=>t.value)),images:JSON.stringify(r)}},createNoPayload(e){var o;const s=this.stateDefectInfo,r=((o=this.images)==null?void 0:o.ImageInfos)??[];this.statePayload.defectDetail={type:"NO",title:e,assetNumber:s.AssetNumber,description:s.Description.value,raisedBy:this.selectedFitter.name,date:"<<ServerDateTime>>",actions:JSON.stringify(s.Actions.map(a=>a.value)),images:JSON.stringify(r)}},createPayload(){const e=D();this.statePayload.id=this.selectedGroup.id,this.statePayload.headerId=this.selectedGroup.headerId,this.statePayload.workorder=this.selectedGroup.workOrder,this.statePayload.updateParams=[],this.statePayload.updateParams.push({keyValue:this.stateTask.key,propertyParams:[{propertyName:"taskValue",propertyValue:"2"},{propertyName:"updatedBy",propertyValue:JSON.stringify(this.selectedFitter)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}),this.statePayload.employee=this.selectedFitter,this.statePayload.defectHeader={workorder:e.generalForm.workOrder,form:this.selectedGroup.modelId,serviceSheetDetailId:this.selectedGroup.id,category:this.stateTask.category,taskId:this.stateTask.key,taskNo:this.stateTask.description!=""?this.stateTask.description.split(";")[0]:this.stateTask.items[0].value,taskDesc:this.stateTask.description!=""?this.stateTask.description:this.stateTask.items[1].value,defectWorkorder:"",formDefect:"BA-PL-F55",defectType:this.stateIsYes?"YES":"NO",cbmMeasurement:"",cbmUom:"",cbmImageKey:"",cbmImageProp:"",isCbmAdjusment:"",taskValue:"2",repairedStatus:"Not-Repaired",cbmNAStatus:"Not-Confirm",supervisor:this.supervisor,status:"Submited",defectStatus:"Submited"};const s=ie(this.stateTask);this.stateIsYes?this.createYesPayload(s):this.createNoPayload(s)},async createDefect(){this.stateLoading=!0;const e={ver:"v1"};try{this.createPayload();const s=await h.post(`${J}?${new URLSearchParams(e).toString()}`,this.statePayload);return this.stateLoading=!1,s.data.result.message==_.TASK_UPDATED_BY_OTHER?(D().toggleTaskAlreadyUpdatedStatus(!0),!1):s.data.result.message==_.SUBMITTED?(D().toggleFormAlreadySubmitted(!0),!1):s.data.result.message==_.CLOSE?(D().toggleFormAlreadyClose(!0),!1):!0}catch(s){const r=this.globalConnectionStore.checkIsErrorNoNetwork(s);return this.globalConnectionStore.setSubmitConnectionError(r),v(s),console.log(s),this.stateLoading=!1,g("IRONS",s),!1}},async createSMUDefect(e){var i,l,E,P,w;const{val:s,hmOffset:r,range:o,smuDate:a,isInRange:t}=e;let u=b.STATUS_NOT_IN_RANGE;t&&(u=b.STATUS_IN_RANGE);const c=ee(),d={id:c.generalForm.id,updateParams:[{keyValue:"GENERAL",propertyParams:[{propertyName:"smu",propertyValue:s},{propertyName:"smuBy",propertyValue:s!==""?JSON.stringify(this.selectedFitter):""},{propertyName:"smuDate",propertyValue:s!==""?a:""},{propertyName:"updatedBy",propertyValue:s!==""?JSON.stringify(this.selectedFitter):""},{propertyName:"updatedDate",propertyValue:s!==""?a:""}]}],headerId:c.generalForm.id,workorder:c.generalForm.workOrder,employee:this.selectedFitter,defectHeader:{workorder:c.generalForm.workOrder,form:c.generalForm.form,category:"GENERAL",taskId:"",formDefect:"",defectType:"machineSMU",taskDesc:b.TITLE(u),supervisor:this.supervisor,status:"Submited",defectStatus:"Submited"},defectDetail:{title:b.TITLE(u),machineSMU:s,minRange:o.MinRange,maxRange:o.MaxRange,smuDue:this.dailyScheduleStore.stateSelectedDailyScheduleInterim.smuDue,assetNumber:c.generalForm.equipment,serialNumber:c.generalForm.serialNumber,images:JSON.stringify(c.generalForm.imageEquipment??[])}};r!=""&&(d.updateParams[0].propertyParams.push({propertyName:"hmOffset",propertyValue:r}),d.defectDetail.hmOffset=r);const n={ver:"v1"};try{const f=await h.post(`${J}?${new URLSearchParams(n).toString()}`,d);f.data.statusCode==400&&(this.stateErrorMessage=(l=(i=f.data)==null?void 0:i.result)==null?void 0:l.message)}catch(f){console.log("update defect smu/hmoffset value",f),this.stateErrorMessage=oe(((w=(P=(E=f==null?void 0:f.response)==null?void 0:E.data)==null?void 0:P.result)==null?void 0:w.message)??`${f}`),g("IRONS",f)}},async getDefectDetail(e,s){this.stateLoading=!0;const r={ver:"v1"},o={servicesheetDetailId:e,taskId:s};try{const t=(await h.post(`${A}?${new URLSearchParams(r).toString()}`,o)).data.result.content.detail,u=U(),c=ce();if(u.setCurrent("defect"),u.clearCurrent(),t.type==="YES"){this.stateIsYes=!0,this.stateDefectInfo=new x,this.stateDefectInfo.setAssetNumber(t.assetNumber),this.stateDefectInfo.setDescription(t.description),this.stateDefectInfo.setPriority(t.priority),this.stateDefectInfo.setRaisedBy(t.raisedBy),this.stateDefectInfo.setDate(t.date),this.stateDefectInfo.setPlannedDuration(t.plannedDuration),this.stateDefectInfo.setInstruction(t.instruction),this.stateDefectInfo.setTitle(t.title),this.stateDefectInfo.importParts(...JSON.parse(t.parts)),this.stateDefectInfo.importLabours(...JSON.parse(t.labours)),this.stateDefectInfo.importResources(...JSON.parse(t.resources)),this.stateDefectInfo.importSymptoms(...JSON.parse(t.symptoms)),this.stateDefectInfo.importCauses(...JSON.parse(t.causes)),this.images.ImageInfos.push(...JSON.parse(t.images));const d=[];this.images.ImageInfos.forEach(n=>{let i="";typeof n=="string"?i=n:i=n.filename,d.push(c.downloadAttachment(i))}),Promise.all(d).then(n=>{n.forEach(i=>{const l=new Blob([i],{type:"image/png"});this.images.ImageBlobs.push(l)}),this.toggleViewYesVisible(!0)})}else{this.stateIsYes=!1,this.stateDefectInfo=new G,this.stateDefectInfo.setAssetNumber(t.assetNumber),this.stateDefectInfo.setDescription(t.description),this.stateDefectInfo.setRaisedBy(t.raisedBy),this.stateDefectInfo.setDate(t.date),this.stateDefectInfo.setTitle(t.title),this.stateDefectInfo.importActions(...JSON.parse(t.actions)),this.images.ImageInfos.push(...JSON.parse(t.images));const d=[];this.images.ImageInfos.forEach(n=>{let i="";typeof n=="string"?i=n:i=n.filename,d.push(c.downloadAttachment(i))}),Promise.all(d).then(n=>{n.forEach(i=>{const l=new Blob([i],{type:"image/png"});this.images.ImageBlobs.push(l)}),this.toggleViewNoVisible(!0)})}this.stateLoading=!1}catch(a){v(a),console.log(a),this.stateLoading=!1,g("IRONS",a)}},resetInstance(){this.stateLoading=!1,this.stateIsYes=void 0,this.stateDefectYesVisible=!1,this.stateDefectNoVisible=!1,this.stateViewYesVisible=!1,this.stateViewtNoVisible=!1,this.stateIsValid=!0,this.stateItemKey="",this.stateTask={},this.stateDefectInfo={},this.statePayload={updateParams:[]}},resetErrorStatus(){this.stateErrorMessage=""}}}),Ve=B({id:"InterimdefectPreview",state:()=>({stateLoading:!1,stateViewYesVisible:!1,stateViewtNoVisible:!1,stateDefectInfo:{},stateIsYes:void 0,stateApprovalDefectList:[],stateSelectedApprovalDefect:{}}),getters:{ViewYesVisible:e=>e.stateViewYesVisible,ViewNoVisible:e=>e.stateViewtNoVisible,images:()=>U().ImageObjects.find(s=>s.Id==="defect"),defectInfo:e=>e.stateDefectInfo,ApprovalDefect:e=>e.stateSelectedApprovalDefect},actions:{toggleViewYesVisible(e){this.stateViewYesVisible=e,this.stateViewtNoVisible=!1},toggleViewNoVisible(e){this.stateViewtNoVisible=e,this.stateViewYesVisible=!1},async getDefectDetail(e,s){this.stateLoading=!0;const r={ver:"v1"},o={servicesheetDetailId:e,taskId:s};try{const t=(await h.post(`${A}?${new URLSearchParams(r).toString()}`,o)).data.result.content.detail,u=U(),c=re();if(u.setCurrent("defect"),u.clearCurrent(),t.type==="YES"){this.stateIsYes=!0,this.stateDefectInfo=new x,this.stateDefectInfo.setAssetNumber(t.assetNumber),this.stateDefectInfo.setDescription(t.description),this.stateDefectInfo.setPriority(t.priority),this.stateDefectInfo.setRaisedBy(t.raisedBy),this.stateDefectInfo.setDate(t.date),this.stateDefectInfo.setPlannedDuration(t.plannedDuration),this.stateDefectInfo.setInstruction(t.instruction),this.stateDefectInfo.setTitle(t.title),this.stateDefectInfo.importParts(...JSON.parse(t.parts)),this.stateDefectInfo.importLabours(...JSON.parse(t.labours)),this.stateDefectInfo.importResources(...JSON.parse(t.resources)),this.stateDefectInfo.importSymptoms(...JSON.parse(t.symptoms)),this.stateDefectInfo.importCauses(...JSON.parse(t.causes)),this.images.ImageInfos.push(...JSON.parse(t.images));const d=[];this.images.ImageInfos.forEach(n=>{let i="";typeof n=="string"?i=n:i=n.filename,d.push(c.downloadAttachment(i))}),Promise.all(d).then(n=>{n.forEach(i=>{const l=new Blob([i],{type:"image/png"});this.images.ImageBlobs.push(l)}),this.toggleViewYesVisible(!0)})}else{this.stateIsYes=!1,this.stateDefectInfo=new G,this.stateDefectInfo.setAssetNumber(t.assetNumber),this.stateDefectInfo.setDescription(t.description),this.stateDefectInfo.setRaisedBy(t.raisedBy),this.stateDefectInfo.setDate(t.date),this.stateDefectInfo.setTitle(t.title),this.stateDefectInfo.importActions(...JSON.parse(t.actions)),this.images.ImageInfos.push(...JSON.parse(t.images));const d=[];this.images.ImageInfos.forEach(n=>{let i="";typeof n=="string"?i=n:i=n.filename,d.push(c.downloadAttachment(i))}),Promise.all(d).then(n=>{n.forEach(i=>{const l=new Blob([i],{type:"image/png"});this.images.ImageBlobs.push(l)}),this.toggleViewNoVisible(!0)})}this.stateLoading=!1}catch(a){v(a),console.log(a),this.stateLoading=!1,g("IRONS",a)}},async getApprovalDefect(e){const{id:s,taskId:r}=e;let o=null;if(this.stateApprovalDefectList.length!=0&&(o=ne(this.stateApprovalDefectList,t=>s?t.defectHeaderId==s:r?t.taskKey==r:!1),o&&(o.object.status=="Acknowledge"||o.object.status=="Decline"||o.object.cbmNAStatus=="Confirmed"||o.object.cbmNAStatus=="Decline")))return o.object;const a=await this.getDefectsDataHeaderPerDefect(e);if(a){const t={defectHeaderId:a.id,taskKey:a.taskId,approvedBy:a.approvedBy,approvedDate:a.approvedDate,status:a.status,cbmNAStatus:a.cbmNAStatus,declineReason:a.declineReason,declineBy:a.declineBy,declineDate:a.declineDate};return o?o.index>=0&&(this.stateApprovalDefectList[o.index]=t):this.stateApprovalDefectList.push(t),t}return null},async getDefectsDataHeaderPerDefect(e){const s=e;try{const r=await h.post(`${te}`,s);return r.data.result.content&&r.data.result.content[0]?r.data.result.content[0]:null}catch(r){g("IRONS",r)}},setApprovalData(e){this.stateSelectedApprovalDefect=e},async updateSMUDefect(e){const s=Y(),r=ve();s.setDetailId(s.DefectSMUHeader.id),s.DefectSMUDetailDetail?(await this.updateDefectDetailSMU(e,!0),await this.updateDefectHeaderSMU(e,!0)):await r.createSMUDefect(e)},async updateDefectHeaderSMU(e,s=!1){const r=F(),a=Y().DefectSMUHeader;let t=b.STATUS_NOT_IN_RANGE;e.isInRange&&(t=b.STATUS_IN_RANGE);const u={id:a.id,updateParams:[{keyValue:a.key,propertyParams:[{propertyName:"taskDesc",propertyValue:b.TITLE(t)},{propertyName:"updatedBy",propertyValue:JSON.stringify({id:r.user.EmployeeId,name:r.user.Name})},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}],employee:{id:r.user.EmployeeId,name:r.user.Name},userGroup:r.user.Position};s&&(u.isEdit="true");try{await h.post(`${se}`,u)}catch(c){g("IRONS",c),console.log(c)}},async updateDefectDetailSMU(e,s=!1){var d;const r=F(),a=Y().DefectSMUDetailDetail;let t=b.STATUS_NOT_IN_RANGE;e.isInRange&&(t=b.STATUS_IN_RANGE);const u={...a==null?void 0:a.detail,title:b.TITLE(t),machineSMU:e.val,images:(d=e.generalData)==null?void 0:d.imageEquipment},c={id:a==null?void 0:a.id,updateParams:[{keyValue:a==null?void 0:a.id,propertyParams:[{propertyName:"detail",propertyValue:JSON.stringify(u)},{propertyName:"updatedBy",propertyValue:JSON.stringify({id:r.user.EmployeeId,name:r.user.Name})},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}],employee:{id:r.user.EmployeeId,name:r.user.Name},userGroup:r.user.Position};s&&(c.isEdit="true");try{await h.post(`${ae}`,c)}catch(n){v(n),g("IRONS",n),console.log(n)}},resetList(){this.stateApprovalDefectList=[],this.stateSelectedApprovalDefect={}},resetInstance(){this.stateLoading=!1,this.stateIsYes=void 0,this.stateViewYesVisible=!1,this.stateViewtNoVisible=!1,this.stateDefectInfo={}}}}),ut="https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/interim_engine_detail/update_task_with_defect",mt="https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/interim_engine_defect_detail/get_previous_crack",pt="https://digital-bumaau-dev-apm-001.azure-api.net/dinspect//api/interim_engine_defect_detail/get_data_by_param/",z=B({id:"InterimNAPreview",state:()=>({stateLoading:!1,stateViewVisible:!1,stateNAInfo:{}}),getters:{ViewVisible:e=>e.stateViewVisible,Details:e=>e.stateNAInfo},actions:{async getNADetail(e,s){this.stateLoading=!0;const r={ver:"v1"},o={servicesheetDetailId:e,taskId:s};try{const a=await h.post(`${A}?${new URLSearchParams(r).toString()}`,o);this.stateNAInfo=a.data.result.content.detail,console.log(this.stateNAInfo),this.stateLoading=!1,this.toggleIsViewVisible(!0)}catch(a){v(a),console.log(a),this.stateLoading=!1,g("IRONS",a)}},setNAInfo(e){this.stateNAInfo=e},toggleIsViewVisible(e){this.stateViewVisible=e},resetInstance(){this.stateLoading=!1,this.stateNAInfo={},this.stateViewVisible=!1}}}),_e=B({id:"Interimna",state:()=>({stateLoading:!1,stateCancelled:!1,stateVisible:!1,stateViewVisible:!1,stateIsValid:!0,stateItemKey:"",stateReason:"",stateTitle:"",stateTask:{},statePayload:{updateParams:[]},stateItem:{},stateSuccessUpdateItemKey:""}),getters:{Loading:e=>e.stateLoading,Cancelled:e=>e.stateCancelled,Reason:e=>e.stateReason,Visible:e=>e.stateVisible,ViewVisible:e=>e.stateViewVisible,ItemKey:e=>e.stateItemKey,isValid:e=>e.stateIsValid,selectedGroup:()=>D().selectedGroup,selectedFitter:()=>D().employee,supervisor:()=>{const e=F();return{id:e.user.EmployeeId,name:e.user.Name}},globalConnectionStore:()=>L()},actions:{setItem(e){this.stateItem=e},setReason(e){this.stateReason=e},setCancelledState(e){this.stateCancelled=e},setItemKey(e){this.stateItemKey=e,this.stateSuccessUpdateItemKey=""},setTask(e){this.stateTask=e},toggleIsVisible(e){this.stateVisible=e,this.stateCancelled=!1},toggleIsViewVisible(e){this.stateViewVisible=e},createPayload(){const e=D();this.statePayload.id=this.selectedGroup.id,this.statePayload.workorder=this.selectedGroup.workOrder,this.statePayload.headerId=this.selectedGroup.headerId,this.statePayload.updateParams=[],this.statePayload.updateParams.push({keyValue:this.stateTask.key,propertyParams:[{propertyName:"taskValue",propertyValue:this.stateTask.category==="NORMAL"||this.stateTask.category==="CBM"?"3":"4"},{propertyName:"updatedBy",propertyValue:JSON.stringify(this.selectedFitter)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}),this.statePayload.employee=this.selectedFitter,this.statePayload.defectHeader={workorder:e.generalForm.workOrder,form:this.selectedGroup.modelId,serviceSheetDetailId:this.selectedGroup.id,category:this.stateTask.category,taskId:this.stateTask.key,taskNo:this.stateTask.description!=""?this.stateTask.description.split(";")[0]:this.stateTask.items[0].value,taskDesc:this.stateTask.description!=""?this.stateTask.description:this.stateTask.items[1].value,defectWorkorder:"",formDefect:"DM-PL-F55",defectType:"",cbmMeasurement:"",cbmUom:"",cbmImageKey:"",cbmImageProp:"",isCbmAdjusment:"",taskValue:this.stateTask.category==="NORMAL"||this.stateTask.category==="CBM"?"3":"4",repairedStatus:"Not-Repaired",cbmNAStatus:"Not-Confirm",supervisor:this.supervisor,status:"Submited",defectStatus:"Submited"},this.statePayload.defectDetail={type:"N/A",reason:this.Reason,title:this.stateTask.description!=""?this.stateTask.description:this.stateTask.items[1].value}},async createNA(){this.stateLoading=!0;const e={ver:"v1"};try{this.createPayload();const s=await h.post(`${J}?${new URLSearchParams(e).toString()}`,this.statePayload);this.stateLoading=!1;const r=D();switch(s.data.result.message){case _.SUBMITTED:return r.toggleFormAlreadySubmitted(!0),!1;case _.CLOSE:return r.toggleFormAlreadyClose(!0),!1;case _.TASK_UPDATED_BY_OTHER:return r.toggleTaskAlreadyUpdatedStatus(!0),!1;default:if(s.data.statusCode==400)return r.toogleTaskErrorDialog(!0),r.stateErrorMessageTaskErrorDialog=s.data.result.message,!1;break}return!0}catch(s){const r=this.globalConnectionStore.checkIsErrorNoNetwork(s);this.globalConnectionStore.setSubmitConnectionError(r),v(s),g("IRONS",s),console.log(s)}},async getNADetailValue(e,s){this.stateLoading=!0;const r={ver:"v1"},o={servicesheetDetailId:e,taskId:s};try{return(await h.post(`${A}?${new URLSearchParams(r).toString()}`,o)).data.result.content.detail}catch(a){a.message.includes("Network Error")&&L().setSubmitConnectionError(!0),v(a),g("IRONS",a),console.log(a)}this.stateLoading=!1},async getNADetail(e,s){this.stateLoading=!0;const r={ver:"v1"},o={servicesheetDetailId:e,taskId:s};try{const t=(await h.post(`${A}?${new URLSearchParams(r).toString()}`,o)).data.result.content.detail;z().setNAInfo(t),this.setReason(t.reason),this.stateTitle=t.title,this.stateLoading=!1,this.toggleIsViewVisible(!0)}catch(a){a.message.includes("Network Error")&&L().setSubmitConnectionError(!0),v(a),g("IRONS",a),console.log(a)}this.stateLoading=!1},setSuccesItem(e){this.stateSuccessUpdateItemKey=e},resetInstance(){this.stateLoading=!1,this.stateReason="",this.stateVisible=!1,this.stateViewVisible=!1,this.stateIsValid=!0,this.stateTask={},this.statePayload={updateParams:[]}}}}),K=e=>(De("data-v-919ae46e"),e=e(),be(),e),we={class:"el-dialog__title"},Te={key:0,class:"status-badge-dialog-header approved-badge p-1"},ke={key:1,class:"status-badge-dialog-header declined-badge p-1"},Ae=["innerHTML"],Ee={class:"mt-1 p-2"},Pe={class:"d-flex flex-column"},Oe=K(()=>m("h4",{class:"title ps-3"},"Reason",-1)),Ce={key:0,class:"mt-1 p-2"},Re={key:1,class:"mt-1 py-2"},Le={class:"row mb-1"},Fe={class:"col"},Ue=K(()=>m("div",{class:"form-floating approved-text-box"},[m("div",{class:"form-control",style:{"white-space":"break-spaces"}},"This information has been approved"),m("label",null,"Confirmed")],-1)),Be={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},Ye={key:2,class:"mt-1 py-2"},Me={class:"row mb-1"},$e={class:"col"},Je={class:"form-floating declined-text-box"},Ge={class:"form-control",style:{"white-space":"break-spaces"}},xe=K(()=>m("label",null,"Declined",-1)),Ke={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},He=pe({__name:"ViewOnlyNAForm",props:{visibility:{required:!0,type:Boolean}},emits:["close"],setup(e,{emit:s}){const r=e,o=s,a=z(),t=Ve(),u=_e(),c=ue(),d=fe(null),n=he(r,"visibility"),i=V(()=>a.Details),l=V(()=>t.ApprovalDefect),E=V(()=>{var p,y,O,C,R,I,H;if((p=i.value)!=null&&p.title&&i.value.title!=""){if((y=i.value)!=null&&y.title.includes(";;"))return(O=i.value)==null?void 0:O.title.split(";;")[1];if((C=i.value)!=null&&C.title.includes(";")){const j=[];if(i.value.title.includes("|"))return i.value.title.split("|").forEach(Z=>{j.push(Z.split("")[2])}),j.join(", ");if((i.value.title.match(/;/g)||[]).length==2)return`${(R=i.value)==null?void 0:R.title.split(";")[1]}. ${(I=i.value)==null?void 0:I.title.split(";")[2]}`}}return(H=i.value)==null?void 0:H.title}),P=()=>{le(d.value)},w=V(()=>{var p;return(p=i.value)==null?void 0:p.reason.split(":")[0]}),f=V(()=>{var p;return(p=i.value)==null?void 0:p.reason.split(":")[0].includes("Other")}),Q=V(()=>{var y;const p=(y=i.value)==null?void 0:y.reason.split(":");return p.length>=2?p.slice(1).join(":"):""}),X=async()=>{o("close"),a.resetInstance(),u.resetInstance()};return(p,y)=>{const O=$("el-option"),C=$("el-select"),R=$("el-dialog");return S(),q(R,{modelValue:n.value,"onUpdate:modelValue":y[1]||(y[1]=I=>n.value=I),width:"90%",center:"",onOpened:P,onClosed:X,"destroy-on-close":!0,"custom-class":"el-defect-crack-form-custom"},{title:M(()=>[m("span",we,[ge("Not Applicable "),l.value&&l.value.cbmNAStatus=="Confirmed"?(S(),N("span",Te,"Confirmed")):l.value&&l.value.cbmNAStatus=="Decline"?(S(),N("span",ke,"Declined")):T("",!0)]),m("span",{class:"el-dialog__title task-title",innerHTML:E.value,ref_key:"defectDetailRef",ref:d},null,8,Ae)]),default:M(()=>[m("div",Ee,[m("div",Pe,[Oe,W(C,{modelValue:w.value,"onUpdate:modelValue":y[0]||(y[0]=I=>w.value=I),disabled:!0,class:"w-100"},{default:M(()=>[(S(!0),N(Se,null,ye(Ie(c).NAConditions,I=>(S(),q(O,{key:I.id,label:I.naCondition,value:I.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),f.value?(S(),N("div",Ce,[W(me,{value:Q.value,label:"Why not applicable item task?",name:"Reason",disabled:!0},null,8,["value"])])):T("",!0),l.value&&l.value.cbmNAStatus=="Confirmed"?(S(),N("div",Re,[m("div",Le,[m("div",Fe,[Ue,l.value.approvedBy&&l.value.approvedDate?(S(),N("div",Be,k(l.value.approvedBy.name)+", "+k(l.value.approvedDate),1)):T("",!0)])])])):l.value&&l.value.cbmNAStatus=="Decline"&&l.value.declineReason?(S(),N("div",Ye,[m("div",Me,[m("div",$e,[m("div",Je,[m("div",Ge,k(l.value.declineReason),1),xe]),l.value.declineBy&&l.value.declineDate?(S(),N("div",Ke,k(l.value.declineBy.name)+", "+k(l.value.declineDate),1)):T("",!0)])])])):T("",!0)]),_:1},8,["modelValue"])}}}),ft=Ne(He,[["__scopeId","data-v-919ae46e"]]);export{pt as G,ut as U,ft as V,z as a,ve as b,mt as c,_e as d,Ve as u};

import{u as gt}from"./vuex-BbOKrtVp.js";import{a as ht}from"./breadcrumb-D-Q4Tk9w.js";import{b as $,u as z,i as B,h as M,j as T,A as ft}from"./index-BCnwA6yE.js";import{P as ot}from"./Pagination-CVDIvnOM.js";import{F as Dt}from"./FilterIconButton-Bj0WTbms.js";import{h as _t,A as vt,U as St}from"./excel-generator-CRLIz6fw.js";import{D as yt}from"./DownloadIconButton-CIQp-YG7.js";import{_ as w,b as rt}from"./element-plus-C5R56mia.js";import{b as bt}from"./date-format-BASVuupi.js";import{P as R,d as Pt,a as Ut}from"./table-sort-VnBD5Hfa.js";import{d as Q}from"./pinia-BjOS2_Ao.js";import{m as it,a as wt}from"./mapOption-sP4IrA4W.js";import{L as Et}from"./urls-DzqKjzQ_.js";import{k as N,bL as Ct,r as V,u as r,y as A,p as E,aa as nt,q as C,x as d,Y as q,R as G,s as o,aB as m,C as J,a0 as j,c as F,B as k,A as K,T as lt,bd as kt,bb as Gt,a7 as Ft,L as It,F as Lt}from"./@vue-BypzYtbH.js";import{_ as H}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{a as dt}from"./vee-validate-C_msoaAA.js";import{c as ut,a as O}from"./yup-BRaPd8dh.js";import"./property-expr-DEi1ZLzV.js";import{E as pt}from"./ErrorAlert-CMKGfwAi.js";import{_ as ct}from"./AutoComplete.vue_vue_type_script_setup_true_lang-D4CTLiQF.js";import{e as xt}from"./lodash-Cr9vlq0V.js";import{_ as $t}from"./FileDropZone.vue_vue_type_style_index_0_lang-Ct77XTnP.js";import{m as Nt}from"./map-anything-abi6NY2Z.js";import{_ as Ot}from"./nw-img-vue-CR837WER.js";import{_ as at}from"./AutoComplete.vue_vue_type_style_index_0_lang-CRR6Z--K.js";import{F as At}from"./file-saver-DhbZvGod.js";import"./vue-router-iNp9kJ0K.js";import"./object-path-BACu75q6.js";import"./attr-accept-BWI1aNlo.js";import"./crypto-js-BZehCumu.js";import"./cron-Ci8nYs3o.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-N3crNZ6y.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-DK0FVkv3.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./dayjs-C7SXsQPH.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-xcxZ5rdH.js";import"./mitt-C1xD_ZTF.js";import"./@popperjs-WhmJkuoZ.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./vue-i18n-CE6bnohq.js";import"./@intlify-CjZh8qSI.js";import"./PageEnum-BoOqFyRq.js";import"./xlsx-CpbwoZfi.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-CalJriC0.js";import"./vue3-dropzone-DPWU9yJt.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";const W="https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_user_group/user_group",Vt=`${W}/update`,Bt="https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_user_group/user_group_bulk",Tt="https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_user_group/validate_upload",Rt="https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_user_group/export",Ht="https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_user_group/lookup",Y={UserGroup:"",UserGroupTo:"",Site:"",SiteTo:"",ver:"v1",Page:1,PageSize:10,Order:""},Z=Q({id:"UserGroupList",state:()=>({stateFilterData:{...Y},stateLastUsedFilterData:{...Y},statePageName:"userGroup",stateDisplayData:[],statePagination:new R,stateLoading:!1,statePaginationLoading:!1,stateMdIdOption:[],stateUserGroupOption:[],stateSiteOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,UserGroupOption:t=>t.stateUserGroupOption,siteOption:t=>t.stateSiteOption,groupMdIdOption:t=>t.stateMdIdOption},actions:{async getData(t=!0){const i={UserGroup:this.stateFilterData.UserGroup,Site:this.stateFilterData.Site,Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await $.get(W,"",new URLSearchParams(i).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const i=await $.get(Ht,"",new URLSearchParams(t).toString());this.stateUserGroupOption=it(i.data.result.content,"groupName","groupDescription"),this.stateSiteOption=wt(i.data.result.content.site)}catch(i){console.log(i)}},async export(){const t={UserGroup:this.stateFilterData.UserGroup,Site:this.stateFilterData.Site,ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await $.getBlob(Rt,"",new URLSearchParams(t).toString())).data}catch(i){console.log(i)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:i}){if(!t&&!i)this.stateFilterData.Order="";else{const e=i=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setUserGroup(t){this.stateFilterData.UserGroup=t},setUserGroupTo(t){this.stateFilterData.UserGroupTo=t},setSite(t){this.stateFilterData.Site=t},setSiteTo(t){this.stateFilterData.SiteTo=t},async resetFilter(){this.stateFilterData.UserGroup="",this.stateFilterData.Site="";const t=this.stateLastUsedFilterData.UserGroup!=="",i=this.stateLastUsedFilterData.Site!=="";(t||i)&&await this.getData()},resetState(){this.stateFilterData={...Y},this.stateDisplayData=[],this.statePagination=new R,this.stateLoading=!1,this.statePaginationLoading=!1}}}),st={userGroupId:0,groupName:"",groupDescription:"",site:"",isDeleted:!1},X=Q({id:"userGroupForm",state:()=>({stateFormData:{...st},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1,stateSiteOption:[]}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading,siteOption:t=>t.stateSiteOption},actions:{async getSiteLookup(){const t={ver:"v1"};try{const i=await $.get(Et,"",new URLSearchParams(t).toString());this.stateSiteOption=it(i.data.result.content,"siteId","siteDescription")}catch(i){console.log(i)}},async insertData(t){try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"},e=await $.post(`${W}?${new URLSearchParams(i).toString()}`,this.stateFormData);e.data.title==="Error"?(this.stateErrors.push(e.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t,i=!1){try{this.stateLoading=!0;const e={userAccount:t,ver:"v1"};i&&(this.stateFormData.isDeleted=!0);const g=await $.post(`${Vt}?${new URLSearchParams(e).toString()}`,this.stateFormData);g.data.title==="Error"?(this.stateErrors.push(g.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(e){this.stateErrors.push(e.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.userGroupId=t.UserGroupId||0,this.stateFormData.groupName=t.GroupName||"",this.stateFormData.groupDescription=t.GroupDescription||"",this.stateFormData.site=t.Site||""},resetState(){this.stateFormData={...st},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),zt={key:0,style:{height:"100px"}},Mt={class:"row justify-content-center"},qt=["onClick"],jt=["onClick"],Kt=N({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:i}){const e=t,g=Z(),s=X(),n=z(),f=i,p=Ct(()=>(e.page-1)*10+1),v=V(""),P=D=>{v.value=D.order;const c={prop:D.prop,order:D.order};g.setSort(c)},S=(D,c,_)=>Pt(D[_],c[_],v.value),U=D=>{s.setFormData(D),f("show-dialog",null)},y=D=>{B("Are you sure to delete?","Confirm").then(async c=>{c.isConfirmed&&(s.setFormData(D),s.updateData(n.user.Name,!0).then(()=>{s.resetState(),s.isError||M("Data has been successfully deleted!","Ok").then(()=>{g.getData()})}))})};return(D,c)=>{const _=G("inline-svg"),l=G("el-tooltip"),u=q("loading");return r(g).loading?A((E(),nt("div",zt,null,512)),[[u,r(g).loading]]):A((E(),C(r(rt),{key:1,data:e.listData,style:{width:"100%"},onSortChange:P,"empty-text":"No Data"},{default:d(()=>[o(r(w),{label:"No",width:"90",align:"center"},{default:d(a=>[m("span",null,J(r(p)+a.$index),1)]),_:1}),o(r(w),{prop:"GroupName",label:"Group Name",width:"200",sortable:"","sort-method":(a,h)=>S(a,h,"GroupName")},null,8,["sort-method"]),o(r(w),{prop:"GroupDescription",label:"Group Desc.","min-width":"200",sortable:"","sort-method":(a,h)=>S(a,h,"GroupDescription")},null,8,["sort-method"]),o(r(w),{prop:"Site",label:"Site",sortable:"","sort-method":(a,h)=>S(a,h,"Site")},null,8,["sort-method"]),o(r(w),{prop:"ChangedOn",label:"Changed on",align:"center",width:"150",sortable:""},{default:d(a=>[m("span",null,J(r(bt)(a.row.ChangedOn)),1)]),_:1}),o(r(w),{prop:"ChangedBy",label:"Changed by",sortable:"",width:"300","sort-method":(a,h)=>S(a,h,"ChangedBy")},null,8,["sort-method"]),o(r(w),{label:"",width:"180"},{default:d(a=>[m("div",Mt,[o(l,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:d(()=>[m("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:h=>U(a.row)},[o(_,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,qt)]),_:2},1024),o(l,{class:"box-item",effect:"dark",content:"Delete",placement:"top"},{default:d(()=>[m("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:h=>y(a.row)},[o(_,{src:"/media/svg/tables/rows/trash-delete-blue.svg",width:"12",height:"12"})],8,jt)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[u,r(g).loading]])}}}),Xt={class:"dialog-footer"},Yt=N({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=t,g=i,s=X(),n=z(),f=j(e,"visibility"),p=F(()=>s.formData),v=F(()=>s.errors),P=F(()=>s.isError),S=ut().shape({groupName:O().required("Group Name is mandatory"),groupDescription:O().required("Group Description is mandatory"),site:O().required("Site is mandatory")}),U=()=>{D(""),c(""),_("")},y=(a=!1)=>{u(),U(),g("handle-close",a)},D=a=>{p.value.groupName=a},c=a=>{p.value.groupDescription=a},_=a=>{p.value.site=a},l=async()=>{u(),await S.validate(p.value,{abortEarly:!1}).catch(a=>{s.setErrors(a.errors)}),!P.value&&B("Are you sure you want to submit ?").then(async a=>{a.isConfirmed&&s.insertData(n.user.Name).then(()=>{s.isError||M("Form has been successfully submitted!","Ok").then(()=>{y(!0)})})})},u=()=>{s.setErrors([])};return(a,h)=>{const I=G("el-button"),L=G("el-dialog"),b=q("loading");return A((E(),C(L,{modelValue:f.value,"onUpdate:modelValue":h[0]||(h[0]=x=>f.value=x),title:"New Data",width:"40%",onClose:h[1]||(h[1]=x=>y())},{footer:d(()=>[m("span",Xt,[o(I,{type:"primary",onClick:l,disabled:r(s).loading},{default:d(()=>[k("Submit")]),_:1},8,["disabled"]),o(I,{type:"secondary",onClick:y,disabled:r(s).loading},{default:d(()=>[k("Close")]),_:1},8,["disabled"])])]),default:d(()=>[o(lt,{name:"fade"},{default:d(()=>[P.value?(E(),C(pt,{key:0,errorMessages:v.value,onResetForm:u},null,8,["errorMessages"])):K("",!0)]),_:1}),A((E(),C(r(dt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:d(()=>[o(H,{value:p.value.groupName,margin:!1,placeholder:"Add Group Name",label:"Group Name",name:"groupName",max:100,onHandleChange:D},null,8,["value"]),o(H,{value:p.value.groupDescription,placeholder:"Add Group Description",label:"Group Desc.",name:"groupDescription",max:40,onHandleChange:c},null,8,["value"]),o(ct,{value:p.value.site,margin:!1,placeholder:"Add Site",label:"Site",name:"site",max:4,onHandleChange:_,options:r(s).siteOption},null,8,["value","options"])]),_:1})),[[b,r(s).loading]])]),_:1},8,["modelValue"])),[[b,r(s).loading]])}}}),Jt={class:"dialog-footer"},Qt=N({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=t,g=i,s=X(),n=z(),f=j(e,"visibility"),p=F(()=>s.formData),v=F(()=>s.errors),P=F(()=>s.isError),S=ut().shape({groupName:O().required("Group Name is mandatory"),groupDescription:O().required("Group Description is mandatory"),site:O().required("Site is mandatory")}),U=()=>{p.value.userGroupId=0,D(""),c(""),_("")},y=(a=!1)=>{U(),s.resetState(),u(),g("handle-close",a)},D=a=>{p.value.groupName=a},c=a=>{p.value.groupDescription=a},_=a=>{p.value.site=a},l=async()=>{u(),await S.validate(p.value,{abortEarly:!1}).catch(a=>{s.setErrors(a.errors)}),!P.value&&B("Are you sure you want to submit ?").then(async a=>{a.isConfirmed&&s.updateData(n.user.Name).then(()=>{s.isError||M("Form has been successfully submitted!","Ok").then(()=>{y(!0)})})})},u=()=>{s.setErrors([])};return(a,h)=>{const I=G("el-button"),L=G("el-dialog"),b=q("loading");return A((E(),C(L,{modelValue:f.value,"onUpdate:modelValue":h[0]||(h[0]=x=>f.value=x),title:"Update Data",width:"40%",onClose:h[1]||(h[1]=x=>y())},{footer:d(()=>[m("span",Jt,[o(I,{type:"primary",onClick:l,disabled:r(s).loading},{default:d(()=>[k("Submit")]),_:1},8,["disabled"]),o(I,{type:"secondary",onClick:y,disabled:r(s).loading},{default:d(()=>[k("Close")]),_:1},8,["disabled"])])]),default:d(()=>[o(lt,{name:"fade"},{default:d(()=>[P.value?(E(),C(pt,{key:0,errorMessages:v.value,onResetForm:u},null,8,["errorMessages"])):K("",!0)]),_:1}),o(r(dt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:d(()=>[o(H,{value:p.value.groupName,margin:!1,placeholder:"Add Group Name",label:"Group Name",name:"groupName",max:100,onHandleChange:D},null,8,["value"]),o(H,{value:p.value.groupDescription,placeholder:"Add Group Description",label:"Group Desc.",name:"groupDescription",max:40,onHandleChange:c},null,8,["value"]),o(ct,{value:p.value.site,margin:!1,placeholder:"Add Site",label:"Site",name:"site",max:4,onHandleChange:_,options:r(s).siteOption},null,8,["value","options"])]),_:1})]),_:1},8,["modelValue"])),[[b,r(s).loading]])}}}),tt=Q({id:"userGroupBulk",state:()=>({statePagination:new R,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const i={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const e=await $.post(`${Bt}?${new URLSearchParams(i).toString()}`,this.stateBulkData);this.stateError=e.data.result.isError?e.data.result.message:"",this.stateIsError=e.data.result.isError}catch(e){console.log(e)}this.stateLoading=!1},async upload({userAccount:t,excelFile:i}){const e={userAccount:t,ver:"v1"},g=`${Tt}?${new URLSearchParams(e).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const s=await $.postImages(g,i);s.data.statusCode==200?s.data.result.isError?(this.stateIsError=!0,this.stateError=s.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=s.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=xt.some(this.stateValidatedData,{IsValid:!1}),this.setPage(1)):(this.stateIsError=s.data.result.isError,this.stateError=s.data.result.message)}catch(s){console.log(s),this.stateIsError=!0,this.stateError=s.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(Ut(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new R,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),Wt={class:"icon"},Zt=N({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const i=t,e=tt(),g=F(()=>(i.page-1)*10+1),s=n=>{const f={prop:n.prop,order:n.order};e.setSort(f)};return(n,f)=>{const p=G("inline-svg");return E(),C(r(rt),{data:i.listData,style:{width:"100%"},onSortChange:s,"empty-text":"No Data"},{default:d(()=>[o(r(w),{label:"No",width:"60",align:"center"},{default:d(v=>[m("span",null,J(g.value+v.$index),1)]),_:1}),o(r(w),{prop:"GroupName",label:"Group Name",sortable:""}),o(r(w),{prop:"GroupDescription",label:"Group Desc.",sortable:""}),o(r(w),{prop:"Site",label:"Site",sortable:""}),o(r(w),{prop:"ValidationReason",label:"Remark","min-width":"300",sortable:""}),o(r(w),{prop:"IsValid",label:"Status",width:"100",sortable:""},{default:d(v=>[m("div",Wt,[o(p,{src:v.row.IsValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),et=t=>(kt("data-v-1b208382"),t=t(),Gt(),t),te=et(()=>m("div",{class:"text-center"},null,-1)),ee=et(()=>m("div",{class:"mb-3"},[m("span",null,[k(" Download template "),m("a",{href:"documents/MasterDataUserGroup.xlsx",target:"_blank",id:"link-download"},"here"),k(" before uploading file ")])],-1)),ae=et(()=>m("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[m("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),se={class:"card"},oe={class:"card-body grid-padding"},re={class:"dialog-footer"},ie=N({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:i}){const e=t,g=i,s=z(),n=tt(),f=j(e,"visibility"),p=()=>{const l=Nt(n.validatedData,u=>{const a=u;return{userGroupId:0,groupName:a.GroupName,groupDescription:a.GroupDescription,site:a.Site}});return Object.values(l)},v=()=>{const l=document.getElementById("link-download");l&&l.click()},P=()=>{n.validatedData.length>0?B("Cancel Upload Data?","Confirm").then(u=>{u.isConfirmed&&U()}):U()},S=async l=>{await n.upload({userAccount:s.user.Name,excelFile:l}),n.stateError&&T(n.error)},U=(l=!1)=>{n.resetState(),g("handle-close",l)},y=l=>{n.setIsUploadedState(l)},D=l=>{n.setPage(l)},c=()=>{if(n.validatedData.length<1){v();return}const l=["Group Name","Group Description","Site","Remark","Status"],u=n.validatedData.map(a=>({GroupName:a.GroupName,GroupDescription:a.GroupDescription,Site:a.Site,remark:a.ValidationReason,status:a.IsValid?"OK":"Error"}));_t("Master User Group",l,u)},_=async()=>{if(n.displayData.length<1){T("There is no data to submit");return}if(n.isError){T("There is still invalid row(s)");return}B("Are you sure you want to submit ?").then(async l=>{if(l.isConfirmed){const u=p();if(n.setBulkData(u),await n.bulkInsert(s.user.Name),n.isError){T(n.stateError);return}M("Form has been successfully submitted!","Ok").then(()=>{U(!0)})}})};return(l,u)=>{const a=G("el-button"),h=G("el-dialog"),I=q("loading");return E(),C(h,{title:"Upload Bulk Data",modelValue:f.value,"onUpdate:modelValue":u[1]||(u[1]=L=>f.value=L),"before-close":P,width:"70%","custom-class":"upload-modal"},{footer:d(()=>[m("div",null,[m("span",re,[o(a,{type:"success",onClick:c},{default:d(()=>[k("Download")]),_:1}),o(a,{type:"primary",onClick:_},{default:d(()=>[k("Upload")]),_:1}),o(a,{type:"success",onClick:P},{default:d(()=>[k("Cancel")]),_:1})])])]),default:d(()=>[te,ee,A(o($t,{isSubmissionUploadSuccess:r(n).isUploaded,onHandleCloseUploadedFile:P,onHandleUpload:S,onHandleSetIsExcelFileUploaded:y},null,8,["isSubmissionUploadSuccess"]),[[I,r(n).uploadLoading]]),ae,m("div",se,[m("div",oe,[o(Zt,{"list-data":r(n).displayData,page:r(n).pagination.currentPage},null,8,["list-data","page"])])]),r(n).displayData.length>0?(E(),C(ot,{key:0,onRaisePageChange:u[0]||(u[0]=L=>D(L)),currentPage:r(n).pagination.currentPage,totalPage:r(n).pagination.totalPage,totalPageSize:r(n).pagination.totalPageSize,startPaginationIndex:r(n).pagination.startPaginationIndex,endPaginationIndex:r(n).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):K("",!0)]),_:1},8,["modelValue"])}}}),ne=Ot(ie,[["__scopeId","data-v-1b208382"]]),le={class:"row g-9 my-4"},de={class:"dialog-footer"},ue=N({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=Z(),g=t,s=i,n=j(g,"visibility"),f=F(()=>e.filterData),p=()=>{v(),e.resetFilter()},v=()=>{s("handle-close",!1)},P=c=>{e.setUserGroup(c)},S=c=>{e.setUserGroupTo(c)},U=c=>{e.setSite(c)},y=c=>{e.setSiteTo(c)},D=()=>{const c=e.lastUsedFilterData.UserGroup!==e.filterData.UserGroup,_=e.lastUsedFilterData.UserGroupTo!==e.filterData.UserGroupTo,l=e.lastUsedFilterData.Site!==e.filterData.SiteTo,u=e.lastUsedFilterData.SiteTo!==e.filterData.SiteTo;s("handle-close",c||_||l||u)};return(c,_)=>{const l=G("el-button"),u=G("el-dialog");return E(),C(u,{modelValue:n.value,"onUpdate:modelValue":_[0]||(_[0]=a=>n.value=a),title:"Filter",width:"60%",onClose:_[1]||(_[1]=a=>v())},{footer:d(()=>[m("span",de,[o(l,{type:"secondary",onClick:p},{default:d(()=>[k("Reset")]),_:1}),o(l,{type:"primary",onClick:D},{default:d(()=>[k("Filter")]),_:1})])]),default:d(()=>[m("div",le,[o(at,{"value-from":f.value.UserGroup,"value-to":f.value.UserGroupTo,label:"User Group",name:"UserGroup",options:r(e).UserGroupOption,onHandleChangeFrom:P,onHandleChangeTo:S},null,8,["value-from","value-to","options"]),o(at,{"value-from":f.value.Site,"value-to":f.value.SiteTo,label:"Site",name:"Site",options:r(e).siteOption,onHandleChangeFrom:U,onHandleChangeTo:y},null,8,["value-from","value-to","options"])])]),_:1},8,["modelValue"])}}}),pe={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},ce=m("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),me={class:"d-flex justify-content-between align-items-center"},ge={class:"card"},he={class:"card-body grid-padding"},fe={class:"my-5"},ya=N({__name:"Index",setup(t){const i=gt(),e=Z(),g=X(),s=tt(),n=V(!1),f=V(!1),p=V(!1),v=V(!1),P=F(()=>e.displayData),S=F(()=>e.pagination),U=b=>{e.setPage(b)};Ft(async()=>{i.dispatch(ft.ACTIVE_PAGE,"IronLake"),ht("User Group",[{pageName:"Ironlake",pageRoute:"ironlake"},{pageName:"Role Management",pageRoute:"ironlake-rolemanagement-usergroup"},{pageName:"User Group",pageRoute:"ironlake-rolemanagement-usergroup"}]),e.setPage(1),await e.getLookup(),await g.getSiteLookup()}),It(async()=>{e.resetState(),g.resetState(),s.resetState()});const y=async()=>{await e.setPage(1),await e.getLookup(),await g.getSiteLookup()},D=()=>{n.value=!0},c=async b=>{n.value=!1,b&&await y()},_=()=>{f.value=!0},l=async b=>{f.value=!1,b&&await y()},u=()=>{p.value=!0},a=async b=>{p.value=!1,b&&await y()},h=async()=>{const b=await e.export();At.saveAs(new Blob([b],{type:"application/octet-stream"}),"UserGroup.xlsx")},I=()=>{v.value=!0},L=async b=>{v.value=!1,b&&await y()};return(b,x)=>(E(),nt(Lt,null,[m("div",pe,[ce,m("div",me,[o(vt,{onShowDialog:D}),o(Dt,{onShowDialog:u}),o(yt,{onHandleDownload:h}),o(St,{onShowDialog:I})])]),m("div",ge,[m("div",he,[o(Kt,{"list-data":P.value,page:S.value.currentPage,onShowDialog:_},null,8,["list-data","page"])])]),m("div",fe,[r(e).paginationLoading?K("",!0):(E(),C(ot,{key:0,onRaisePageChange:x[0]||(x[0]=mt=>U(mt)),currentPage:S.value.currentPage,totalPage:S.value.totalPage,totalPageSize:S.value.totalPageSize,startPaginationIndex:S.value.startPaginationIndex,endPaginationIndex:S.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),o(Yt,{visibility:n.value,onHandleClose:c},null,8,["visibility"]),o(Qt,{visibility:f.value,onHandleClose:l},null,8,["visibility"]),o(ue,{visibility:p.value,onHandleClose:a},null,8,["visibility"]),o(ne,{visibility:v.value,onHandleClose:L},null,8,["visibility"])],64))}});export{ya as default};

import{_ as J}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{c as K}from"./index-BuVmIl8K.js";import{_ as X}from"./FullScreenDialog.vue_vue_type_style_index_0_lang-DXRDt27h.js";import{a as Z}from"./@vueuse-DFoNmIyu.js";import{k as ee,r as i,a0 as te,c as ae,R as x,p as v,aa as y,s as f,x as g,aB as a,q as L,A as _,F as le,bd as oe,bb as se}from"./@vue-BypzYtbH.js";import{_ as ie}from"./nw-img-vue-CR837WER.js";const C=d=>(oe("data-v-068512db"),d=d(),se(),d),ne=C(()=>a("span",{class:"el-dialog__title",style:{"word-break":"break-word !important","font-size":"18px !important"}},"Detailed picture of Cab Side & Off Cab Side",-1)),re={class:"row d-flex flex-column"},ce={key:0,class:"photo-wrapper"},ue=C(()=>a("span",{class:"sub-title"},[a("strong",null,"Cab Side")],-1)),de={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center"}},me={class:"d-flex justify-content-center"},ve={style:{position:"relative",width:"fit-content"}},fe=["src"],pe=C(()=>a("div",{class:"my-2"},null,-1)),ge={key:1,class:"photo-wrapper"},_e=C(()=>a("span",{class:"sub-title"},[a("strong",null,"Off Cab Side")],-1)),ye={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center",position:"relative"}},be={class:"d-flex justify-content-center"},he={style:{position:"relative",width:"fit-content"}},we=["src"],ke=ee({__name:"ImagePreviewCabSide",props:{visibility:{type:Boolean,required:!1},images:{type:Array,required:!0},viewOnly:{type:Boolean,default:!0}},emits:["onClose","onDelete"],setup(d,{expose:j,emit:D}){const r=d,O=D,b=i([]),I=te(r,"visibility"),A=i(0),S=i(!1),B=i(!1),N=Z("(min-width: 1000px)"),F=i(!1),R=i(""),h=i(!1),p=i(),l=i(),o=i(),c=i([]),E=ae(()=>N.value?"70%":"90%"),q=async()=>{l.value=r.images.find(e=>e.type=="cab side"),l.value||(l.value=r.images.find(e=>!e.type)),l.value&&await H(l.value.filename)},z=async()=>{o.value=r.images.find(e=>e.type=="off cab side"),!o.value&&r.images.length>0&&(o.value=r.images.find(e=>{var t;return e.filename!=((t=l.value)==null?void 0:t.filename)})),o.value&&await Q(o.value.filename)},w=e=>{var s;if(b.value.length<1)return;let t;do t=(s=b.value.find(n=>n.key==e))==null?void 0:s.value;while(!t);return t},G=()=>{I.value=!1,O("onClose",null)},M=()=>{c.value=r.images.map(e=>({imgBlob:e.filename,url:"",description:e.description}))},P=()=>{M(),A.value=0,b.value=[],r.images&&(q(),z())},H=async e=>{S.value=!0,await U(e),S.value=!1},Q=async e=>{B.value=!0,await U(e),B.value=!1},U=async e=>{const t={fileUrl:e,ver:"v1"};try{const s=`https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/attachment/download_by_url?${new URLSearchParams(t).toString()}`,n=await K.getBlob(s),m=new Blob([n.data]);let k=window.URL||window.webkitURL;b.value.push({key:e,value:k.createObjectURL(m)}),c.value.forEach(u=>{u.imgBlob==e&&(u.url=k.createObjectURL(m))})}catch(s){console.log("image",s)}},V=e=>{const t=c.value.findIndex(n=>n.imgBlob==e),s=c.value[t];if(t>0){const n=c.value.slice(t),m=c.value.slice(0,t);c.value=[...n,...m]}R.value=s.url,F.value=!0},T=()=>{R.value="",F.value=!1},$=e=>{h.value=!0,p.value=e},W=()=>{h.value=!1},Y=()=>{if(!p.value)return;const e={filename:p.value.filename,type:p.value.type};O("onDelete",e),p.value.type=="front"?l.value=void 0:o.value=void 0,p.value=void 0,h.value=!1};return j({openFirstReRender:()=>{P()}}),(e,t)=>{const s=x("el-skeleton-item"),n=x("NwImg"),m=x("el-skeleton"),k=x("el-dialog");return v(),y(le,null,[f(k,{modelValue:I.value,"onUpdate:modelValue":t[4]||(t[4]=u=>I.value=u),title:"Detailed picture of Cab Side & Off Cab Side",width:E.value,onOpened:P,onClose:G},{title:g(()=>[ne]),default:g(()=>[a("div",re,[l.value?(v(),y("div",ce,[ue,f(m,{loading:S.value,animated:""},{template:g(()=>[f(s,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:g(()=>[a("div",de,[a("div",me,[a("div",ve,[d.viewOnly?_("",!0):(v(),L(n,{key:0,onClick:t[0]||(t[0]=u=>$(l.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),w(l.value.filename)!=null?(v(),y("img",{key:1,src:w(l.value.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",onClick:t[1]||(t[1]=u=>V(l.value.filename)),class:"front"},null,8,fe)):_("",!0)])])])]),_:1},8,["loading"])])):_("",!0),pe,o.value?(v(),y("div",ge,[_e,f(m,{loading:B.value,animated:""},{template:g(()=>[f(s,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:g(()=>[a("div",ye,[a("div",be,[a("div",he,[d.viewOnly?_("",!0):(v(),L(n,{key:0,onClick:t[2]||(t[2]=u=>$(o.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),w(o.value.filename)!=null?(v(),y("img",{key:1,src:w(o.value.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",class:"back",onClick:t[3]||(t[3]=u=>V(o.value.filename))},null,8,we)):_("",!0)])])])]),_:1},8,["loading"])])):_("",!0)])]),_:1},8,["modelValue","width"]),f(J,{visibility:h.value,caption:"Are you sure want to delete this image?",onOnNoConfirm:W,onOnYesConfirm:Y},null,8,["visibility"]),f(X,{images:c.value,visibility:F.value,image:R.value,onHandleClose:T},null,8,["images","visibility","image"])],64)}}}),Oe=ie(ke,[["__scopeId","data-v-068512db"]]);export{Oe as I};

import{C as L}from"./Cameras-vtENZZzD.js";import{u as q}from"./useCameraStore-BwXVJhPe.js";import{D as Y,C as j,N as G}from"./DefectSMUPanel-BcV_00Q9.js";import{D as K}from"./cbm-helper-BxJZ9NTc.js";import{C as W}from"./CommentPanel-D0ptrEBp.js";import{u as z}from"./useInterimDefectsStore-DCjj_hjG.js";import{u as J}from"./useInterimDefectSheetStore-BXQL839L.js";import{e as Q}from"./lodash-DrHMlsdo.js";import{_ as X}from"./MessageBox.vue_vue_type_style_index_0_lang-DfpcTVNJ.js";import{_ as Z}from"./ErrorBox.vue_vue_type_style_index_0_lang-Bysg_zE3.js";import{a as D}from"./element-plus-BeWdvTRa.js";import{B as ee}from"./BackNavigator-DxLlvPLq.js";import{u as te,b as re}from"./useDefectsFormStore-41UTMhiG.js";import{_ as oe}from"./PDFViewerDialog.vue_vue_type_style_index_0_lang-GWz8s3FD.js";import{_ as C}from"./InformationPopUp.vue_vue_type_style_index_0_lang-O2xYF9Pq.js";import{N as ae}from"./NoDefect-DdL3mqty.js";import{_ as se}from"./InformationPopUpSideButton.vue_vue_type_style_index_0_lang-BO5OquVj.js";import{u as ie}from"./vue-router-iNp9kJ0K.js";import{u as ne}from"./useMonitoringListStore-AIaGTQg8.js";import{_ as pe}from"./Toast.vue_vue_type_style_index_0_lang-OOgaHWFE.js";import{v as le}from"./helpers-wUOLw-dU.js";import{A as me,N as ce}from"./number-format-BdMuQVyW.js";import{k as ue,r as i,c as m,d as fe,a7 as de,o as ve,L as he,p as g,aa as De,aB as y,s as o,u as n,q as E,A as ge,F as ye}from"./@vue-BypzYtbH.js";import"./UploadImageFailureDialog.vue_vue_type_style_index_0_lang-DVBJv3c1.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";import"./index-BuVmIl8K.js";import"./pinia-BjOS2_Ao.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./nw-img-vue-CR837WER.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./useAttachmentStore-DqM3autD.js";import"./authentication-handler-Pueb_EI7.js";import"./useGlobalConnectionStore-DV9B81de.js";import"./date-format-8-IvfSl3.js";import"./moment-C5S46NFB.js";import"./simple-vue-camera-D9MGhAeE.js";import"./vue-BzYgrL08.js";import"./PhotoDescription.vue_vue_type_style_index_0_lang-1F5CAfuD.js";import"./Textarea.vue_vue_type_style_index_0_lang-v94SEJmi.js";import"./vue-drawing-canvas-CzCJUKem.js";import"./string-to-imageinfo-converter-Cdr1iOkP.js";import"./useInterimEngineStore-Ctq4w8Oq.js";import"./urls-COjrEEs1.js";import"./urls-B0Rq9QQ3.js";import"./prev-val-handler-DvA3D_kF.js";import"./urls-CPQ2HRXU.js";import"./urls-hWHEBXep.js";import"./urls-D8F5Tyyp.js";import"./disabled-state-O9W-ZY8y.js";import"./FullScreenDialog.vue_vue_type_style_index_0_lang-DXRDt27h.js";import"./@vueuse-DFoNmIyu.js";import"./ToastWithIcon.vue_vue_type_style_index_0_lang-wfM94fOM.js";import"./IronformConfig-BWypCgSI.js";import"./manipulate-html-string-DqTEGh-F.js";import"./Check-CTArJpdm.js";import"./NAForm-BdrJ0TGj.js";import"./useMasterStore-CzSO06fn.js";import"./SMUDetailDialog-Bs-98WGo.js";import"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import"./OfflineFullScreenDialog.vue_vue_type_style_index_0_lang-C2GTRJsq.js";import"./MachineSMUEnum-CgiCo9nf.js";import"./Repair-zyV2di4A.js";import"./CrackNoClass-0DSU7BAn.js";import"./urls-CvqtYZA-.js";import"./CrackYesClass-COntz77m.js";import"./DefectNoClass-BqGKOkzR.js";import"./urls-RITu66bD.js";import"./webp-converter-browser-C3MD88Lp.js";import"./compressorjs-Cmz8Y9J9.js";import"./file-saver-CwTBvle_.js";const Se={class:"p-2 py-5 d-flex justify-content-end mt-20 border-top border-top-2"},be=["disabled"],fr=ue({__name:"Detail",setup(Ae){const S=ne(),e=z(),b=te(),t=J(),B=re(),A=q(),p=ie(),w=i(!1),f=i(!1),c=i(!1),F=m(()=>e.DefectKey),M=m(()=>{const r=e.ApprovalData.CBMHeaders.every(l=>l.plannerCbmNAStatus==="Confirmed"),a=le(e.ApprovalData.DefectNAHeaders,!0);let s=!0;return e.DefectSMUHeader&&(s=e.DefectSMUHeader.plannerStatus==="Acknowledge"),r&&a&&s}),O=m(()=>{var r;return`${(r=e.ApproveBy)==null?void 0:r.name}, ${e.ApproveDate}`}),x=m(()=>e.stateErrorByNetwork),_=m(()=>t.stateSheetAlreadyApproved);fe(()=>_.value,r=>{r&&setTimeout(()=>{t.stateSheetAlreadyApproved=!1,p.push({name:"defectsplanner"})},3e3)});const I=async()=>{c.value=!1;const r=D.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});if(await t.approveDefectSheetByPlanner(),r.close(),t.IsError){f.value=!0;return}t.reset(),c.value=!0},H=()=>{c.value=!1,k()},R=()=>{e.toggleErrorByNetwork(!1),p.push({name:"defectsplanner"})},k=()=>{w.value=!1,S.setDefaultFormTypeOpenFromApprovalPlanner("Interim Engine Service Forms"),p.push({name:"monitoringstatus"})},U=()=>{f.value=!1,t.Error!=me.INCOMPLETE_DATA&&t.Error!=ce.NO_NETWORK_VIEW&&(S.setDefaultFormTypeOpenFromApprovalPlanner("Interim Engine Service Forms"),p.push({name:"monitoringstatus"}))},d=i(null),v=i(""),u=i(!1),N=i(!1),P=r=>{N.value=r},$=i(0),T=()=>{$.value=window.scrollY},h=async()=>{const r=D.service({lock:!0,text:"Refresh Data...",background:"rgba(0, 0, 0, 0.7)"});await e.getDefectsData(t.SelectedDefectSheet.workOrder),r.close()};de(()=>{(!t.SelectedDefectSheet||Q.isEmpty(t.SelectedDefectSheet))&&p.push({name:"defectsplanner"})}),ve(async()=>{const r=D.service({lock:!0,text:"Loading Defect Data",background:"rgba(0, 0, 0, 0.7)"});if(e.DataFetched===!1){await e.getDefectsData(t.SelectedDefectSheet.workOrder);const a=t.SelectedDefectSheet.equipmentModel.split(" ")[0].split("-"),s=[...new Set(a)].join("-");b.setModelAndPsTypeId("",t.SelectedDefectSheet.psType,"",s,""),await b.getEhmsRating(),await B.getOwnershipDefectForm(t.SelectedDefectSheet.unitNumber)}try{Array.from(d.value.getElementsByClassName("show-pdf")).forEach(s=>{s.onclick=l=>{l.preventDefault(),u.value=!0,v.value=s.href}})}catch(a){console.log(a)}try{Array.from(d.value.getElementsByClassName("spv-print-pdf")).forEach(s=>{s.onclick=l=>{l.preventDefault(),u.value=!0,v.value=s.href,P(!0)}})}catch(a){console.log(a)}e.setCurrentUserGroup("Planner"),r.close()});const V=()=>{u.value=!1};return he(()=>{A.reset()}),(r,a)=>(g(),De(ye,null,[y("div",{ref_key:"defectDetailRef",ref:d},[o(ee,{title:`${n(t).SelectedDefectSheet.form}`,"component-router-push":"defectsplanner","approve-history":O.value},null,8,["title","approve-history"]),o(K),(g(),E(Y,{key:F.value,"view-only":!1,"planner-approve":!0,supervisor:!1,onOnRefreshData:h,onOnGetPositionY:T})),o(j,{headers:n(e).ApprovalData.CBMHeaders,"planner-approve":!0,onOnRefreshData:h},null,8,["headers"]),o(G,{title:"Not Applicable Item Check",headers:n(e).ApprovalData.DefectNAHeaders,"is-defect":!0,"planner-approve":!0,onOnRefreshData:h},null,8,["headers"]),o(W,{headers:n(e).Comments},null,8,["headers"]),y("div",Se,[n(e).ApprovalData.DefectNAHeaders.length==0&&n(e).ApprovalData.CBMHeaders.length==0?(g(),E(ae,{key:0,message:"Interim Engine Service sheet was completed in full and no issues were identified."})):ge("",!0),y("button",{class:"btn btn-success",style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},disabled:!M.value,onClick:I},"Approve",8,be)])],512),o(L,{visibility:n(A).isVisible},null,8,["visibility"]),o(se,{show:c.value,onClose:H,"title-pop-up":"Please ensure you generate a PDF copy of the completed IronForms service sheet and attach it to the SAP work order.",confirmLabel:"Ok"},null,8,["show"]),o(X,{show:w.value,onClose:k,message:"Data successfully approved"},null,8,["show"]),o(Z,{visibility:f.value,caption:n(t).Error,onOnClose:U},null,8,["visibility","caption"]),o(oe,{show:u.value,onHandleCloseModal:V,"blob-url":v.value},null,8,["show","blob-url"]),o(C,{show:N.value,onClose:P,"title-pop-up":"if required, see your supervisor to print this"},null,8,["show"]),o(pe,{visibility:_.value,caption:"You cannot approve this digital service sheet because another user already approved."},null,8,["visibility"]),o(C,{show:x.value,onClose:R,"title-pop-up":"No internet connection"},null,8,["show"])],64))}});export{fr as default};

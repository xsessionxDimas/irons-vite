import{u as G}from"./vuex-BbOKrtVp.js";import{a as q}from"./breadcrumb-D-Q4Tk9w.js";import{b as I,A as M}from"./index-BCnwA6yE.js";import{P as j}from"./Pagination-CVDIvnOM.js";import{F as K}from"./FilterIconButton-Bj0WTbms.js";import{D as X}from"./DownloadIconButton-CIQp-YG7.js";import{_ as L,b as Y}from"./element-plus-C5R56mia.js";import{f as P,b as J}from"./date-format-BASVuupi.js";import{P as U,d as Q}from"./table-sort-VnBD5Hfa.js";import{d as W}from"./pinia-BjOS2_Ao.js";import{m as Z,a as tt}from"./mapOption-sP4IrA4W.js";import{k as E,bL as et,r as A,u as n,y as x,p as S,aa as B,q as w,x as h,Y as at,s as l,aB as d,C,a0 as ot,c as O,R as $,B as R,a7 as it,L as st,A as nt,F as lt}from"./@vue-BypzYtbH.js";import{_ as N}from"./AutoComplete.vue_vue_type_style_index_0_lang-CRR6Z--K.js";import{_ as rt}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-DO0pIl2P.js";import{F as ct}from"./file-saver-DhbZvGod.js";import"./nw-img-vue-CR837WER.js";import"./vue-router-iNp9kJ0K.js";import"./object-path-BACu75q6.js";import"./attr-accept-BWI1aNlo.js";import"./crypto-js-BZehCumu.js";import"./cron-Ci8nYs3o.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-N3crNZ6y.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-DK0FVkv3.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./dayjs-C7SXsQPH.js";import"./lodash-Cr9vlq0V.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-xcxZ5rdH.js";import"./mitt-C1xD_ZTF.js";import"./@popperjs-WhmJkuoZ.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./vue-i18n-CE6bnohq.js";import"./@intlify-CjZh8qSI.js";import"./moment-C5S46NFB.js";const b="https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/user_login",dt=`${b}/paging`,pt=`${b}/lookup`,gt=`${b}/export`,k=W({id:"userLoginList",state:()=>({stateFilterData:{EmployeeId:"",Section:"",LogOnDate:"",EmployeeIdTo:"",SectionTo:"",LogOnDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},stateLastUsedFilterData:{EmployeeId:"",Section:"",LogOnDate:"",EmployeeIdTo:"",SectionTo:"",LogOnDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},statePageName:"userLogin",stateDisplayData:[],statePagination:new U,stateLoading:!1,statePaginationLoading:!1,stateEmployeeIdOption:[],stateSectionOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,employeeIdOption:t=>t.stateEmployeeIdOption,sectionOption:t=>t.stateSectionOption},actions:{async getData(t=!0){const a={EmployeeId:this.stateFilterData.EmployeeId,Section:this.stateFilterData.Section,LogOnDate:this.stateFilterData.LogOnDate?P(this.stateFilterData.LogOnDate):"",EmployeeIdTo:this.stateFilterData.EmployeeIdTo,SectionTo:this.stateFilterData.SectionTo,LogOnDateTo:this.stateFilterData.LogOnDateTo?P(this.stateFilterData.LogOnDateTo):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t?this.stateLoading=!0:this.stateDisplayData=[];const e=await I.get(dt,"",new URLSearchParams(a).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const a=await I.get(pt,"",new URLSearchParams(t).toString());this.stateEmployeeIdOption=Z(a.data.result.content,"employeeId","employeeName"),this.stateSectionOption=tt(a.data.result.content.section)}catch(a){console.log(a)}},async export(){const t={EmployeeId:this.stateFilterData.EmployeeId,Section:this.stateFilterData.Section,LogOnDate:this.stateFilterData.LogOnDate?P(this.stateFilterData.LogOnDate):"",EmployeeIdTo:this.stateFilterData.EmployeeIdTo,SectionTo:this.stateFilterData.SectionTo,LogOnDateTo:this.stateFilterData.LogOnDateTo?P(this.stateFilterData.LogOnDateTo):"",ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await I.getBlob(gt,"",new URLSearchParams(t).toString())).data}catch(a){console.log(a)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:a}){if(!t&&!a)this.stateFilterData.Order="";else{const e=a=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setEmployeeId(t){this.stateFilterData.EmployeeId=t},setSection(t){this.stateFilterData.Section=t},setLogOnDate(t){this.stateFilterData.LogOnDate=t},setEmployeeIdTo(t){this.stateFilterData.EmployeeIdTo=t},setSectionTo(t){this.stateFilterData.SectionTo=t},setLogOnDateTo(t){this.stateFilterData.LogOnDateTo=t},async resetFilter(){this.stateFilterData.EmployeeId="",this.stateFilterData.Section="",this.stateFilterData.LogOnDate="",this.stateFilterData.EmployeeIdTo="",this.stateFilterData.SectionTo="",this.stateFilterData.LogOnDateTo="";const t=this.stateLastUsedFilterData.EmployeeId!=="",a=this.stateLastUsedFilterData.Section!=="",e=this.stateLastUsedFilterData.LogOnDate!=="",g=this.stateLastUsedFilterData.EmployeeIdTo!=="",m=this.stateLastUsedFilterData.SectionTo!=="",r=this.stateLastUsedFilterData.LogOnDateTo!=="";(t||a||e||g||m||r)&&await this.getData()},resetState(){this.stateFilterData={EmployeeId:"",Section:"",LogOnDate:"",EmployeeIdTo:"",SectionTo:"",LogOnDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},this.stateDisplayData=[],this.statePagination=new U,this.stateLoading=!1,this.statePaginationLoading=!1}}}),mt={key:0,style:{height:"100px"}},Dt=E({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const a=t,e=k(),g=et(()=>(a.page-1)*10+1),m=A(""),r=p=>{m.value=p.order;const D={prop:p.prop,order:p.order};e.setSort(D)},c=(p,D,u)=>Q(p[u],D[u],m.value);return(p,D)=>{const u=at("loading");return n(e).loading?x((S(),B("div",mt,null,512)),[[u,n(e).loading]]):x((S(),w(n(Y),{key:1,data:a.listData,style:{width:"100%"},onSortChange:r,"empty-text":"No Data"},{default:h(()=>[l(n(L),{label:"No",width:"90",align:"center"},{default:h(i=>[d("span",null,C(n(g)+i.$index),1)]),_:1}),l(n(L),{prop:"EmployeeId",label:"Employee Id",sortable:"","sort-method":(i,o)=>c(i,o,"EmployeeId")},null,8,["sort-method"]),l(n(L),{prop:"EmployeeName",label:"Name",sortable:"","sort-method":(i,o)=>c(i,o,"EmployeeName")},null,8,["sort-method"]),l(n(L),{prop:"Section",label:"Section",sortable:"","sort-method":(i,o)=>c(i,o,"Section")},null,8,["sort-method"]),l(n(L),{prop:"LoginDate",label:"Login Date",sortable:"","sort-method":(i,o)=>c(i,o,"LoginDate")},{default:h(i=>[d("span",null,C(n(J)(i.row.LoginDate)),1)]),_:1},8,["sort-method"])]),_:1},8,["data"])),[[u,n(e).loading]])}}}),ut={class:"row g-9 my-4"},ht={class:"w-100 fv-row fv-plugins-icon-container"},yt={class:"w-100 fv-row fv-plugins-icon-container"},Lt={class:"w-100 fv-row fv-plugins-icon-container"},St={class:"dialog-footer"},ft=E({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:a}){const e=k(),g=t,m=a,r=ot(g,"visibility"),c=O(()=>e.filterData),p=()=>{D(),e.resetFilter()},D=()=>{m("handle-close",!1)},u=s=>{e.setEmployeeId(s)},i=s=>{e.setSection(s)},o=s=>{e.setLogOnDate(s)},f=s=>{e.setEmployeeIdTo(s)},_=s=>{e.setSectionTo(s)},V=s=>{e.setLogOnDateTo(s)},z=()=>{const s=e.lastUsedFilterData.EmployeeId!==e.filterData.EmployeeId,y=e.lastUsedFilterData.Section!==e.filterData.Section,v=e.lastUsedFilterData.LogOnDate!==e.filterData.LogOnDate,T=e.lastUsedFilterData.EmployeeIdTo!==e.filterData.EmployeeIdTo,F=e.lastUsedFilterData.SectionTo!==e.filterData.SectionTo,H=e.lastUsedFilterData.LogOnDateTo!==e.filterData.LogOnDateTo;m("handle-close",s||y||v||T||F||H)};return(s,y)=>{const v=$("el-button"),T=$("el-dialog");return S(),w(T,{modelValue:r.value,"onUpdate:modelValue":y[0]||(y[0]=F=>r.value=F),title:"Filter",width:"50%",onClose:y[1]||(y[1]=F=>D())},{footer:h(()=>[d("span",St,[l(v,{type:"secondary",onClick:p},{default:h(()=>[R("Reset")]),_:1}),l(v,{type:"primary",onClick:z},{default:h(()=>[R("Filter")]),_:1})])]),default:h(()=>[d("div",ut,[d("div",ht,[l(N,{"value-from":c.value.EmployeeId,"value-to":c.value.EmployeeIdTo,label:"Employee Id",options:n(e).employeeIdOption,onHandleChangeFrom:u,onHandleChangeTo:f},null,8,["value-from","value-to","options"])]),d("div",yt,[l(N,{"value-from":c.value.Section,"value-to":c.value.SectionTo,label:"Section",options:n(e).sectionOption,onHandleChangeFrom:i,onHandleChangeTo:_},null,8,["value-from","value-to","options"])]),d("div",Lt,[l(rt,{"value-from":c.value.LogOnDate,"value-to":c.value.LogOnDateTo,placeholder:"Select Login Date",label:"Login Date To",onHandleChangeFrom:o,onHandleChangeTo:V},null,8,["value-from","value-to"])])])]),_:1},8,["modelValue"])}}}),vt={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},Ft=d("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),Pt={class:"d-flex justify-content-between align-items-center"},_t={class:"card"},Tt={class:"card-body grid-padding"},It={class:"my-5"},ye=E({__name:"Index",setup(t){const a=G(),e=k(),g=A(!1),m=O(()=>e.displayData),r=O(()=>e.pagination),c=o=>{e.setPage(o)};it(async()=>{a.dispatch(M.ACTIVE_PAGE,"IronLake"),q("User Login",[{pageName:"Ironlake",pageRoute:"ironlake"},{pageName:"Role Management",pageRoute:"ironlake-rolemanagement-userlogin"},{pageName:"User Login",pageRoute:"ironlake-rolemanagement-userlogin"}]),e.setPage(1),await e.getLookup()}),st(async()=>{e.resetState()});const p=async()=>{await e.setPage(1),await e.getLookup()},D=()=>{g.value=!0},u=async o=>{g.value=!1,o&&await p()},i=async()=>{const o=await e.export();ct.saveAs(new Blob([o],{type:"application/octet-stream"}),"User Login.xlsx")};return(o,f)=>(S(),B(lt,null,[d("div",vt,[Ft,d("div",Pt,[l(K,{onShowDialog:D}),l(X,{onHandleDownload:i})])]),d("div",_t,[d("div",Tt,[l(Dt,{"list-data":m.value,page:r.value.currentPage},null,8,["list-data","page"])])]),d("div",It,[n(e).paginationLoading?nt("",!0):(S(),w(j,{key:0,onRaisePageChange:f[0]||(f[0]=_=>c(_)),currentPage:r.value.currentPage,totalPage:r.value.totalPage,totalPageSize:r.value.totalPageSize,startPaginationIndex:r.value.startPaginationIndex,endPaginationIndex:r.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),l(ft,{visibility:g.value,onHandleClose:u},null,8,["visibility"])],64))}});export{ye as default};

import{u as te,a as oe,b as ne}from"./index-BCnwA6yE.js";import{e as B}from"./lodash-Cr9vlq0V.js";import{s as se,n as ae}from"./date-format-BASVuupi.js";import{b as re,u as ie}from"./vue-router-iNp9kJ0K.js";import{c as le,a as ce}from"./get-user-info-ClQf79xP.js";import{u as ue}from"./useSyncStore-DsLBNjEA.js";import{d as me}from"./cron-Ci8nYs3o.js";import{u as de}from"./useMsal-BbsBYoof.js";import{i as I,r as F}from"./internet-connection-B91-AJht.js";import{k as pe,r as p,c as r,d as L,a7 as ve,o as _e,p as i,aa as u,aB as t,A as N,s as m,x,q as P,b6 as fe,F as U,R as l,C as d,u as A,$ as he,b4 as ge,bd as be,bb as we}from"./@vue-BypzYtbH.js";import{_ as xe}from"./nw-img-vue-CR837WER.js";import"./vuex-BbOKrtVp.js";import"./object-path-BACu75q6.js";import"./attr-accept-BWI1aNlo.js";import"./pinia-BjOS2_Ao.js";import"./crypto-js-BZehCumu.js";import"./dexie-CWyjz2Lo.js";import"./element-plus-C5R56mia.js";import"./dayjs-C7SXsQPH.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-xcxZ5rdH.js";import"./mitt-C1xD_ZTF.js";import"./@popperjs-WhmJkuoZ.js";import"./async-validator-DK9uouaC.js";import"./axios-N3crNZ6y.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-DK0FVkv3.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./luxon-C_T8jI2d.js";import"./moment-C5S46NFB.js";import"./index-CLJyswLZ.js";import"./@vueuse-MfruhCTE.js";const ye="/media/BUMA-Australia-drone-footage-onl.mp4",ke=v=>(be("data-v-a8185ccd"),v=v(),we(),v),Se={class:"background-wrapper"},Me={key:0,class:"background-img",autoplay:"",loop:"",muted:"",descriptions:"background video"},Ie=ke(()=>t("source",{src:ye,type:"video/mp4"},null,-1)),Ne=[Ie],Pe={class:"ironportal-logo top-menu-item"},Ae={class:"ironportal-logo top-menu-item"},De={class:"top-menu-item d-flex justify-content-end align-items-center"},Ce={id:"user-menu"},Re={class:"px-md-10 px-sm-5 d-flex align-items-center",style:{width:"max-content","justify-content":"normal",height:"60px"}},$e={key:0,class:"symbol symbol-circle"},Te=["src"],je={key:1,class:"symbol avatar-card symbol-circle firstname-placeholder text-center d-flex flex-row justify-content-center align-items-center py-5"},ze={class:"d-flex flex-column ms-3"},Be={class:"d-flex align-items-center text-white wrap name-container justify-content-between text-medium fw-600"},Fe={class:"text-elipsis text-green text-normal fw-500",style:{"text-align":"left",width:"max-content"}},Le={class:"w-100 top-menu-time"},Ue={class:"text-green fw-500 text-normal"},Je={class:"text-white fw-400 text-normal"},Oe={class:"d-flex"},Ee=["src"],Ve=pe({__name:"IronPortalLayout",setup(v){const y=re(),k=ie(),s=te(),D=["ironportaldashboard"],S=p(0),_=oe();p("");const f=p(""),h=p(""),C=r(()=>s.userPic),c=p(!1),{instance:g}=de(),b=r(()=>{const e=y.path.split("/");return`/${e[1]}/${e[2]}`}),J=["CBM Compliance Report","Summary Intervention","Detail Information","Revise and Overwrite Authority"],O=r(()=>{if(B.isFunction(_.menu.getAllProductMenu)){const o=_.menu.getAllProductMenu("IronPortal").find(n=>n.MenuName.includes("/ironportal-dashboard"));if(o)return _.menu.getAllFeatureMenu(o.MenuId).filter(M=>J.indexOf(M.PageName)<0)}return[]}),E=e=>{e==b.value?S.value++:(k.push({path:e}),S.value=0)},V=r(()=>B.isUndefined(s.user.Name)?"":s.user.Name[0]),W=r(()=>{var o;return typeof((o=s.user)==null?void 0:o.Name)!=="undefined"?s.user.Name:""}),q=r(()=>s.loggedIn),R=r(()=>y.name),Y=r(()=>y.path),$=async()=>{const e="https://digital-bumaau-dev-apm-001.azure-api.net/ehms/api/master_week",o={ver:"v1"};try{const n=await ne.get(e,"week_number",new URLSearchParams(o).toString());f.value=n.data.result.content.weekNumber,h.value=n.data.result.content.date}catch(n){console.log(n)}},T=()=>{const e=new Date,o=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24,0,1,0)-e;console.log(o),setTimeout(async()=>{T(),await $()},o)},G=()=>{k.push({name:"mydashboard"})},j=ue(),w=r(()=>j.jobRenewToken),H=()=>{if(!(w.value&&w.value.running))if(w.value)w.value.start();else{const e=new me.CronJob("*/10 * * * *",async function(){F(g)},null,!0);j.setJobRenewTokenRunning(e)}};return L(Y,e=>{_.authPage(e)||k.push({name:"401"})}),ve(async()=>{T(),await le(g),await ce(!I(),g),await $(),s.userPic==""&&await s.setUserProfilePic(!I())}),_e(()=>{I()||H()}),L(q,e=>{e||F(g)}),(e,o)=>{const n=l("el-image"),M=l("inline-svg"),K=l("el-tooltip"),Q=l("el-divider"),z=l("el-menu"),X=l("router-view"),Z=l("el-menu-item");return i(),u(U,null,[t("div",Se,[D.includes(R.value)?(i(),u("video",Me,Ne)):N("",!0)]),m(z,{mode:"horizontal","background-color":"#2d2b39",ellipsis:!1,class:"ironportal-top-menu d-flex align-items-center justify-content-between"},{default:x(()=>[t("div",Pe,[t("a",{href:"javascript:void(0)",onClick:o[0]||(o[0]=a=>G())},[m(n,{style:{height:"40px"},class:"px-md-10 px-sm-2",src:"/media/logos/logo-whitebg.png",alt:"BUMA AU logo"})])]),t("div",Ae,[m(n,{style:{height:"50px",margin:"0 auto"},src:"/media/logos/iron-portal/ironportal-white.png",alt:"IronPortal logo"})]),t("div",De,[m(K,{class:"box-item",effect:"dark",content:`${c.value?"Shrink":"Expand"} dashboard`,placement:"bottom"},{default:x(()=>[t("button",{class:"btn btn-circle btn-icon btn-bg-dark me-1",onClick:o[1]||(o[1]=a=>c.value=!c.value)},[m(M,{src:`media/svg/buttons/${c.value?"minimize":"maximize"}.svg`,style:{fill:"white"},width:"20",height:"20"},null,8,["src"])])]),_:1},8,["content"]),t("div",Ce,[t("div",Re,[C.value!=""?(i(),u("div",$e,[t("img",{class:"menu-avatar-img",src:C.value,alt:"metronic",style:{height:"50px",width:"50px"}},null,8,Te)])):(i(),u("div",je,[t("span",null,d(V.value),1)])),t("div",ze,[t("div",Be,d(W.value),1),t("span",Fe,d(A(s).user.Position),1),t("div",Le,[t("span",Ue,d(f.value&&f.value!=""?f.value:"Week -"),1),m(Q,{direction:"vertical"}),t("span",Je,d(h.value&&h.value!=""?A(se)(A(ae)(new Date(h.value))):"-"),1)])])])])])]),_:1}),t("div",{class:"ironportal-content",style:fe(c.value?"padding-bottom: 10px":"")},[(i(),P(X,{key:S.value}))],4),!D.includes(R.value)&&!c.value?(i(),P(z,{key:0,"default-active":b.value,mode:"horizontal","background-color":"#2d2b39","text-color":"#919eab","active-text-color":"#1d8f45",ellipsis:!0,class:"ironportal-bottom-menu d-flex align-items-center justify-content-center",onSelect:E},{default:x(()=>[t("div",Oe,[(i(!0),u(U,null,he(O.value,(a,ee)=>(i(),P(Z,{key:ee,index:a.MenuName,class:"bottom-menu-item"},{default:x(()=>[a.Icon&&a.Icon!=""?(i(),u("img",{key:0,class:"bottom-menu-item-icon",alt:"",src:`/media/svg/iron-portal/${a.Icon}${b.value==a.MenuName?"-green":""}.svg`},null,8,Ee)):N("",!0),t("span",{class:ge(`ms-3 ${b.value==a.MenuName&&"text-white"}`)},d(a.PageName),3)]),_:2},1032,["index"]))),128))])]),_:1},8,["default-active"])):N("",!0)],64)}}}),Pt=xe(Ve,[["__scopeId","data-v-a8185ccd"]]);export{Pt as default};

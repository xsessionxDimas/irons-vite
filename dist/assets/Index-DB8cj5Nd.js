import{u as bt}from"./vuex-BbOKrtVp.js";import{a as qt}from"./breadcrumb-BYmEOf4C.js";import{c as A,a as nt,J as X,I as it,z as G,A as yt}from"./index-BuVmIl8K.js";import{P as ct}from"./Pagination-D-xfdYmn.js";import{F as Mt}from"./FilterIconButton-Bj0WTbms.js";import{h as wt,A as Ft,U as Pt}from"./excel-generator-DMHRo93s.js";import{D as Tt}from"./DownloadIconButton-CIQp-YG7.js";import{_ as q,b as pt}from"./element-plus-BeWdvTRa.js";import{q as x,w as Q,x as Y,y as Bt}from"./date-format-8-IvfSl3.js";import{P as W}from"./Pagination-BiobnanQ.js";import{C as mt,L as kt,B as Ct,E as It,U as Ut,a as Lt,b as At}from"./urls-DBLs_wGY.js";import{d as rt}from"./pinia-BjOS2_Ao.js";import{m as ut,a as xt}from"./mapOption-CeGMwmH0.js";import{k as R,bL as $t,r as z,u as s,y as N,p as M,aa as J,q as T,x as p,Y as et,R as k,s as a,aB as u,C as V,a0 as at,c as I,B,A as st,T as Dt,bd as Ot,bb as Vt,a7 as Rt,L as Ht,F as Nt}from"./@vue-BypzYtbH.js";import{a as zt,d as jt}from"./table-sort-Bpdq_Uwn.js";import{_ as Z}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{_ as $}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CCwjwK39.js";import{_ as L}from"./AutoComplete.vue_vue_type_script_setup_true_lang-DJ43pGTI.js";import{a as ht}from"./vee-validate-C_msoaAA.js";import{c as gt,a as j,b as tt,d as Et,e as Kt}from"./yup-C6P98bvY.js";import"./property-expr-DEi1ZLzV.js";import{E as vt}from"./ErrorAlert-CMKGfwAi.js";import{_ as Gt}from"./SwitchInput.vue_vue_type_script_setup_true_lang-BosisL7w.js";import{e as Qt}from"./lodash-DrHMlsdo.js";import{_ as Jt}from"./FileDropZone.vue_vue_type_style_index_0_lang-C5PyimC7.js";import{m as Xt}from"./map-anything-abi6NY2Z.js";import{_ as Yt}from"./nw-img-vue-CR837WER.js";import{F as Wt}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./useMenuStore-CD5Gmvif.js";import"./PageEnum-DUtfSNQS.js";import"./xlsx-C4maHrMm.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-NSxIV7Fb.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";const K=rt({id:"equipmentModelList",state:()=>({stateFilterData:{EquipmentModel:"",EquipmentModelTo:"",EquipmentModelDescription:"",EquipmentModelDescriptionTo:"",Brand:"",BrandTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},stateLastUsedFilterData:{EquipmentModel:"",EquipmentModelDescription:"",ver:"v1",Page:1,PageSize:10,Order:""},statePageName:"equipmentModel",stateDisplayData:[],statePagination:new W,stateLoading:!1,statePaginationLoading:!1,stateEquipmentModelOption:[],stateEquipmentModelDescOption:[],stateBrandOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,equipmentModelOption:t=>t.stateEquipmentModelOption,equipmentModelDescOption:t=>t.stateEquipmentModelDescOption,brandOption:t=>t.stateBrandOption},actions:{async getData(t=!0){const i={EquipmentModel:this.stateFilterData.EquipmentModel,EquipmentModelTo:this.stateFilterData.EquipmentModelTo,EquipmentModelDescription:this.stateFilterData.EquipmentModelDescription,EquipmentModelDescriptionTo:this.stateFilterData.EquipmentModelDescriptionTo,Brand:this.stateFilterData.Brand,BrandTo:this.stateFilterData.BrandTo,StartDate:this.stateFilterData.StartDate?x(this.stateFilterData.StartDate):"",StartDateTo:this.stateFilterData.StartDateTo?x(this.stateFilterData.StartDateTo):"",EndDate:this.stateFilterData.EndDate?x(this.stateFilterData.EndDate):"",EndDateTo:this.stateFilterData.EndDateTo?x(this.stateFilterData.EndDateTo):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await A.get(mt,"",new URLSearchParams(i).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const i=await A.get(kt,"",new URLSearchParams(t).toString());this.stateEquipmentModelOption=ut(i.data.result.content.equipmentModel),this.stateEquipmentModelDescOption=ut(i.data.result.content.equipmentModelDescription)}catch(i){console.log(i)}},async getBrandOptions(){const t={ver:this.stateFilterData.ver};try{const i=await A.get(Ct,"",new URLSearchParams(t).toString());this.stateBrandOption=xt(i.data.result.content,"brand","brandDescription")}catch(i){console.log(i)}},async export(){const t={ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await A.getBlob(It,"",new URLSearchParams(t).toString())).data}catch(i){console.log(i)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:i}){if(!t&&!i)this.stateFilterData.Order="";else{const e=i=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setEquipmentModel(t){this.stateFilterData.EquipmentModel=t},setEquipmentModelTo(t){this.stateFilterData.EquipmentModelTo=t},setEquipmentModelDescription(t){this.stateFilterData.EquipmentModelDescription=t},setEquipmentModelDescriptionTo(t){this.stateFilterData.EquipmentModelDescriptionTo=t},setBrand(t){this.stateFilterData.Brand=t},setBrandTo(t){this.stateFilterData.BrandTo=t},setStartDate(t){this.stateFilterData.StartDate=t},setStartDateTo(t){this.stateFilterData.StartDateTo=t},setEndDate(t){this.stateFilterData.EndDate=t},setEndDateTo(t){this.stateFilterData.EndDateTo=t},async resetFilter(){this.stateFilterData.EquipmentModel="",this.stateFilterData.EquipmentModelTo="",this.stateFilterData.EquipmentModelDescription="",this.stateFilterData.EquipmentModelDescriptionTo="",this.stateFilterData.Brand="",this.stateFilterData.BrandTo="",this.stateFilterData.StartDate="",this.stateFilterData.StartDateTo="",this.stateFilterData.EndDate="",this.stateFilterData.EndDateTo="";const t=this.stateLastUsedFilterData.EquipmentModel!=="",i=this.stateLastUsedFilterData.EquipmentModelTo!=="",e=this.stateLastUsedFilterData.EquipmentModelDescription!=="",E=this.stateLastUsedFilterData.EquipmentModelDescriptionTo!=="",n=this.stateLastUsedFilterData.Brand!=="",d=this.stateLastUsedFilterData.BrandTo!=="",D=this.stateLastUsedFilterData.StartDate!=="",v=this.stateLastUsedFilterData.StartDateTo!=="",o=this.stateLastUsedFilterData.EndDate!=="",S=this.stateLastUsedFilterData.EndDateTo!=="";(t||i||e||E||n||d||D||v||o||S)&&await this.getData()},resetState(){this.stateFilterData={EquipmentModel:"",EquipmentModelTo:"",EquipmentModelDescription:"",EquipmentModelDescriptionTo:"",Brand:"",BrandTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},this.stateDisplayData=[],this.statePagination=new W,this.stateLoading=!1,this.statePaginationLoading=!1}}}),ot=rt({id:"equipmentModelForm",state:()=>({stateFormData:{EquipmentModelId:0,IsActive:!0},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading},actions:{async insertData(t){try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"};this.stateFormData.StartDate=x(Q(new Date(this.stateFormData.StartDate))),this.stateFormData.EndDate=x(Q(new Date(this.stateFormData.EndDate)));const e=await A.post(`${mt}?${new URLSearchParams(i).toString()}`,this.stateFormData);e.data.title==="Error"?(this.stateErrors.push(e.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"};this.stateFormData.StartDate=x(Q(new Date(this.stateFormData.StartDate))),this.stateFormData.EndDate=x(Q(new Date(this.stateFormData.EndDate)));const e=await A.post(`${Ut}?${new URLSearchParams(i).toString()}`,this.stateFormData);e.data.title==="Error"?(this.stateErrors.push(e.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.EquipmentModelId=t.equipmentModelId||0,this.stateFormData.EquipmentModel=t.equipmentModel||"",this.stateFormData.EquipmentModelDescription=t.equipmentModelDescription||"",this.stateFormData.Brand=t.brand||"",this.stateFormData.StartDate=t.startDate||"",this.stateFormData.EndDate=t.endDate||"",this.stateFormData.IsActive=t.isActive||!1},resetState(){this.stateFormData={EquipmentModelId:0,IsActive:!0},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),Zt={key:0,style:{height:"100px"}},te={key:0,class:"row justify-content-center"},ee={key:1,class:"row justify-content-center"},ae={class:"row justify-content-center"},se=["onClick"],oe=R({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:i}){const e=t,E=K(),n=ot(),d=i,D=$t(()=>(e.page-1)*10+1),v=z(""),o=f=>{v.value=f.order;const y={prop:f.prop,order:f.order};E.setSort(y)},S=(f,y,_)=>zt(f[_],y[_],v.value),b=f=>{n.setFormData(f),d("show-dialog",null)};return(f,y)=>{const _=k("inline-svg"),F=k("el-tooltip"),w=et("loading");return s(E).loading?N((M(),J("div",Zt,null,512)),[[w,s(E).loading]]):N((M(),T(s(pt),{key:1,data:e.listData,style:{width:"100%"},onSortChange:o,"empty-text":"No Data"},{default:p(()=>[a(s(q),{label:"No",width:"90",align:"center"},{default:p(r=>[u("span",null,V(s(D)+r.$index),1)]),_:1}),a(s(q),{prop:"equipmentModel",label:"Equipment Model",width:"170",sortable:"","sort-method":(r,m)=>S(r,m,"equipmentModel")},null,8,["sort-method"]),a(s(q),{prop:"equipmentModelDescription",label:"Equipment Model Desc.",width:"200",sortable:"","sort-method":(r,m)=>S(r,m,"equipmentModelDescription")},null,8,["sort-method"]),a(s(q),{prop:"brand",label:"Brand",width:"100",sortable:"","sort-method":(r,m)=>S(r,m,"brand")},null,8,["sort-method"]),a(s(q),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:p(r=>[u("span",null,V(s(Y)(r.row.startDate)),1)]),_:1}),a(s(q),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:p(r=>[u("span",null,V(s(Y)(r.row.endDate)),1)]),_:1}),a(s(q),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:p(r=>[r.row.isActive?(M(),J("div",te,[a(_,{src:"/media/svg/tables/rows/check.svg"})])):(M(),J("div",ee,[a(_,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),a(s(q),{prop:"changedOn",label:"Changed on",align:"center",width:"150",sortable:""},{default:p(r=>[u("span",null,V(s(Bt)(r.row.changedOn)),1)]),_:1}),a(s(q),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(r,m)=>S(r,m,"changedBy")},null,8,["sort-method"]),a(s(q),{label:"",width:"80"},{default:p(r=>[u("div",ae,[a(F,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:p(()=>[u("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:m=>b(r.row)},[a(_,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,se)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[w,s(E).loading]])}}}),ne={class:"col-md-6 fv-row fv-plugins-icon-container"},ie={class:"col-md-6 fv-row fv-plugins-icon-container"},re={class:"dialog-footer"},le=R({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=t,E=i,n=ot(),d=K(),D=nt(),v=at(e,"visibility"),o=I(()=>n.formData),S=I(()=>n.errors),b=I(()=>n.isError),f=gt().shape({EquipmentModel:j().required("Equipment Model is mandatory"),EquipmentModelDescription:j().required("Equipment Model Description is mandatory"),Brand:j().required("Brand is mandatory"),StartDate:tt().required("Start Date is mandatory").typeError("Start Date is mandatory"),EndDate:tt().required("End Date is mandatory").min(Et("StartDate"),"End date must be later than start date").typeError("End date must be later than start date")}),y=()=>{F(""),w(""),r(""),m(""),g("")},_=(l=!1)=>{c(),y(),n.resetState(),E("handle-close",l)},F=l=>{o.value.EquipmentModel=l},w=l=>{o.value.EquipmentModelDescription=l},r=l=>{o.value.Brand=l},m=l=>{o.value.StartDate=l},g=l=>{o.value.EndDate=l},U=async()=>{c(),await f.validate(o.value,{abortEarly:!1}).catch(l=>{n.setErrors(l.errors)}),!b.value&&X("Are you sure you want to submit ?").then(async l=>{l.isConfirmed&&n.insertData(D.user.Name).then(()=>{n.isError||it("Form has been successfully submitted!","Ok").then(()=>{_(!0)})})})},c=()=>{n.setErrors([])};return(l,h)=>{const P=k("el-button"),C=k("el-dialog"),H=et("loading");return N((M(),T(C,{modelValue:v.value,"onUpdate:modelValue":h[0]||(h[0]=O=>v.value=O),title:"New Data",width:"40%",onClose:h[1]||(h[1]=O=>_())},{footer:p(()=>[u("span",re,[a(P,{type:"primary",onClick:U,disabled:s(n).loading},{default:p(()=>[B("Submit")]),_:1},8,["disabled"]),a(P,{type:"secondary",onClick:_,disabled:s(n).loading},{default:p(()=>[B("Close")]),_:1},8,["disabled"])])]),default:p(()=>[a(Dt,{name:"fade"},{default:p(()=>[b.value?(M(),T(vt,{key:0,errorMessages:S.value,onResetForm:c},null,8,["errorMessages"])):st("",!0)]),_:1}),N((M(),T(s(ht),{id:"kt_filter_form",class:"row g-9 my-4"},{default:p(()=>[a(Z,{value:o.value.EquipmentModel,margin:!1,placeholder:"Add Equipment Model",label:"Equipment Model",name:"EquipmentModel",max:20,onHandleChange:F},null,8,["value"]),a(Z,{value:o.value.EquipmentModelDescription,placeholder:"Add Equipment Model Description",label:"Equipment Model Desc.",name:"EquipmentModelDescription",max:40,onHandleChange:w},null,8,["value"]),a(L,{value:o.value.Brand,placeholder:"Add Brand",label:"Brand",name:"Brand",max:10,onHandleChange:r,options:s(d).brandOption},null,8,["value","options"]),u("div",ne,[a($,{value:o.value.StartDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:m},null,8,["value"])]),u("div",ie,[a($,{value:o.value.EndDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:g},null,8,["value"])])]),_:1})),[[H,s(n).loading]])]),_:1},8,["modelValue"])),[[H,s(n).loading]])}}}),de={class:"col-md-6 fv-row fv-plugins-icon-container"},ue={class:"col-md-6 fv-row fv-plugins-icon-container"},ce={class:"dialog-footer"},pe=R({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=t,E=i,n=ot(),d=K(),D=nt(),v=at(e,"visibility"),o=I(()=>n.formData),S=I(()=>n.errors),b=I(()=>n.isError),f=gt().shape({EquipmentModelDescription:j().required("Equipment Model Description is mandatory"),Brand:j().required("Brand is mandatory"),StartDate:tt().required("Start Date is mandatory").typeError("Start Date is mandatory"),EndDate:tt().required("End Date is mandatory").min(Et("StartDate"),"End date must be later than start date").typeError("End date must be later than start date"),IsActive:Kt().required("Is Active is mandatory")}),y=()=>{o.value.EquipmentModelId=0,o.value.EquipmentModel="",o.value.EquipmentModelDescription="",o.value.Brand="",o.value.StartDate="",o.value.EndDate="",o.value.IsActive=!0},_=(l=!1)=>{y(),c(),n.resetState(),E("handle-close",l)},F=l=>{o.value.EquipmentModelDescription=l},w=l=>{o.value.Brand=l},r=l=>{o.value.StartDate=l},m=l=>{o.value.EndDate=l},g=l=>{o.value.IsActive=l},U=async()=>{c(),await f.validate(o.value,{abortEarly:!1}).catch(l=>{n.setErrors(l.errors)}),!b.value&&X("Are you sure you want to submit ?").then(async l=>{l.isConfirmed&&n.updateData(D.user.Name).then(()=>{n.isError||it("Form has been successfully submitted!","Ok").then(()=>{_(!0)})})})},c=()=>{n.setErrors([])};return(l,h)=>{const P=k("el-button"),C=k("el-dialog"),H=et("loading");return N((M(),T(C,{modelValue:v.value,"onUpdate:modelValue":h[0]||(h[0]=O=>v.value=O),title:"Update Data",width:"40%",onClose:h[1]||(h[1]=O=>_())},{footer:p(()=>[u("span",ce,[a(P,{type:"primary",onClick:U,disabled:s(n).loading},{default:p(()=>[B("Submit")]),_:1},8,["disabled"]),a(P,{type:"secondary",onClick:_,disabled:s(n).loading},{default:p(()=>[B("Close")]),_:1},8,["disabled"])])]),default:p(()=>[a(Dt,{name:"fade"},{default:p(()=>[b.value?(M(),T(vt,{key:0,errorMessages:S.value,onResetForm:c},null,8,["errorMessages"])):st("",!0)]),_:1}),a(s(ht),{id:"kt_filter_form",class:"row g-9 my-4"},{default:p(()=>[a(Z,{value:o.value.EquipmentModel,margin:!1,placeholder:"Add Equipment Model",label:"Equipment Model",name:"Equipment Model",max:20,disabled:!0},null,8,["value"]),a(Z,{value:o.value.EquipmentModelDescription,margin:!1,placeholder:"Add Equipment Model Description",label:"Equipment Model Desc.",name:"EquipmentModelDescription",max:40,onHandleChange:F},null,8,["value"]),a(L,{value:o.value.Brand,placeholder:"Add Brand",label:"Brand",name:"Brand",max:10,onHandleChange:w,options:s(d).brandOption},null,8,["value","options"]),u("div",de,[a($,{value:o.value.StartDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:r},null,8,["value"])]),u("div",ue,[a($,{value:o.value.EndDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:m},null,8,["value"])]),a(Gt,{value:o.value.IsActive,label:"Is Active",name:"IsActive",onHandleChange:g},null,8,["value"])]),_:1})]),_:1},8,["modelValue"])),[[H,s(n).loading]])}}}),lt=rt({id:"equipmentModelBulk",state:()=>({statePagination:new W,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const i={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const e=await A.post(`${Lt}?${new URLSearchParams(i).toString()}`,this.stateBulkData);this.stateError=e.data.result.isError?e.data.result.message:"",this.stateIsError=e.data.result.isError}catch(e){console.log(e)}this.stateLoading=!1},async upload({userAccount:t,excelFile:i}){const e={userAccount:t,ver:"v1"},E=`${At}?${new URLSearchParams(e).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const n=await A.postImages(E,i);n.data.statusCode==200?n.data.result.isError?(this.stateIsError=!0,this.stateError=n.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=n.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=Qt.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=n.data.result.isError,this.stateError=n.data.result.message)}catch(n){console.log(n),this.stateIsError=!0,this.stateError=n.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(jt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new W,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),me={class:"icon"},De=R({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const i=t,e=lt(),E=I(()=>(i.page-1)*10+1),n=d=>{const D={prop:d.prop,order:d.order};e.setSort(D)};return(d,D)=>{const v=k("inline-svg");return M(),T(s(pt),{data:i.listData,style:{width:"100%"},onSortChange:n,"empty-text":"No Data"},{default:p(()=>[a(s(q),{label:"No",width:"60",align:"center"},{default:p(o=>[u("span",null,V(E.value+o.$index),1)]),_:1}),a(s(q),{prop:"equipmentModel",label:"Equipment Model",width:"200",sortable:""}),a(s(q),{prop:"equipmentModelDescription",label:"Equipment Model Desc.",width:"200",sortable:""}),a(s(q),{prop:"brand",label:"Brand",width:"150",sortable:""}),a(s(q),{prop:"startDate",label:"Start Date",width:"120",sortable:""},{default:p(o=>[u("span",null,V(s(Y)(o.row.startDate)),1)]),_:1}),a(s(q),{prop:"endDate",label:"End Date",width:"100",sortable:""},{default:p(o=>[u("span",null,V(s(Y)(o.row.endDate)),1)]),_:1}),a(s(q),{prop:"validationReason",label:"Remark",width:"200",sortable:""}),a(s(q),{prop:"isValid",label:"Status","min-width":"100",align:"center",sortable:""},{default:p(o=>[u("div",me,[a(v,{src:o.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),dt=t=>(Ot("data-v-4fb3e1af"),t=t(),Vt(),t),he=dt(()=>u("div",{class:"text-center"},null,-1)),ge=dt(()=>u("div",{class:"mb-3"},[u("span",null,[B(" Download template "),u("a",{href:"documents/MasterDataEquipmentModel.xlsx",target:"_blank",id:"link-download"},"here"),B(" before uploading file ")])],-1)),Ee=dt(()=>u("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[u("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),ve={class:"card"},fe={class:"card-body grid-padding"},_e={class:"dialog-footer"},Se=R({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:i}){const e=t,E=i,n=nt(),d=lt(),D=at(e,"visibility"),v=()=>{const r=Xt(d.validatedData,m=>{const g=m;return{equipmentModelId:0,equipmentModel:g.equipmentModel,equipmentModelDescription:g.equipmentModelDescription,brand:g.brand,startDate:g.startDate,endDate:g.endDate,isActive:!0}});return Object.values(r)},o=()=>{const r=document.getElementById("link-download");r&&r.click()},S=()=>{d.validatedData.length>0?X("Cancel Upload Data?","Confirm").then(m=>{m.isConfirmed&&f()}):f()},b=async r=>{await d.upload({userAccount:n.user.Name,excelFile:r}),d.stateError&&G(d.error)},f=(r=!1)=>{d.resetState(),E("handle-close",r)},y=r=>{d.setIsUploadedState(r)},_=r=>{d.setPage(r)},F=()=>{if(d.validatedData.length<1){o();return}const r=["EQUIPMENT MODEL","EQUIPMENT MODEL DESC","BRAND","START DATE","END DATE","REMARK","STATUS"],m=d.validatedData.map(g=>({eqipmentModel:g.equipmentModel,eqipmentModelDescription:g.equipmentModelDescription,brand:g.brand,startDate:g.startDate,endDate:g.endDate,remark:g.validationReason,status:g.isValid?"OK":"Error"}));wt("EquipmentModel",r,m)},w=async()=>{if(d.displayData.length<1){G("There is no data to submit");return}if(d.isError){G("There is still invalid row(s)");return}X("Are you sure you want to submit ?").then(async r=>{if(r.isConfirmed){const m=v();if(d.setBulkData(m),await d.bulkInsert(n.user.Name),d.isError){G(d.stateError);return}it("Form has been successfully submitted!","Ok").then(()=>{f(!0)})}})};return(r,m)=>{const g=k("el-button"),U=k("el-dialog"),c=et("loading");return M(),T(U,{title:"Upload Bulk Data",modelValue:D.value,"onUpdate:modelValue":m[1]||(m[1]=l=>D.value=l),"before-close":S,width:"70%","custom-class":"upload-modal"},{footer:p(()=>[u("div",null,[u("span",_e,[a(g,{type:"success",onClick:F},{default:p(()=>[B("Download")]),_:1}),a(g,{type:"primary",onClick:w},{default:p(()=>[B("Upload")]),_:1}),a(g,{type:"success",onClick:S},{default:p(()=>[B("Cancel")]),_:1})])])]),default:p(()=>[he,ge,N(a(Jt,{isSubmissionUploadSuccess:s(d).isUploaded,onHandleCloseUploadedFile:S,onHandleUpload:b,onHandleSetIsExcelFileUploaded:y},null,8,["isSubmissionUploadSuccess"]),[[c,s(d).uploadLoading]]),Ee,u("div",ve,[u("div",fe,[a(De,{"list-data":s(d).displayData,page:s(d).pagination.currentPage},null,8,["list-data","page"])])]),s(d).displayData.length>0?(M(),T(ct,{key:0,onRaisePageChange:m[0]||(m[0]=l=>_(l)),currentPage:s(d).pagination.currentPage,totalPage:s(d).pagination.totalPage,totalPageSize:s(d).pagination.totalPageSize,startPaginationIndex:s(d).pagination.startPaginationIndex,endPaginationIndex:s(d).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):st("",!0)]),_:1},8,["modelValue"])}}}),be=Yt(Se,[["__scopeId","data-v-4fb3e1af"]]),qe={class:"row g-9 my-4"},ye={class:"col-md-6 fv-row fv-plugins-icon-container"},Me={class:"col-md-6 fv-row fv-plugins-icon-container"},we={class:"col-md-6 fv-row fv-plugins-icon-container"},Fe={class:"col-md-6 fv-row fv-plugins-icon-container"},Pe={class:"col-md-6 fv-row fv-plugins-icon-container"},Te={class:"col-md-6 fv-row fv-plugins-icon-container"},Be={class:"col-md-6 fv-row fv-plugins-icon-container"},ke={class:"col-md-6 fv-row fv-plugins-icon-container"},Ce={class:"col-md-6 fv-row fv-plugins-icon-container"},Ie={class:"col-md-6 fv-row fv-plugins-icon-container"},Ue={class:"dialog-footer"},Le=R({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=K(),E=t,n=i,d=at(E,"visibility"),D=I(()=>e.filterData),v=()=>{o(),e.resetFilter()},o=()=>{n("handle-close",!1)},S=c=>{e.setEquipmentModel(c)},b=c=>{e.setEquipmentModelTo(c)},f=c=>{e.setEquipmentModelDescription(c)},y=c=>{e.setEquipmentModelDescriptionTo(c)},_=c=>{e.setBrand(c)},F=c=>{e.setBrandTo(c)},w=c=>{e.setStartDate(c)},r=c=>{e.setStartDateTo(c)},m=c=>{e.setEndDate(c)},g=c=>{e.setEndDateTo(c)},U=()=>{const c=e.lastUsedFilterData.EquipmentModel!==e.filterData.EquipmentModel,l=e.lastUsedFilterData.EquipmentModel!==e.filterData.EquipmentModelTo,h=e.lastUsedFilterData.EquipmentModelDescription!==e.filterData.EquipmentModelDescription,P=e.lastUsedFilterData.EquipmentModelDescription!==e.filterData.EquipmentModelDescriptionTo,C=e.lastUsedFilterData.Brand!==e.filterData.Brand,H=e.lastUsedFilterData.Brand!==e.filterData.BrandTo,O=e.lastUsedFilterData.StartDate!==e.filterData.StartDate,ft=e.lastUsedFilterData.StartDate!==e.filterData.StartDateTo,_t=e.lastUsedFilterData.EndDate!==e.filterData.EndDate,St=e.lastUsedFilterData.EndDate!==e.filterData.EndDateTo;n("handle-close",c||l||h||P||C||H||O||ft||_t||St)};return(c,l)=>{const h=k("el-button"),P=k("el-dialog");return M(),T(P,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=C=>d.value=C),title:"Filter",width:"60%",onClose:l[1]||(l[1]=C=>o())},{footer:p(()=>[u("span",Ue,[a(h,{type:"secondary",onClick:v},{default:p(()=>[B("Reset")]),_:1}),a(h,{type:"primary",onClick:U},{default:p(()=>[B("Filter")]),_:1})])]),default:p(()=>[u("div",qe,[u("div",ye,[a(L,{value:D.value.EquipmentModel,label:"Equipment Model From",name:"EquipmentModel",options:s(e).equipmentModelOption,onHandleChange:S},null,8,["value","options"])]),u("div",Me,[a(L,{value:D.value.EquipmentModelTo,label:"Equipment Model To",name:"EquipmentModelTo",options:s(e).equipmentModelOption,onHandleChange:b},null,8,["value","options"])]),u("div",we,[a(L,{value:D.value.EquipmentModelDescription,label:"Equipment Model Description From",name:"EquipmentModelDescription",options:s(e).equipmentModelDescOption,onHandleChange:f},null,8,["value","options"])]),u("div",Fe,[a(L,{value:D.value.EquipmentModelDescriptionTo,label:"Equipment Model Description To",name:"EquipmentModelDescriptionTo",options:s(e).equipmentModelDescOption,onHandleChange:y},null,8,["value","options"])]),u("div",Pe,[a(L,{value:D.value.Brand,label:"Brand From",name:"Brand",options:s(e).brandOption,onHandleChange:_},null,8,["value","options"])]),u("div",Te,[a(L,{value:D.value.BrandTo,label:"Brand To",name:"BrandTo",options:s(e).brandOption,onHandleChange:F},null,8,["value","options"])]),u("div",Be,[a($,{value:D.value.StartDate,label:"Start Date From",name:"StartDateFrom",placeholder:"Pick a date",onHandleChange:w},null,8,["value"])]),u("div",ke,[a($,{value:D.value.StartDateTo,label:"Start Date To",name:"StartDateFrom",placeholder:"Pick a date",onHandleChange:r},null,8,["value"])]),u("div",Ce,[a($,{value:D.value.EndDate,label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChange:m},null,8,["value"])]),u("div",Ie,[a($,{value:D.value.EndDateTo,label:"End Date To",name:"EndDateTo",placeholder:"Pick a date",onHandleChange:g},null,8,["value"])])])]),_:1},8,["modelValue"])}}}),Ae={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},xe=u("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),$e={class:"d-flex justify-content-between align-items-center"},Oe={class:"card"},Ve={class:"card-body grid-padding"},Re={class:"my-5"},ts=R({__name:"Index",setup(t){const i=bt(),e=K(),E=ot(),n=lt(),d=z(!1),D=z(!1),v=z(!1),o=z(!1),S=I(()=>e.displayData),b=I(()=>e.pagination),f=h=>{e.setPage(h)};Rt(async()=>{i[yt.ACTIVE_PAGE]("IronLake"),qt("Equipment Model",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Equipment",pageRoute:"equipmentmodel"},{pageName:"Equipment Model",pageRoute:"equipmentmodel"}]),e.setPage(1),await e.getLookup(),await e.getBrandOptions()}),Ht(()=>{e.resetState(),E.resetState(),n.resetState()});const y=async()=>{await e.setPage(1),await e.getLookup(),await e.getBrandOptions()},_=()=>{d.value=!0},F=async h=>{d.value=!1,h&&await y()},w=()=>{D.value=!0},r=async h=>{D.value=!1,h&&await y()},m=()=>{v.value=!0},g=async h=>{v.value=!1,h&&await y()},U=async()=>{const h=await e.export();Wt.saveAs(new Blob([h],{type:"application/octet-stream"}),"Equipment Model.xlsx")},c=()=>{o.value=!0},l=async h=>{o.value=!1,h&&await y()};return(h,P)=>(M(),J(Nt,null,[u("div",Ae,[xe,u("div",$e,[a(Ft,{onShowDialog:_}),a(Mt,{onShowDialog:m}),a(Tt,{onHandleDownload:U}),a(Pt,{onShowDialog:c})])]),u("div",Oe,[u("div",Ve,[a(oe,{"list-data":S.value,page:b.value.currentPage,onShowDialog:w},null,8,["list-data","page"])])]),u("div",Re,[s(e).paginationLoading?st("",!0):(M(),T(ct,{key:0,onRaisePageChange:P[0]||(P[0]=C=>f(C)),currentPage:b.value.currentPage,totalPage:b.value.totalPage,totalPageSize:b.value.totalPageSize,startPaginationIndex:b.value.startPaginationIndex,endPaginationIndex:b.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),a(le,{visibility:d.value,onHandleClose:F},null,8,["visibility"]),a(pe,{visibility:D.value,onHandleClose:r},null,8,["visibility"]),a(Le,{visibility:v.value,onHandleClose:g},null,8,["visibility"]),a(be,{visibility:o.value,onHandleClose:l},null,8,["visibility"])],64))}});export{ts as default};

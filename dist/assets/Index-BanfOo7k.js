import{k as Ue,c as i,r as k,p as c,aa as $,F as Ve,$ as nt,aB as n,b4 as we,C as Ie,A as D,a0 as De,bL as Te,a7 as Ia,Y as Aa,y as Wt,b6 as ce,u as W,R as ne,q as Z,x as le,s as j,B as yt,K as Et,P as fs,d as ke,o as xt,_ as va,bd as zt,bb as Xt,L as $a,a1 as pa,z as ys,n as vs,a5 as ps}from"./@vue-BypzYtbH.js";import{u as vt,a as Zt}from"./useInterimEngineStore-Ctq4w8Oq.js";import{_ as Fa}from"./InformationPopUp.vue_vue_type_style_index_0_lang-O2xYF9Pq.js";import{C as bs}from"./Cameras-vtENZZzD.js";import{u as gs,a as ks}from"./useInterimDefectsStore-DCjj_hjG.js";import{a as Ye}from"./element-plus-BeWdvTRa.js";import{u as Vt}from"./useGlobalConnectionStore-DV9B81de.js";import{e as t,_ as Ba}from"./lodash-DrHMlsdo.js";import{_ as $t}from"./nw-img-vue-CR837WER.js";import{u as hs,d as Ss,H as Cs,s as ws}from"./useHistoricalStore-9gpJHRqR.js";import{c as Ht,a as Dt,s as ya}from"./index-BuVmIl8K.js";import{a as ba,d as Us}from"./manipulate-html-string-DqTEGh-F.js";import{_ as oa,a as ga}from"./defect-CAkPobhd.js";import{u as _s,_ as Is,a as $s,V as Ts}from"./ViewOnlyNAReasonDialog-DR-Uz59p.js";import{U as Rs,c as Ps,G as Bs,u as Vs,b as Oa,d as Ta,V as Ns}from"./ViewOnlyNAForm-DC1ogXLe.js";import{C as Va}from"./CrackNoClass-0DSU7BAn.js";import{d as Ea}from"./pinia-BjOS2_Ao.js";import{u as bt,b as Ra}from"./useDefectsFormStore-41UTMhiG.js";import{u as _t}from"./useCameraStore-BwXVJhPe.js";import{C as Na}from"./CrackYesClass-COntz77m.js";import{u as Ca}from"./authentication-handler-Pueb_EI7.js";import{S as wa,m as Pa,v as La,b as ja,r as Bt,f as Mt}from"./number-format-BdMuQVyW.js";import{N as xs}from"./NAReasonDialog-Bb7Vw_qI.js";import{H as Ds,M as As,l as Fs,o as Os,a as Es,b as Ls,t as js,p as Ms}from"./helpers-wUOLw-dU.js";import{_ as Hs}from"./ErrorBox.vue_vue_type_style_index_0_lang-Bysg_zE3.js";import{_ as ua}from"./ImagePreview.vue_vue_type_style_index_0_lang-DrcOCjy4.js";import{a as Ma}from"./UploadImageFailureDialog.vue_vue_type_style_index_0_lang-DVBJv3c1.js";import{s as lt,a as xa}from"./string-to-imageinfo-converter-Cdr1iOkP.js";import{_ as Ha,a as ka,S as ha}from"./ImageListModal.vue_vue_type_style_index_0_lang-djt6-PkA.js";import{i as Ks,g as ia,G as Gs,H as Da,p as qs}from"./date-format-8-IvfSl3.js";import{S as Ys}from"./SelectSearchWithLabel-CWBDKtLo.js";import{_ as Yt}from"./GeneralDialog.vue_vue_type_style_index_0_lang-Bvj3I9QR.js";import{u as Ka}from"./usePersonelLabourStore-BUmSURn2.js";import{_ as Ga,T as Js,a as Ws,b as zs}from"./ProcessingTimePopUp.vue_vue_type_style_index_0_lang-DeJTSv0v.js";import{_ as Jt}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{_ as Xs}from"./ToastWithIcon.vue_vue_type_style_index_0_lang-wfM94fOM.js";import{S as Zs}from"./SMUDetailDialog-Bs-98WGo.js";import{M as Ua}from"./MachineSMUEnum-CgiCo9nf.js";import{C as Qs}from"./CameraIdEnum-C2Xl0HNE.js";import{v as el}from"./uuid-SoommWqA.js";import{a as tl}from"./RiskAssessment-Cp7incD6.js";import{_ as al}from"./FullScreenDialog.vue_vue_type_style_index_0_lang-DXRDt27h.js";import{a as sl}from"./@vueuse-DFoNmIyu.js";import{_ as ll}from"./Toast.vue_vue_type_style_index_0_lang-OOgaHWFE.js";import{u as ol}from"./useMasterStore-CzSO06fn.js";import{_ as rl}from"./MessageBox.vue_vue_type_style_index_0_lang-DfpcTVNJ.js";import{_ as nl}from"./Textarea.vue_vue_type_style_index_0_lang-v94SEJmi.js";import{u as il}from"./vue-router-iNp9kJ0K.js";import"./bootstrap-47JNjt8K.js";import{_ as ul}from"./Index.vue_vue_type_script_setup_true_lang-pbRyJFPY.js";import dl from"./Index-Ch5-tvyZ.js";import{u as cl}from"./usePositionListStore-BsprGHwA.js";import{O as ml}from"./OnlineStatus-Bhk3CA8-.js";import{g as fl,f as yl,u as da}from"./DefectPanelGeneric-BYVMPBe-.js";import{_ as vl}from"./Check-CTArJpdm.js";import{u as _a}from"./prev-val-handler-DvA3D_kF.js";import{l as pl,u as bl,m as gl}from"./urls-COjrEEs1.js";import{_ as fa}from"./InformationPopUpSideButton.vue_vue_type_style_index_0_lang-BO5OquVj.js";import{u as kl}from"./useDefectSheetStore-85RM-z1z.js";import{i as hl}from"./urls-CPQ2HRXU.js";import"./urls-B0Rq9QQ3.js";import"./urls-hWHEBXep.js";import"./urls-D8F5Tyyp.js";import"./disabled-state-O9W-ZY8y.js";import"./useAttachmentStore-DqM3autD.js";import"./simple-vue-camera-D9MGhAeE.js";import"./@popperjs-BaMZbQYT.js";import"./vue-BzYgrL08.js";import"./PhotoDescription.vue_vue_type_style_index_0_lang-1F5CAfuD.js";import"./vue-drawing-canvas-CzCJUKem.js";import"./urls-CvqtYZA-.js";import"./DefectNoClass-BqGKOkzR.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./object-path-DPahbflh.js";import"./deepmerge-oeePEK50.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./useDailyScheduleStore-B3ZQzhxq.js";import"./webp-converter-browser-C3MD88Lp.js";import"./compressorjs-Cmz8Y9J9.js";import"./file-saver-CwTBvle_.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";import"./PDFViewerDialog.vue_vue_type_style_index_0_lang-GWz8s3FD.js";import"./moment-C5S46NFB.js";import"./green-checklist-BWMKprFt.js";import"./OfflineFullScreenDialog.vue_vue_type_style_index_0_lang-C2GTRJsq.js";import"./Index.vue_vue_type_script_setup_true_lang-BKnCIuZK.js";import"./cbm-helper-BxJZ9NTc.js";import"./Repair-zyV2di4A.js";import"./CommentPanel-D0ptrEBp.js";import"./useDefectsStore-7BpSnT1n.js";import"./methods-bliey5hF.js";import"./useAttachmentStore-CPMOf2aR.js";import"./usePreviewFormStore-q8XX1uYG.js";import"./Index-D5s2WKlG.js";import"./useDefectsStore-j2gYF-8i.js";import"./useEFormStore-DtkLPope.js";import"./list-pcxkCnQg.js";import"./useOfflineCameraStore-BBsMm6DV.js";import"./internet-connection-CnLQPjRt.js";import"./IronformConfig-BWypCgSI.js";import"./reference-file-C1vLEEpf.js";import"./CrackForm-CAm6DVbX.js";import"./CrackForm-CIiKEd4n.js";import"./useHistoricalEformDmaStore-Fo4tKNgB.js";import"./manipulate-file-oif_A7gg.js";import"./pdf-DNpyvVEz.js";import"./image-close-button-red-B1UxWyBV.js";import"./@progress-DBKeVTWA.js";import"./pdf-merger-js-DY3-eECH.js";import"./pdf-lib-DrnT2QV2.js";import"./@pdf-lib-CXIx2D9y.js";import"./pako-Dx2kwFQn.js";import"./NAForm-BdrJ0TGj.js";import"./PDFViewerDialog.vue_vue_type_style_index_0_lang-DqiQYePb.js";import"./usePreviewNaFormStore-C1MJT2RQ.js";import"./ImagePreviewCabSide-CpYtX9kF.js";import"./BackNavigator-DUE8rWVW.js";import"./usePreviewDefectFormStore-CVtftEdK.js";import"./FormAlreadyOpenedByOtherSupervisor.vue_vue_type_style_index_0_lang-DkxhNkJR.js";import"./Pagination-BiobnanQ.js";import"./urls-DI_NR_TT.js";import"./mapOption-CeGMwmH0.js";import"./document_download-C1p7j0nJ.js";import"./ImagePreviews.vue_vue_type_style_index_0_lang-BJGkhvcB.js";import"./DefectForm-eu6l4STx.js";import"./helpers-BS1ZZpAr.js";import"./LargeCamera-BnWfLFAm.js";const Sl={class:"d-flex justify-content-between"},Cl=["onClick"],wl=["onClick"],Ul=Ue({__name:"GroupStepper",props:{groups:{type:Array,default(){return[]}}},setup(r){const s=vt(),e=gs(),l=Zt(),a=Vt(),o=i(()=>s.selectedGroup),v=i(()=>l.generalUpdated),y=m=>{var f;let b="";if(m.totalTask>0){const F=m.groupName!="General"&&m.groupName!="DEFECT_IDENTIFIED_SERVICE",J=m.totalTask==m.doneTask,_=m.id==((f=o.value)==null?void 0:f.id);F&&J&&(b="done-task"),F&&J&&_&&(b="done-task-selected")}return b},d=i(()=>s.groups.find(m=>m.groupName=="PRE_SERVICE_OPERATIONAL_CHECK")),p=(m,b)=>{var F,J;let f="";return f=m==((F=o.value)==null?void 0:F.id)?"active":"",!t.isUndefined(b.isDisable)&&b.isDisable=="true"&&(f+=" disabled"),!t.isUndefined(d.value)&&!t.isUndefined(d.value.doneTask)&&d.value.doneTask!=((J=d.value)==null?void 0:J.totalTask)&&b.groupName!=d.value.groupName&&b.groupName!="DEFECT_IDENTIFIED_SERVICE"&&b.groupName!="General"&&(f+=" disabled"),f},u=k("fa-chevron-up"),g=k(!0),h=async(m,b,f)=>{var F;if(!(!t.isUndefined(f.isDisable)&&f.isDisable=="true")&&!(!t.isUndefined(d.value)&&!t.isUndefined(d.value.doneTask)&&d.value.doneTask!=((F=d.value)==null?void 0:F.totalTask)&&f.groupName!=d.value.groupName&&f.groupName!="DEFECT_IDENTIFIED_SERVICE"&&f.groupName!="General"))if(!a.stateConnectionStatus)a.setSubmitConnectionError(!0);else{const J=Ye.service({lock:!0,text:"Loading E-Form",background:"rgba(0, 0, 0, 0.7)"});s.setSelectedGroup(m),await s.getTaskProgress(),b=="DEFECT_IDENTIFIED_SERVICE"?await e.getDefectsData(s.generalForm.workOrder):await s.updateGroupByParam(b),J.close()}},w=async m=>{var b,f;v.value&&(((b=s.selectedGroup)==null?void 0:b.groupName)!=m.groupName&&await h(m.id,m.groupName,m),!(!t.isUndefined(m.isDisable)&&m.isDisable=="true")&&(!t.isUndefined(d.value)&&!t.isUndefined(d.value.doneTask)&&d.value.doneTask!=((f=d.value)==null?void 0:f.totalTask)&&m.groupName!=d.value.groupName&&m.groupName!="DEFECT_IDENTIFIED_SERVICE"&&m.groupName!="General"||m.totalTask!=m.doneTask&&s.handleScrollToUnfilledTask()))},U=()=>{g.value=!g.value,u.value=g.value?"fa-chevron-up":"fa-chevron-down"};return(m,b)=>(c(),$("div",Sl,[(c(!0),$(Ve,null,nt(r.groups,(f,F)=>(c(),$("div",{key:f.id,class:we(["d-flex flex-column m-1 mb-3 stepper-button",y(f)])},[n("div",{class:we(["box-menu text-center p-2 d-flex justify-content-center align-items-center stepper-title",[p(f.id,f)]]),onClick:J=>h(f.id,f.groupName,f)},[n("span",null,Ie(f.groupLabel),1)],10,Cl),g.value?(c(),$("div",{key:0,onClick:J=>w(f),class:we(["text-center box-pill rounded-pill mt-2 mb-4 stepper-button-info w-100 py-2",[F==0?"invisible":"",p(f.id,f)]])}," Done "+Ie(f.doneTask)+"/"+Ie(f.totalTask),11,wl)):D("",!0)],2))),128)),n("div",null,[n("button",{class:"border-0 mt-10 align-items-center",onClick:U,style:{background:"transparent"}},[n("em",{class:we(["fa",u.value])},null,2)])])]))}}),_l=$t(Ul,[["__scopeId","data-v-e371a457"]]),Il=["src"],qa=Ue({__name:"Image",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const s=r,e=k("/media/svg/dma/warning.svg"),l=k(!0),a=De(s,"item"),o=Te(()=>!t.isUndefined(a.value.style)&&a.value.style.breakPoint!="none"?`col-${a.value.style.breakPoint}`:"col"),v=Te(()=>{let u="";return s.generalStyle&&!t.isUndefined(a.value.style)&&(!t.isUndefined(a.value.style.potraitBreakPoint)&&a.value.style.breakPoint!="none"?(u=`col-md-${a.value.style.potraitBreakPoint}`,u=`${u} col-lg-${a.value.style.breakPoint}`):(u=`col-md-${a.value.style.potraitBreakPoint}`,u=`${u} col-lg-${a.value.style.breakPoint}`)),u}),y=Te(()=>{var O,V,K;const u=!t.isUndefined(a.value.style)&&a.value.style.bgColor!="none"?`background-color: ${a.value.style.bgColor}; `:"",g=!t.isUndefined(a.value.style)&&a.value.style.fontColor!="none"?`color: ${a.value.style.fontColor}; `:"",h=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.top!="none"?`border-top: ${a.value.style.border.top}; `:"",w=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.right!="none"?`border-right: ${a.value.style.border.right}; `:"";let U=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((O=s.task)==null?void 0:O.isShowAdjustmentRow)&&((V=s.task)!=null&&V.isShowAdjustmentRow))U="";else{let q=0;(K=s.task)==null||K.items.forEach(A=>{var P;t.isUndefined(A.style)||(t.isUndefined(A.style.border)?t.isUndefined(A.style.border)&&(q=q+Number(A.style.breakPoint)):((A.style.border.right=="none"||t.isUndefined(A.style.border.right))&&(q=q+Number(A.style.breakPoint)),t.isEqual(A,t.last((P=s.task)==null?void 0:P.items))&&(q=q+Number(A.style.breakPoint))))}),q==12&&(U=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const m=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.left!="none"?`border-left: ${a.value.style.border.left}; `:"",b=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${a.value.style.borderRadius.topRight}; `:"",f=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${a.value.style.borderRadius.bottomRight}; `:"",F=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${a.value.style.borderRadius.topLeft}; `:"",J=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${a.value.style.borderRadius.bottomLeft}; `:"";let _="";return U&&(_="padding-bottom: 25px; "),`${_}${u}${g}${h}${w}${U}${m}${b}${f}${F}${J}`}),d=Te(()=>!t.isUndefined(a.value.style)&&a.value.style.breakPoint=="1"?"width: 20px; height: 20px":"");Ia(async()=>{const u={id:a.value.value.toString(),ver:"v1"};try{const w=(await Ht.getBlob("https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_attachment/download_by_id","",new URLSearchParams(u).toString())).data,U=new Blob([w]),m=window.URL||window.webkitURL;e.value=m.createObjectURL(U),l.value=!1}catch{l.value=!1}});const p=Te(()=>{let u="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(u=""),u});return(u,g)=>{const h=Aa("loading");return Wt((c(),$("div",{class:we([[W(o),W(v),W(p)],"pt-2 px-2 d-flex d-flex justify-content-center"]),style:ce(W(y))},[n("img",{src:e.value,class:"img-fluid",style:ce(W(d))},null,12,Il)],6)),[[h,l.value]])}}}),$l=["innerHTML"],Ya=Ue({__name:"Label",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const s=r,e=De(s,"item"),l=i(()=>ba(s.item.value)),a=i(()=>{var u,g;return((u=s.task)==null?void 0:u.taskType)==="table"||((g=s.task)==null?void 0:g.taskType)==="collapsibleTable"?"col":s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""}),o=i(()=>{var g,h;if(((g=s.task)==null?void 0:g.taskType)==="table"||((h=s.task)==null?void 0:h.taskType)==="collapsibleTable")return"col";let u="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(u=`col-md-${e.value.style.potraitBreakPoint}`,u=`${u} col-lg-${e.value.style.breakPoint}`):(u=`col-md-${e.value.style.potraitBreakPoint}`,u=`${u} col-lg-${e.value.style.breakPoint}`)),u}),v=i(()=>t.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),y=i(()=>{var O,V,K,q;const u=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",g=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",h=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",w=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let U=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((O=s.task)==null?void 0:O.isShowAdjustmentRow)&&((V=s.task)!=null&&V.isShowAdjustmentRow))U="";else{let A=0;(K=s.task)==null||K.items.forEach(P=>{var I;t.isUndefined(P.style)||(t.isUndefined(P.style.border)?t.isUndefined(P.style.border)&&(A=A+Number(P.style.breakPoint)):((P.style.border.right=="none"||t.isUndefined(P.style.border.right))&&(A=A+Number(P.style.breakPoint)),t.isEqual(P,t.last((I=s.task)==null?void 0:I.items))&&(A=A+Number(P.style.breakPoint))))}),((q=s.task)==null?void 0:q.showParameter)=="suspensionCylinder"&&console.log("totalCol",A),A==12&&(U=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const m=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",b=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",f=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",F=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",J=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let _="";return U&&(_="padding-bottom: 25px; "),`${_}${u}${g}${h}${w}${U}${m}${b}${f}${F}${J}`}),d=i(()=>`${!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.fontWeight)&&e.value.style.fontWeight!="normal"?`font-weight: ${e.value.style.fontWeight}; `:""}`),p=i(()=>{let u="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(u=""),u});return(u,g)=>(c(),$("div",{class:we([[a.value,v.value,o.value,p.value],"px-2 pt-2"]),style:ce(y.value)},[!W(t.isUndefined)(r.item.style)&&r.item.style.visibility!="hidden"?(c(),$("label",{key:0,style:ce(d.value),innerHTML:l.value},null,12,$l)):D("",!0)],6))}}),Tl=Ea({id:"Interimcrack",state:()=>({stateLoading:!1,stateCancelled:!1,stateIsYes:void 0,stateCrackYesVisible:!1,stateCrackNoVisible:!1,stateViewYesVisible:!1,stateViewtNoVisible:!1,stateIsValid:!0,stateItemKey:"",stateTask:{},stateCrackInfo:{},statePayload:{updateParams:[]},statePreviousCrack:[]}),getters:{Loading:r=>r.stateLoading,Cancelled:r=>r.stateCancelled,CrackYesVisible:r=>r.stateCrackYesVisible,CrackNoVisible:r=>r.stateCrackNoVisible,ViewYesVisible:r=>r.stateViewYesVisible,ViewNoVisible:r=>r.stateViewtNoVisible,ItemKey:r=>r.stateItemKey,isValid:r=>r.stateIsValid,IsYes:r=>r.stateIsYes,crackInfo:r=>r.stateCrackInfo,selectedGroup:()=>bt().selectedGroup,selectedFitter:()=>bt().employee,supervisor:()=>{const r=Dt();return{id:r.user.EmployeeId,name:r.user.Name}},images:()=>_t().ImageObjects.find(s=>s.Id==="crack"),globalConnectionStore:()=>Vt()},actions:{setItemKey(r){this.stateItemKey=r},setCancelledState(r){this.stateCancelled=r},cretateInstance(r=!0){this.stateCrackInfo=r?new Na:new Va,this.stateIsYes=r},setTask(r){this.stateTask=r},toggleYesVisible(r){this.stateCrackYesVisible=r,this.stateCrackNoVisible=!1,this.stateCancelled=!1},toggleNoVisible(r){this.stateCrackNoVisible=r,this.stateCrackYesVisible=!1,this.stateCancelled=!1},toggleViewNoVisible(r){this.stateViewtNoVisible=r,this.stateViewYesVisible=!1},toggleViewYesVisible(r){this.stateViewYesVisible=r,this.stateViewtNoVisible=!1},createCrackYesPayload(r){var a;const s=this.stateCrackInfo,e=((a=this.images)==null?void 0:a.ImageInfos)??[],l=s.Resources.filter(o=>o.value!=="");this.statePayload.defectDetail={type:"YES",title:r,assetNumber:s.AssetNumber,description:s.Description.value,raisedBy:this.selectedFitter.name,date:"<<ServerDateTime>>",plannedDuration:s.PlannedDuration.value,instruction:s.Instruction.value,priority:s.Priority,parts:JSON.stringify(s.Parts),labours:JSON.stringify(s.Labours),resources:JSON.stringify(l.map(o=>o.value)),symptoms:JSON.stringify(s.Symptoms.map(o=>o.value)),causes:JSON.stringify(s.Causes.map(o=>o.value)),images:JSON.stringify(e),previousCracks:JSON.stringify(s.CrackLength)}},createCrackNoPayload(r){var l;const s=this.stateCrackInfo,e=((l=this.images)==null?void 0:l.ImageInfos)??[];this.statePayload.defectDetail={type:"NO",title:r,assetNumber:this.crackInfo.AssetNumber,description:this.crackInfo.Description.value,raisedBy:this.selectedFitter.name,instruction:s.Instruction.value,date:"<<ServerDateTime>>",images:JSON.stringify(e),previousCracks:JSON.stringify(s.CrackLength)}},createPayloadCrack(){const r=bt();this.statePayload.id=this.selectedGroup.id,this.statePayload.workorder=this.selectedGroup.workOrder,this.statePayload.headerId=this.selectedGroup.headerId,this.statePayload.updateParams=[],this.statePayload.updateParams.push({keyValue:this.stateTask.key,propertyParams:[{propertyName:"taskValue",propertyValue:this.stateIsYes?"3":"2"},{propertyName:"updatedBy",propertyValue:JSON.stringify(this.selectedFitter)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}),this.statePayload.employee=this.selectedFitter,this.statePayload.defectHeader={workorder:r.generalForm.workOrder,form:this.selectedGroup.modelId,serviceSheetDetailId:this.selectedGroup.id,category:this.stateTask.category,taskId:this.stateTask.key,taskNo:this.stateTask.description!=""?this.stateTask.description.split(";")[0]:this.stateTask.items[0].value,taskDesc:this.stateTask.description!=""?this.stateTask.description:this.stateTask.items[1].value,crackWorkorder:"",formCrack:"BA-PL-F55",crackType:this.stateIsYes?"YES":"NO",taskValue:this.stateIsYes?"3":"2",repairedStatus:"Not-Repaired",cbmNAStatus:"Not-Confirm",supervisor:this.supervisor,status:"Submited",defectStatus:"Submited"};let s="";if(this.stateTask.description!=""&&this.stateTask.description.includes(";")){const e=[];this.stateTask.description.split("|").forEach(l=>{e.push(l.split(";")[2])}),s=e.join(", ")}else s=this.stateTask.items.length<4?this.stateTask.items[1].value:this.stateTask.items[2].value;this.stateIsYes?this.createCrackYesPayload(s):this.createCrackNoPayload(s)},async createCrack(){this.stateLoading=!0;const r={ver:"v1"};try{this.createPayloadCrack();const s=await Ht.post(`${Rs}?${new URLSearchParams(r).toString()}`,this.statePayload);return this.stateLoading=!1,s.data.result.message==wa.TASK_UPDATED_BY_OTHER?(bt().toggleTaskAlreadyUpdatedStatus(!0),!1):s.data.result.message==wa.SUBMITTED?(bt().toggleFormAlreadySubmitted(!0),!1):s.data.result.message==wa.CLOSE?(bt().toggleFormAlreadyClose(!0),!1):!0}catch(s){const e=this.globalConnectionStore.checkIsErrorNoNetwork(s);return this.globalConnectionStore.setSubmitConnectionError(e),Ca(s),console.log(s),this.stateLoading=!1,ya("IRONS",s),!1}},async getPreviousCrack(r,s,e,l){this.stateLoading=!0;const a={ver:"v1"},o={workorder:r,modelId:s,psTypeId:e,taskId:l};try{const v=await Ht.post(`${Ps}?${new URLSearchParams(a).toString()}`,o),y=[];v.data.result.content.forEach(d=>{const p={currentCrack:d.currentCrack,locationDesc:d.locationDesc,locationId:d.locationId,previousCrack:d.previousCrack,isValid:!0,message:""};y.push(p)}),this.stateCrackInfo.importPreviousCrack(...y)}catch(v){Ca(v),ya("IRONS",v),console.log(v)}this.stateLoading=!1},async getCrackDetail(r,s){this.stateLoading=!0;const e={ver:"v1"},l={servicesheetDetailId:r,taskId:s};try{const o=(await Ht.post(`${Bs}?${new URLSearchParams(e).toString()}`,l)).data.result.content.detail,v=_t(),y=ks();if(v.setCurrent("crack"),v.clearCurrent(),o.type==="YES"){this.stateIsYes=!0;const d=new Na;d.setAssetNumber(o.assetNumber),d.setDescription(o.description),d.setPriority(o.priority),d.setRaisedBy(o.raisedBy),d.setDate(o.date),d.setPlannedDuration(o.plannedDuration),d.setInstruction(o.instruction),d.setTitle(o.title),d.importParts(...JSON.parse(o.parts)),d.importLabours(...JSON.parse(o.labours)),d.importResources(...JSON.parse(o.resources)),d.importSymptoms(...JSON.parse(o.symptoms)),d.importCauses(...JSON.parse(o.causes)),d.importPreviousCrack(...JSON.parse(o.previousCracks)),this.images.ImageInfos.push(...JSON.parse(o.images));const p=[];this.images.ImageInfos.forEach(u=>{let g="";typeof u=="string"?g=u:g=u.filename,p.push(y.downloadAttachment(g))}),Promise.all(p).then(u=>{u.forEach(g=>{const h=new Blob([g],{type:"image/png"});this.images.ImageBlobs.push(h)}),this.stateCrackInfo=d,this.toggleViewYesVisible(!0)})}else{this.stateIsYes=!1,this.stateCrackInfo=new Va,this.stateCrackInfo.setAssetNumber(o.assetNumber),this.stateCrackInfo.setDescription(o.description),this.stateCrackInfo.setRaisedBy(o.raisedBy),this.stateCrackInfo.setDate(o.date),this.stateCrackInfo.setInstruction(o.instruction),this.stateCrackInfo.setTitle(o.title),this.stateCrackInfo.importPreviousCrack(...JSON.parse(o.previousCracks)),this.images.ImageInfos.push(...JSON.parse(o.images));const d=[];this.images.ImageInfos.forEach(p=>{let u="";typeof p=="string"?u=p:u=p.filename,d.push(y.downloadAttachment(u))}),Promise.all(d).then(p=>{p.forEach(u=>{const g=new Blob([u],{type:"image/png"});this.images.ImageBlobs.push(g)}),this.toggleViewNoVisible(!0)})}}catch(a){Ca(a),ya("IRONS",a),console.log(a)}this.stateLoading=!1},resetInstance(){this.stateLoading=!1,this.stateCrackInfo={},this.stateCrackNoVisible=!1,this.stateCrackYesVisible=!1,this.stateViewYesVisible=!1,this.stateViewtNoVisible=!1,this.stateIsValid=!0,this.stateItemKey="",this.stateTask={},this.stateIsYes=void 0,this.statePayload={updateParams:[]}}}}),Rl=n("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[n("h3",null,"Notify Supervisor or Reliability Engineer")],-1),Pl={class:"row text-center pt-5"},Ja=Ue({__name:"CBMDefectC",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(r,{emit:s}){const e=r,l=s,a=Te(()=>e.show),o=()=>{l("close")};return(v,y)=>{const d=ne("el-button"),p=ne("el-dialog");return c(),Z(p,{modelValue:W(a),"onUpdate:modelValue":y[0]||(y[0]=u=>Et(a)?a.value=u:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:le(()=>[Rl,n("div",Pl,[j(d,{type:"success",class:"ok-button",onClick:o},{default:le(()=>[yt("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),Bl=n("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[n("h3",null,"Machine is not to be used. Notify Supervisor or Reliability Engineer Immediately")],-1),Vl={class:"row text-center pt-5"},Wa=Ue({__name:"CBMDefectX",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(r,{emit:s}){const e=r,l=s,a=Te(()=>e.show),o=()=>{l("close")};return(v,y)=>{const d=ne("el-button"),p=ne("el-dialog");return c(),Z(p,{modelValue:W(a),"onUpdate:modelValue":y[0]||(y[0]=u=>Et(a)?a.value=u:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:le(()=>[Bl,n("div",Vl,[j(d,{type:"success",class:"ok-button",onClick:o},{default:le(()=>[yt("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),Nl=n("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[n("h3",null,"Please take a photo")],-1),xl={class:"row text-center pt-5"},za=Ue({__name:"TakePhoto",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(r,{emit:s}){const e=r,l=s,a=Te(()=>e.show),o=()=>{l("close")};return(v,y)=>{const d=ne("el-button"),p=ne("el-dialog");return c(),Z(p,{modelValue:W(a),"onUpdate:modelValue":y[0]||(y[0]=u=>Et(a)?a.value=u:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0,"close-on-click-modal":!1,"close-on-press-escape":!1},{default:le(()=>[Nl,n("div",xl,[j(d,{type:"success",class:"ok-button",onClick:o},{default:le(()=>[yt("OK")]),_:1})])]),_:1},8,["modelValue"])}}}),Dl={class:"row pt-3 pb-3 text-dark modal-title"},Al=n("h3",null," Please select if any of the questions below are applicable to this defect before submitting. Please note neither may be applicable and you can still submit and continue. ",-1),Fl=n("span",{innerHTML:"Does the defect identified require > 30 minutes in labour to repair?"},null,-1),Ol={class:"dialog-footer",style:{display:"block","text-align":"right"}},El=Ue({__name:"DefectConfirmationDialog",props:["show","checkListArr"],emits:["close","updateCheckList","submit"],setup(r,{emit:s}){const e=r,l=s,a=Te({get:()=>e.checkListArr,set:d=>{l("updateCheckList",d)}}),o=()=>{l("submit")},v=Te(()=>e.show),y=()=>{l("close")};return(d,p)=>{const u=ne("el-checkbox"),g=ne("el-checkbox-group"),h=ne("el-button"),w=ne("el-dialog");return c(),Z(w,{modelValue:W(v),"onUpdate:modelValue":p[1]||(p[1]=U=>Et(v)?v.value=U:null),width:"50%","show-close":!1,"custom-class":"oil-not-in-range__header defect__confirmation_container",top:"30vh",center:!0,onClose:y},{footer:le(()=>[n("span",Ol,[j(h,{onClick:y,style:{"box-shadow":"0px 24px 48px rgba(145, 158, 171, 0.2)"}},{default:le(()=>[yt("Cancel")]),_:1}),j(h,{class:"button-OK-confirmation",type:"success",onClick:fs(o,["prevent"]),style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},{default:le(()=>[yt("Submit")]),_:1})])]),default:le(()=>[n("div",Dl,[Al,j(g,{modelValue:W(a),"onUpdate:modelValue":p[0]||(p[0]=U=>Et(a)?a.value=U:null),class:"d-flex flex-column defect-checkbox"},{default:le(()=>[j(u,null,{default:le(()=>[Fl]),_:1}),j(u,{label:"Does the defect identified require > $250 in parts to repair?"})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}}),Kt=r=>(zt("data-v-b02c4cf5"),r=r(),Xt(),r),Ll={class:"px-0 mx-0 d-flex"},jl=["innerHTML"],Ml=["innerHTML"],Hl={key:0,class:"ms-2"},Kl=Kt(()=>n("img",{src:ga,alt:"na",class:"d-icon"},null,-1)),Gl=[Kl],ql=Kt(()=>n("img",{src:oa,alt:"defect",class:"d-icon"},null,-1)),Yl=[ql],Jl=Kt(()=>n("img",{src:oa,alt:"defect",class:"d-icon"},null,-1)),Wl=[Jl],zl=Kt(()=>n("img",{src:ga,alt:"na",class:"d-icon"},null,-1)),Xl=[zl],Zl=Kt(()=>n("img",{src:Is,alt:"ok",class:"d-icon"},null,-1)),Ql=[Zl],eo={key:0,class:"ms-1 d-flex align-items-center"},to=Kt(()=>n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Updating...")],-1)),ao=Kt(()=>n("span",{class:"timestamp-task"},"Updating...",-1)),so=[to,ao],lo={key:1,class:"ms-1 d-flex align-items-center",style:{opacity:"0"}},oo=Kt(()=>n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Updating...")],-1)),ro=Kt(()=>n("span",{class:"timestamp-task"},"Updating...",-1)),no=[oo,ro],io=Ue({__name:"Dropdown",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1},generalSubmitted:{required:!0,type:Boolean}},emits:["setLoading"],setup(r,{emit:s}){const e=r,l=s,a=De(e,"item"),o=De(e,"task"),v=Dt(),y=Vs(),d=vt(),p=Oa(),u=Tl(),g=Ta(),h=Vt(),w=k(!1),U=k(!1),m=k(""),b=k(""),f=k(!1),F=_t(),J=k(!1),_=_s(),O=k(!1),V=k(null),K=k([]),q=()=>{var R,X;_.setReason((R=e.task)==null?void 0:R.reason),_.setTitle((X=e.task)==null?void 0:X.description),_.setVisible(!0)},A=R=>{K.value=R},P=()=>{K.value.length<1?ve():Se(),K.value=[]},I=i(()=>U),x=i(()=>p.Cancelled),T=i(()=>u.Cancelled),L=i(()=>g.Cancelled),z=k(!1),ue=k(!1),be=k(!1),Ee=()=>{var R;(R=e.task)==null||R.items.forEach(X=>{X.itemType==="smallCamera"&&(F.toggleIsVisible(!0,X.key),F.setShowCloseButton(!1),F.setShowCloseButton(!1))}),be.value=!1},Q=i(()=>{let R="Choose One";return!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.placeholder)&&(R=a.value.style.placeholder),R});ke(x,R=>{var X,de,ye;if(l("setLoading",!1),R===!0){if(((X=a.value)==null?void 0:X.categoryItemType)=="resultRating")return;const Be=localStorage.getItem("taskKey");console.log((de=o.value)==null?void 0:de.key),Be===((ye=o.value)==null?void 0:ye.key)&&(a.value.value=m.value,U.value=!U.value,p.setCancelledState(!1),f.value=!1)}}),ke(T,R=>{var X,de;if(l("setLoading",!1),R===!0){if(((X=a.value)==null?void 0:X.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((de=o.value)==null?void 0:de.key)&&(a.value.value=m.value,U.value=!U.value,u.setCancelledState(!1),f.value=!1)}}),ke(L,R=>{var X,de;if(l("setLoading",!1),R===!0){if(((X=a.value)==null?void 0:X.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((de=o.value)==null?void 0:de.key)&&(a.value.value=m.value,U.value=!U.value,g.setCancelledState(!1),f.value=!1)}});const N=i(()=>e.generalStyle?!t.isUndefined(a.value.style)&&a.value.style.breakPoint!="none"?`col-${a.value.style.breakPoint}`:"col":""),Y=i(()=>{let R="";return e.generalStyle&&!t.isUndefined(a.value.style)&&(!t.isUndefined(a.value.style.potraitBreakPoint)&&a.value.style.breakPoint!="none"?(R=`col-md-${a.value.style.potraitBreakPoint}`,R=`${R} col-lg-${a.value.style.breakPoint}`):(R=`col-md-${a.value.style.potraitBreakPoint}`,R=`${R} col-lg-${a.value.style.breakPoint}`)),R}),te=i(()=>{var R;return G.value?(R=ge.value.find(X=>X.value==String(G.value)))==null?void 0:R.label:G.value}),ie=i(()=>{var de,ye;const R=a.value.value.toString().replaceAll("'","");let X;return R=="1"?X="green":R=="2"||R=="3"&&((de=o.value)==null?void 0:de.category)=="CRACK"?X="red":R=="3"&&(((ye=o.value)==null?void 0:ye.category)=="NORMAL"||a.value.categoryItemType=="resultStatus")||R=="4"?X="yellow":R=="A"?X="a":R=="B"?X="b":R=="C"?X="c":R=="X"&&(X="x"),X}),ae=i(()=>{var X;let R=[];return(X=e.task)==null||X.items.forEach(de=>{de.itemType==="smallCamera"&&(R=de.value)}),R}),Ne=async R=>{var de;const X=R.selectedReason+":"+R.desc;if(a.value.value=="1"){const ye=Ye.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"}),Be=[{keyValue:(de=o.value)==null?void 0:de.key,propertyParams:[{propertyName:"taskValue",propertyValue:"1"},{propertyName:"updatedBy",propertyValue:JSON.stringify(d.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"},{propertyName:"reason",propertyValue:X}]}],ze=[{keyValue:a.value.key,propertyParams:[{propertyName:"value",propertyValue:"1"},{propertyName:"updatedBy",propertyValue:JSON.stringify(d.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}],it=[...Be,...ze];d.updateAllItems(a.value.key,"1"),await d.updateServiceSheetTaskValue(it,v.user.EmployeeId,v.user.Name),ye.close(),R.afterSubmit()}},Ze=async()=>{V.value=null,O.value=!1},Je=async()=>{a.value.value=m.value,Ze()},Qe=R=>{B(R,!0)},ct=i(()=>Ds(o.value.updatedBy||"",d.employee)),B=async(R,X,de=!1)=>{var ye,Be,ze,it,pt,wt,Xe,ut,dt,kt,mt,tt,Lt,Qt,Tt,ea,Gt,At,ta,aa,sa;if(pe.value=!1,t.isUndefined((Be=(ye=e.task)==null?void 0:ye.updatedBy)==null?void 0:Be.id)||l("setLoading",!0),d.setStateItemKey(a.value.key),e.item.categoryItemType=="brakeTypeDropdown"){const ht=[{keyValue:(ze=o.value)==null?void 0:ze.key,propertyParams:[{propertyName:"taskValue",propertyValue:""},{propertyName:"updatedBy",propertyValue:R===""},{propertyName:"updatedDate",propertyValue:R===""}]}];await d.updateItemServiceSheetDetail(ht)}if(e.item.categoryItemType=="dropdownTool"||e.item.categoryItemType=="dropdownToolDisc")if(h.stateConnectionStatus){f.value=!0,m.value=G.value;const ht=[{keyValue:(it=o.value)==null?void 0:it.key,propertyParams:[{propertyName:"taskValue",propertyValue:""},{propertyName:"updatedBy",propertyValue:R===""},{propertyName:"updatedDate",propertyValue:R===""}]}];await d.updateItemServiceSheetDetail(ht),a.value.value=R,await d.updateToolUom(e.task,a.value),f.value=!1,l("setLoading",!1)}else{h.setSubmitConnectionError(!0),a.value.value=m.value,localStorage.removeItem("taskKey");return}else{if(G.value===R||R===((pt=e.task)==null?void 0:pt.taskValue)&&!(x.value||T.value||L.value))return;if(oe(),x.value||T.value||L.value){m.value="",localStorage.removeItem("taskKey");return}else if(h.stateConnectionStatus){if(l("setLoading",!0),f.value=!0,localStorage.setItem("taskKey",(wt=o.value)==null?void 0:wt.key),m.value=G.value,b.value=(Xe=o.value)==null?void 0:Xe.key,a.value.value=R,m.value=="3"&&((ut=e.task)==null?void 0:ut.category)==="NORMAL"&&R!=""&&!ct.value)V.value=await g.getNADetailValue((dt=d.selectedGroup)==null?void 0:dt.id,(kt=o.value)==null?void 0:kt.key),O.value=!0;else if(R==="2"&&((mt=e.task)==null?void 0:mt.category)==="NORMAL")p.setTask(e.task),p.setItemKey(a.value.key),w.value=!0,p.setItem(a.value);else if(R==="3"&&((tt=e.task)==null?void 0:tt.category)==="CRACK")u.setTask(e.task),u.setItemKey(a.value.key),u.cretateInstance(!0),await u.getPreviousCrack(d.generalForm.workOrder,d.generalForm.modelId,d.generalForm.psTypeId,e.task.key),u.toggleYesVisible(!0);else if(R==="2"&&((Lt=e.task)==null?void 0:Lt.category)==="CRACK")u.setTask(e.task),u.setItemKey(a.value.key),u.cretateInstance(!1),await u.getPreviousCrack(d.generalForm.workOrder,d.generalForm.modelId,d.generalForm.psTypeId,e.task.key),u.toggleNoVisible(!0);else if(R==="3"&&((Qt=e.task)==null?void 0:Qt.category)==="NORMAL"||R=="3"&&a.value.categoryItemType=="resultStatus"||R==="4"&&((Tt=e.task)==null?void 0:Tt.category)==="CRACK")g.setTask(e.task),g.setItemKey(a.value.key),g.toggleIsVisible(!0),g.setItem(a.value);else if(R=="C"||R=="X"){let ht;if(!t.isUndefined(a.value.customValidation)){const Rt=a.value.customValidation.includes("cbmTakePhotoAllRating"),Ot=a.value.customValidation.includes("cbmTakePhoto");(Rt||Ot)&&(ht=Ye.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"}))}const ft=e.task.items.find(Rt=>Rt.itemType==="smallCamera");ft&&d.setMeasurementValueAndUOM("","",ft.key);const Ft=await d.updateDefect(e.task,R,a.value);if(!t.isUndefined(a.value.customValidation)){const Rt=a.value.customValidation.includes("cbmTakePhotoAllRating"),Ot=a.value.customValidation.includes("cbmTakePhoto");(Rt||Ot)&&ht.close()}Ft&&(R=="C"||R=="X")&&X&&(d.setInputCameraMandatoryKey(a.value.key),pe.value||ae.value.length==0&&(be.value=!0),pe.value=!1)}else if(e.task.showParameter=="suspensionCylinder"&&R=="Yes")f.value=!0,await d.updateDefectCalibrationDropdown(e.task,a.value);else{a.value.value=="1"&&d.updateAllItems(a.value.key,"1");let ht;((ea=e.task)==null?void 0:ea.category)==="CBM"&&(R=="A"||R=="B")&&!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("cbmTakePhotoAllRating")&&(ht=Ye.service({lock:!0,text:"",background:"rgba(0, 0, 0, 0.7)"})),m.value&&(((Gt=e.task)==null?void 0:Gt.category)==="CBM"||((At=e.task)==null?void 0:At.category)==="NORMAL"||((ta=e.task)==null?void 0:ta.category)==="CRACK")&&await d.deleteDefect(e.task);let ft=a.value.value.toString()??"1";e.task.showParameter=="suspensionCylinder"&&(a.value.value==""?ft="":ft="1",d.updateStoredAdjustmentOptionValue(a.value.value));const Ft={keyValue:(aa=o.value)==null?void 0:aa.key,propertyParams:[{propertyName:"taskValue",propertyValue:ft},{propertyName:"updatedBy",propertyValue:R===""?"":JSON.stringify(d.employee)},{propertyName:"updatedDate",propertyValue:R===""?"":"<<ServerDateTime>>"}]};((sa=e.task)==null?void 0:sa.category)=="NORMAL"&&Ft.propertyParams.push({propertyName:"reason",propertyValue:""});let Rt={},Ot={};a.value.categoryItemType=="resultRating"&&((e.task.taskValue=="3"||e.task.taskValue=="4")&&await d.deleteDefect(e.task),Ot={keyValue:e.task.key,propertyParams:[{propertyName:"taskNormalValue",propertyValue:""}]},e.task.items.forEach(jt=>{jt.categoryItemType=="resultStatus"&&(Rt={keyValue:jt.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]})}));const qt=[{keyValue:a.value.key,propertyParams:[{propertyName:"value",propertyValue:R},{propertyName:"updatedBy",propertyValue:R===""?"":JSON.stringify(d.employee)},{propertyName:"updatedDate",propertyValue:R===""?"":"<<ServerDateTime>>"}]}];!t.isUndefined(a.value.isTaskValue)&&a.value.isTaskValue&&qt.push(Ft),a.value.categoryItemType=="resultRating"&&(qt.push(Rt),qt.push(Ot)),await d.updateServiceSheetTaskValue(qt,v.user.EmployeeId,v.user.Name).then(jt=>{var la;f.value=!1,d.setStateItemKey(""),jt?(((la=e.task)==null?void 0:la.category)==="CBM"&&(R=="A"||R=="B")&&(d.setInputCameraMandatoryKey(a.value.key),!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("cbmTakePhotoAllRating")&&(pe.value||ae.value.length==0&&(be.value=!0),pe.value=!1)),R=="1"&&m.value==""&&(d.setInputCameraMandatoryKey(a.value.key),!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("normalTakePhoto")&&(pe.value||ae.value.length==0&&(be.value=!0),pe.value=!1),!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("cbmTakePhoto")&&(pe.value||ae.value.length==0&&(be.value=!0),pe.value=!1)),me()):a.value.value=m.value}),(R=="A"||R=="B")&&!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("cbmTakePhotoAllRating")&&ht.close()}f.value=!1,J.value=!0,l("setLoading",!1)}else{h.setSubmitConnectionError(!0),localStorage.removeItem("taskKey"),a.value.value=m.value;return}}},G=i(()=>e.item.value.toString().replaceAll("'","")),me=()=>{e.item.categoryItemType=="brakeTypeDropdown"&&d.updateStoredBrakeTypeValue({key:a.value.key,value:a.value.value})},Re=i(()=>d.taskAlreadyUpdated),pe=k(!1);ke(Re,async(R,X)=>{R&&(pe.value=!0)}),xt(()=>{m.value=a.value.value});const he=async()=>{var R,X,de;if(!t.isUndefined(a.value.brakeTypeItemKey)){let ye=d.stateStoredBrakeTypeValue.find(Be=>Be.key==a.value.brakeTypeItemKey);if(t.isUndefined(ye)){const Be=await d.getValueFromItemKey(a.value.brakeTypeItemKey);d.pushStoredDisabledItems({key:a.value.brakeTypeItemKey,value:Be})}ye=d.stateStoredBrakeTypeValue.find(Be=>Be.key==a.value.brakeTypeItemKey),(ye==null?void 0:ye.value)==""?(xe.value=!0,((R=e.task)==null?void 0:R.taskType)=="inline"&&a.value.value&&B("",!1)):(ye==null?void 0:ye.value)=="Oil Cooled"?e.item.categoryItemType=="dropdownTool"?(xe.value=!0,((X=e.task)==null?void 0:X.taskType)=="inline"&&a.value.value&&B("",!1)):xe.value=!1:(ye==null?void 0:ye.value)=="Caliper"?(e.item.categoryItemType=="dropdownToolDisc"?(xe.value=!0,((de=e.task)==null?void 0:de.taskType)=="inline"&&a.value.value&&B("",!1)):xe.value=!1,e.item.categoryItemType=="dropdownTool"&&e.item.value==""&&B(ge.value[0].value,!1)):xe.value=!1}},xe=k(!1);ke(G,async(R,X)=>{var de;if(me(),he(),!t.isUndefined(a.value.disabledByItemKey)){let ye=d.stateStoredDisableKeyValue.find(Be=>Be.key==a.value.disabledByItemKey);if(t.isUndefined(ye)){const Be=await d.getValueFromItemKey(a.value.disabledByItemKey);d.pushStoredDisabledItems({key:a.value.disabledByItemKey,value:Be})}ye=d.stateStoredDisableKeyValue.find(Be=>Be.key==a.value.disabledByItemKey),(ye==null?void 0:ye.value)=="3"?(xe.value=!0,((de=e.task)==null?void 0:de.taskType)=="inline"&&a.value.value&&B("",!1)):xe.value=!1}d.stateStoredDisableKeyValue.forEach(ye=>{ye.key==a.value.key&&(ye.value=R)})},{deep:!0});const Me=i(()=>e.itemLoading);ke(()=>d.stateShowSCConfirmToSPC,R=>{var X,de;R&&!t.isUndefined((X=e.task)==null?void 0:X.showParameter)&&((de=e.task)==null?void 0:de.showParameter)=="suspensionCylinder"&&e.item.value!=""&&B("",!1)}),ke(Me,R=>{f.value=R});const E=i(()=>d.stateStoredSuspensionCylinderValue);ke(E,R=>{var ye,Be;if(t.isUndefined((ye=e.task)==null?void 0:ye.showParameter)||((Be=e.task)==null?void 0:Be.showParameter)!="suspensionCylinder")return;let X=!1;R.forEach(ze=>{ze.value==""&&(X=!0)});let de=!0;X||(R.forEach(ze=>{(ze.value=="Out of spec"||ze.value=="Out Spec")&&(de=!1)}),de&&a.value.value==""&&B("No",!1))},{deep:!0});const oe=()=>{p.toggleYesVisible(!1),p.toggleNoVisible(!1),p.toggleViewNoVisible(!1),p.toggleViewYesVisible(!1),u.toggleYesVisible(!1),u.toggleNoVisible(!1),u.toggleViewNoVisible(!1),u.toggleViewYesVisible(!1),g.toggleIsVisible(!1),g.toggleIsViewVisible(!1)},ge=i(()=>{const R=e.item.caption.replace("[","").replace("]","").split("; "),X=e.item.itemValue.replace("[","").replace("]","").split(", ");return R.map((ye,Be)=>({label:ye.replaceAll("'",""),value:X[Be].replaceAll("'","")}))}),Pe=i(()=>{var ut,dt,kt;const R=!t.isUndefined(a.value.style)&&a.value.style.bgColor!="none"?`background-color: ${a.value.style.bgColor}; `:"",X=!t.isUndefined(a.value.style)&&a.value.style.fontColor!="none"?`color: ${a.value.style.fontColor}; `:"",de=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.top!="none"?`border-top: ${a.value.style.border.top}; `:"",ye=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.right!="none"?`border-right: ${a.value.style.border.right}; `:"";let Be=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((ut=e.task)==null?void 0:ut.isShowAdjustmentRow)&&((dt=e.task)!=null&&dt.isShowAdjustmentRow))Be="";else{let mt=0;(kt=e.task)==null||kt.items.forEach(tt=>{var Lt;t.isUndefined(tt.style)||(t.isUndefined(tt.style.border)?t.isUndefined(tt.style.border)&&(mt=mt+Number(tt.style.breakPoint)):((tt.style.border.right=="none"||t.isUndefined(tt.style.border.right))&&(mt=mt+Number(tt.style.breakPoint)),t.isEqual(tt,t.last((Lt=e.task)==null?void 0:Lt.items))&&(mt=mt+Number(tt.style.breakPoint))))}),mt==12&&(Be=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const ze=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.left!="none"?`border-left: ${a.value.style.border.left}; `:"",it=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${a.value.style.borderRadius.topRight}; `:"",pt=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${a.value.style.borderRadius.bottomRight}; `:"",wt=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${a.value.style.borderRadius.topLeft}; `:"",Xe=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${a.value.style.borderRadius.bottomLeft}; `:"";return`${R}${X}${de}${ye}${Be}${ze}${it}${pt}${wt}${Xe}`}),Oe=async()=>{var X,de;const R=Ye.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await p.getDefectDetail((X=d.selectedGroup)==null?void 0:X.id,(de=o.value)==null?void 0:de.key),R.close()},We=async()=>{var X,de;const R=Ye.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await u.getCrackDetail((X=d.selectedGroup)==null?void 0:X.id,(de=o.value)==null?void 0:de.key),R.close()},C=async()=>{var X,de,ye;const R=Ye.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await g.getNADetail((X=d.selectedGroup)==null?void 0:X.id,(de=o.value)==null?void 0:de.key),await H({workorder:d.generalForm.workOrder,taskId:(ye=o.value)==null?void 0:ye.key}),R.close()},H=async R=>{const X=await y.getApprovalDefect(R);y.setApprovalData(X||{})},fe=i(()=>{var R;return(R=e.task)==null?void 0:R.updatedBy});ke(fe,R=>{R!=""&&(J.value=!1)});const Se=async()=>{w.value=!1,p.cretateInstance(!0),p.toggleYesVisible(!0)},ve=()=>{w.value=!1,p.cretateInstance(!1),p.toggleNoVisible(!0)},_e=()=>{K.value=[],w.value=!1,a.value.value=m.value},je=()=>{z.value=!1},Ae=()=>{ue.value=!1},He=i(()=>d.generalForm.status=="Submited"),Ke=i(()=>{var ze,it,pt,wt,Xe,ut;if(!e.generalSubmitted)return!0;let R=!0;!t.isUndefined(o.value.updatedBy)&&!t.isUndefined(o.value.updatedBy.id)&&((ze=o.value)==null?void 0:ze.updatedBy.toString())!=""&&d.employee.id!=o.value.updatedBy.id&&(R=!1);const X=((it=o.value)==null?void 0:it.category)=="CBM",de=a.value.value=="3"&&((pt=o.value)==null?void 0:pt.category)=="NORMAL";(X||de)&&(R=!0);let ye=!1;(G.value=="2"||((wt=e.task)==null?void 0:wt.category)=="CRACK"&&G.value=="3")&&(ye=!0);let Be=!1;return!t.isUndefined((Xe=e.task)==null?void 0:Xe.showParameter)&&((ut=e.task)==null?void 0:ut.showParameter)=="suspensionCylinder"&&G.value=="Yes"&&(Be=!0),!R||ye||xe.value||f.value||Be||He.value}),rt=R=>ba(R),Ct=i(()=>{let R="pb-2";return!t.isUndefined(e.task.updatedBy.name)&&e.task.updatedBy.name&&(R=""),R}),gt=i(()=>g.stateSuccessUpdateItemKey);ke(gt,R=>{R==a.value.key&&!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("normalTakePhoto")&&(d.setInputCameraMandatoryKey(a.value.key),pe.value||ae.value.length==0&&(be.value=!0),pe.value=!1)});const et=i(()=>F.stateIsCameraError);return ke(et,async R=>{R&&d.stateInputCameraMandatoryKey==a.value.key&&(await B("",!1,!0),d.setInputCameraMandatoryKey(""))}),(R,X)=>{var Be,ze,it,pt,wt,Xe,ut;const de=ne("el-option"),ye=ne("el-select");return c(),$(Ve,null,[n("div",{class:we([[Y.value,N.value,Ct.value],"px-2 pt-2 dropdown-eform-status"]),style:ce(Pe.value)},[n("div",Ll,[(c(),Z(ye,{modelValue:G.value,"onUpdate:modelValue":X[0]||(X[0]=dt=>G.value=dt),placeholder:Q.value,size:"small",class:we(["w-100",ie.value]),disabled:Ke.value,onChange:Qe,key:I.value},va({default:le(()=>[(c(!0),$(Ve,null,nt(ge.value,dt=>(c(),Z(de,{key:dt,value:dt.value},{default:le(()=>[n("span",{innerHTML:dt&&dt.label?rt(dt&&dt.label):""},null,8,jl)]),_:2},1032,["value"]))),128))]),_:2},[G.value?{name:"prefix",fn:le(()=>[n("span",{class:"el-input__custom-option",innerHTML:te.value},null,8,Ml)]),key:"0"}:void 0]),1032,["modelValue","placeholder","disabled","class"])),a.value.value==="2"&&((Be=r.task)==null?void 0:Be.category)=="NORMAL"?(c(),$("div",Hl,[n("img",{src:oa,alt:"defect",class:"d-icon",onClick:Oe})])):D("",!0),a.value.value==="3"&&(((ze=r.task)==null?void 0:ze.category)=="NORMAL"||((it=r.task)==null?void 0:it.category)=="CBM")?(c(),$("div",{key:1,class:"ms-2",onClick:C},Gl)):D("",!0),a.value.value==="2"&&((pt=r.task)==null?void 0:pt.category)=="CRACK"?(c(),$("div",{key:2,class:"ms-2",onClick:We},Yl)):D("",!0),a.value.value==="3"&&((wt=r.task)==null?void 0:wt.category)=="CRACK"?(c(),$("div",{key:3,class:"ms-2",onClick:We},Wl)):D("",!0),a.value.value==="4"?(c(),$("div",{key:4,class:"ms-2",onClick:C},Xl)):D("",!0),a.value.value==="1"&&((Xe=r.task)!=null&&Xe.reason)&&((ut=r.task)==null?void 0:ut.reason)!=""?(c(),$("div",{key:5,class:"ms-2",onClick:q},Ql)):D("",!0)]),f.value?(c(),$("div",eo,so)):D("",!0),J.value?(c(),$("div",lo,no)):D("",!0)],6),j(Ja,{show:z.value,onClose:je},null,8,["show"]),j(Wa,{show:ue.value,onClose:Ae},null,8,["show"]),w.value?(c(),Z(El,{key:0,show:w.value,"check-list-arr":K.value,onUpdateCheckList:A,onSubmit:P,onClose:_e},null,8,["show","check-list-arr"])):D("",!0),j(za,{show:be.value,onClose:Ee},null,8,["show"]),j(xs,{"na-detail":V.value,visibility:O.value,onOnSave:Ne,onOnClose:Ze,onOnCancel:Je},null,8,["na-detail","visibility"])],64)}}}),Xa=$t(io,[["__scopeId","data-v-b02c4cf5"]]),uo=n("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[n("h3",null,"Please ensure oil level is checked and it is within the tolerance range.")],-1),co={class:"row text-center pt-5"},mo=Ue({__name:"OilNotInRange",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(r,{emit:s}){const e=r,l=s,a=Te(()=>e.show),o=()=>{l("close")};return(v,y)=>{const d=ne("el-button"),p=ne("el-dialog");return c(),Z(p,{modelValue:W(a),"onUpdate:modelValue":y[0]||(y[0]=u=>Et(a)?a.value=u:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:le(()=>[uo,n("div",co,[j(d,{type:"success",class:"ok-button",onClick:o},{default:le(()=>[yt("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),fo={key:0,class:"text-danger ps-2 font-weight-bold"},yo={key:1,class:"d-flex align-items-center"},vo=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Loading...")],-1),po=n("span",{class:"timestamp-task"},"Calculating...",-1),bo=[vo,po],go={key:2,class:"d-flex align-items-center"},ko=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Updating...")],-1),ho=n("span",{class:"timestamp-task"},"Updating...",-1),So=[ko,ho],Co={key:3,class:"ms-1 d-flex align-items-center",style:{opacity:"0"}},wo=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Updating...")],-1),Uo=n("span",{class:"timestamp-task"},"Updating...",-1),_o=[wo,Uo],Za=Ue({__name:"Input",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1},generalSubmitted:{required:!0,type:Boolean}},setup(r){const s=r,e=De(s,"item"),l=De(s,"task"),a=vt(),o=Dt(),v=k(!1),y=k("");let d;const p=k(!1),u=k(!1),g=k(!1),h=_t(),w=Vt();k("");const U=k(!1),m=k(!1),b=i(()=>{let C="";return!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.suffix)&&(C=e.value.style.suffix),C}),f=i(()=>{let C="Please Input";return(e.value.categoryItemType=="targetRating"||e.value.categoryItemType=="resultParamRating")&&(C=""),!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.placeholder)&&(C=e.value.style.placeholder),C}),F=k(!1),J=k(!1),_=k(!1),O=()=>{var C;(C=s.task)==null||C.items.forEach(H=>{H.itemType==="smallCamera"&&(!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("normalTakePhoto")&&h.setShowCloseButton(!1),!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhoto")&&h.setShowCloseButton(!1),h.toggleIsVisible(!0,H.key))}),_.value=!1},V=i(()=>s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),K=i(()=>{let C="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(C=`col-md-${e.value.style.potraitBreakPoint}`,C=`${C} col-lg-${e.value.style.breakPoint}`):(C=`col-md-${e.value.style.potraitBreakPoint}`,C=`${C} col-lg-${e.value.style.breakPoint}`)),C}),q=i(()=>a.taskAlreadyUpdated),A=k(!1);ke(q,async(C,H)=>{C&&(A.value=!0)});const P=i(()=>{if(!s.generalSubmitted)return!0;let C=!1;const H=e.value.categoryItemType;(H=="targetRating"||H=="resultParamRating")&&(C=!0);let fe=!1;e.value.categoryItemType=="paramRatingDynamic"&&l.value.items.forEach(ve=>{ve.itemType=="dropDown"&&(ve.categoryItemType=="dropdownTool"||ve.categoryItemType=="dropdownToolDisc")&&ve.value==""&&(fe=!0)});let Se=!1;return e.value.categoryItemType=="suspensionParamRating"&&(a.stateStoredAdjustmentOptionValue=="Yes"||a.stateStoredAdjustmentOptionValue=="2")&&(Se=!0),C||s.task.isShowAdjustmentRow||fe||I.value||Se}),I=k(!1),x=i(()=>{let C="text";return(T.value||L.value||z.value||ue.value)&&(C="numeric"),C}),T=i(()=>e.value.valueType=="int"),L=i(()=>{var C;return(C=e.value.customValidation)==null?void 0:C.toLowerCase().includes("percentage")}),z=i(()=>e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="paramRatingDynamic"),ue=i(()=>!t.isUndefined(e.value.mappingKeyId)&&!t.isArray(e.value.mappingKeyId)&&e.value.categoryItemType!="adjustmentSuspensionRating");i(()=>{let C="";return(T.value||L.value||z.value||ue.value)&&(C="number"),C});const be=i({get:()=>e.value.value,set:async C=>{if(T.value||z.value||ue.value){if(isNaN(Number(C)))return;if(C.length>8)return;if((`${C}`.split(".")||[]).length-1>1)return;if(C.includes(".")){if(`${C}`.split(".")[1].length>2)return;e.value.value=C}if(C.length>5){if(C.length>=6&&C.length<=6){if(C[5]!=".")return;e.value.value=C}}else e.value.value}e.value.value=C}}),Ee=C=>{if(A.value=!1,!w.stateConnectionStatus)w.setSubmitConnectionError(!0),e.value.value=E.value;else{if(me.value)return;const H=C.target.value;if(Q(H)){let Se=H;(T.value||L.value||z.value||ue.value)&&(Se=parseFloat(H)),isNaN(Se)&&(Se=C.target.value),Y(String(Se))}else e.value.value=E.value}},Q=C=>{y.value="";let H=!0;return(T.value||L.value||z.value||ue.value)&&isNaN(C)&&(H=!1,y.value="value must be a number"),H},N=()=>{var C;if(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic"){if(!t.isUndefined(e.value.disabledByItemKey&&e.value.value=="")||t.isUndefined(e.value.customValidation)||!((C=e.value.customValidation)!=null&&C.toLowerCase().includes("required")))return!0;if(!Pa(e.value.value))return y.value="max. 2 decimal digits",!1}return!0},Y=async C=>{if(C!==E.value){clearTimeout(d),e.value.value=C;let H=ie();H&&(H=N()),H&&(y.value="",d=setTimeout(async()=>{if(s.task.category=="CBM"&&(e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic")?p.value=!0:(!t.isUndefined(e.value.mappingKeyId)&&t.isArray(e.value.mappingKeyId),g.value=!0),oe(C)){const Se={keyValue:l.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:C},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};if(ue.value)C!==""?await xe(C):await Ne(Se,C);else{let ve=!0;(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic")&&await Je().then(_e=>{ve=_e,!_e&&!a.ratingNotMapped&&(m.value=!0,setTimeout(()=>{m.value=!1},2e3),e.value.value="")}),e.value.categoryItemType=="suspensionParamRating"&&(await a.updateSuspensionCylinderTask(s.task,e.value),ve=!1),e.value.categoryItemType=="adjustmentSuspensionRating"&&(await a.updateAdjustmentSuspensionCylinderTask(s.task,e.value),ve=!0),ve&&(await Ne(Se,C),E.value=C,e.value.category=="cbmCalculateAvg"&&(a.setAvgTargetKey(e.value.targetCalculateKeyId),ae()))}}p.value=!1,g.value=!1,e.value.isCalculatingTrue=!1,U.value=!0},0))}else y.value=""},te=i(()=>{var C;return(C=s.task)==null?void 0:C.updatedBy});ke(te,C=>{C!=""&&(U.value=!1)});const ie=()=>{var C;if((C=e.value.customValidation)!=null&&C.toLowerCase().includes("percentage")){const H=parseFloat(e.value.value);return isNaN(H)||H<0||H>100?(y.value="must be between 0 - 100",!1):(y.value=="must be between 0 - 100"&&(y.value=""),!0)}return y.value=="must be between 0 - 100"&&(y.value=""),!0},ae=async C=>{const H=e.value.mappingKeyId,fe=[];let Se;if(a.stateSelectedSubGroups.find(ve=>ve.taskGroup.some(_e=>_e.task.some(je=>je.items.some(Ae=>(Ae.key==e.value.targetCalculateKeyId&&(Se=Ae),Ae.key==e.value.targetCalculateKeyId))))),Se.isCalculatingTrue=!0,t.isArray(H)){for(let _e=0;_e<H.length;_e++){const je=await a.getValueFromItemKey(H[_e]);fe.push(Number(je))}let ve=0;fe.forEach(_e=>{ve=ve+_e}),ve=t.round(ve/fe.length,2),a.stateSelectedSubGroups.find(_e=>_e.taskGroup.some(je=>je.task.some(Ae=>Ae.items.some(He=>(He.key==e.value.targetCalculateKeyId&&(Se=He),He.key==e.value.targetCalculateKeyId))))),Se.value=ve}},Ne=async(C,H)=>{const fe=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:H},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}];if(!t.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&fe.push(C),e.value.categoryItemType=="adjustmentSuspensionRating"){const Se={keyValue:l.value.key,propertyParams:[{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};fe.push(Se)}await a.updateServiceSheetTaskValue(fe,o.user.EmployeeId,o.user.Name)},Ze=i(()=>{var H;let C=[];return(H=s.task)==null||H.items.forEach(fe=>{fe.itemType==="smallCamera"&&(C=fe.value)}),C}),Je=async()=>{let C=!0;const H=s.task,fe=H.items.findIndex(_e=>_e.key==e.value.key)+1,Se=H.items[fe],ve=H.items.find(_e=>_e.itemType==="smallCamera");return Se&&ve&&a.setMeasurementValueAndUOM(e.value.value,Se.value,ve.key),await a.getCBMResult(H,e.value).then(_e=>{C=_e.status,_e.status&&(_e.value&&!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhoto")&&(a.setInputCameraMandatoryKey(e.value.key),A.value||Ze.value.length==0&&(_.value=!0),A.value=!1),(_e.value=="A"||_e.value=="B")&&!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating")&&(a.setInputCameraMandatoryKey(e.value.key),A.value||Ze.value.length==0&&(_.value=!0),A.value=!1),(_e.value=="C"||_e.value=="X")&&(!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmDefectTakePhoto")||!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating"))&&(a.setInputCameraMandatoryKey(e.value.key),A.value||Ze.value.length==0&&(_.value=!0),A.value=!1))}),C},Qe=i(()=>h.stateIsCameraError);ke(Qe,async C=>{C&&a.stateInputCameraMandatoryKey==e.value.key&&(await Y(""),a.setInputCameraMandatoryKey(""))});const ct=i(()=>{const C=e.value.value.toString().replaceAll("'","");let H;return e.value.categoryItemType=="targetRating"&&(C=="A"?H="a":C=="B"?H="b":C=="C"?H="c":C=="X"&&(H="x")),H}),B=i(()=>{var Ct,gt,et;const C=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",H=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",fe=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",Se=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let ve=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((Ct=s.task)==null?void 0:Ct.isShowAdjustmentRow)&&((gt=s.task)!=null&&gt.isShowAdjustmentRow))ve="";else{let R=0;(et=s.task)==null||et.items.forEach(X=>{var de;t.isUndefined(X.style)||(t.isUndefined(X.style.border)?t.isUndefined(X.style.border)&&(R=R+Number(X.style.breakPoint)):((X.style.border.right=="none"||t.isUndefined(X.style.border.right))&&(R=R+Number(X.style.breakPoint)),t.isEqual(X,t.last((de=s.task)==null?void 0:de.items))&&(R=R+Number(X.style.breakPoint))))}),R==12&&(ve=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const _e=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",je=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",Ae=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",He=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",Ke=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let rt="";return ve&&(rt="padding-bottom: 25px; "),`${rt}${C}${H}${fe}${Se}${ve}${_e}${je}${Ae}${He}${Ke}`}),G=i(()=>a.generalForm.status=="Submited"),me=i(()=>{const C=e.value.categoryItemType=="targetRating";let H=!0,fe=!0;!t.isUndefined(l.value.updatedBy)&&!t.isUndefined(l.value.updatedBy.id)&&e.value.categoryItemType!="paramRating"&&(a.employee.id==l.value.updatedBy.id?H=!0:H=!1,!t.isUndefined(e.value.updatedBy)&&!t.isUndefined(e.value.updatedBy.id)&&(a.employee.id==e.value.updatedBy.id?fe=!0:fe=!1));let Se=!1;!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.visibility)&&e.value.style.visibility=="readonly"&&(Se=!0);let ve=!0,_e;return e.value.category=="cbmCalculateAvg"&&(a.stateSelectedSubGroups.find(je=>je.taskGroup.some(Ae=>Ae.task.some(He=>He.items.some(Ke=>(Ke.key==e.value.targetCalculateKeyId&&(_e=Ke),Ke.key==e.value.targetCalculateKeyId))))),!t.isUndefined(_e.updatedBy)&&!t.isUndefined(_e.updatedBy.id)&&(a.employee.id==_e.updatedBy.id?ve=!0:ve=!1)),C||!H||Se||!fe||!ve||G.value}),Re=()=>{v.value=!1},pe=()=>{F.value=!1},he=()=>{J.value=!1},xe=async C=>{a.stateOilToleranceNotMapped?(u.value=!0,e.value.value=E.value):await a.getValueFromItemKey(e.value.mappingKeyId).then(async H=>{if(H!=""){const fe=a.oilTolerance;let Se=fe.min,ve=fe.max;fe.uom=="%"&&(Se=Number(H)*(Se/100),ve=Number(H)*(ve/100));const je=Number(H)+Number(Se),Ae=Number(H)+Number(ve),He=C>=je,Ke=C<=Ae,rt=parseFloat(je.toString()).toFixed(2),Ct=parseFloat(Ae.toString()).toFixed(2);if(He&&Ke){const gt={keyValue:l.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:C},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};g.value=!1,await Ne(gt,C),E.value=C}else y.value=`Range refill capacity is between ${rt} until ${Ct}`,g.value=!1,v.value=!0,e.value.value=E.value}})},Me=k(),ot=C=>{if(T.value||L.value||z.value||ue.value){let H=C.keyCode?C.keyCode:C.which;if(L.value&&(C.target.value>100&&C.preventDefault(),C.target.value.includes(".")?C.target.value.split(".")[1].length>=2&&C.preventDefault():C.target.value.length>=3&&C.preventDefault()),H==13){Me.value.blur();return}(H<48||H>57)&&H!=46&&C.preventDefault()}},E=k("");xt(async()=>{E.value=e.value.value,be.value=e.value.value,await Pe()}),$a(()=>{e.value={}});const oe=C=>{if(e.value.valueType=="int"){const H=C.split(".");let fe=!1,Se=H[0].length>5;return H[1]&&(fe=H[1].length>2),Se||fe?(y.value="max input length is 5 digits and 2 number after .",!1):!0}else return!0},ge=i(()=>e.value.isCalculatingTrue);ke(ge,(C,H)=>{C&&(p.value=!0)});const Pe=async()=>{var C;if(!t.isUndefined(e.value.disabledByItemKey)){let H=a.stateStoredDisableKeyValue.find(fe=>fe.key==e.value.disabledByItemKey);if(t.isUndefined(H)){const fe=await a.getValueFromItemKey(e.value.disabledByItemKey);a.pushStoredDisabledItems({key:e.value.disabledByItemKey,value:fe})}H=a.stateStoredDisableKeyValue.find(fe=>fe.key==e.value.disabledByItemKey),(H==null?void 0:H.value)=="3"?(y.value="",I.value=!0,e.value.value&&((C=s.task)==null?void 0:C.taskType)=="inline"&&await Y("")):I.value=!1}},Oe=i(()=>s.itemLoading);ke(Oe,C=>{g.value=C}),ke(be,async(C,H)=>{C==""&&(E.value=""),e.value.categoryItemType&&e.value.categoryItemType=="resultParamRating"&&e.value.key==a.stateAvgTargetKey&&C!=H&&Y(C),await Pe()},{deep:!0}),ke(s.item,(C,H)=>{e.value=C},{deep:!0});const We=i(()=>{let C="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(C=""),C});return(C,H)=>{const fe=ne("el-input");return c(),$(Ve,null,[n("div",{class:we([[V.value,K.value,We.value],"px-2 pt-2 input-eform-status"]),style:ce(B.value)},[j(fe,{ref_key:"cbmInput",ref:Me,class:we([ct.value,b.value!=""?"service-sheet-input":""]),modelValue:be.value,"onUpdate:modelValue":H[0]||(H[0]=Se=>be.value=Se),size:"small",placeholder:f.value,readonly:me.value,onKeypress:ot,onFocusout:Ee,onChange:ot,inputmode:x.value,disabled:P.value},va({_:2},[b.value!=""?{name:"append",fn:le(()=>[yt(Ie(b.value),1)]),key:"0"}:void 0]),1032,["class","modelValue","placeholder","readonly","inputmode","disabled"]),y.value!=""?(c(),$("label",fo,Ie(y.value),1)):D("",!0),p.value?(c(),$("div",yo,bo)):D("",!0),g.value?(c(),$("div",go,So)):D("",!0),U.value?(c(),$("div",Co,_o)):D("",!0)],6),j(mo,{show:v.value,onClose:Re},null,8,["show"]),j(Ja,{show:F.value,onClose:pe},null,8,["show"]),j(Wa,{show:J.value,onClose:he},null,8,["show"]),j(za,{show:_.value,onClose:O},null,8,["show"]),j(Hs,{visibility:m.value,isCloseButtonShow:!1,caption:"Out Of Range",onOnClose:H[1]||(H[1]=()=>{m.value=!1})},null,8,["visibility"])],64)}}}),Io=["disabled"],$o=["src"],To={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},Ro={class:"text-white"},Qa=Ue({__name:"SmallCamera",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},generalSubmitted:{required:!0,type:Boolean},task:{type:Object}},setup(r){const s=r,e=De(s,"item"),l=k(!1),a=De(s,"task"),o=vt(),v=_t(),y=Dt(),d=Te(()=>s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),p=Te(()=>{var T;let x=!1;return((T=s.task)==null?void 0:T.category)=="CBM"&&s.task.items.every(L=>{var z,ue;if(L.itemType=="dropDown"||L.itemType=="input"){if(L.customValidation=="cbmTakePhotoAllRating")return x=!0,!1;if(L.customValidation=="cbmDefectTakePhoto"&&(((z=s.task)==null?void 0:z.taskValue)=="C"||((ue=s.task)==null?void 0:ue.taskValue)=="X"))return x=!0,!1}return!0}),x}),u=Te(()=>{let x="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(x=`col-md-${e.value.style.potraitBreakPoint} col-lg-${e.value.style.breakPoint}`),x}),g=Te(()=>e.value.value?lt(e.value.value):[]),h=(x=!1)=>{v.toggleIsVisible(!0,e.value.key),v.setIsActionFromDelete(x),v.setShowCloseButton(!0)},w=Te(()=>t.cloneDeep(v.ImageObjects.find(x=>x.Id===e.value.key))),U=()=>{var T;let x="/media/svg/dma/camera/e-form/png/cam-active.png";return(T=s.task)!=null&&T.updatedBy&&e.value.updatedBy&&g.value.length>0&&(x="/media/svg/dma/camera/e-form/png/cam-user.png"),x},m=Te(()=>!P.value),b=()=>{l.value=!0},f=()=>{l.value=!1},F=Te(()=>{var ie,ae,Ne;const x=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",T=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",L=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",z=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let ue=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((ie=s.task)==null?void 0:ie.isShowAdjustmentRow)&&((ae=s.task)!=null&&ae.isShowAdjustmentRow))ue="";else{let Ze=0;(Ne=s.task)==null||Ne.items.forEach(Je=>{var Qe;t.isUndefined(Je.style)||(t.isUndefined(Je.style.border)?t.isUndefined(Je.style.border)&&(Ze=Ze+Number(Je.style.breakPoint)):((Je.style.border.right=="none"||t.isUndefined(Je.style.border.right))&&(Ze=Ze+Number(Je.style.breakPoint)),t.isEqual(Je,t.last((Qe=s.task)==null?void 0:Qe.items))&&(Ze=Ze+Number(Je.style.breakPoint))))}),Ze==12&&(ue=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const be=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",Ee=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",Q=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",N=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",Y=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let te="";return ue&&(te="padding-bottom: 25px; "),`${te}${x}${T}${L}${z}${ue}${be}${Ee}${Q}${N}${Y}`}),J=async x=>{if(p.value&&g.value.length==1)l.value=!1,h(!0);else{e.value.value=lt(e.value.value);const T=e.value.value;e.value.value=T.filter(L=>L.filename!=x),v.setCurrent(e.value.key),await _(),e.value.value.length==0&&f(),v.clearCurrent()}},_=async()=>{const x={keyValue:a.value.key,propertyParams:[{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]},T=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:JSON.stringify(e.value.value)},{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}];!t.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&T.push(x),o.updateServiceSheetTaskValue(T,y.user.EmployeeId,y.user.Name)},O=k(!1),V=()=>{O.value=!1},K=()=>{O.value=!1,v.setShowCloseButton(!0),h()},q=async()=>{e.value.value==""&&(e.value.value=[]);let x=[];w.value&&(x=lt(w.value.ImageInfos));const T=lt(e.value.value),L=x.filter(z=>!T.includes(z));e.value.value=lt(e.value.value),v.IsFromActionDelete?e.value.value=L:e.value.value=[...e.value.value,...L],await _(),v.setIsActionFromDelete(!1),O.value=!0},A=Te(()=>o.generalForm.status=="Submited"),P=Te(()=>s.generalSubmitted?!!0||A.value:!0);ke(w,async(x,T)=>{x&&x.ImageInfos.length>0&&(x.ImageInfos.length!=(T==null?void 0:T.ImageInfos.length)?await q():v.IsFromActionDelete&&(t.isEqual(x,T)||await q()))},{deep:!0});const I=Te(()=>{var T;let x="pb-2";return(T=s.task)!=null&&T.updatedBy&&s.task.updatedBy.name&&(x=""),x});return(x,T)=>(c(),$("div",{class:we([[W(d),W(u),W(I)],"pt-2"]),style:ce(W(F))},[n("div",{class:we(["row",!W(t.isUndefined)(e.value.value)&&e.value.value.length>0?"justify-content-around":"justify-content-center"])},[n("div",{class:we(["d-flex justify-content-center",!W(t.isUndefined)(e.value.value)&&e.value.value.length>0?"col-6 pe-0 ps-1":"col-6 px-0"])},[n("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:T[0]||(T[0]=L=>h()),disabled:W(P)},[n("img",{src:U(),style:{height:"12px",width:"14px"},alt:"photo"},null,8,$o)],8,Io)],2),W(g)&&W(g).length>0?(c(),$("div",To,[n("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:b,style:{"background-color":"#18AF4A"}},[n("label",Ro,"+"+Ie(W(g).length),1)])])):D("",!0)],2),l.value?(c(),Z(ua,{key:0,type:"task","re-render":!1,images:W(g),"show-delete-button":W(m),"is-mandatory":W(p),visibility:l.value,"is-monitoring":!W(m),"show-mandatory-caption":W(p),onOnClose:f,onOnDelete:J},null,8,["images","show-delete-button","is-mandatory","visibility","is-monitoring","show-mandatory-caption"])):D("",!0),j(Ma,{visibility:O.value,caption:"The photo successfully taken, would you like to take another photo?",onOnNoConfirm:V,onOnYesConfirm:K},null,8,["visibility"])],6))}}),Po={class:"p-2"},Bo={class:"form-check checkbox-success item-checkbox"},es=Ue({__name:"CheckBox",props:{item:{type:Object,required:!0},task:{type:Object},generalStyle:{type:Boolean,default:!0}},setup(r){const s=r,e=De(s,"item"),l=De(s,"task"),a=vt(),o=Dt(),v=i({get:()=>JSON.parse(s.item.value),set:async g=>{var U;const h={keyValue:(U=l.value)==null?void 0:U.key,propertyParams:[{propertyName:"taskValue",propertyValue:e.value.value.toString()},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]},w=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:g.toString()},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}];!t.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&w.push(h),await a.updateServiceSheetTaskValue(w,o.user.EmployeeId,o.user.Name)}}),y=i(()=>!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col"),d=i(()=>{let g="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(g=`col-md-${e.value.style.potraitBreakPoint}`,g=`${g} col-lg-${e.value.style.breakPoint}`):(g=`col-md-${e.value.style.potraitBreakPoint}`,g=`${g} col-lg-${e.value.style.breakPoint}`)),g}),p=i(()=>{var V,K,q;const g=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",h=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",w=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",U=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let m=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((V=s.task)==null?void 0:V.isShowAdjustmentRow)&&((K=s.task)!=null&&K.isShowAdjustmentRow))m="";else{let A=0;(q=s.task)==null||q.items.forEach(P=>{var I;t.isUndefined(P.style)||(t.isUndefined(P.style.border)?t.isUndefined(P.style.border)&&(A=A+Number(P.style.breakPoint)):((P.style.border.right=="none"||t.isUndefined(P.style.border.right))&&(A=A+Number(P.style.breakPoint)),t.isEqual(P,t.last((I=s.task)==null?void 0:I.items))&&(A=A+Number(P.style.breakPoint))))}),A==12&&(m=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const b=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",f=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",F=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",J=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",_=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";let O="";return m&&(O="padding-bottom: 25px; "),`${O}${g}${h}${w}${U}${m}${b}${f}${F}${J}${_}`}),u=i(()=>{let g="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(g=""),g});return(g,h)=>(c(),$("div",{class:we([[d.value,y.value,u.value],"pt-2 px-2 d-flex align-items-center d-flex justify-content-center"]),style:ce(p.value)},[n("div",Po,[n("div",Bo,[Wt(n("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":h[0]||(h[0]=w=>v.value=w)},null,512),[[pa,v.value]])])])],6))}}),ts=Ue({__name:"InteractiveButton",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const s=r,e=De(s,"item"),l=De(s,"task"),a=i(()=>s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),o=i(()=>!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:""),v=i(()=>!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; border-color: ${e.value.style.bgColor};`:""),y=vt(),d=i(()=>{let b="";return s.task.isShowAdjustmentRow&&(b="opacity: 50%;"),u.value&&(b="opacity: 50%;"),b}),p=i(()=>y.generalForm.status=="Submited"),u=i(()=>{const b=s.task.taskValue=="",f=s.task.taskValue=="A"||s.task.taskValue=="B";let F=!0;return!t.isUndefined(s.task.updatedBy)&&!t.isUndefined(s.task.updatedBy.id)&&(y.employee.id==s.task.updatedBy.id?F=!0:F=!1),b||f||s.task.isShowAdjustmentRow||!F||p.value}),g=i(()=>{let b="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(b=`col-md-${e.value.style.potraitBreakPoint}`,b=`${b} col-lg-${e.value.style.breakPoint}`):(b=`col-md-${e.value.style.potraitBreakPoint}`,b=`${b} col-lg-${e.value.style.breakPoint}`)),b}),h=i(()=>t.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),w=i(()=>{var q,A,P,I;const b=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",f=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let F=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((q=s.task)==null?void 0:q.isShowAdjustmentRow)&&((A=s.task)!=null&&A.isShowAdjustmentRow))F="";else{let x=0;(P=s.task)==null||P.items.forEach(T=>{var L;t.isUndefined(T.style)||(t.isUndefined(T.style.border)?t.isUndefined(T.style.border)&&(x=x+Number(T.style.breakPoint)):((T.style.border.right=="none"||t.isUndefined(T.style.border.right))&&(x=x+Number(T.style.breakPoint)),t.isEqual(T,t.last((L=s.task)==null?void 0:L.items))&&(x=x+Number(T.style.breakPoint))))}),x==12&&(F=!((I=s.task.updatedBy)!=null&&I.name)&&!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const J=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",_=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",O=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",V=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",K=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${b}${f}${F}${J}${_}${O}${V}${K}`}),U=()=>{e.value.value=="Adjustment"&&(l.value.isShowAdjustmentRow=!0)},m=i(()=>{let b="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(b=""),b});return(b,f)=>{const F=ne("el-button");return c(),$("div",{class:we([[a.value,h.value,g.value,m.value],"px-2 pt-2"]),style:ce(w.value)},[!W(t.isUndefined)(r.item.style)&&r.item.style.visibility!="hidden"?(c(),Z(F,{key:0,style:ce([o.value,v.value,d.value]),size:"small",type:"success",onClick:U,class:"item-button w-100",disabled:u.value},{default:le(()=>[yt(Ie(r.item.value),1)]),_:1},8,["style","disabled"])):D("",!0)],6)}}}),Vo={class:"row w-100"},No=n("div",{class:"col-1 pb-1 px-2"},null,-1),xo={class:"col-4 col-md-3 pb-1 px-2",style:ce([])},Do={class:"col-2 pb-1 px-2",style:ce([])},Ao={key:0,class:"text-danger ps-2 font-weight-bold"},Fo={key:1,class:"d-flex align-items-center"},Oo=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Loading...")],-1),Eo=n("span",{class:"timestamp-task"},"Updating...",-1),Lo=[Oo,Eo],jo={class:"col-1 pb-1 px-2",style:ce([])},Mo={class:"col-1 col-md-1 pb-1 px-2 input-eform-status",style:ce([])},Ho={class:"col-1 col-md-1 pb-1 px-2",style:ce([])},Ko={class:"row justify-content-center"},Go={class:"px-0 col-6 d-flex justify-content-center"},qo=["disabled"],Yo=["src"],Jo={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},Wo={class:"text-white"},zo={key:0,class:"row w-100"},Xo={key:1,class:"row w-100"},Zo=n("div",{class:"col-1 pb-1 px-2"},null,-1),Qo={key:0,class:"d-flex align-items-center"},er=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Loading...")],-1),tr=n("span",{class:"timestamp-task"},"Updating...",-1),ar=[er,tr],sr=Ue({__name:"TaskAdjustment",props:{task:{type:Object,required:!0}},setup(r){const s=r,e=k(""),l=async N=>{const Y=a.value.adjustment.pictures;a.value.adjustment.pictures=Y.filter(te=>te!=N),J.setCurrent(`${a.value.key}-adjustment`),J.clearCurrent(),await f.addCBMAdjustmentPictures(a.value),a.value.adjustment.pictures.length==0},a=De(s,"task"),o=k(!1),v=Vt(),y=i({get:()=>a.value.adjustment.measurement,set:N=>{La(N)&&(a.value.adjustment.measurement=ja(N))}}),d=i(()=>a.value.adjustment.pictures),p=i(()=>f.generalForm.status=="Submited"),u=i(()=>{let N=!0;return!t.isUndefined(a.value.updatedBy)&&!t.isUndefined(a.value.updatedBy.id)&&(f.employee.id==a.value.updatedBy.id?N=!0:N=!1),!N||p.value}),g=()=>{o.value=!1},h=()=>{o.value=!0},w=i(()=>{let N="";return s.task.items.forEach(Y=>{!t.isUndefined(Y.style)&&!t.isUndefined(Y.style.border)&&Y.style.border.left!="none"&&(N=Y.style.border.left)}),N}),U=i(()=>{let N="",Y=!1;return a.value.items.forEach(te=>{!t.isUndefined(te.style)&&!t.isUndefined(te.style.border)&&te.style.border.bottom!="none"&&(Y=!0)}),Y&&(N=`border-bottom: ${w.value}`),N}),m=()=>t.isUndefined(y.value=="")?Pa(y.value)?!0:(e.value="max. 2 decimal digits",!1):!0;i(()=>{let N=!1;a.value.items.forEach(te=>{!t.isUndefined(te.style)&&!t.isUndefined(te.style.border)&&te.style.border.bottom!="none"&&(N=!0)});let Y="";return a.value.adjustment.updatedBy.name!=""&&N&&(Y=`border-bottom: ${w.value}`),Y});const b=N=>{let Y=N.keyCode?N.keyCode:N.which;(Y<48||Y>57)&&Y!=46&&N.preventDefault()},f=vt(),F=k(!1),J=_t(),_=k(!1),O=Dt(),V=k(!1),K=()=>{var Y,te;let N="/media/svg/dma/camera/e-form/png/cam-active.png";return t.isUndefined((Y=s.task.adjustment.updatedBy)==null?void 0:Y.id)||((te=s.task.adjustment.updatedBy)==null?void 0:te.id)==f.employee.id&&a.value.adjustment.pictures.length>0&&(N="/media/svg/dma/camera/e-form/png/cam-user.png"),u.value&&(N="/media/svg/dma/camera/e-form/png/cam-read.png"),N},q=async N=>{let Y=N.target.value;if(!u.value){if(!v.stateConnectionStatus){v.setSubmitConnectionError(!0),a.value.adjustment.measurement=be.value;return}if(Y!=Ee.value){V.value=!0;const te=[{keyValue:s.task.adjustment.key,propertyParams:[{propertyName:"commentValue",propertyValue:Y}]}];await f.updateServiceSheetTaskValue(te,O.user.EmployeeId,O.user.Name),V.value=!1,Ee.value=Y}}},A=N=>{const Y=String(N).split(".");let te=!1,ie=Y[0].length>5;return Y[1]&&(te=Y[1].length>2),ie||te?(e.value="max input length is 5 digits and 2 number after .",!1):!0},P=async N=>{e.value="";let Y=parseFloat(N.target.value);isNaN(Y)&&(Y=N.target.value);let te=String(Y);if(u.value)return;let ie=m();if(ie&&(ie=A(te)),!v.stateConnectionStatus){v.setSubmitConnectionError(!0),a.value.adjustment.measurement=be.value;return}if(ie)if(te&&te!=be.value){_.value=!0,a.value.adjustment.measurement=te;const ae=await f.getAdjusmentRating(a.value);_.value=!1,ae?(be.value=te,(ae=="C"||ae=="X")&&(F.value=!0)):(await f.deleteAdjusmentTask(a.value),be.value="",e.value="Out Of Range",te="",a.value.adjustment.measurement="")}else te==""&&te!=be.value&&(await f.getAdjusmentRating(a.value),be.value="",e.value="",te="",a.value.adjustment.measurement="")},I=()=>{J.toggleIsVisible(!0,`${a.value.key}-adjustment`),F.value=!1},x=async()=>{if(a.value.adjustment.measurement){const N=Ye.service({lock:!0,text:"Deleting Adjustment",background:"rgba(0, 0, 0, 0.7)"});await f.deleteAdjusmentTask(a.value),N.close(),J.setCurrent(`${a.value.key}-adjustment`),J.clearCurrent()}a.value.isShowAdjustmentRow=!1},T=i(()=>{const N=a.value.adjustment.rating;let Y;return N=="A"?Y="a":N=="B"?Y="b":N=="C"?Y="c":N=="X"&&(Y="x"),Y}),L=i(()=>t.cloneDeep(J.ImageObjects.find(N=>N.Id===`${a.value.key}-adjustment`))),z=k(!1),ue=()=>{const N=L.value.ImageInfos,Y=a.value.adjustment.pictures,te=N.filter(ie=>!Y.includes(ie));a.value.adjustment.pictures=[...a.value.adjustment.pictures,...te],f.addCBMAdjustmentPictures(a.value),z.value=!0};ke(L,async(N,Y)=>{!t.isUndefined(N)&&N.ImageInfos.length>0&&N.ImageInfos.length!=(Y==null?void 0:Y.ImageInfos.length)&&await ue()},{deep:!0});const be=k(""),Ee=k(""),Q=k("");return xt(()=>{be.value=a.value.adjustment.measurement,Q.value=a.value.adjustment.measurement,t.isUndefined(a.value.adjustment.commentValue)||(Ee.value=a.value.adjustment.measurement)}),(N,Y)=>{const te=ne("el-input"),ie=ne("el-button");return c(),$(Ve,null,[n("div",Vo,[No,n("div",{class:"col-1 pb-1 px-2",style:ce([`border-left: ${w.value}`])},null,4),n("div",xo,Ie(r.task.adjustment.description),1),n("div",Do,[j(te,{modelValue:y.value,"onUpdate:modelValue":Y[0]||(Y[0]=ae=>y.value=ae),size:"small",placeholder:"Please Input",onKeypress:b,onFocusout:P,inputmode:"numeric",readonly:u.value},null,8,["modelValue","readonly"]),e.value!=""?(c(),$("label",Ao,Ie(e.value),1)):D("",!0),_.value?(c(),$("div",Fo,Lo)):D("",!0)]),n("div",jo,Ie(r.task.adjustment.uom),1),n("div",Mo,[j(te,{modelValue:a.value.adjustment.rating,"onUpdate:modelValue":Y[1]||(Y[1]=ae=>a.value.adjustment.rating=ae),modelModifiers:{lazy:!0},size:"small",disabled:"",class:we(T.value)},null,8,["modelValue","class"])]),n("div",Ho,[n("div",Ko,[n("div",Go,[n("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:I,disabled:u.value},[n("img",{src:K(),style:{height:"12px",width:"14px"}},null,8,Yo)],8,qo)]),a.value.adjustment.pictures.length>0?(c(),$("div",Jo,[n("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:h,style:{"background-color":"#18AF4A"}},[n("label",Wo,"+"+Ie(a.value.adjustment.pictures.length),1)])])):D("",!0)])]),n("div",{class:"col-2 pb-1 px-2",style:ce([`border-right: ${w.value}`])},[j(ie,{disabled:u.value,type:"danger",size:"small",class:"item-button w-100",onClick:x},{default:le(()=>[yt("Delete")]),_:1},8,["disabled"])],4)]),r.task.adjustment.updatedBy.name?(c(),$("div",zo,[n("div",{class:"d-flex justify-content-end py-1 col-11 offset-1 timestamp-task",style:ce([`border-left: ${w.value}; border-right: ${w.value}`])},Ie(r.task.adjustment.updatedBy.name)+", "+Ie(r.task.adjustment.updatedDate),5)])):D("",!0),W(t.isUndefined)(a.value.adjustment.commentValue)?D("",!0):(c(),$("div",Xo,[Zo,n("div",{class:"col-1 pb-1 px-2",style:ce([`border-left: ${w.value}`,U.value])},null,4),n("div",{class:"col-4 col-md-3 pb-1 px-2",style:ce([U.value])},Ie(r.task.adjustment.commentLabel),5),n("div",{class:"col-6 col-md-7 pb-1 px-2",style:ce([U.value,`border-right: ${w.value}`])},[j(te,{modelValue:a.value.adjustment.commentValue,"onUpdate:modelValue":Y[2]||(Y[2]=ae=>a.value.adjustment.commentValue=ae),modelModifiers:{lazy:!0},size:"small",placeholder:a.value.adjustment.commentPlaceHolder,onFocusout:q,readonly:u.value},null,8,["modelValue","placeholder","readonly"]),V.value?(c(),$("div",Qo,ar)):D("",!0)],4)])),o.value?(c(),Z(Ha,{key:2,images:d.value,visibility:o.value,showDeleteButton:!u.value,onHandleClose:g,onHandleDelete:l},null,8,["images","visibility","showDeleteButton"])):D("",!0)],64)}}}),lr={key:0,class:"row w-100",style:{height:"25px"}},or=n("div",{class:"col-1"},null,-1),rr=Ue({__name:"InlineTask",props:{task:{type:Object,required:!0},taskIndex:{type:Number,required:!0},taskGroup:{type:Array,required:!0},generalSubmitted:{required:!0,type:Boolean}},setup(r){const s=r,e=vt(),l=i(()=>{let _=!0;if(s.task.showParameter=="suspensionCylinder"){_=!1;let O=!0,V=!1;(e.stateStoredSuspensionCylinderValue||e.stateStoredSuspensionCylinderValue.length>0)&&e.stateStoredSuspensionCylinderValue.forEach(K=>{K.value||(O=!1),(K.value=="Out of spec"||K.value=="Out Spec")&&(V=!0)}),_=O&&V}return s.task.showParameter=="cylinderHeightNeedAdjustment"&&(e.stateStoredAdjustmentOptionValue=="Yes"||e.stateStoredAdjustmentOptionValue=="2"?_=!0:_=!1),s.task.showParameter=="cylinderHeightAdjustmentsFilled"&&(_=!0,e.stateStoredAdjustedSuspensionCylinderValue.forEach(O=>{O.value||(_=!1)})),_}),a=i(()=>{let _="",O;return s.task.items.length<=1?O=s.task.items[0]:O=s.task.items[1],!t.isUndefined(O.style)&&!t.isUndefined(O.style.border)&&O.style.border.top!="none"&&(_="mt-3"),_}),o=i(()=>{let _="";return s.task.taskValue!=null&&s.task.taskValue==""&&(_="task-required"),_}),v=i(()=>{let _=12,O=0;return s.task.items.every(V=>!t.isUndefined(V.style)&&V.style.visibility=="hidden"&&(t.isUndefined(V.style)||t.isUndefined(V.style.border)||V.style.border.left=="none")?(_=Number(_)-Number(V.style.breakPoint),O=Number(O)+Number(V.style.breakPoint),!0):!1),`col-${_} offset-${O}`}),y=k(""),d=k(""),p=i(()=>{let _=0;return s.task.items.forEach((O,V)=>{if(V+1==s.task.items.length&&O.itemType=="dropDown"){const K=s.task.items[V-1];!t.isUndefined(K.style)&&!t.isUndefined(K.style.border)&&K.style.border.right!="none"&&(s.task.items.length==3?_=Number(K.style.breakPoint)-1:s.task.items.forEach((q,A)=>{if(A>1&&A<=V-1){let P=0;if(!t.isUndefined(q.style.potraitBreakPoint))P=q.style.potraitBreakPoint;else{let I=0;q.style.breakPoint=="none"?(s.task.items.forEach((x,T)=>{x.style.breakPoint!="none"&&(I+=Number(x.style.breakPoint))}),P=12-I):P=q.style.breakPoint-I}_+=Number(P)}}))}}),_}),u=i(()=>{let _=0;return s.task.items.forEach((O,V)=>{if(V+1==s.task.items.length&&O.itemType=="dropDown"){const K=s.task.items[V-1];!t.isUndefined(K.style)&&!t.isUndefined(K.style.border)&&K.style.border.right!="none"&&(s.task.items.length==3?_=Number(K.style.breakPoint)-1:s.task.items.forEach((q,A)=>{if(A>1&&A<=V-1){let P=0,I=0;q.style.breakPoint=="none"?(s.task.items.forEach((x,T)=>{x.style.breakPoint!="none"&&(I+=Number(x.style.breakPoint))}),P=12-I):P=q.style.breakPoint-I,_+=Number(P)}}))}}),_}),g=i(()=>{let _=!1,O=!1,V=!1;return s.task.items.forEach((K,q)=>{if(q==1&&!t.isUndefined(K.style)&&!t.isUndefined(K.style.border)&&K.style.border.left!="none"&&(_=!0,y.value=K.style.border.left,!t.isUndefined(K.style)&&!t.isUndefined(K.style.border)&&K.style.border.bottom!="none"&&(V=!0)),q+1==s.task.items.length&&K.itemType=="dropDown"){const A=s.task.items[q-1];!t.isUndefined(A.style)&&!t.isUndefined(A.style.border)&&A.style.border.right!="none"&&(O=!0,d.value=A.style.border.right)}}),_&&O&&!V}),h=k(!1),w=_=>{h.value=_},U=i(()=>{let _=40;return h.value&&(_=60),_}),m=i(()=>{var V,K;const _=s.task.items.find(q=>q.style.visibility!="hidden"),O=t.last(s.task.items);return!(!t.isUndefined((V=s.task)==null?void 0:V.isShowAdjustmentRow)&&((K=s.task)!=null&&K.isShowAdjustmentRow))&&!t.isUndefined(O.style)&&!t.isUndefined(O.style.border)&&O.style.border.bottom!="none"&&!t.isUndefined(_.style)&&!t.isUndefined(_.style.border)&&_.style.border.left!="none"}),b=i(()=>{var A,P;const _=s.task.items.find(I=>I.style.visibility!="hidden"),O=t.last(s.task.items);let V=!t.isUndefined(O.style)&&!t.isUndefined(O.style.border)&&O.style.border.right!="none"?`border-right: ${O.style.border.right}; `:"",K=!t.isUndefined(_.style)&&!t.isUndefined(_.style.border)&&_.style.border.left!="none"?`border-left: ${_.style.border.left}; `:"",q=s.task.updatedBy.name&&!t.isUndefined(O.style)&&!t.isUndefined(O.style.border)&&O.style.border.bottom!="none"?"margin-bottom: 1rem; ":"";return m.value&&(V="",K=""),!t.isUndefined((A=s.task)==null?void 0:A.isShowAdjustmentRow)&&((P=s.task)!=null&&P.isShowAdjustmentRow)&&(q=""),V?`${V}${K}${q}`:`${q}`}),f=i(()=>{var O,V;const _=t.last(s.task.items);return!t.isUndefined((O=s.task)==null?void 0:O.isShowAdjustmentRow)&&((V=s.task)!=null&&V.isShowAdjustmentRow)||s.task.updatedBy.name&&!t.isUndefined(_.style)&&!t.isUndefined(_.style.border)&&_.style.border.bottom!="none"&&`${_.style.border.bottom}`,""}),F=i(()=>{let _="";return t.isUndefined(s.task.generalStyle)||(_=s.task.generalStyle),_}),J=i(()=>{let _="";const O=s.task.customStyle;return t.isUndefined(O)||O.split(" | ").forEach(K=>{K.includes("noteStyle")&&!t.isUndefined(s.taskGroup[s.taskIndex-1].updatedBy.name)&&s.taskGroup[s.taskIndex-1].updatedBy.name&&(_=`${_} ${K.split(" = ")[1]}`)}),_});return(_,O)=>Wt((c(),$("div",null,[n("div",{class:we(["row w-100",[a.value,o.value]]),style:ce([F.value,J.value])},[(c(!0),$(Ve,null,nt(s.task.items,V=>(c(),$(Ve,{key:V.key},[V.itemType==="image"?(c(),Z(qa,{key:0,item:V,task:r.task},null,8,["item","task"])):D("",!0),V.itemType==="label"?(c(),Z(Ya,{key:1,item:V,task:r.task},null,8,["item","task"])):D("",!0),V.itemType==="dropDown"?(c(),Z(Xa,{key:2,item:V,task:r.task,"general-submitted":r.generalSubmitted,onSetLoading:w},null,8,["item","task","general-submitted"])):D("",!0),V.itemType==="input"?(c(),Z(Za,{key:3,item:V,task:r.task,"general-submitted":r.generalSubmitted},null,8,["item","task","general-submitted"])):D("",!0),V.itemType==="smallCamera"?(c(),Z(Qa,{key:4,item:V,task:r.task,"general-submitted":r.generalSubmitted},null,8,["item","task","general-submitted"])):D("",!0),V.itemType==="checkbox"?(c(),Z(es,{key:5,item:V,task:r.task},null,8,["item","task"])):D("",!0),V.itemType==="html"?(c(),Z(ka,{key:6,item:V,task:r.task},null,8,["item","task"])):D("",!0),V.itemType==="button"?(c(),Z(ts,{key:7,item:V,task:r.task},null,8,["item","task"])):D("",!0),V.itemType==="statusInfo"?(c(),Z(ha,{key:8,item:V,task:r.task},null,8,["item","task"])):D("",!0)],64))),128))],6),r.task.updatedBy.name?(c(),$("div",{key:0,class:"row w-100 position-absolute pe-3",style:ce(`top: ${U.value}px;`)},[n("div",{class:we(["d-flex justify-content-end pb-1 my-0 timestamp-task",v.value]),style:ce([b.value,f.value])},Ie(r.task.updatedBy.name)+", "+Ie(r.task.updatedDate),7)],4)):D("",!0),r.task.updatedBy.name?(c(),$(Ve,{key:1},[m.value?D("",!0):(c(),$("div",lr,[g.value?(c(),$(Ve,{key:1},[or,n("div",{class:"col-1",style:ce(`border-left: ${y.value}`)},null,4),n("div",{class:we(`col-md-${p.value} col-lg-${u.value}`),style:ce(`border-right: ${d.value}`)},null,6)],64)):(c(),$("div",{key:0,style:ce(b.value),class:we(v.value)},null,6))]))],64)):D("",!0),r.task.isShowAdjustmentRow?(c(),Z(sr,{key:2,task:r.task},null,8,["task"])):D("",!0)],512)),[[ys,l.value]])}}),nr=Ue({__name:"TableRow",props:{item:{type:Object,required:!0},task:{type:Object},itemLoading:{type:Boolean,default:!1},generalSubmitted:{required:!0,type:Boolean}},setup(r){const s=r,e=i(a=>{const o=[];for(const v in s.item)o.push(s.item[v]);return o}),l=a=>{let o="";return!t.isUndefined(a.style)&&!t.isUndefined(a.style.textvAlign)&&(o=`align-self-${a.style.textvAlign}`),o};return(a,o)=>(c(!0),$(Ve,null,nt(e.value,v=>(c(),$("div",{class:we([l(v),"eform-table-row col px-0"]),key:v.key},[v.itemType==="image"?(c(),Z(qa,{key:0,item:v,task:r.task},null,8,["item","task"])):D("",!0),v.itemType==="label"?(c(),Z(Ya,{key:1,item:v,task:r.task},null,8,["item","task"])):D("",!0),v.itemType==="input"?(c(),Z(Za,{key:2,item:v,task:r.task,"item-loading":r.itemLoading,"general-submitted":r.generalSubmitted},null,8,["item","task","item-loading","general-submitted"])):D("",!0),v.itemType==="dropDown"?(c(),Z(Xa,{key:3,item:v,task:r.task,"item-loading":r.itemLoading,"general-submitted":r.generalSubmitted},null,8,["item","task","item-loading","general-submitted"])):D("",!0),v.itemType==="smallCamera"?(c(),Z(Qa,{key:4,item:r.item,task:r.task,"general-submitted":r.generalSubmitted},null,8,["item","task","general-submitted"])):D("",!0),r.item.itemType==="checkbox"?(c(),Z(es,{key:5,item:r.item,task:r.task},null,8,["item","task"])):D("",!0),v.itemType==="html"?(c(),Z(ka,{key:6,item:v,task:r.task},null,8,["item","task"])):D("",!0),r.item.itemType==="button"?(c(),Z(ts,{key:7,item:r.item,task:r.task},null,8,["item","task"])):D("",!0),r.item.itemType==="statusInfo"?(c(),Z(ha,{key:8,item:r.item,task:r.task},null,8,["item","task"])):D("",!0)],2))),128))}}),ir={class:"row w-100 mx-0 mb-5"},ur={key:0,class:"col-1 px-2"},dr={class:"row text-center task-table__header py-2 w-100"},cr=Ue({__name:"TableTask",props:{task:{type:Object,required:!0},generalSubmitted:{required:!0,type:Boolean}},setup(r){const s=r,e=i(()=>s.task.header.replaceAll("'","").replace("[","").replace("]","").split(", ")),l=p=>{let u="";return!t.isUndefined(s.task.style)&&!t.isUndefined(s.task.style.borderBottom)&&s.task.style.borderBottom=="none"?u="":u="border-bottom-table",p+1==s.task.items.length&&(u="border-bottom-table"),u},a=vt(),o=i(()=>s.task),v=k(!1),y=i(()=>{let p="";if(t.isUndefined(s.task.disabledByItemKey))return p;const u=a.stateStoredDisableKeyValue.find(g=>g.key==s.task.disabledByItemKey);return t.isUndefined(u)||(p=u.value),p});ke(y,async p=>{p=="3"&&d()},{deep:!0});const d=async()=>{if(!t.isUndefined(s.task.disabledByItemKey)){let p=a.stateStoredDisableKeyValue.find(u=>u.key==s.task.disabledByItemKey);if(t.isUndefined(p)){const u=await a.getValueFromItemKey(s.task.disabledByItemKey);a.pushStoredDisabledItems({key:s.task.disabledByItemKey,value:u})}if(p=a.stateStoredDisableKeyValue.find(u=>u.key==s.task.disabledByItemKey),(p==null?void 0:p.value)=="3"){const u=[];s.task.items.forEach(g=>{for(var h in g){const w=g[h];if(!t.isUndefined(w.disabledByItemKey)&&w.value){const U={keyValue:w.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]};u.push(U)}}}),u.length>0&&(v.value=!0,await a.updateItemFromTask(u),v.value=!1)}}};return(p,u)=>(c(),$("div",ir,[!W(t.isUndefined)(o.value.style)&&o.value.style.category=="taskTable"?(c(),$("div",ur)):D("",!0),n("div",{class:we(["task-table",!W(t.isUndefined)(o.value.style)&&o.value.style.category=="taskTable"?"col-11 px-0":"col-12 pe-0"]),style:{"font-size":"12px !important"}},[n("label",null,Ie(o.value.description),1),n("div",dr,[(c(!0),$(Ve,null,nt(e.value,g=>(c(),$("div",{class:"col font-weight-normal task-table__header__item",key:g},Ie(g),1))),128))]),(c(!0),$(Ve,null,nt(o.value.items,(g,h)=>(c(),$("div",{key:g.key,class:we(["row w-100 task-table__body d-flex align-items-start",l(h)])},[j(nr,{item:g,task:o.value,"item-loading":v.value,"general-submitted":r.generalSubmitted},null,8,["item","task","item-loading","general-submitted"])],2))),128))],2)]))}}),as=$t(cr,[["__scopeId","data-v-3a374d27"]]),mr={class:"row w-100 mt-3 mb-3"},fr={key:0,class:"col-1 px-2"},yr={class:"small-hyperlink-text-style"},vr=Ue({__name:"CollapsibleTableTask",props:{task:{type:Object,required:!0},generalSubmitted:{required:!0,type:Boolean}},setup(r){const s=r,e=k("open"),l=i(()=>{let a="";return!t.isUndefined(s.task.style)&&!t.isUndefined(s.task.style.defaultCollapse)&&(a=s.task.style.defaultCollapse),a});return(a,o)=>{const v=ne("el-collapse-item"),y=ne("el-collapse");return c(),$("div",mr,[!W(t.isUndefined)(r.task.style)&&r.task.style.collapseCategory=="taskTable"?(c(),$("div",fr)):D("",!0),n("div",{class:we(["task-table collapsible-table-container",!W(t.isUndefined)(r.task.style)&&r.task.style.collapseCategory=="taskTable"?"col-11 px-0":"col-12 pe-0"])},[j(y,{class:"task-group general-accordion py-1 px-5",modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value=d)},{default:le(()=>[j(v,{name:l.value},{title:le(()=>[n("span",yr,Ie(r.task.triggerCaption),1)]),default:le(()=>[j(as,{task:r.task,"general-submitted":r.generalSubmitted},null,8,["task","general-submitted"])]),_:1},8,["name"])]),_:1},8,["modelValue"])],2)])}}}),pr=Ue({__name:"TaskGroup",props:{taskGroup:{type:Object,required:!0}},setup(r){const s=r,e=vt(),l=Zt(),a=k(""),o=()=>{a.value=s.taskGroup.key,e.decreaseCollapse()},v=Te(()=>e.stateToggleExpandTaskGroup),y=Te(()=>l.generalUpdated);ke(v,u=>{u&&o()}),xt(()=>{o()});const d=u=>{t.isEmpty(a.value)?e.increaseeCollapse():e.decreaseCollapse()};Te(()=>s.taskGroup.key);const p=Te(()=>s.taskGroup);return ke(p,u=>{o(),e.stateSelectedSubGroups.forEach(g=>{g.taskGroup.forEach(h=>{if(h.key=="MECHANICAL_SERVICE_SUSPENSION"){let w=[],U=[];h.task.forEach(m=>{m.items.forEach(b=>{b.categoryItemType=="suspensionTargetRating"&&w.push({key:b.key,value:b.value}),b.categoryItemType=="adjustmentSuspensionTargetRating"&&U.push({key:b.key,value:b.value})}),t.isUndefined(m.showParameter)||m.showParameter=="suspensionCylinder"&&e.updateStoredAdjustmentOptionValue(m.taskValue)}),e.pushDataToAdjustedSuspensionCylinderStoredValue(U),e.pushDataToSuspensionCylinderStoredValue(w)}})})}),(u,g)=>{const h=ne("el-collapse-item"),w=ne("el-collapse");return c(),Z(w,{modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=U=>a.value=U),class:"task-group e-form-only py-1 px-5 mb-3",onClick:d},{default:le(()=>[j(h,{title:r.taskGroup.name,name:r.taskGroup.key},{default:le(()=>[(c(!0),$(Ve,null,nt(s.taskGroup.task,(U,m)=>(c(),$("div",{key:U.key,class:"ps-3 position-relative"},[U.taskType=="inline"?(c(),Z(rr,{key:0,task:U,"task-index":m,"task-group":r.taskGroup.task,"general-submitted":W(y)},null,8,["task","task-index","task-group","general-submitted"])):D("",!0),U.taskType==="table"?(c(),Z(as,{key:1,task:U,"general-submitted":W(y)},null,8,["task","general-submitted"])):D("",!0),U.taskType=="collapsibleTable"?(c(),Z(vr,{key:2,task:U,"general-submitted":W(y)},null,8,["task","general-submitted"])):D("",!0)]))),128))]),_:1},8,["title","name"])]),_:1},8,["modelValue"])}}}),br={class:"ps-0 mt-5"},gr={class:"card"},kr=Ue({__name:"SubGroup",props:{subGroup:{type:Object,required:!0}},setup(r){const s=r;return(e,l)=>(c(),$("div",br,[n("div",gr,[(c(!0),$(Ve,null,nt(s.subGroup.taskGroup,a=>(c(),Z(pr,{key:a.key,"task-group":a},null,8,["task-group"]))),128))])]))}}),It=r=>(zt("data-v-dd4a11d5"),r=r(),Xt(),r),hr={class:"mt-5 ps-0"},Sr=It(()=>n("h4",{class:"subtitle ps-3"},"Service Labour Personnel",-1)),Cr={class:"p-2 me-0"},wr={class:"row",style:{width:"101%"}},Ur={class:"col-12 pe-0"},_r={class:"p-2 me-0"},Ir={class:"row",style:{width:"101%"}},$r={class:"col-6 pe-0"},Tr=["value"],Rr=It(()=>n("label",{for:"floatingInput",class:"text-nowrap"},"Actual Service Start (each labour personnel)",-1)),Pr={class:"col-6 pe-0"},Br={class:"form-floating mb-3",style:{position:"relative !important"}},Vr=["value"],Nr=It(()=>n("label",{for:"floatingInput"},"Shift",-1)),xr=It(()=>n("h4",{class:"subtitle ps-3"},"Equipment Information",-1)),Dr={class:"d-flex flex-row justify-content-between"},Ar={class:"p-2 pb-0 d-flex flex-row flex-grow-1"},Fr={class:"d-flex w-100"},Or={class:"flex-fill"},Er={class:"form-floating mb-3"},Lr=["value"],jr=It(()=>n("label",null,"Unit Number",-1)),Mr={class:"flex-fill ps-3"},Hr={class:"form-floating mb-3"},Kr=["value"],Gr=It(()=>n("label",null,"Serial Number",-1)),qr={class:"flex-fill ps-3"},Yr={class:"form-floating mb-3"},Jr=["value"],Wr=It(()=>n("label",{for:"floatingInput"},"Work Order",-1)),zr={class:"flex-fill ps-3"},Xr={class:"form-floating mb-3 position-relative"},Zr=["value"],Qr=["disabled","value"],en={key:2,class:"ms-2 position-absolute",style:{top:"2px",right:"0"}},tn=It(()=>n("img",{src:$s,style:{width:"1.25rem",height:"1.25rem"}},null,-1)),an=[tn],sn=It(()=>n("label",{for:"floatingInput2",class:"text-nowrap"},"Machine SMU",-1)),ln={key:0,class:"text-danger ps-2 font-weight-bold"},on={class:"ms-2"},rn=["disabled"],nn=["src"],un={key:0,class:"ms-2"},dn={class:"p-3 justify-items-center rounded",style:{background:"#18af4a"}},cn={key:0,class:"d-flex flex-row justify-content-end timestamp-task"},mn={class:"d-flex flex-row justify-content-between"},fn={class:"p-2 d-flex flex-row flex-grow-1"},yn={class:"d-flex w-100"},vn={class:"flex-fill"},pn={class:"form-floating mb-3"},bn=["value"],gn=It(()=>n("label",null,"Actual Service Start",-1)),kn={class:"flex-fill ps-3"},hn={class:"form-floating mb-3"},Sn=["value"],Cn=It(()=>n("label",{for:"floatingInput"},"Hour Meter Offset",-1)),wn={key:0,class:"d-flex",style:{"flex-basis":"40%"}},Un={class:"flex-fill ps-3"},_n={class:"form-floating mb-3"},In=["value"],$n=["value"],Tn=It(()=>n("label",{for:"floatingInput2",class:"text-nowrap"},"Travel Hours",-1)),Rn={key:0,class:"text-danger ps-2 font-weight-bold"},Pn={class:"ms-2"},Bn=["disabled"],Vn=["src"],Nn={key:0,class:"ms-2"},xn={class:"p-3 justify-items-center rounded",style:{background:"#18af4a"}},Dn={class:"d-flex flex-row justify-content-between"},An={class:"p-2 d-flex flex-row flex-grow-1"},Fn={class:"d-flex w-100"},On={class:"flex-fill"},En={class:"form-floating mb-3"},Ln=["value"],jn=It(()=>n("label",null,"Actual Service Finish",-1)),Mn={key:0,class:"d-flex",style:{"flex-basis":"40%"}},Hn={class:"flex-fill ps-3"},Kn={class:"form-floating mb-3"},Gn=["value"],qn=["value"],Yn=It(()=>n("label",{for:"floatingInput2",class:"text-nowrap"},"Swing Hours",-1)),Jn={key:0,class:"text-danger ps-2 font-weight-bold"},Wn={class:"ms-2"},zn=["disabled"],Xn=["src"],Zn={key:0,class:"ms-2"},Qn={class:"p-3 justify-items-center rounded",style:{background:"#18af4a"}},ei=Ue({__name:"CardEquipmentInformation",props:{data:{required:!0,type:Object},timer:{required:!0,type:String}},emits:["onPersonelSelected","updateTimer"],setup(r,{expose:s,emit:e}){const l=r,a=e,o=Zt(),v=_t(),y=vt(),d=Ka(),p=Oa(),u=Ra(),g=k(y.serviceStart),h=k(y.shift),w=k("Equipment Information"),U=k(""),m=k({smu:"",travelHour:"",swingHour:""}),b=k(!1),f=k(!1),F=k(),J=k(!1),_=k(!1),O=k(!1),V=k(!1),K=k(""),q=k(!1),A=k(""),P=k(""),I=k(!1),x=k(""),T=k({name:"",id:""}),L=k(""),z=k(""),ue=k(""),be=k(!1),Ee=i(()=>o.generalForm.hmOffset?Number(o.generalForm.hmOffset):0),Q=i(()=>{const S=o.smuActual,M=o.smuTolerance;return Number(Number(S)+Number(M.min))}),N=i(()=>{const S=o.smuActual,M=o.smuTolerance;return Number(Number(S)+Number(M.max))}),Y=i(()=>Q.value-Ee.value),te=i(()=>N.value-Ee.value),ie=i(()=>As({smu:x.value||l.data.smu,hmOffset:Ee.value,range:{min:Q.value,max:N.value}})),ae=i(()=>{var S;return T.value.name?T.value:(S=l.data)==null?void 0:S.smuBy}),Ne=i(()=>{var S;return L.value!=""?L.value:(S=l.data)==null?void 0:S.smuDate}),Ze=i(()=>({isError:p.stateErrorMessage!="",messages:p.stateErrorMessage})),Je=()=>{let S="/media/svg/dma/camera/e-form/png/cam-active.png";return Ae.value&&(S="/media/svg/dma/camera/e-form/png/cam-read.png"),B.value.length>0&&(S="/media/svg/dma/camera/e-form/png/cam-user.png"),S},Qe=()=>{let S="/media/svg/dma/camera/e-form/png/cam-active.png";return Ke.value&&(S="/media/svg/dma/camera/e-form/png/cam-read.png"),me.value.length>0&&(S="/media/svg/dma/camera/e-form/png/cam-user.png"),S},ct=()=>{let S="/media/svg/dma/camera/e-form/png/cam-active.png";return He.value&&(S="/media/svg/dma/camera/e-form/png/cam-read.png"),G.value.length>0&&(S="/media/svg/dma/camera/e-form/png/cam-user.png"),S},B=i(()=>{const S=o.generalForm.imageEquipment;return t.isUndefined(S)?[]:S==""?[]:lt(S)}),G=i(()=>{try{const S=o.generalForm.travelHourImages;return t.isUndefined(S)?[]:S==""?[]:lt(S)}catch{return[]}}),me=i(()=>{try{const S=o.generalForm.swingHourImages;return t.isUndefined(S)?[]:S==""?[]:lt(S)}catch{return[]}}),Re=i(()=>t.cloneDeep(v.ImageObjects.find(S=>S.Id==="equipment-smu"))),pe=i(()=>t.cloneDeep(v.ImageObjects.find(S=>S.Id==="equipment-swing"))),he=i(()=>t.cloneDeep(v.ImageObjects.find(S=>S.Id==="equipment-travel"))),xe=k(),Me=async()=>{var Ce;if(!((Ce=Re.value)!=null&&Ce.ImageInfos))return;let S=[];Re.value&&(S=lt(Re.value.ImageInfos));const M=lt(o.generalForm.imageEquipment),se=S.filter(Le=>!M.includes(Le));if(o.updateSMUImages([t.last(se)]),o.generalForm.imageEquipment.length==1)if(xe.value=Ye.service({lock:!0,text:"Uploading Picture",background:"rgba(0, 0, 0, 0.7)"}),(await o.updateSMUImageToBE()).data.result.isError)xe.value.close();else{q.value=!0,xe.value.close(),setTimeout(()=>{q.value=!1},2e3);let Pt=l.data.smu;be.value||(Pt=x.value,await mt()),be.value=!1,await p.createSMUDefect({val:Bt(Pt),hmOffset:String(o.HmOffset),range:{MinRange:Q.value,MaxRange:N.value},smuDate:L.value,isInRange:ie.value}),y.getTaskProgress()}},ot=()=>{I.value=!0},E=i(()=>{var Le,Pt;let S=Bt(t.cloneDeep(x.value||((Le=l.data)==null?void 0:Le.smu)));const M=Number(S)+Number(Ee.value)>=Q.value,se=Number(S)+Number(Ee.value)<=N.value;let Ce=Ua.STATUS_NOT_IN_RANGE;return M&&se&&(Ce=Ua.STATUS_IN_RANGE),{title:Ua.TITLE(Ce),machineSMU:((Pt=l.data)==null?void 0:Pt.smu)||x.value,minRange:Q.value,maxRange:N.value,smuDue:o.smuActual,assetNumber:y.unitNumber,serialNumber:y.generalForm.serialNumber,images:JSON.stringify(B.value),hmOffset:o.HmOffset,key:"",type:"",reason:""}}),oe=i(()=>{const S=u.Ownership;return Fs(S)}),ge=async()=>{var Ce;if(!((Ce=pe.value)!=null&&Ce.ImageInfos))return;const S=pe.value.ImageInfos,se=[...lt(o.generalForm.swingHourImages),...S];o.updateSwingImages(se),await o.updateTravelSwingImageToBE("swingHourImages",o.generalForm.swingHourImages),v.setCurrent("equipment-swing"),v.clearCurrent()},Pe=async()=>{var Ce;if(!((Ce=he.value)!=null&&Ce.ImageInfos))return;const S=he.value.ImageInfos,se=[...lt(o.generalForm.travelHourImages),...S];o.updateTravelImages(se),await o.updateTravelSwingImageToBE("travelHourImages",o.generalForm.travelHourImages),v.setCurrent("equipment-travel"),v.clearCurrent()};ke(Re,(S,M)=>{!t.isUndefined(S)&&S.ImageInfos.length>0&&(t.isEqual(S.ImageInfos,M==null?void 0:M.ImageInfos)||Me())},{deep:!0}),ke(pe,(S,M)=>{!t.isUndefined(S)&&S.ImageInfos.length>0&&(t.isEqual(S.ImageInfos,M==null?void 0:M.ImageInfos)||ge())},{deep:!0}),ke(he,(S,M)=>{!t.isUndefined(S)&&S.ImageInfos.length>0&&(t.isEqual(S.ImageInfos,M==null?void 0:M.ImageInfos)||Pe())},{deep:!0});const Oe=k(!1),We=()=>{Oe.value=!0},C=()=>{Oe.value=!1},H=k(!1),fe=()=>{H.value=!0},Se=()=>{H.value=!1},ve=k(!1),_e=()=>{ve.value=!0},je=()=>{ve.value=!1},Ae=i(()=>et.value.name?o.stateIsSmuCameraDisabled||y.generalForm.smu=="":!0),He=i(()=>et.value.name?o.stateIsTravelHourCameraDisabled||y.generalForm.travelHour=="":!0),Ke=i(()=>et.value.name?o.stateIsSwingHourCameraDisabled||y.generalForm.swingHour=="":!0),rt=()=>{X(),be.value=!0,C()},Ct=S=>{let M=o.generalForm.swingHourImages;M=M.filter(se=>typeof se=="string"?se!=S:se.filename!=S),o.updateSwingImages(M),v.setCurrent("equipment-swing"),v.clearCurrent(),o.stateGeneralForm.isSwingMandatoryTakePhoto&&me.value.length==0&&ze(!1),me.value.length==0&&je()},gt=S=>{let M=o.generalForm.travelHourImages;M=M.filter(se=>typeof se=="string"?se!=S:se.filename!=S),o.updateTravelImages(M),v.setCurrent("equipment-travel"),v.clearCurrent(),o.stateGeneralForm.isTravelMandatoryTakePhoto&&G.value.length==0&&it(!1),G.value.length==0&&Se()},et=i(()=>y.employee),R=i(()=>et.value.name!=""&&o.generalUpdated),X=()=>{v.toggleIsVisible(!0,"equipment-smu")},de=()=>{v.toggleIsVisible(!0,"equipment-smu"),v.setShowCloseButton(!1),_.value=!1},ye=()=>{it(!1),O.value=!1},Be=()=>{ze(!1),V.value=!1},ze=(S=!0)=>{v.toggleIsVisible(!0,"equipment-swing")},it=(S=!0)=>{v.toggleIsVisible(!0,"equipment-travel")},pt=()=>{b.value=!1},wt=()=>{f.value=!1},Xe=i(()=>{let S=Mt(x.value);return S=="0"&&(S=""),S}),ut=i(()=>{let S=Mt(z.value);return S=="0"&&(S=""),S}),dt=i(()=>{let S=Mt(ue.value);return S=="0"&&(S=""),S}),kt=async S=>{m.value.smu="",x.value=S,o.SMUToleranceNotMapped?(m.value.smu="SMU tolerance not yet mapped",f.value=!0):ie.value?o.generalForm.imageEquipment.length>0?(mt(),p.createSMUDefect({val:Bt(x.value),hmOffset:String(o.HmOffset),range:{MinRange:Q.value,MaxRange:N.value},smuDate:L.value,isInRange:ie.value})):_.value=!0:(K.value=`<b>Is this correct Machine SMU value?</b><br><span>Machine SMU should be in range <b>${Y.value} to ${te.value}</b></span>`,J.value=!0)},mt=async(S="")=>{const M=Bt(S||x.value);L.value=M==""?"":Ks(),T.value=M==""?"":p.selectedFitter,o.addPropertyParam("GENERAL","smu",M),o.addPropertyParam("GENERAL","smuBy",JSON.stringify(T.value)),o.addPropertyParam("GENERAL","smuDate",L.value),o.addPropertyParam("GENERAL","hmOffset",String(o.HmOffset)),o.updateSMUONGeneral({value:M,smuBy:T.value,smuDate:L.value}),await o.updateSMUValueToBE({smu:M,hmOffset:String(o.HmOffset),smuDate:L.value,smuBy:T.value})},tt=k(),Lt=()=>{J.value=!1,x.value="",T.value={id:"",name:""},L.value="",tt.value.value="",vs(()=>{tt.value.focus()})},Qt=()=>{J.value=!1,o.generalForm.imageEquipment.length>0?(mt(),p.createSMUDefect({val:Bt(x.value),hmOffset:String(o.HmOffset),range:{MinRange:Q.value,MaxRange:N.value},smuDate:L.value,isInRange:ie.value})):_.value=!0};let Tt;const ea=async S=>{if(A.value==S.target.value)return;if(S.target.value=Mt(Bt(S.target.value)),m.value.smu="",clearTimeout(Tt),S.target.value=="")return!1;const M=S.target.value;Tt=setTimeout(async()=>{ht("smu")?await ft("smu")||await kt(M):(S.target.value="",x.value="")},0)},Gt=S=>{S.target.value=Os(S.target.value)},At=async S=>{m.value.travelHour="";let M=Bt(t.cloneDeep(S));o.addPropertyParam("GENERAL","travelHour",M),o.updateTravelHourONGeneral(M),await o.updateSwingTravelValueToBE("travelHour",M)},ta=async S=>{if(A.value==S.target.value)return;S.target.value=Mt(Bt(S.target.value)),m.value.travelHour="",clearTimeout(Tt);const M=S.target.value;Tt=setTimeout(async()=>{ht("travelHour")?await ft("travelHour")||(o.stateGeneralForm.isTravelMandatoryTakePhoto&&G.value.length==0&&(O.value=!0),await At(M)):S.target.value=""},0)},aa=async S=>{m.value.swingHour="";let M=Bt(t.cloneDeep(S));o.addPropertyParam("GENERAL","swingHour",M),o.updateSwingHourONGeneral(M),await o.updateSwingTravelValueToBE("swingHour",M)},sa=async S=>{if(A.value==S.target.value)return;S.target.value=Mt(Bt(S.target.value)),m.value.swingHour="",clearTimeout(Tt);const M=S.target.value;Tt=setTimeout(async()=>{ht("swingHour")?await ft("swingHour")||(o.stateGeneralForm.isSwingMandatoryTakePhoto&&me.value.length==0&&(V.value=!0),await aa(M)):S.target.value=""},0)},ht=S=>{const M="Labour Personnel Name Personnel field must be completed";return y.employee.id==""||t.isUndefined(y.employee.id)?(m.value[S]=M,!1):!0},ft=async S=>{let M=!1,se="";return S=="smu"?(se="SMU",P.value="SMU"):S=="travelHour"?(se="Travel Hour",P.value="Travel Hours"):S=="swingHour"&&(se="Swing Hour",P.value="Swing Hours"),await o.getServiceSheetHeaderKeyVal(S,se).then(async Ce=>{Ce!=""?(b.value=!0,y.updateGeneralValue(S,Ce),M=!0):M=!1}),M},Ft=S=>{let M=S.keyCode?S.keyCode:S.which;if((M<48||M>57)&&M!=46&&S.preventDefault(),M==13){tt.value.blur();return}},Rt=()=>{U.value="relative-hidder"},Ot=()=>{U.value=""},qt=()=>{const S=o.stateShiftList,M=Gs(o.stateTimeZone),se=S.find(Ce=>{const Le=Ce.startHourType=="PM"?Da(`${Ce.startHour}:00`):`${Ce.startHour}:00`,Pt=Ce.endHourType=="PM"?Da(`${Ce.endHour}:00`):`${Ce.endHour}:00`;if(Ce.startHourType=="PM"&&Ce.endHourType=="AM"){if(M>"12:00:00"){if(M>=Le||M<=Pt)return Ce}else if(M<=Le&&M<=Pt)return Ce}else if(M>=Le&&M<=Pt)return Ce});return t.isUndefined(se)?qs(o.stateTimeZone):se.shift.toLowerCase().includes("shift")?se.shift:`${se.shift} Shift`},jt=S=>{if(S.value!="")if(o.generalForm.log.length==0)o.setFitterInfoFitter(S,ia(o.stateTimeZone),h.value),o.setIsFitterLoggedInExist(!1);else{const M=o.generalForm.log.filter(se=>{if(!t.isUndefined(se.employee))return se.employee.id==S.value});if(M.length==0)o.setFitterInfoFitter(S,ia(o.stateTimeZone),h.value),o.setIsFitterLoggedInExist(!1);else{const se=t.last(M);o.setFitterInfo(se);const Ce=ia(o.stateTimeZone).split(" ")[1],Le=o.stateShiftList.find(Nt=>{let na=!1;if(Nt.startHourType=="AM"&&Nt.endHourType=="PM"){const ca=Number(Nt.endHour.split(":")[0])+6;let ma=`${Number(ca)+12}:${Nt.endHour.split(":")[1]}`;na=Ce>=Nt.startHour&&Ce<=ma}else if(Nt.startHourType=="PM"&&Nt.endHourType=="AM"){let ca=`${Number(Nt.startHour.split(":")[0])+12}:${Nt.startHour.split(":")[1]}`;const ma=`${Number(Nt.endHour)+6}:${Nt.endHour.split(":")[1]}`;Ce<"24:00:00"?na=Ce<=ca||Ce>=ma:na=Ce<=ca&&Ce<=ma}else na=!0;return na});let Pt=Number(Le==null?void 0:Le.endHour.split(":")[0])+6;(Le==null?void 0:Le.endHourType)=="PM"&&(Pt+=12);let ms=`${Pt}:${Le==null?void 0:Le.endHour.split(":")[1]}:${Le==null?void 0:Le.endHour.split(":")[2]}`;Ce<ms&&o.setIsFitterLoggedInExist(!0)}}},la=async S=>{U.value="",g.value=`${ia(o.stateTimeZone)} (${o.stateTimeZoneDesc})`,h.value=qt();const M={id:S.value,name:S.label};y.updateSelectedFitter(M),jt(S),a("onPersonelSelected");const se={key:el(),mechanic:M,serviceStart:"<<ServerDateTime>>",serviceEnd:"",shift:h.value};o.addPropertyParam("GENERAL","servicePersonnels",JSON.stringify(se)),o.setCurrentPersoneel(se),y.updateServiceStart(g.value),m.value.smu=="Service Labour Personnel must be filled"&&(m.value.smu=""),y.updateSelectedFitter(M)};s({showTravelRequired:()=>{m.value.travelHour="Required"},showSwingRequired:()=>{m.value.swingHour="Required"},hideTravelRequired:()=>{m.value.travelHour=""},hideSwingRequired:()=>{m.value.swingHour=""}}),xt(()=>{y.stateFromHomePage&&(F.value.optionSelected({label:"",value:""}),g.value="",y.setFromHomePage(!1))});const qe=async S=>{const M=!S.newDetail.title.toLowerCase().includes("not");mt(S.newDetail.machineSMU),t.isEqual(B.value,JSON.parse(S.newDetail.images))||(o.updateSMUImages(JSON.parse(S.newDetail.images)),await o.updateSMUImageToBE()),await p.createSMUDefect({val:Bt(S.newDetail.machineSMU),hmOffset:String(o.HmOffset),range:{MinRange:S.newDetail.minRange,MaxRange:S.newDetail.maxRange},smuDate:L.value,isInRange:M}),S.callback()},$e=Qs.SMU_REVISE,at=i(()=>{const S=v.ImageObjects.find(M=>M.Id===$e);return t.cloneDeep(S)}),Ut=()=>{v.toggleIsVisible(!0,$e),v.setIsActionFromDelete(!0)},St=()=>{v.reset()},st=()=>{p.resetErrorStatus()};return(S,M)=>{const se=ne("el-collapse-item"),Ce=ne("el-collapse");return c(),$(Ve,null,[n("div",hr,[j(Ce,{modelValue:w.value,"onUpdate:modelValue":M[2]||(M[2]=Le=>w.value=Le),class:"general-accordion task-group py-1 px-5 mb-3"},{default:le(()=>[j(se,{name:"Equipment Information"},{title:le(()=>[Sr]),default:le(()=>{var Le;return[n("div",Cr,[n("div",wr,[n("div",Ur,[j(Ys,{ref_key:"selectFitter",ref:F,"field-label":"Labour Personnel Name",placeholder:"Select your name",data:W(d).PersonelLabours,value:et.value.name,"display-label":!0,onOnFocus:Rt,onOnLostFocus:Ot,onOnSelected:la,disabled:R.value},null,8,["data","value","disabled"])])])]),n("div",_r,[n("div",Ir,[n("div",$r,[n("div",{class:we(["form-floating mb-3",U.value]),style:{position:"relative !important"}},[n("input",{type:"text",class:"form-control",disabled:"",value:g.value},null,8,Tr),Rr],2)]),n("div",Pr,[n("div",Br,[n("input",{type:"text",class:"form-control no-float",disabled:"",value:h.value},null,8,Vr),Nr])])])]),xr,n("div",Dr,[n("div",Ar,[n("div",Fr,[n("div",Or,[n("div",Er,[n("input",{type:"text",class:"form-control",disabled:"",value:W(y).unitNumber},null,8,Lr),jr])]),n("div",Mr,[n("div",Hr,[n("input",{type:"text",class:"form-control",disabled:"",value:W(y).generalForm.serialNumber},null,8,Kr),Gr])]),n("div",qr,[n("div",Yr,[n("input",{type:"text",class:"form-control",disabled:"",value:r.data.workOrder},null,8,Jr),Wr])]),n("div",zr,[n("div",Xr,[r.data.smu!==""?(c(),$("input",{key:0,type:"text",class:"form-control",placeholder:"Machine SMU",disabled:"",value:W(Mt)(r.data.smu),pattern:"[0-9]*",inputmode:"numeric"},null,8,Zr)):(c(),$("input",{key:1,type:"text",name:"machine-smu",ref_key:"machineSMUField",ref:tt,class:"form-control",disabled:J.value||_.value,placeholder:"Machine SMU",onKeypress:Ft,onInput:Gt,value:Xe.value,onFocusout:ea,pattern:"[0-9]*",inputmode:"numeric"},null,40,Qr)),!r.data.isApprovedSmu&&r.data.smu&&((Le=et.value)!=null&&Le.name)?(c(),$("div",en,[n("button",{class:"btn p-4 justify-items-center rounded cursor-pointer svg-icon svg-icon-btech-primary-500",onClick:ot},an)])):D("",!0),sn]),m.value.smu?(c(),$("label",ln,Ie(m.value.smu),1)):D("",!0)]),n("div",on,[n("button",{class:"btn p-4 justify-items-center rounded",disabled:Ae.value,style:{background:"#f4f6f8",cursor:"pointer"},onClick:X},[n("img",{src:Je(),style:{height:"20px",width:"24px"},alt:"camera"},null,8,nn)],8,rn)]),B.value.length>0?(c(),$("div",un,[n("div",dn,[n("span",{style:{"font-weight":"700",color:"white"},onClick:We},"+"+Ie(B.value.length),1)])])):D("",!0)])])]),ae.value&&Ne.value?(c(),$("div",cn,Ie(ae.value.name)+", "+Ie(Ne.value),1)):D("",!0),n("div",mn,[n("div",fn,[n("div",yn,[n("div",vn,[n("div",pn,[n("input",{type:"text",class:"form-control",disabled:"",value:r.data.serviceStart},null,8,bn),gn])]),n("div",kn,[n("div",hn,[n("input",{type:"text",class:"form-control",disabled:"",value:W(o).HmOffset},null,8,Sn),Cn])]),W(t.isUndefined)(r.data.travelHour)?D("",!0):(c(),$("div",wn,[n("div",Un,[n("div",_n,[r.data.travelHour!==""||W(o).generalUpdated||W(o).generalForm.status=="Submited"?(c(),$("input",{key:0,type:"text",class:"form-control travel-swing",placeholder:"Travel Hours",disabled:"",value:W(Mt)(r.data.travelHour),pattern:"[0-9]*",inputmode:"numeric"},null,8,In)):(c(),$("input",{key:1,type:"text",class:"form-control travel-swing",placeholder:"Travel Hours",onKeypress:Ft,onInput:Gt,value:ut.value,onFocusin:M[0]||(M[0]=()=>{A.value=ut.value}),onFocusout:ta,pattern:"[0-9]*",inputmode:"numeric"},null,40,$n)),Tn]),m.value.travelHour?(c(),$("label",Rn,Ie(m.value.travelHour),1)):D("",!0)]),n("div",Pn,[n("button",{class:"btn p-4 justify-items-center rounded",disabled:He.value,style:{background:"#f4f6f8",cursor:"pointer"},onClick:it},[n("img",{src:ct(),style:{height:"20px",width:"24px"},alt:"photo"},null,8,Vn)],8,Bn)]),G.value.length>0?(c(),$("div",Nn,[n("div",xn,[n("span",{style:{"font-weight":"700",color:"white"},onClick:fe},"+"+Ie(G.value.length),1)])])):D("",!0)]))])])]),n("div",Dn,[n("div",An,[n("div",Fn,[n("div",On,[n("div",En,[n("input",{type:"text",class:"form-control",disabled:"",value:r.data.serviceEnd},null,8,Ln),jn])]),W(t.isUndefined)(r.data.swingHour)?D("",!0):(c(),$("div",Mn,[n("div",Hn,[n("div",Kn,[r.data.swingHour!==""||W(o).generalUpdated||W(o).generalForm.status=="Submited"?(c(),$("input",{key:0,type:"text",class:"form-control travel-swing",placeholder:"Swing Hours",disabled:"",value:W(Mt)(r.data.swingHour),pattern:"[0-9]*",inputmode:"numeric"},null,8,Gn)):(c(),$("input",{key:1,type:"text",class:"form-control travel-swing",placeholder:"Swing Hours",onKeypress:Ft,onInput:Gt,value:dt.value,onFocusin:M[1]||(M[1]=()=>{A.value=ut.value}),onFocusout:sa,pattern:"[0-9]*",inputmode:"numeric"},null,40,qn)),Yn]),m.value.swingHour?(c(),$("label",Jn,Ie(m.value.swingHour),1)):D("",!0)]),n("div",Wn,[n("button",{class:"btn p-4 justify-items-center rounded",disabled:Ke.value,style:{background:"#f4f6f8",cursor:"pointer"},onClick:ze},[n("img",{src:Qe(),style:{height:"20px",width:"24px"},alt:"photo"},null,8,Xn)],8,zn)]),me.value.length>0?(c(),$("div",Zn,[n("div",Qn,[n("span",{style:{"font-weight":"700",color:"white"},onClick:_e},"+"+Ie(me.value.length),1)])])):D("",!0)]))])])])]}),_:1})]),_:1},8,["modelValue"])]),j(Yt,{"modal-type":"alreadyFilled",show:b.value,onClose:pt},null,8,["show"]),j(Yt,{"modal-type":"notMapped",show:f.value,onClose:wt},null,8,["show"]),Oe.value?(c(),Z(ua,{key:0,type:"imageEquipment","re-render":!1,images:B.value,"show-delete-button":!0,"is-mandatory":!0,visibility:Oe.value,"is-monitoring":!1,"show-mandatory-caption":!1,onOnClose:C,onOnDelete:rt},null,8,["images","visibility"])):D("",!0),H.value?(c(),Z(ua,{key:1,type:"equipment-travel","re-render":!1,images:G.value,"show-delete-button":!0,"is-mandatory":!1,visibility:H.value,"is-monitoring":!1,"show-mandatory-caption":!1,onOnClose:Se,onOnDelete:gt},null,8,["images","visibility"])):D("",!0),ve.value?(c(),Z(ua,{key:2,type:"equipment-swing","re-render":!1,images:me.value,"show-delete-button":!0,"is-mandatory":!1,visibility:ve.value,"is-monitoring":!1,"show-mandatory-caption":!1,onOnClose:je,onOnDelete:Ct},null,8,["images","visibility"])):D("",!0),j(Ga,{visibility:J.value,caption:K.value,onOnNoConfirm:Lt,onOnYesConfirm:Qt},null,8,["visibility","caption"]),j(Jt,{visibility:_.value,caption:"Please take photo of Machine SMU in the cabin dashboard","yes-label":"Take a Photo","hide-no":!0,onOnYesConfirm:de},null,8,["visibility"]),j(Jt,{visibility:O.value,caption:"Please take photo","yes-label":"Take a Photo","hide-no":!0,onOnYesConfirm:ye},null,8,["visibility"]),j(Jt,{visibility:V.value,caption:"Please take photo","yes-label":"Take a Photo","hide-no":!0,onOnYesConfirm:Be},null,8,["visibility"]),j(Xs,{show:q.value,message:"Machine SMU photo has been taken"},null,8,["show"]),j(Zs,{show:I.value,"onUpdate:show":M[3]||(M[3]=Le=>I.value=Le),detailDefect:E.value,ownership:oe.value,"view-only":r.data.isApprovedSmu,"error-status":Ze.value,isFitter:!0,"cameras-image":at.value,onUpdateDefectDetailSMU:qe,onRetakePhoto:Ut,onResetPhoto:St,onResetErrorStatus:st},null,8,["show","detailDefect","ownership","view-only","error-status","cameras-image"])],64)}}}),ti=$t(ei,[["__scopeId","data-v-dd4a11d5"]]),ai={class:"ps-2 justify-content-start"},si={class:"p-2 row justify-content-between"},li={class:"col-7 form-check checkbox-success"},oi=["disabled","id"],ri=["for"],ni={class:"col-5 text-end"},ii=Ue({__name:"CheckBoxItem",props:{item:{required:!0,type:Object},index:{type:Number},isAggrementChecked:{type:Boolean,default:!1}},setup(r){const s=r,e=De(s,"item"),l=Zt(),a=i(()=>{const d=e.value.value=="true";return!s.isAggrementChecked||d}),o=i({get:()=>s.item.value,set:d=>{e.value.value=`${d}`,v()}}),v=async()=>{const d=Ye.service({lock:!0,text:"Updating",background:"rgba(0, 0, 0, 0.7)"}),p={keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:e.value.value},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};await l.postCheckBeforeTruckItem(p,e.value.key),d.close()},y=i(()=>{var p;let d="";return t.isUndefined(s.item.updatedDate)||(d=`${(p=s.item.updatedBy)==null?void 0:p.name}, ${s.item.updatedDate}`),d});return(d,p)=>(c(),$("div",ai,[n("div",si,[n("div",li,[Wt(n("input",{class:"form-check-input",type:"checkbox",disabled:a.value,"onUpdate:modelValue":p[0]||(p[0]=u=>o.value=u),id:r.item.caption},null,8,oi),[[pa,o.value]]),n("label",{class:"form-check-label subtitle",for:r.item.caption},Ie(r.item.caption),9,ri)]),n("div",ni,Ie(y.value),1)])]))}}),ui=$t(ii,[["__scopeId","data-v-7ec88bf2"]]),di={key:0,class:"mt-5 ps-0"},ci="WASH AND CHECKS BEFORE MACHINE ENTERS THE WORKSHOP:",mi="WASH AND CHECK BEFORE MACHINE ENTERS THE WORKSHOP OR SHUTDOWN AREA:",fi="WASH AND CHECK BEFORE MACHINE ENTERS THE SHUTDOWN AREA:",yi=Ue({__name:"CardCheckBeforeTruck",props:{data:{required:!0,type:Object},isAggrementChecked:{type:Boolean,default:!1}},setup(r){const s=r,e=vt(),l=k(""),a=i(()=>e.generalForm.checkBeforeTruck.items),o=i(()=>{let v="";return t.isUndefined(s.data.taskGroupName)?(v=Es(e.generalForm.modelId)?mi:"",v||(v=Ls(e.generalForm.modelId)?fi:ci),v):s.data.taskGroupName});return(v,y)=>{const d=ne("el-collapse-item"),p=ne("el-collapse");return a.value.length>0?(c(),$("div",di,[j(p,{modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=u=>l.value=u),class:"task-group general-accordion py-1 px-5 mb-3"},{default:le(()=>[j(d,{title:o.value,name:o.value},{default:le(()=>[(c(!0),$(Ve,null,nt(a.value,(u,g)=>(c(),Z(ui,{key:u.label,item:u,index:g,"is-aggrement-checked":r.isAggrementChecked},null,8,["item","index","is-aggrement-checked"]))),128))]),_:1},8,["title","name"])]),_:1},8,["modelValue"])])):D("",!0)}}}),vi=$t(yi,[["__scopeId","data-v-5d3d1e4c"]]),Sa=r=>(zt("data-v-2ed92361"),r=r(),Xt(),r),pi=Sa(()=>n("span",{class:"el-dialog__title",style:{"word-break":"break-word !important","font-size":"18px !important"}},"Detailed picture of Pre-Task Risk Assessment Form",-1)),bi={class:"row d-flex flex-column"},gi={key:0,class:"photo-wrapper"},ki=Sa(()=>n("span",{class:"sub-title"},[n("strong",null,"Front Page")],-1)),hi={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center"}},Si={class:"d-flex justify-content-center"},Ci={style:{position:"relative",width:"fit-content"}},wi=["src"],Ui={class:"timestampp"},_i=Sa(()=>n("div",{class:"my-2"},null,-1)),Ii={key:1,class:"photo-wrapper"},$i=Sa(()=>n("span",{class:"sub-title"},[n("strong",null,"Back Page")],-1)),Ti={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center",position:"relative"}},Ri={class:"d-flex justify-content-center"},Pi={style:{position:"relative",width:"fit-content"}},Bi=["src"],Vi={class:"timestampp"},Ni=Ue({__name:"ImagePreviewPrerisk",props:{visibility:{type:Boolean,required:!1},images:{type:Array,required:!0},viewOnly:{type:Boolean,default:!0}},emits:["onClose","onDelete"],setup(r,{expose:s,emit:e}){const l=r,a=e,o=k([]),v=De(l,"visibility"),y=k(0),d=k(!1),p=k(!1),u=sl("(min-width: 1000px)"),g=k(!1),h=k(""),w=k(!1),U=k(),m=k(),b=k(),f=k([]),F=i(()=>u.value?"70%":"90%"),J=async()=>{m.value=l.images.find(Q=>Q.imageType=="front"),m.value||(m.value=l.images.find(Q=>!Q.imageType)),m.value&&await P(typeof m.value.image=="string"?m.value.image:m.value.image.filename)},_=async()=>{b.value=l.images.find(Q=>Q.imageType=="back"),!b.value&&l.images.length>0&&(b.value=l.images.find(Q=>{var N;return Q.image.filename!=((N=m.value)==null?void 0:N.image).filename})),b.value&&await I(typeof b.value.image=="string"?b.value.image:b.value.image.filename)},O=Q=>`${Q.updatedBy.name}, ${Q.updatedDate}`,V=Q=>{var Y;if(o.value.length<1)return;let N;do N=(Y=o.value.find(te=>te.key==Q))==null?void 0:Y.value;while(!N);return N},K=()=>{v.value=!1,a("onClose",null)},q=()=>{if(!l.images)return;const Q=l.images.map(N=>N.image);f.value=lt(Q).map(N=>({imgBlob:N.filename,url:"",description:N.description}))},A=()=>{q(),y.value=0,o.value=[],l.images&&(J(),_())},P=async Q=>{d.value=!0,await x(Q),d.value=!1},I=async Q=>{p.value=!0,await x(Q),p.value=!1},x=async Q=>{const N={fileUrl:Q,ver:"v1"};try{const Y=`https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/attachment/download_by_url?${new URLSearchParams(N).toString()}`,te=await Ht.getBlob(Y),ie=new Blob([te.data]);let ae=window.URL||window.webkitURL;o.value.push({key:Q,value:ae.createObjectURL(ie)}),f.value.forEach(Ne=>{Ne.imgBlob==Q&&(Ne.url=ae.createObjectURL(ie))})}catch(Y){console.log("image",Y)}},T=Q=>{const N=f.value.findIndex(te=>te.imgBlob==Q),Y=f.value[N];if(N>0){const te=f.value.slice(N),ie=f.value.slice(0,N);f.value=[...te,...ie]}h.value=Y.url,g.value=!0},L=()=>{h.value="",g.value=!1},z=Q=>{w.value=!0,U.value=Q},ue=()=>{w.value=!1},be=()=>{U.value&&(a("onDelete",typeof U.value.image=="string"?U.value.image:U.value.image.filename),U.value.imageType=="front"?m.value=void 0:b.value=void 0,U.value=void 0,w.value=!1)};return s({openFirstReRender:()=>{A()}}),(Q,N)=>{const Y=ne("el-skeleton-item"),te=ne("NwImg"),ie=ne("el-skeleton"),ae=ne("el-dialog");return c(),$(Ve,null,[j(ae,{modelValue:v.value,"onUpdate:modelValue":N[4]||(N[4]=Ne=>v.value=Ne),title:"Detailed picture of Pre-Task Risk Assessment Form",width:F.value,onOpened:A,onClose:K},{title:le(()=>[pi]),default:le(()=>[n("div",bi,[m.value?(c(),$("div",gi,[ki,j(ie,{loading:d.value,animated:""},{template:le(()=>[j(Y,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:le(()=>[n("div",hi,[n("div",Si,[n("div",Ci,[r.viewOnly?D("",!0):(c(),Z(te,{key:0,onClick:N[0]||(N[0]=Ne=>z(m.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),V(m.value.image.filename)!=null?(c(),$("img",{key:1,src:V(m.value.image.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",onClick:N[1]||(N[1]=Ne=>T(m.value.image.filename)),class:"front"},null,8,wi)):D("",!0)])]),n("div",Ui,Ie(O(m.value)),1)])]),_:1},8,["loading"])])):D("",!0),_i,b.value?(c(),$("div",Ii,[$i,j(ie,{loading:p.value,animated:""},{template:le(()=>[j(Y,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:le(()=>[n("div",Ti,[n("div",Ri,[n("div",Pi,[r.viewOnly?D("",!0):(c(),Z(te,{key:0,onClick:N[2]||(N[2]=Ne=>z(b.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),V(b.value.image.filename)!=null?(c(),$("img",{key:1,src:V(b.value.image.filename),style:{height:"auto","max-width":"700px","max-height":"300px"},alt:"images",class:"back",onClick:N[3]||(N[3]=Ne=>T(b.value.image.filename))},null,8,Bi)):D("",!0)])]),n("div",Vi,Ie(O(b.value)),1)])]),_:1},8,["loading"])])):D("",!0)])]),_:1},8,["modelValue","width"]),j(Jt,{visibility:w.value,caption:"Are you sure want to delete this image?",onOnNoConfirm:ue,onOnYesConfirm:be},null,8,["visibility"]),j(al,{images:f.value,visibility:g.value,image:h.value,onHandleClose:L},null,8,["images","visibility","image"])],64)}}}),xi=$t(Ni,[["__scopeId","data-v-2ed92361"]]),Di=r=>(zt("data-v-ebd97062"),r=r(),Xt(),r),Ai={class:"mt-5 px-0"},Fi={class:"row vcp mx-0 py-4 d-flex justify-content-between me-3 risk-assessment-title"},Oi=Di(()=>n("div",{class:"col title ps-6"},[yt("Take photo of completed Pre-Task Risk Assessment Form "),n("span",{class:"text-danger"},"(required)"),yt(".")],-1)),Ei={class:"col-2 col-md-1"},Li={class:"row justify-content-center"},ji={class:"px-0 col-6"},Mi=["disabled"],Hi=["src"],Ki={key:0,class:"col-6 ps-0 pe-1"},Gi={class:"text-white"},qi=Ue({__name:"CardRiskAssessment",props:{ready:{required:!0,type:Boolean}},emits:["onFrontPageTaken"],setup(r,{expose:s,emit:e}){const l=e,a=_t(),o=Zt(),v=vt(),y=k([]),d=k(0),p=k(),u=i(()=>v.employee);ke(u,async I=>{d.value=0,o.IsFitterLoggedInExist?o.FitterInfo.employee.id==I.id?V.value=lt(o.FitterInfo.riskPhotos).slice(0,2):V.value=[]:V.value=[]},{deep:!0});const g=k(0),h=k(!1),w=k(!1),U=()=>{h.value=!0},m=i(()=>{const I=v.employee,x=(I==null?void 0:I.id)!="";K();const T=y.value.length>1;return x&&T}),b=()=>{let I="/media/svg/dma/camera/e-form/png/cam-active.png";return m.value?I="/media/svg/dma/camera/e-form/png/cam-read.png":(y.value.length>0||o.IsSelectedFitterAlreadyLoggedIn)&&(I="/media/svg/dma/camera/e-form/png/cam-user.png"),I},f=i(()=>{let I=[];return v.employee.id?(K(),y.value):I}),F=i(()=>Ba.cloneDeep(a.ImageObjects.find(I=>I.Id==="pre-risk"))),J=i(()=>{var I;return(I=F.value)==null?void 0:I.ImageInfos.length}),_=i(()=>v.generalForm.riskAssesment[0].key);ke(J,()=>{g.value+=1});const O=()=>{h.value=!1};ke(F,async(I,x)=>{var T;d.value=0,!Ba.isUndefined(I)&&I.ImageInfos.length>0&&(o.addPropertyParam(_.value,"value",JSON.stringify((T=F.value)==null?void 0:T.ImageInfos)),I.ImageInfos.length!=(x==null?void 0:x.ImageInfos.length)&&await q())},{deep:!0});const V=k([]),K=()=>{if(d.value>0)return;let I=[];if(!Array.isArray(o.generalForm.riskAssesment[0].value))return I;const x=v.employee;I=xa(o.generalForm.riskAssesment[0].value).filter(z=>{const ue=z;if(ue.updatedBy.id==x.id)return ue}),I=I.filter((z,ue,be)=>ue===be.findIndex(Ee=>Ee.image.filename===z.image.filename&&Ee.imageType===z.imageType)),I.filter(z=>!z.imageType).length>0?I=t.orderBy(I,z=>z.updatedDate):I=t.orderBy(I,z=>z.imageType,["desc"]),y.value=I.slice(0,2),y.value.forEach(z=>{typeof z.image=="string"&&(z.image={filename:z.image,description:z.image.includes("^")?z.image.split("^")[1]:""})}),d.value=1},q=async()=>{o.toggleChangeIsRiskAssesmentPhotoTaken(!0);const I=await o.getServerTimestamp(),x=v.employee;let T={};F.value&&(T=lt(F.value.ImageInfos)[0]);const L=o.generalForm.riskAssesment[0].value;let z=[];if(Array.isArray(L)){let Q=xa(L);[...new Set(Q.map(Y=>Y.updatedBy.id))].forEach(Y=>{let te=Q.filter(ae=>ae.updatedBy.id==Y),ie=te.filter(ae=>ae.imageType).slice(0,2);ie.length<2&&(ie=t.orderBy(te,ae=>ae.updatedDate).slice(0,1),ie[0].imageType=ie[0].imageType==""?"front":ie[0].imageType),z=[...z,...ie]})}let ue=z.filter(Q=>Q.updatedBy.id==x.id).slice(0,1),be="front";ue.length>0&&(be=ue[0].imageType=="front"?"back":be);const Ee={image:T,imageType:be,updatedDate:I,updatedBy:x};z.push(Ee),ue=z.filter(Q=>Q.updatedBy.id==x.id),ue.length<2?l("onFrontPageTaken"):(w.value=!0,setTimeout(()=>{var Q;w.value=!1,(Q=p.value)==null||Q.openFirstReRender()},2e3)),a.setCurrent("pre-risk"),a.clearCurrent(),await v.updateRiskAssesment(z),o.setFitterInfoRiskPhotos(T),ue.length>=1&&o.setGeneralFitterInfoToIndexedDB(!0)},A=async I=>{let x=o.generalForm.riskAssesment[0].value;x=x.filter(T=>typeof T.image=="string"?T.image!=I:T.image.filename!=I),await v.updateRiskAssesment(x),P()},P=()=>{a.setShowCloseButton(!1),a.toggleIsVisible(!0,"pre-risk")};return s({triggerCamera:P}),(I,x)=>(c(),$(Ve,null,[n("div",Ai,[n("div",Fi,[Oi,n("div",Ei,[n("div",Li,[n("div",ji,[n("button",{class:"btn btn-sm btn-icon btn-bg-light",disabled:m.value,style:{cursor:"default"}},[n("img",{src:b(),style:{height:"12px",width:"14px"},alt:"photo"},null,8,Hi)],8,Mi)]),f.value&&f.value.length>0?(c(),$("div",Ki,[n("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:U,style:{"background-color":"#18AF4A"}},[n("label",Gi,"+"+Ie(f.value.length),1)])])):D("",!0)])])])]),h.value?(c(),Z(xi,{key:0,ref_key:"preview",ref:p,images:y.value,visibility:h.value,"view-only":!1,onOnClose:O,onOnDelete:A},null,8,["images","visibility"])):D("",!0),j(ll,{visibility:w.value,caption:"Pre-Task Risk Assessment Photo Sucessfully Taken"},null,8,["visibility"])],64))}}),Yi=$t(qi,[["__scopeId","data-v-ebd97062"]]),ss=r=>(zt("data-v-fa5b6abd"),r=r(),Xt(),r),Ji=ss(()=>n("span",{class:"el-dialog__title"},"Not Applicable",-1)),Wi=["innerHTML"],zi={class:"mt-1 p-2"},Xi={class:"d-flex flex-column"},Zi=ss(()=>n("label",null,"Why could you not complete the required service item?",-1)),Qi={key:0,class:"px-1 text-danger"},eu={key:0,class:"mt-1 p-2"},tu={class:"my-5 w-100"},au=["disabled"],su=Ue({__name:"NAForm",props:{visibility:{required:!0,type:Boolean}},setup(r){const s=r,e=Ta(),l=Dt(),a=vt(),o=ol(),v=Vt(),y=_t(),d=De(s,"visibility"),p=k(!1),u=k(!1),g=k(!1),h=k(!0),w=k(!1),U=k(""),m=k(""),b=k(!1),f=k(!0),F=k(!1),J=k(null),_=i(()=>a.taskUpdated),O=i(()=>a.formAlreadySubmitted),V=i(()=>js(e.stateTask)),K=i(()=>v.stateSubmitConnectionError);ke(O,Q=>{Q&&(e.toggleIsVisible(!1),a.resetTaskUpdated(),p.value=!1,h.value=!1,w.value=!1,w.value=!1,e.setCancelledState(!0))}),ke(K,Q=>{Q==!0&&(u.value=!0)});const q=i(()=>a.taskAlreadyUpdated);ke(q,Q=>{Q&&(e.toggleIsVisible(!1),a.resetTaskUpdated(),p.value=!1,h.value=!1,w.value=!1,w.value=!1,e.setCancelledState(!0))}),ke(_,Q=>{e.Visible==!0&&(Q===!1&&(w.value=!0),Q===!0&&(a.stateItemKey||(p.value=!0)))});const A=()=>{console.log(e.stateItem),U.value&&(F.value=!1),b.value=U.value.includes("Other"),b.value?(m.value="",f.value=!0):f.value=!1,e.setReason(U.value)},P=Q=>{m.value=Q.value,f.value=m.value===""},I=async()=>{let Q={},N={},Y={};e.stateItem.categoryItemType=="resultStatus"&&(N={keyValue:e.stateTask.key,propertyParams:[{propertyName:"taskNormalValue",propertyValue:e.stateTask.category==="NORMAL"||e.stateTask.category==="CBM"?"3":"4"}]},e.stateTask.items.forEach(ae=>{ae.categoryItemType=="resultRating"&&(Q={keyValue:ae.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]}),ae.itemType=="smallCamera"&&(Y={keyValue:ae.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]})}));const te=[{keyValue:e.ItemKey,propertyParams:[{propertyName:"value",propertyValue:e.stateTask.category==="NORMAL"||e.stateTask.category==="CBM"?"3":"4"}]}];e.stateItem.categoryItemType=="resultStatus"&&(te.push(Q),te.push(N),te.push(Y),y.clearImageById(Y.keyValue)),a.setStateItemKey(""),await a.updateServiceSheetTaskValue(te,l.user.EmployeeId,l.user.Name),a.stateStoredDisableKeyValue.filter(ae=>ae.key==e.ItemKey).length<1?a.pushStoredDisabledItems({key:e.ItemKey,value:e.stateTask.category==="NORMAL"||e.stateTask.category==="CBM"?"3":"4"}):a.updateAllItems(e.ItemKey,e.stateTask.category==="NORMAL"||e.stateTask.category==="CBM"?"3":"4")},x=()=>{U.value?g.value=!0:F.value=!0},T=async()=>{v.setSubmitConnectionError(!1),g.value=!1,e.Reason.includes("Other")&&e.setReason(`${e.Reason}:${m.value}`);const Q=Ye.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});await e.createNA()?await I():a.taskErrorDialog&&z(),Q.close()},L=()=>{g.value=!1},z=()=>{e.toggleIsVisible(!1),a.resetTaskUpdated(),p.value=!1,h.value=!1,w.value=!1},ue=()=>{u.value=!1,w.value=!1},be=async()=>{h.value===!0?(e.setCancelledState(!0),e.setSuccesItem("")):e.setSuccesItem(e.stateItemKey),U.value="",m.value="",b.value=!1,F.value=!1,p.value=!1,u.value=!1,e.resetInstance()},Ee=()=>{h.value=!0,Ms(J.value)};return(Q,N)=>{const Y=ne("el-option"),te=ne("el-select"),ie=ne("el-dialog");return c(),Z(ie,{modelValue:d.value,"onUpdate:modelValue":N[1]||(N[1]=ae=>d.value=ae),width:"90%",center:"","lock-scroll":!1,onClosed:be,onOpened:Ee,"custom-class":"el-defect-crack-form-custom","destroy-on-close":!0},{title:le(()=>[Ji,n("span",{class:"el-dialog__title task-title",innerHTML:W(Us)(V.value),ref_key:"defectDetailRef",ref:J},null,8,Wi)]),default:le(()=>[n("div",null,[n("div",zi,[n("div",Xi,[Zi,j(te,{modelValue:U.value,"onUpdate:modelValue":N[0]||(N[0]=ae=>U.value=ae),filterable:"",onChange:A,class:"w-100"},{default:le(()=>[(c(!0),$(Ve,null,nt(W(o).NAConditions,ae=>(c(),Z(Y,{key:ae.id,label:ae.naCondition,value:ae.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),F.value?(c(),$("label",Qi,"Required")):D("",!0)])]),b.value?(c(),$("div",eu,[j(nl,{value:m.value,label:"Description",name:"Description",onHandleChange:P},null,8,["value"])])):D("",!0),n("div",tu,[n("button",{class:"btn btn-success w-100",onClick:x,disabled:f.value,style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},"Submit",8,au)])]),j(Jt,{visibility:g.value,caption:"Please confirm this is the reason you could not do the service item.",onOnNoConfirm:L,onOnYesConfirm:T},null,8,["visibility"]),j(rl,{show:p.value,onClose:z},null,8,["show"]),j(Fa,{show:u.value,onClose:ue,"title-pop-up":"No internet connection"},null,8,["show"])]),_:1},8,["modelValue"])}}}),lu=$t(su,[["__scopeId","data-v-fa5b6abd"]]),ou={class:"row justify-content-end"},ru={class:"col-3 col-sm-2 col-xl-1"},nu={class:"row justify-content-end"},iu=["disabled"],uu=Ue({__name:"SubmitButton",props:{disabled:{default:!1}},emits:["submit"],setup(r,{emit:s}){const e=vt(),l=s,a=i(()=>e.isAllTaskDone),o=i(()=>a.value&&e.generalForm.status!="Submited"?"Submit":"Next"),v=async()=>{const y=Ye.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),d=await e.setShowNextPage(o.value);d&&l("submit",d),y.close()};return(y,d)=>(c(),$("div",ou,[n("div",ru,[n("div",nu,[n("button",{disabled:r.disabled,type:"button",class:"btn btn-success",onClick:v,style:{"background-color":"#18AF4A"}},"Submit",8,iu)])])]))}}),du=n("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[n("h3",null,"Rating for this task has not been mapped yet, please insert mapping on IronLake first")],-1),cu={class:"row text-center pt-5"},mu=Ue({__name:"NotMapped",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(r,{emit:s}){const e=r,l=s,a=Te(()=>e.show),o=()=>{l("close")};return(v,y)=>{const d=ne("el-button"),p=ne("el-dialog");return c(),Z(p,{modelValue:W(a),"onUpdate:modelValue":y[0]||(y[0]=u=>Et(a)?a.value=u:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:le(()=>[du,n("div",cu,[j(d,{type:"success",class:"ok-button",onClick:o},{default:le(()=>[yt("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),fu=n("div",{class:"row text-center pt-3 pb-3 text-dark modal-title text-break"},[n("h3",null,"Cannot Access this form With Different Supervisor")],-1),yu={class:"row text-center pt-5"},vu=Ue({__name:"FormAlreadyOpenedByOtherSupervisor",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(r,{emit:s}){const e=r,l=s,a=Te(()=>e.show),o=()=>{l("close")};return(v,y)=>{const d=ne("el-button"),p=ne("el-dialog");return c(),Z(p,{modelValue:W(a),"onUpdate:modelValue":y[0]||(y[0]=u=>Et(a)?a.value=u:null),width:"40%","show-close":!1,"custom-class":"oil-not-in-range__header",top:"30vh",center:!0},{default:le(()=>[fu,n("div",yu,[j(d,{type:"success",class:"ok-button",onClick:o},{default:le(()=>[yt("Ok")]),_:1})])]),_:1},8,["modelValue"])}}}),pu=["src"],ls=Ue({__name:"Image",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const s=r,e=k("/media/svg/dma/warning.svg"),l=k(!0),a=De(s,"item"),o=Te(()=>!t.isUndefined(a.value.style)&&a.value.style.breakPoint!="none"?`col-${a.value.style.breakPoint}`:"col"),v=Te(()=>{let u="";return s.generalStyle&&!t.isUndefined(a.value.style)&&(!t.isUndefined(a.value.style.potraitBreakPoint)&&a.value.style.breakPoint!="none"?(u=`col-md-${a.value.style.potraitBreakPoint}`,u=`${u} col-lg-${a.value.style.breakPoint}`):(u=`col-md-${a.value.style.potraitBreakPoint}`,u=`${u} col-lg-${a.value.style.breakPoint}`)),u}),y=Te(()=>{var _,O,V,K;const u=!t.isUndefined(a.value.style)&&a.value.style.bgColor!="none"?`background-color: ${a.value.style.bgColor}; `:"",g=!t.isUndefined(a.value.style)&&a.value.style.fontColor!="none"?`color: ${a.value.style.fontColor}; `:"",h=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.top!="none"?`border-top: ${a.value.style.border.top}; `:"",w=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.right!="none"?`border-right: ${a.value.style.border.right}; `:"";let U=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((_=s.task)==null?void 0:_.isShowAdjustmentRow)&&((O=s.task)!=null&&O.isShowAdjustmentRow))U="";else{let q=0;(V=s.task)==null||V.items.forEach(A=>{var P;t.isUndefined(A.style)||(t.isUndefined(A.style.border)?t.isUndefined(A.style.border)&&(q=q+Number(A.style.breakPoint)):((A.style.border.right=="none"||t.isUndefined(A.style.border.right))&&(q=q+Number(A.style.breakPoint)),t.isEqual(A,t.last((P=s.task)==null?void 0:P.items))&&(q=q+Number(A.style.breakPoint))))}),q==12&&(U=!((K=s.task.updatedBy)!=null&&K.name)&&!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const m=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.left!="none"?`border-left: ${a.value.style.border.left}; `:"",b=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${a.value.style.borderRadius.topRight}; `:"",f=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${a.value.style.borderRadius.bottomRight}; `:"",F=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${a.value.style.borderRadius.topLeft}; `:"",J=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${a.value.style.borderRadius.bottomLeft}; `:"";return`${u}${g}${h}${w}${U}${m}${b}${f}${F}${J}`}),d=Te(()=>!t.isUndefined(a.value.style)&&a.value.style.breakPoint=="1"?"width: 20px; height: 20px":"");Ia(async()=>{const u={id:a.value.value.toString(),ver:"v1"};try{const w=(await Ht.getBlob("https://digital-bumaau-dev-apm-001.azure-api.net/utility/api/master_attachment/download_by_id","",new URLSearchParams(u).toString())).data,U=new Blob([w]),m=window.URL||window.webkitURL;e.value=m.createObjectURL(U),l.value=!1}catch{l.value=!1}});const p=Te(()=>{let u="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(u=""),u});return(u,g)=>{const h=Aa("loading");return Wt((c(),$("div",{class:we([[W(o),W(v),W(p)],"pt-2 px-2 d-flex d-flex justify-content-center"]),style:ce(W(y))},[n("img",{src:e.value,class:"img-fluid",style:ce(W(d))},null,12,pu)],6)),[[h,l.value]])}}}),bu=["innerHTML"],os=Ue({__name:"Label",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const s=r,e=De(s,"item"),l=i(()=>ba(s.item.value)),a=i(()=>{var u,g;return((u=s.task)==null?void 0:u.taskType)==="table"||((g=s.task)==null?void 0:g.taskType)==="collapsibleTable"?"col":s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""}),o=i(()=>{var g,h;if(((g=s.task)==null?void 0:g.taskType)==="table"||((h=s.task)==null?void 0:h.taskType)==="collapsibleTable")return"col";let u="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(u=`col-md-${e.value.style.potraitBreakPoint}`,u=`${u} col-lg-${e.value.style.breakPoint}`):(u=`col-md-${e.value.style.potraitBreakPoint}`,u=`${u} col-lg-${e.value.style.breakPoint}`)),u}),v=i(()=>t.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),y=i(()=>{var _,O,V,K;const u=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",g=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",h=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",w=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let U=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((_=s.task)==null?void 0:_.isShowAdjustmentRow)&&((O=s.task)!=null&&O.isShowAdjustmentRow))U="";else{let q=0;(V=s.task)==null||V.items.forEach(A=>{var P;t.isUndefined(A.style)||(t.isUndefined(A.style.border)?t.isUndefined(A.style.border)&&(q=q+Number(A.style.breakPoint)):((A.style.border.right=="none"||t.isUndefined(A.style.border.right))&&(q=q+Number(A.style.breakPoint)),t.isEqual(A,t.last((P=s.task)==null?void 0:P.items))&&(q=q+Number(A.style.breakPoint))))}),q==12&&(U=!((K=s.task.updatedBy)!=null&&K.name)&&!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const m=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",b=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",f=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",F=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",J=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${u}${g}${h}${w}${U}${m}${b}${f}${F}${J}`}),d=i(()=>`${!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.fontWeight)&&e.value.style.fontWeight!="normal"?`font-weight: ${e.value.style.fontWeight}; `:""}`),p=i(()=>{let u="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(u=""),u});return(u,g)=>(c(),$("div",{class:we([[a.value,v.value,o.value,p.value],"px-2 pt-2"]),style:ce(y.value)},[!W(t.isUndefined)(r.item.style)&&r.item.style.visibility!="hidden"?(c(),$("label",{key:0,style:ce(d.value),innerHTML:l.value},null,12,bu)):D("",!0)],6))}}),ra=r=>(zt("data-v-28a14333"),r=r(),Xt(),r),gu={class:"px-0 mx-0 d-flex"},ku=["innerHTML"],hu=["innerHTML"],Su={key:0,class:"ms-2"},Cu=ra(()=>n("img",{src:ga,alt:"na",class:"d-icon"},null,-1)),wu=[Cu],Uu=ra(()=>n("img",{src:oa,alt:"defect",class:"d-icon"},null,-1)),_u=[Uu],Iu=ra(()=>n("img",{src:oa,alt:"defect",class:"d-icon"},null,-1)),$u=[Iu],Tu=ra(()=>n("img",{src:ga,alt:"na",class:"d-icon"},null,-1)),Ru=[Tu],Pu={key:0,class:"ms-1 d-flex align-items-center"},Bu=ra(()=>n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Updating...")],-1)),Vu=ra(()=>n("span",null,"Updating...",-1)),Nu=[Bu,Vu],xu=Ue({__name:"Dropdown",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},emits:["setLoading"],setup(r,{emit:s}){const e=r,l=s,a=De(e,"item"),o=De(e,"task"),v=Dt(),y=bt(),d=Ra(),p=fl(),u=yl(),g=Vt(),h=k(!1),w=k(!1),U=k(""),m=k(""),b=k(!1),f=_t(),F=k([]),J=E=>{F.value=E},_=()=>{F.value.length<1?B():ct(),F.value=[]},O=i(()=>w),V=i(()=>d.Cancelled),K=i(()=>p.Cancelled),q=i(()=>u.Cancelled),A=k(!1),P=k(!1),I=k(!1),x=()=>{var E;(E=e.task)==null||E.items.forEach(oe=>{oe.itemType==="smallCamera"&&(f.toggleIsVisible(!0,oe.key),f.setShowCloseButton(!1),f.setShowCloseButton(!1))}),I.value=!1},T=i(()=>{let E="Choose One";return!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.placeholder)&&(E=a.value.style.placeholder),E});ke(V,E=>{var oe,ge,Pe;if(l("setLoading",!1),E===!0){if(((oe=a.value)==null?void 0:oe.categoryItemType)=="resultRating")return;const Oe=localStorage.getItem("taskKey");console.log((ge=o.value)==null?void 0:ge.key),Oe===((Pe=o.value)==null?void 0:Pe.key)&&(a.value.value=U.value,w.value=!w.value,d.setCancelledState(!1),b.value=!1)}}),ke(K,E=>{var oe,ge;if(l("setLoading",!1),E===!0){if(((oe=a.value)==null?void 0:oe.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((ge=o.value)==null?void 0:ge.key)&&(a.value.value=U.value,w.value=!w.value,p.setCancelledState(!1),b.value=!1)}}),ke(q,E=>{var oe,ge;if(l("setLoading",!1),E===!0){if(((oe=a.value)==null?void 0:oe.categoryItemType)=="resultRating")return;localStorage.getItem("taskKey")===((ge=o.value)==null?void 0:ge.key)&&(a.value.value=U.value,w.value=!w.value,u.setCancelledState(!1),b.value=!1)}});const L=i(()=>e.generalStyle?!t.isUndefined(a.value.style)&&a.value.style.breakPoint!="none"?`col-${a.value.style.breakPoint}`:"col":""),z=i(()=>{let E="";return e.generalStyle&&!t.isUndefined(a.value.style)&&(!t.isUndefined(a.value.style.potraitBreakPoint)&&a.value.style.breakPoint!="none"?(E=`col-md-${a.value.style.potraitBreakPoint}`,E=`${E} col-lg-${a.value.style.breakPoint}`):(E=`col-md-${a.value.style.potraitBreakPoint}`,E=`${E} col-lg-${a.value.style.breakPoint}`)),E}),ue=i(()=>{var E;return N.value?(E=ae.value.find(oe=>oe.value==String(N.value)))==null?void 0:E.label:N.value}),be=i(()=>{var ge,Pe;const E=a.value.value.toString().replaceAll("'","");let oe;return E=="1"?oe="green":E=="2"||E=="3"&&((ge=o.value)==null?void 0:ge.category)=="CRACK"?oe="red":E=="3"&&(((Pe=o.value)==null?void 0:Pe.category)=="NORMAL"||a.value.categoryItemType=="resultStatus")||E=="4"?oe="yellow":E=="A"?oe="a":E=="B"?oe="b":E=="C"?oe="c":E=="X"&&(oe="x"),oe}),Ee=E=>{Q(E,!0)},Q=async(E,oe,ge=!1)=>{var Pe,Oe,We,C,H,fe,Se,ve,_e,je,Ae,He,Ke;if(t.isUndefined((Oe=(Pe=e.task)==null?void 0:Pe.updatedBy)==null?void 0:Oe.id)||l("setLoading",!0),y.setStateItemKey(a.value.key),e.item.categoryItemType=="dropdownTool")if(g.stateConnectionStatus)b.value=!0,U.value=N.value,a.value.value=E,await y.updateToolUom(e.task,a.value),b.value=!1;else{g.setSubmitConnectionError(!0),a.value.value=U.value,localStorage.removeItem("taskKey");return}else{if(N.value===E||E===((We=e.task)==null?void 0:We.taskValue)&&!(V.value||K.value||q.value))return;if(ie(),V.value||K.value||q.value){U.value="",localStorage.removeItem("taskKey");return}else if(g.stateConnectionStatus){if(l("setLoading",!0),b.value=!0,localStorage.setItem("taskKey",(C=o.value)==null?void 0:C.key),U.value=N.value,m.value=(H=o.value)==null?void 0:H.key,a.value.value=E,E==="2"&&((fe=e.task)==null?void 0:fe.category)==="NORMAL")d.setTask(e.task),d.setItemKey(a.value.key),h.value=!0,d.setItem(a.value);else if(E==="3"&&((Se=e.task)==null?void 0:Se.category)==="CRACK")p.setTask(e.task),p.setItemKey(a.value.key),p.cretateInstance(!0),await p.getPreviousCrack(y.generalForm.workOrder,y.generalForm.modelId,y.generalForm.psTypeId,e.task.key),p.toggleYesVisible(!0);else if(E==="2"&&((ve=e.task)==null?void 0:ve.category)==="CRACK")p.setTask(e.task),p.setItemKey(a.value.key),p.cretateInstance(!1),await p.getPreviousCrack(y.generalForm.workOrder,y.generalForm.modelId,y.generalForm.psTypeId,e.task.key),p.toggleNoVisible(!0);else if(E==="3"&&((_e=e.task)==null?void 0:_e.category)==="NORMAL"||E=="3"&&a.value.categoryItemType=="resultStatus"||E==="4"&&((je=e.task)==null?void 0:je.category)==="CRACK")u.setTask(e.task),u.setItemKey(a.value.key),u.toggleIsVisible(!0),u.setItem(a.value);else if(E=="C"||E=="X"){const rt=e.task.items.find(gt=>gt.itemType==="smallCamera");rt&&y.setMeasurementValueAndUOM("","",rt.key),await y.updateDefect(e.task,E,a.value)&&(E=="C"||E=="X")&&oe&&(y.setInputCameraMandatoryKey(a.value.key),I.value=!0)}else{U.value&&(((Ae=e.task)==null?void 0:Ae.category)==="CBM"||((He=e.task)==null?void 0:He.category)==="NORMAL")&&await y.deleteDefect(e.task);const rt={keyValue:(Ke=o.value)==null?void 0:Ke.key,propertyParams:[{propertyName:"taskValue",propertyValue:a.value.value.toString()??"1"},{propertyName:"updatedBy",propertyValue:E===""?"":JSON.stringify(y.employee)},{propertyName:"updatedDate",propertyValue:E===""?"":"<<ServerDateTime>>"}]};let Ct={},gt={};a.value.categoryItemType=="resultRating"&&((e.task.taskValue=="3"||e.task.taskValue=="4")&&await y.deleteDefect(e.task),gt={keyValue:e.task.key,propertyParams:[{propertyName:"taskNormalValue",propertyValue:""}]},e.task.items.forEach(R=>{R.categoryItemType=="resultStatus"&&(Ct={keyValue:R.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]})}));const et=[{keyValue:a.value.key,propertyParams:[{propertyName:"value",propertyValue:E},{propertyName:"updatedBy",propertyValue:E===""?"":JSON.stringify(y.employee)},{propertyName:"updatedDate",propertyValue:E===""?"":"<<ServerDateTime>>"}]}];!t.isUndefined(a.value.isTaskValue)&&a.value.isTaskValue&&et.push(rt),a.value.categoryItemType=="resultRating"&&(et.push(Ct),et.push(gt)),await y.updateServiceSheetTaskValue(et,v.user.EmployeeId,v.user.Name).then(R=>{var X;y.setStateItemKey(""),R?(((X=e.task)==null?void 0:X.category)==="CBM"&&(E=="A"||E=="B")&&(y.setInputCameraMandatoryKey(a.value.key),!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("cbmTakePhotoAllRating")&&(I.value=!0)),E=="1"&&U.value==""&&(y.setInputCameraMandatoryKey(a.value.key),!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("normalTakePhoto")&&(I.value=!0),!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("cbmTakePhoto")&&(I.value=!0))):a.value.value=U.value})}b.value=!1,l("setLoading",!1)}else{g.setSubmitConnectionError(!0),localStorage.removeItem("taskKey"),a.value.value=U.value;return}}},N=i(()=>e.item.value.toString().replaceAll("'",""));xt(()=>{U.value=a.value.value});const Y=k(!1);ke(N,async(E,oe)=>{var ge;if(!t.isUndefined(a.value.disabledByItemKey)){let Pe=y.stateStoredDisableKeyValue.find(Oe=>Oe.key==a.value.disabledByItemKey);if(t.isUndefined(Pe)){const Oe=await y.getValueFromItemKey(a.value.disabledByItemKey);y.pushStoredDisabledItems({key:a.value.disabledByItemKey,value:Oe})}Pe=y.stateStoredDisableKeyValue.find(Oe=>Oe.key==a.value.disabledByItemKey),(Pe==null?void 0:Pe.value)=="3"?(Y.value=!0,((ge=e.task)==null?void 0:ge.taskType)=="inline"&&a.value.value&&Q("",!1)):Y.value=!1}E=="3"&&y.stateStoredDisableKeyValue.forEach(Pe=>{Pe.key==a.value.disabledByItemKey&&(Pe.value=E)})},{deep:!0});const te=i(()=>e.itemLoading);ke(te,E=>{b.value=E});const ie=()=>{d.toggleYesVisible(!1),d.toggleNoVisible(!1),d.toggleViewNoVisible(!1),d.toggleViewYesVisible(!1),p.toggleYesVisible(!1),p.toggleNoVisible(!1),p.toggleViewNoVisible(!1),p.toggleViewYesVisible(!1),u.toggleIsVisible(!1),u.toggleIsViewVisible(!1)},ae=i(()=>{const E=e.item.caption.replace("[","").replace("]","").split("; "),oe=e.item.itemValue.replace("[","").replace("]","").split(", ");return E.map((Pe,Oe)=>({label:Pe.replaceAll("'",""),value:oe[Oe].replaceAll("'","")}))}),Ne=i(()=>{var ve,_e,je,Ae;const E=!t.isUndefined(a.value.style)&&a.value.style.bgColor!="none"?`background-color: ${a.value.style.bgColor}; `:"",oe=!t.isUndefined(a.value.style)&&a.value.style.fontColor!="none"?`color: ${a.value.style.fontColor}; `:"",ge=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.top!="none"?`border-top: ${a.value.style.border.top}; `:"",Pe=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.right!="none"?`border-right: ${a.value.style.border.right}; `:"";let Oe=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((ve=e.task)==null?void 0:ve.isShowAdjustmentRow)&&((_e=e.task)!=null&&_e.isShowAdjustmentRow))Oe="";else{let He=0;(je=e.task)==null||je.items.forEach(Ke=>{var rt;t.isUndefined(Ke.style)||(t.isUndefined(Ke.style.border)?t.isUndefined(Ke.style.border)&&(He=He+Number(Ke.style.breakPoint)):((Ke.style.border.right=="none"||t.isUndefined(Ke.style.border.right))&&(He=He+Number(Ke.style.breakPoint)),t.isEqual(Ke,t.last((rt=e.task)==null?void 0:rt.items))&&(He=He+Number(Ke.style.breakPoint))))}),He==12&&(Oe=!((Ae=e.task.updatedBy)!=null&&Ae.name)&&!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const We=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.left!="none"?`border-left: ${a.value.style.border.left}; `:"",C=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${a.value.style.borderRadius.topRight}; `:"",H=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${a.value.style.borderRadius.bottomRight}; `:"",fe=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${a.value.style.borderRadius.topLeft}; `:"",Se=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${a.value.style.borderRadius.bottomLeft}; `:"";return`${E}${oe}${ge}${Pe}${Oe}${We}${C}${H}${fe}${Se}`}),Ze=async()=>{var oe,ge;const E=Ye.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await d.getDefectDetail((oe=y.selectedGroup)==null?void 0:oe.id,(ge=o.value)==null?void 0:ge.key),E.close()},Je=async()=>{var oe,ge;const E=Ye.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await p.getCrackDetail((oe=y.selectedGroup)==null?void 0:oe.id,(ge=o.value)==null?void 0:ge.key),E.close()},Qe=async()=>{var oe,ge;const E=Ye.service({lock:!0,text:"Opening Form",background:"rgba(0, 0, 0, 0.7)"});await u.getNADetail((oe=y.selectedGroup)==null?void 0:oe.id,(ge=o.value)==null?void 0:ge.key),E.close()},ct=async()=>{h.value=!1,d.cretateInstance(!0),d.toggleYesVisible(!0)},B=()=>{h.value=!1,d.cretateInstance(!1),d.toggleNoVisible(!0)},G=()=>{F.value=[],h.value=!1,a.value.value=U.value},me=()=>{A.value=!1},Re=()=>{P.value=!1},pe=i(()=>{var ge;let E=!0;!t.isUndefined(o.value.updatedBy)&&!t.isUndefined(o.value.updatedBy.id)&&((ge=o.value)==null?void 0:ge.updatedBy.toString())!=""&&y.employee.id!=o.value.updatedBy.id&&(E=!1);let oe=!1;return(N.value=="2"||N.value=="3"||N.value=="4")&&(oe=!0),!E||oe||Y.value||b.value}),he=E=>ba(E),xe=i(()=>{let E="pb-2";return!t.isUndefined(e.task.updatedBy.name)&&e.task.updatedBy.name&&(E=""),E}),Me=i(()=>u.stateSuccessUpdateItemKey);ke(Me,E=>{E==a.value.key&&!t.isUndefined(a.value.customValidation)&&a.value.customValidation.includes("normalTakePhoto")&&(y.setInputCameraMandatoryKey(a.value.key),I.value=!0)});const ot=i(()=>f.stateIsCameraError);return ke(ot,async E=>{E&&y.stateInputCameraMandatoryKey==a.value.key&&(await Q("",!1,!0),y.setInputCameraMandatoryKey(""))}),(E,oe)=>{var fe,Se,ve,_e,je;const ge=ne("el-option"),Pe=ne("el-select"),Oe=ne("CBMDefectC"),We=ne("CBMDefectX"),C=ne("DefectConfirmationDialog"),H=ne("TakePhoto");return c(),$(Ve,null,[n("div",{class:we([[z.value,L.value,xe.value],"px-2 pt-2 dropdown-eform-status"]),style:ce(Ne.value)},[n("div",gu,[(c(),Z(Pe,{modelValue:N.value,"onUpdate:modelValue":oe[0]||(oe[0]=Ae=>N.value=Ae),placeholder:T.value,size:"small",class:we(["w-100",be.value]),disabled:pe.value,onChange:Ee,key:O.value},va({default:le(()=>[(c(!0),$(Ve,null,nt(ae.value,Ae=>(c(),Z(ge,{key:Ae,value:Ae.value},{default:le(()=>[n("span",{innerHTML:Ae&&Ae.label?he(Ae&&Ae.label):""},null,8,ku)]),_:2},1032,["value"]))),128))]),_:2},[N.value?{name:"prefix",fn:le(()=>[n("span",{class:"el-input__custom-option",innerHTML:ue.value},null,8,hu)]),key:"0"}:void 0]),1032,["modelValue","placeholder","disabled","class"])),a.value.value==="2"&&((fe=r.task)==null?void 0:fe.category)=="NORMAL"?(c(),$("div",Su,[n("img",{src:oa,alt:"defect",class:"d-icon",onClick:Ze})])):D("",!0),a.value.value==="3"&&(((Se=r.task)==null?void 0:Se.category)=="NORMAL"||((ve=r.task)==null?void 0:ve.category)=="CBM")?(c(),$("div",{key:1,class:"ms-2",onClick:Qe},wu)):D("",!0),a.value.value==="2"&&((_e=r.task)==null?void 0:_e.category)=="CRACK"?(c(),$("div",{key:2,class:"ms-2",onClick:Je},_u)):D("",!0),a.value.value==="3"&&((je=r.task)==null?void 0:je.category)=="CRACK"?(c(),$("div",{key:3,class:"ms-2",onClick:Je},$u)):D("",!0),a.value.value==="4"?(c(),$("div",{key:4,class:"ms-2",onClick:Qe},Ru)):D("",!0)]),b.value?(c(),$("div",Pu,Nu)):D("",!0)],6),j(Oe,{show:A.value,onClose:me},null,8,["show"]),j(We,{show:P.value,onClose:Re},null,8,["show"]),h.value?(c(),Z(C,{key:0,show:h.value,"check-list-arr":F.value,onUpdateCheckList:J,onSubmit:_,onClose:G},null,8,["show","check-list-arr"])):D("",!0),j(H,{show:I.value,onClose:x},null,8,["show"])],64)}}}),rs=$t(xu,[["__scopeId","data-v-28a14333"]]),Du={key:0,class:"text-danger ps-2 font-weight-bold"},Au={key:1,class:"d-flex align-items-center"},Fu=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Loading...")],-1),Ou=n("span",null,"Calculating...",-1),Eu=[Fu,Ou],Lu={key:2,class:"d-flex align-items-center"},ju=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Updating...")],-1),Mu=n("span",null,"Updating...",-1),Hu=[ju,Mu],ns=Ue({__name:"Input",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},setup(r){const s=r,e=De(s,"item"),l=De(s,"task"),a=bt(),o=Dt(),v=da(),y=k(!1),d=k("");let p;const u=k(!1),g=k(!1),h=k(!1),w=_t();Vt(),k("");const U=i(()=>{let B="";return!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.suffix)&&(B=e.value.style.suffix),B}),m=i(()=>{let B="Please Input";return(e.value.categoryItemType=="targetRating"||e.value.categoryItemType=="resultParamRating")&&(B=""),!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.placeholder)&&(B=e.value.style.placeholder),B});k(!1),k(!1);const b=k(!1),f=i(()=>s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),F=i(()=>{let B="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(B=`col-md-${e.value.style.potraitBreakPoint}`,B=`${B} col-lg-${e.value.style.breakPoint}`):(B=`col-md-${e.value.style.potraitBreakPoint}`,B=`${B} col-lg-${e.value.style.breakPoint}`)),B}),J=i(()=>{let B=!1;const G=e.value.categoryItemType;(G=="targetRating"||G=="resultParamRating")&&(B=!0);let me=!1;return e.value.categoryItemType=="paramRatingDynamic"&&l.value.items.forEach(Re=>{Re.itemType=="dropDown"&&Re.categoryItemType=="dropdownTool"&&Re.value==""&&(me=!0)}),B||s.task.isShowAdjustmentRow||me||_.value}),_=k(!1),O=i(()=>{var G;let B="text";return(e.value.valueType=="int"||(G=e.value.customValidation)!=null&&G.toLowerCase().includes("percentage"))&&(B="numeric"),B}),V=i(()=>e.value.valueType=="int"),K=i(()=>{var B;return(B=e.value.customValidation)==null?void 0:B.toLowerCase().includes("percentage")}),q=i(()=>e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="paramRatingDynamic"),A=i(()=>!t.isUndefined(e.value.mappingKeyId)&&!t.isArray(e.value.mappingKeyId)),P=i({get:()=>e.value.value,set:async B=>{if(V.value||q.value||A.value){if(B.length>8)return;if((`${B}`.split(".")||[]).length-1>1)return;if(B.includes(".")){if(`${B}`.split(".")[1].length>2)return;e.value.value=B}if(B.length>5){if(B.length>=6&&B.length<=6){if(B[5]!=".")return;e.value.value=B}}else e.value.value}e.value.value=B,I()}}),I=()=>{if(!e.value.value)v.deleteParams(e.value.key);else{const B={keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:e.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};v.addUpdateParams(B)}},x=()=>{var B;if(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic"){if(!t.isUndefined(e.value.disabledByItemKey&&e.value.value=="")||t.isUndefined(e.value.customValidation)||!((B=e.value.customValidation)!=null&&B.toLowerCase().includes("required")))return!0;if(!Pa(e.value.value))return d.value="max. 2 decimal digits",!1}return!0},T=async B=>{if(B!=ae.value){clearTimeout(p),e.value.value=B;let G=L();G&&(G=x()),G&&(d.value="",p=setTimeout(async()=>{if(s.task.category=="CBM"&&(e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic")?u.value=!0:(!t.isUndefined(e.value.mappingKeyId)&&t.isArray(e.value.mappingKeyId),h.value=!0),Ne(B)){const Re={keyValue:l.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:B},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};if(A.value)B!==""?await te(B):await ue(Re,B);else{let pe=!0;(s.task.category=="CBM"&&e.value.categoryItemType=="paramRating"||e.value.categoryItemType=="resultParamRating"||e.value.categoryItemType=="paramRatingDynamic")&&await be().then(he=>{pe=he,!he&&a.ratingNotMapped}),pe&&(await ue(Re,B),ae.value=B,e.value.category=="cbmCalculateAvg"&&(a.setAvgTargetKey(e.value.targetCalculateKeyId),z()))}}u.value=!1,h.value=!1,e.value.isCalculatingTrue=!1},0))}else d.value=""},L=()=>{var B;if((B=e.value.customValidation)!=null&&B.toLowerCase().includes("percentage")){const G=parseFloat(e.value.value);return isNaN(G)||G<0||G>100?(d.value="must be between 0 - 100",!1):(d.value=="must be between 0 - 100"&&(d.value=""),!0)}return d.value=="must be between 0 - 100"&&(d.value=""),!0},z=async B=>{const G=e.value.mappingKeyId,me=[];let Re;if(a.stateSelectedSubGroups.find(pe=>pe.taskGroup.some(he=>he.task.some(xe=>xe.items.some(Me=>(Me.key==e.value.targetCalculateKeyId&&(Re=Me),Me.key==e.value.targetCalculateKeyId))))),Re.isCalculatingTrue=!0,t.isArray(G)){for(let he=0;he<G.length;he++){const xe=await a.getValueFromItemKey(G[he]);me.push(Number(xe))}let pe=0;me.forEach(he=>{pe=pe+he}),pe=t.round(pe/me.length,2),a.stateSelectedSubGroups.find(he=>he.taskGroup.some(xe=>xe.task.some(Me=>Me.items.some(ot=>(ot.key==e.value.targetCalculateKeyId&&(Re=ot),ot.key==e.value.targetCalculateKeyId))))),Re.value=pe}},ue=async(B,G)=>{const me=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:G},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}];!t.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&me.push(B),await a.updateServiceSheetTaskValue(me,o.user.EmployeeId,o.user.Name)},be=async()=>{let B=!0;const G=s.task,me=G.items.findIndex(he=>he.key==e.value.key)+1,Re=G.items[me],pe=G.items.find(he=>he.itemType==="smallCamera");return Re&&pe&&a.setMeasurementValueAndUOM(e.value.value,Re.value,pe.key),await a.getCBMResult(G,e.value).then(he=>{B=he.status,he.status&&(he.value&&!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhoto")&&(a.setInputCameraMandatoryKey(e.value.key),b.value=!0),(he.value=="A"||he.value=="B")&&!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating")&&(a.setInputCameraMandatoryKey(e.value.key),b.value=!0),(he.value=="C"||he.value=="X")&&(!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmDefectTakePhoto")||!t.isUndefined(e.value.customValidation)&&e.value.customValidation.includes("cbmTakePhotoAllRating"))&&(a.setInputCameraMandatoryKey(e.value.key),b.value=!0))}),B},Ee=i(()=>w.stateIsCameraError);ke(Ee,async B=>{B&&a.stateInputCameraMandatoryKey==e.value.key&&(await T(""),a.setInputCameraMandatoryKey(""))});const Q=i(()=>{const B=e.value.value.toString().replaceAll("'","");let G;return e.value.categoryItemType=="targetRating"&&(B=="A"?G="a":B=="B"?G="b":B=="C"?G="c":B=="X"&&(G="x")),G}),N=i(()=>{var oe,ge,Pe,Oe;const B=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",G=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",me=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",Re=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let pe=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((oe=s.task)==null?void 0:oe.isShowAdjustmentRow)&&((ge=s.task)!=null&&ge.isShowAdjustmentRow))pe="";else{let We=0;(Pe=s.task)==null||Pe.items.forEach(C=>{var H;t.isUndefined(C.style)||(t.isUndefined(C.style.border)?t.isUndefined(C.style.border)&&(We=We+Number(C.style.breakPoint)):((C.style.border.right=="none"||t.isUndefined(C.style.border.right))&&(We=We+Number(C.style.breakPoint)),t.isEqual(C,t.last((H=s.task)==null?void 0:H.items))&&(We=We+Number(C.style.breakPoint))))}),We==12&&(pe=!((Oe=s.task.updatedBy)!=null&&Oe.name)&&!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const he=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",xe=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",Me=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",ot=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",E=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${B}${G}${me}${Re}${pe}${he}${xe}${Me}${ot}${E}`}),Y=i(()=>{const B=e.value.categoryItemType=="targetRating";let G=!0;!t.isUndefined(l.value.updatedBy)&&!t.isUndefined(l.value.updatedBy.id)&&(a.employee.id==l.value.updatedBy.id?G=!0:G=!1);let me=!0;!t.isUndefined(e.value.updatedBy)&&!t.isUndefined(e.value.updatedBy.id)&&(a.employee.id==e.value.updatedBy.id?me=!0:me=!1);let Re=!1;!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.visibility)&&e.value.style.visibility=="readonly"&&(Re=!0);let pe=!0,he;return e.value.category=="cbmCalculateAvg"&&(a.stateSelectedSubGroups.find(xe=>xe.taskGroup.some(Me=>Me.task.some(ot=>ot.items.some(E=>(E.key==e.value.targetCalculateKeyId&&(he=E),E.key==e.value.targetCalculateKeyId))))),!t.isUndefined(he.updatedBy)&&!t.isUndefined(he.updatedBy.id)&&(a.employee.id==he.updatedBy.id?pe=!0:pe=!1)),B||!G||Re||!me||!pe}),te=async B=>{a.stateOilToleranceNotMapped?(g.value=!0,e.value.value=ae.value):await a.getValueFromItemKey(e.value.mappingKeyId).then(async G=>{if(G!=""){const me=a.oilTolerance;let Re=me.min,pe=me.max;me.uom=="%"&&(Re=Number(G)*(Re/100),pe=Number(G)*(pe/100));const xe=Number(G)+Number(Re),Me=Number(G)+Number(pe),ot=B>=xe,E=B<=Me,oe=parseFloat(xe.toString()).toFixed(2),ge=parseFloat(Me.toString()).toFixed(2);if(ot&&E){const Pe={keyValue:l.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:B},{propertyName:"updatedBy",propertyValue:JSON.stringify(a.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};h.value=!1,await ue(Pe,B),ae.value=B}else d.value=`Range refill capacity is between ${oe} until ${ge}`,h.value=!1,y.value=!0,e.value.value=ae.value}})},ie=B=>{if(V.value||K.value||q.value||A.value){let G=B.keyCode?B.keyCode:B.which;K.value&&(B.target.value>100&&B.preventDefault(),B.target.value.includes(".")?B.target.value.split(".")[1].length>=2&&B.preventDefault():B.target.value.length>=3&&B.preventDefault()),(G<48||G>57)&&G!=46&&B.preventDefault()}},ae=k("");xt(async()=>{ae.value=e.value.value,P.value=e.value.value,await Je()}),$a(()=>{e.value={}});const Ne=B=>{if(e.value.valueType=="int"){const G=B.split(".");let me=!1,Re=G[0].length>5;return G[1]&&(me=G[1].length>2),Re||me?(d.value="max input length is 5 digits and 2 number after .",!1):!0}else return!0},Ze=i(()=>e.value.isCalculatingTrue);ke(Ze,(B,G)=>{B&&(u.value=!0)});const Je=async()=>{var B;if(!t.isUndefined(e.value.disabledByItemKey)){let G=a.stateStoredDisableKeyValue.find(me=>me.key==e.value.disabledByItemKey);if(t.isUndefined(G)){const me=await a.getValueFromItemKey(e.value.disabledByItemKey);a.pushStoredDisabledItems({key:e.value.disabledByItemKey,value:me})}G=a.stateStoredDisableKeyValue.find(me=>me.key==e.value.disabledByItemKey),(G==null?void 0:G.value)=="3"?(_.value=!0,e.value.value&&((B=s.task)==null?void 0:B.taskType)=="inline"&&await T("")):_.value=!1}},Qe=i(()=>s.itemLoading);ke(Qe,B=>{h.value=B}),ke(P,async(B,G)=>{B==""&&(ae.value=""),e.value.categoryItemType&&e.value.categoryItemType=="resultParamRating"&&e.value.key==a.stateAvgTargetKey&&B!=G&&T(B),await Je()},{deep:!0}),ke(s.item,(B,G)=>{e.value=B},{deep:!0});const ct=i(()=>{let B="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(B=""),B});return(B,G)=>{const me=ne("el-input");return c(),$("div",{class:we([[f.value,F.value,ct.value],"px-2 pt-2 input-eform-status"]),style:ce(N.value)},[j(me,{class:we([Q.value,U.value!=""?"service-sheet-input":""]),modelValue:P.value,"onUpdate:modelValue":G[0]||(G[0]=Re=>P.value=Re),size:"small",placeholder:m.value,readonly:Y.value,onKeypress:ie,inputmode:O.value,disabled:J.value},va({_:2},[U.value!=""?{name:"append",fn:le(()=>[yt(Ie(U.value),1)]),key:"0"}:void 0]),1032,["class","modelValue","placeholder","readonly","inputmode","disabled"]),d.value!=""?(c(),$("label",Du,Ie(d.value),1)):D("",!0),u.value?(c(),$("div",Au,Eu)):D("",!0),h.value?(c(),$("div",Lu,Hu)):D("",!0)],6)}}}),Ku=["disabled"],Gu=["src"],qu={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},Yu={class:"text-white"},is=Ue({__name:"SmallCamera",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const s=r,e=De(s,"item"),l=k(!1),a=De(s,"task"),o=bt(),v=_t(),y=Dt(),d=Te(()=>s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),p=Te(()=>{let P="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(P=`col-md-${e.value.style.potraitBreakPoint} col-lg-${e.value.style.breakPoint}`),P}),u=Te(()=>e.value.value?lt(e.value.value):[]),g=()=>{v.toggleIsVisible(!0,e.value.key)},h=Te(()=>t.cloneDeep(v.ImageObjects.find(P=>P.Id===e.value.key))),w=()=>{var I;let P="/media/svg/dma/camera/e-form/png/cam-active.png";return(I=s.task)!=null&&I.updatedBy&&e.value.updatedBy&&(s.task.updatedBy.id==o.employee.id?u.value.length>0&&(P="/media/svg/dma/camera/e-form/png/cam-user.png"):P="/media/svg/dma/camera/e-form/png/cam-read.png"),P},U=Te(()=>{let P=!1;return u.value.length==1&&(P=!0),!q.value&&!P}),m=()=>{l.value=!0},b=()=>{l.value=!1},f=Te(()=>{var N,Y,te;const P=!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; `:"",I=!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:"",x=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",T=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let L=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((N=s.task)==null?void 0:N.isShowAdjustmentRow)&&((Y=s.task)!=null&&Y.isShowAdjustmentRow))L="";else{let ie=0;(te=s.task)==null||te.items.forEach(ae=>{var Ne;t.isUndefined(ae.style)||(t.isUndefined(ae.style.border)?t.isUndefined(ae.style.border)&&(ie=ie+Number(ae.style.breakPoint)):((ae.style.border.right=="none"||t.isUndefined(ae.style.border.right))&&(ie=ie+Number(ae.style.breakPoint)),t.isEqual(ae,t.last((Ne=s.task)==null?void 0:Ne.items))&&(ie=ie+Number(ae.style.breakPoint))))}),ie==12&&(L=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const z=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",ue=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",be=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",Ee=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",Q=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${P}${I}${x}${T}${L}${z}${ue}${be}${Ee}${Q}`}),F=async P=>{e.value.value=lt(e.value.value);const I=e.value.value;e.value.value=I.filter(x=>x.filename!=P),v.setCurrent(e.value.key),await J(),e.value.value.length==0&&b(),v.clearCurrent()},J=async()=>{const P={keyValue:a.value.key,propertyParams:[{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]},I=[{keyValue:e.value.key,propertyParams:[{propertyName:"value",propertyValue:JSON.stringify(e.value.value)},{propertyName:"updatedBy",propertyValue:JSON.stringify(o.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]}];!t.isUndefined(e.value.isTaskValue)&&e.value.isTaskValue&&I.push(P),o.updateServiceSheetTaskValue(I,y.user.EmployeeId,y.user.Name)},_=k(!1),O=()=>{_.value=!1},V=()=>{_.value=!1,g()},K=async()=>{e.value.value==""&&(e.value.value=[]);let P=[];h.value&&(P=lt(h.value.ImageInfos));const I=lt(e.value.value),x=P.filter(T=>!I.includes(T));e.value.value=lt(e.value.value),e.value.value=[...e.value.value,...x],await J(),_.value=!0},q=Te(()=>{var I;let P=!0;return(I=a.value)!=null&&I.updatedBy&&o.employee.id!=a.value.updatedBy.id&&(P=!1),!P});ke(h,async(P,I)=>{!t.isUndefined(P)&&P.ImageInfos.length>0&&P.ImageInfos.length!=(I==null?void 0:I.ImageInfos.length)&&await K()},{deep:!0});const A=Te(()=>{var I;let P="pb-2";return(I=s.task)!=null&&I.updatedBy&&s.task.updatedBy.name&&(P=""),P});return(P,I)=>(c(),$("div",{class:we([[W(d),W(p),W(A)],"pt-2"]),style:ce(W(f))},[n("div",{class:we(["row",!W(t.isUndefined)(e.value.value)&&e.value.value.length>0?"justify-content-around":"justify-content-center"])},[n("div",{class:we(["d-flex justify-content-center",!W(t.isUndefined)(e.value.value)&&e.value.value.length>0?"col-6 pe-0 ps-1":"col-6 px-0"])},[n("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:g,disabled:W(q)},[n("img",{src:w(),style:{height:"12px",width:"14px"},alt:"photo"},null,8,Gu)],8,Ku)],2),W(u)&&W(u).length>0?(c(),$("div",qu,[n("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:m,style:{"background-color":"#18AF4A"}},[n("label",Yu,"+"+Ie(W(u).length),1)])])):D("",!0)],2),l.value?(c(),Z(ua,{key:0,type:"task","re-render":!1,images:W(u),"show-delete-button":W(U),"is-mandatory":!0,visibility:l.value,"is-monitoring":!W(U),"show-mandatory-caption":!0,onOnClose:b,onOnDelete:F},null,8,["images","show-delete-button","visibility","is-monitoring"])):D("",!0),j(Ma,{visibility:_.value,caption:"The photo successfully taken, would you like to take another photo?",onOnNoConfirm:O,onOnYesConfirm:V},null,8,["visibility"])],6))}}),Ju={class:"p-2"},Wu={class:"form-check checkbox-success item-checkbox"},us=Ue({__name:"CheckBox",props:{item:{type:Object,required:!0},task:{type:Object},generalStyle:{type:Boolean,default:!0}},setup(r){const s=r,e=da(),l=bt(),a=De(s,"item"),o=De(s,"task"),v=i({get:()=>JSON.parse(s.item.value),set:async g=>{a.value.value=="false"?a.value.value="true":a.value.value="false",console.log("perubahan status radio",a.value.value),e.updateValidationValue({key:a.value.key,value:a.value.value});const h={keyValue:a.value.key,propertyParams:[{propertyName:"value",propertyValue:a.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(l.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};a.value.value?e.addUpdateParams(h):e.deleteParams(a.value.key);const w={keyValue:o.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:a.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(l.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};a.value.isTaskValue&&(a.value.value?e.addUpdateParams(w):e.deleteParams(o.value.key))}}),y=i(()=>!t.isUndefined(a.value.style)&&a.value.style.breakPoint!="none"?`col-${a.value.style.breakPoint}`:"col"),d=i(()=>{let g="";return s.generalStyle&&!t.isUndefined(a.value.style)&&(!t.isUndefined(a.value.style.potraitBreakPoint)&&a.value.style.breakPoint!="none"?(g=`col-md-${a.value.style.potraitBreakPoint}`,g=`${g} col-lg-${a.value.style.breakPoint}`):(g=`col-md-${a.value.style.potraitBreakPoint}`,g=`${g} col-lg-${a.value.style.breakPoint}`)),g}),p=i(()=>{var O,V,K,q;const g=!t.isUndefined(a.value.style)&&a.value.style.bgColor!="none"?`background-color: ${a.value.style.bgColor}; `:"",h=!t.isUndefined(a.value.style)&&a.value.style.fontColor!="none"?`color: ${a.value.style.fontColor}; `:"",w=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.top!="none"?`border-top: ${a.value.style.border.top}; `:"",U=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.right!="none"?`border-right: ${a.value.style.border.right}; `:"";let m=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((O=s.task)==null?void 0:O.isShowAdjustmentRow)&&((V=s.task)!=null&&V.isShowAdjustmentRow))m="";else{let A=0;(K=s.task)==null||K.items.forEach(P=>{var I;t.isUndefined(P.style)||(t.isUndefined(P.style.border)?t.isUndefined(P.style.border)&&(A=A+Number(P.style.breakPoint)):((P.style.border.right=="none"||t.isUndefined(P.style.border.right))&&(A=A+Number(P.style.breakPoint)),t.isEqual(P,t.last((I=s.task)==null?void 0:I.items))&&(A=A+Number(P.style.breakPoint))))}),A==12&&(m=!((q=s.task.updatedBy)!=null&&q.name)&&!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const b=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.left!="none"?`border-left: ${a.value.style.border.left}; `:"",f=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${a.value.style.borderRadius.topRight}; `:"",F=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${a.value.style.borderRadius.bottomRight}; `:"",J=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${a.value.style.borderRadius.topLeft}; `:"",_=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${a.value.style.borderRadius.bottomLeft}; `:"";return`${g}${h}${w}${U}${m}${b}${f}${F}${J}${_}`}),u=i(()=>{let g="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(g=""),g});return(g,h)=>(c(),$("div",{class:we([[d.value,y.value,u.value],"pt-2 px-2 d-flex align-items-center d-flex justify-content-center"]),style:ce(p.value)},[n("div",Ju,[n("div",Wu,[Wt(n("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":h[0]||(h[0]=w=>v.value=w)},null,512),[[pa,v.value]])])])],6))}}),ds=Ue({__name:"InteractiveButton",props:{item:{type:Object,required:!0},generalStyle:{type:Boolean,default:!0},task:{type:Object}},setup(r){const s=r,e=De(s,"item"),l=De(s,"task"),a=i(()=>s.generalStyle?!t.isUndefined(e.value.style)&&e.value.style.breakPoint!="none"?`col-${e.value.style.breakPoint}`:"col":""),o=i(()=>!t.isUndefined(e.value.style)&&e.value.style.fontColor!="none"?`color: ${e.value.style.fontColor}; `:""),v=i(()=>!t.isUndefined(e.value.style)&&e.value.style.bgColor!="none"?`background-color: ${e.value.style.bgColor}; border-color: ${e.value.style.bgColor};`:""),y=bt(),d=i(()=>{let m="";return s.task.isShowAdjustmentRow&&(m="opacity: 50%;"),p.value&&(m="opacity: 50%;"),m}),p=i(()=>{const m=s.task.taskValue=="",b=s.task.taskValue=="A"||s.task.taskValue=="B";let f=!0;return!t.isUndefined(s.task.updatedBy)&&!t.isUndefined(s.task.updatedBy.id)&&(y.employee.id==s.task.updatedBy.id?f=!0:f=!1),m||b||s.task.isShowAdjustmentRow||!f}),u=i(()=>{let m="";return s.generalStyle&&!t.isUndefined(e.value.style)&&(!t.isUndefined(e.value.style.potraitBreakPoint)&&e.value.style.breakPoint!="none"?(m=`col-md-${e.value.style.potraitBreakPoint}`,m=`${m} col-lg-${e.value.style.breakPoint}`):(m=`col-md-${e.value.style.potraitBreakPoint}`,m=`${m} col-lg-${e.value.style.breakPoint}`)),m}),g=i(()=>t.isUndefined(e.value.style)?"":e.value.style.textAlign=="left"?"text-start":e.value.style.textAlign=="right"?"text-end":"text-center"),h=i(()=>{var K,q,A,P;const m=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.top!="none"?`border-top: ${e.value.style.border.top}; `:"",b=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.right!="none"?`border-right: ${e.value.style.border.right}; `:"";let f=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((K=s.task)==null?void 0:K.isShowAdjustmentRow)&&((q=s.task)!=null&&q.isShowAdjustmentRow))f="";else{let I=0;(A=s.task)==null||A.items.forEach(x=>{var T;t.isUndefined(x.style)||(t.isUndefined(x.style.border)?t.isUndefined(x.style.border)&&(I=I+Number(x.style.breakPoint)):((x.style.border.right=="none"||t.isUndefined(x.style.border.right))&&(I=I+Number(x.style.breakPoint)),t.isEqual(x,t.last((T=s.task)==null?void 0:T.items))&&(I=I+Number(x.style.breakPoint))))}),I==12&&(f=!((P=s.task.updatedBy)!=null&&P.name)&&!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.bottom!="none"?`border-bottom: ${e.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const F=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.border)&&e.value.style.border.left!="none"?`border-left: ${e.value.style.border.left}; `:"",J=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${e.value.style.borderRadius.topRight}; `:"",_=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${e.value.style.borderRadius.bottomRight}; `:"",O=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${e.value.style.borderRadius.topLeft}; `:"",V=!t.isUndefined(e.value.style)&&!t.isUndefined(e.value.style.borderRadius)&&e.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${e.value.style.borderRadius.bottomLeft}; `:"";return`${m}${b}${f}${F}${J}${_}${O}${V}`}),w=()=>{e.value.value=="Adjustment"&&(l.value.isShowAdjustmentRow=!0)},U=i(()=>{let m="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(m=""),m});return(m,b)=>{const f=ne("el-button");return c(),$("div",{class:we([[a.value,g.value,u.value,U.value],"px-2 pt-2"]),style:ce(h.value)},[!W(t.isUndefined)(r.item.style)&&r.item.style.visibility!="hidden"?(c(),Z(f,{key:0,style:ce([o.value,v.value,d.value]),size:"small",type:"success",onClick:w,class:"item-button w-100",disabled:p.value},{default:le(()=>[yt(Ie(r.item.value),1)]),_:1},8,["style","disabled"])):D("",!0)],6)}}}),zu={class:"row w-100"},Xu=n("div",{class:"col-1 pb-1 px-2"},null,-1),Zu={key:0,class:"d-flex align-items-center"},Qu=n("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[n("span",{class:"sr-only"},"Loading...")],-1),ed=n("span",null,"Loading...",-1),td=[Qu,ed],ad={class:"row justify-content-center"},sd={class:"px-0 col-6 d-flex justify-content-center"},ld=["disabled"],od=["src"],rd={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},nd={class:"text-white"},id={key:0,class:"row w-100"},ud=Ue({__name:"TaskAdjustment",props:{task:{type:Object,required:!0}},setup(r){const s=r,e=async T=>{const L=l.value.adjustment.pictures;l.value.adjustment.pictures=L.filter(z=>z!=T),f.setCurrent(`${l.value.key}-adjustment`),f.clearCurrent(),await m.addCBMAdjustmentPictures(l.value),l.value.adjustment.pictures.length==0},l=De(s,"task"),a=k(!1),o=Vt(),v=i({get:()=>l.value.adjustment.measurement,set:T=>{La(T)&&(l.value.adjustment.measurement=ja(T))}}),y=i(()=>l.value.adjustment.pictures),d=i(()=>{let T=!0;return!t.isUndefined(l.value.updatedBy)&&!t.isUndefined(l.value.updatedBy.id)&&(m.employee.id==l.value.updatedBy.id?T=!0:T=!1),!T}),p=()=>{a.value=!1},u=()=>{a.value=!0},g=i(()=>{let T="";return s.task.items.forEach(L=>{!t.isUndefined(L.style)&&!t.isUndefined(L.style.border)&&L.style.border.left!="none"&&(T=L.style.border.left)}),T}),h=i(()=>{let T="",L=!1;return l.value.items.forEach(z=>{!t.isUndefined(z.style)&&!t.isUndefined(z.style.border)&&z.style.border.bottom!="none"&&(L=!0)}),(l.value.adjustment.updatedBy.name==""||t.isUndefined(l.value.adjustment.updatedBy.name)&&L)&&(T=`border-bottom: ${g.value}`),T}),w=i(()=>{let T=!1;l.value.items.forEach(z=>{!t.isUndefined(z.style)&&!t.isUndefined(z.style.border)&&z.style.border.bottom!="none"&&(T=!0)});let L="";return l.value.adjustment.updatedBy.name!=""&&T&&(L=`border-bottom: ${g.value}`),L}),U=T=>{let L=T.keyCode?T.keyCode:T.which;(L<48||L>57)&&L!=46&&T.preventDefault()},m=bt(),b=k(!1),f=_t(),F=k(!1),J=()=>{var L,z;let T="/media/svg/dma/camera/e-form/png/cam-active.png";return t.isUndefined((L=s.task.adjustment.updatedBy)==null?void 0:L.id)||((z=s.task.adjustment.updatedBy)==null?void 0:z.id)==m.employee.id&&l.value.adjustment.pictures.length>0&&(T="/media/svg/dma/camera/e-form/png/cam-user.png"),d.value&&(T="/media/svg/dma/camera/e-form/png/cam-read.png"),T},_=async T=>{let L=T.target.value;if(!d.value){if(!o.stateConnectionStatus){o.setSubmitConnectionError(!0),l.value.adjustment.measurement=I.value;return}if(console.log("val",L,"value old",I.value),L&&L!=I.value){F.value=!0,l.value.adjustment.measurement=L;const z=await m.getAdjusmentRating(l.value);F.value=!1,(z=="C"||z=="X")&&(b.value=!0),I.value=L}}},O=()=>{f.toggleIsVisible(!0,`${l.value.key}-adjustment`),b.value=!1},V=async()=>{if(l.value.adjustment.measurement){const T=Ye.service({lock:!0,text:"Deleting Adjustment",background:"rgba(0, 0, 0, 0.7)"});await m.deleteAdjusmentTask(l.value),T.close(),f.setCurrent(`${l.value.key}-adjustment`),f.clearCurrent()}l.value.isShowAdjustmentRow=!1},K=i(()=>{const T=l.value.adjustment.rating;let L;return T=="A"?L="a":T=="B"?L="b":T=="C"?L="c":T=="X"&&(L="x"),L}),q=i(()=>t.cloneDeep(f.ImageObjects.find(T=>T.Id===`${l.value.key}-adjustment`))),A=k(!1),P=()=>{const T=q.value.ImageInfos,L=l.value.adjustment.pictures,z=T.filter(ue=>!L.includes(ue));l.value.adjustment.pictures=[...l.value.adjustment.pictures,...z],m.addCBMAdjustmentPictures(l.value),A.value=!0};ke(q,async(T,L)=>{!t.isUndefined(T)&&T.ImageInfos.length>0&&T.ImageInfos.length!=(L==null?void 0:L.ImageInfos.length)&&await P()},{deep:!0});const I=k(""),x=k("");return xt(()=>{I.value=l.value.adjustment.measurement,x.value=l.value.adjustment.measurement}),(T,L)=>{const z=ne("el-input"),ue=ne("el-button");return c(),$(Ve,null,[n("div",zu,[Xu,n("div",{class:"col-1 pb-1 px-2",style:ce([`border-left: ${g.value}`,h.value])},null,4),n("div",{class:"col-4 col-md-3 pb-1 px-2",style:ce([h.value])},Ie(r.task.adjustment.description),5),n("div",{class:"col-2 pb-1 px-2",style:ce([h.value])},[j(z,{modelValue:v.value,"onUpdate:modelValue":L[0]||(L[0]=be=>v.value=be),size:"small",placeholder:"Please Input",onKeypress:U,onFocusout:_,inputmode:"numeric",readonly:d.value},null,8,["modelValue","readonly"]),F.value?(c(),$("div",Zu,td)):D("",!0)],4),n("div",{class:"col-1 pb-1 px-2",style:ce([h.value])},Ie(r.task.adjustment.uom),5),n("div",{class:"col-1 col-md-1 pb-1 px-2 input-eform-status",style:ce([h.value])},[j(z,{modelValue:l.value.adjustment.rating,"onUpdate:modelValue":L[1]||(L[1]=be=>l.value.adjustment.rating=be),modelModifiers:{lazy:!0},size:"small",disabled:"",class:we(K.value)},null,8,["modelValue","class"])],4),n("div",{class:"col-1 col-md-1 pb-1 px-2",style:ce([h.value])},[n("div",ad,[n("div",sd,[n("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:O,disabled:d.value},[n("img",{src:J(),style:{height:"12px",width:"14px"}},null,8,od)],8,ld)]),l.value.adjustment.pictures.length>0?(c(),$("div",rd,[n("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:u,style:{"background-color":"#18AF4A"}},[n("label",nd,"+"+Ie(l.value.adjustment.pictures.length),1)])])):D("",!0)])],4),n("div",{class:"col-2 pb-1 px-2",style:ce([`border-right: ${g.value}`,h.value])},[j(ue,{disabled:d.value,type:"danger",size:"small",class:"item-button w-100",onClick:V},{default:le(()=>[yt("Delete")]),_:1},8,["disabled"])],4)]),r.task.adjustment.updatedBy.name?(c(),$("div",id,[n("div",{class:"d-flex justify-content-end py-1 col-11 offset-1 timestamp-task",style:ce([`border-left: ${g.value}; border-right: ${g.value}`,w.value])},Ie(r.task.adjustment.updatedBy.name)+", "+Ie(r.task.adjustment.updatedDate),5)])):D("",!0),a.value?(c(),Z(Ha,{key:1,images:y.value,visibility:a.value,showDeleteButton:!d.value,onHandleClose:p,onHandleDelete:e},null,8,["images","visibility","showDeleteButton"])):D("",!0)],64)}}}),dd=r=>(zt("data-v-7b623f6c"),r=r(),Xt(),r),cd={class:"px-2 w-100"},md={class:"form-check checkbox-success item-checkbox w-100 ps-0 d-flex"},fd={class:"ms-1 d-flex align-items-center"},yd={key:0,class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},vd=dd(()=>n("span",{class:"sr-only"},"Loading...",-1)),pd=[vd],bd={key:1},gd={class:"ms-2 flex-fill text-start"},kd=Ue({__name:"RadioButtonWithStatus",props:{item:{type:Object,required:!0},task:{type:Object},generalStyle:{type:Boolean,default:!0}},setup(r){const s=r,e=da(),l=bt(),a=De(s,"item"),o=De(s,"task"),v=k(!1),y=()=>{a.value.value?a.value.value="":a.value.value="true",console.log("perubahan status radio",a.value.value),e.updateValidationValue({key:a.value.key,value:a.value.value});const w={keyValue:a.value.key,propertyParams:[{propertyName:"value",propertyValue:a.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(l.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};a.value.value?e.addUpdateParams(w):e.deleteParams(a.value.key);const U={keyValue:o.value.key,propertyParams:[{propertyName:"taskValue",propertyValue:a.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(l.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};a.value.isTaskValue&&(a.value.value?e.addUpdateParams(U):e.deleteParams(o.value.key))},d=i(()=>!t.isUndefined(a.value.style)&&a.value.style.breakPoint!="none"?`col-${a.value.style.breakPoint}`:"col"),p=i(()=>{let w="";return s.generalStyle&&!t.isUndefined(a.value.style)&&(!t.isUndefined(a.value.style.potraitBreakPoint)&&a.value.style.breakPoint!="none"?(w=`col-md-${a.value.style.potraitBreakPoint}`,w=`${w} col-lg-${a.value.style.breakPoint}`):(w=`col-md-${a.value.style.potraitBreakPoint}`,w=`${w} col-lg-${a.value.style.breakPoint}`)),w}),u=i(()=>{var K,q,A,P;const w=!t.isUndefined(a.value.style)&&a.value.style.bgColor!="none"?`background-color: ${a.value.style.bgColor}; `:"",U=!t.isUndefined(a.value.style)&&a.value.style.fontColor!="none"?`color: ${a.value.style.fontColor}; `:"",m=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.top!="none"?`border-top: ${a.value.style.border.top}; `:"",b=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.right!="none"?`border-right: ${a.value.style.border.right}; `:"";let f=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((K=s.task)==null?void 0:K.isShowAdjustmentRow)&&((q=s.task)!=null&&q.isShowAdjustmentRow))f="";else{let I=0;(A=s.task)==null||A.items.forEach(x=>{var T;t.isUndefined(x.style)||(t.isUndefined(x.style.border)?t.isUndefined(x.style.border)&&(I=I+Number(x.style.breakPoint)):((x.style.border.right=="none"||t.isUndefined(x.style.border.right))&&(I=I+Number(x.style.breakPoint)),t.isEqual(x,t.last((T=s.task)==null?void 0:T.items))&&(I=I+Number(x.style.breakPoint))))}),I==12&&(f=!((P=s.task.updatedBy)!=null&&P.name)&&!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.bottom!="none"?`border-bottom: ${a.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const F=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.border)&&a.value.style.border.left!="none"?`border-left: ${a.value.style.border.left}; `:"",J=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${a.value.style.borderRadius.topRight}; `:"",_=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${a.value.style.borderRadius.bottomRight}; `:"",O=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${a.value.style.borderRadius.topLeft}; `:"",V=!t.isUndefined(a.value.style)&&!t.isUndefined(a.value.style.borderRadius)&&a.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${a.value.style.borderRadius.bottomLeft}; `:"";return`${w}${U}${m}${b}${f}${F}${J}${_}${O}${V}`}),g=i(()=>{let w="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(w=""),w}),h=i(()=>{let w="Not Complete";return a.value.value=="true"&&(w="Complete"),w});return(w,U)=>(c(),$("div",{class:we([[d.value,p.value,g.value],"pt-2 px-2 d-flex d-flex justify-content-center"]),style:ce(u.value)},[n("div",cd,[n("div",md,[n("div",{class:we(["little-box rounded-circle d-flex flex-column justify-content-center cbm-confirm-checkbox","dot"])},[a.value.value?(c(),$("img",{key:1,src:vl,style:{width:"28px"},onClick:U[1]||(U[1]=m=>y()),alt:""})):(c(),$("div",{key:0,class:"little-dot",onClick:U[0]||(U[0]=m=>y())})),n("div",fd,[v.value?(c(),$("div",yd,pd)):D("",!0),v.value?(c(),$("span",bd,"Loading...")):D("",!0)])]),n("span",gd,Ie(h.value),1)])])],6))}}),hd=$t(kd,[["__scopeId","data-v-7b623f6c"]]),Sd=Ue({__name:"TextAreaInput",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},setup(r){const s=r,e=Vt(),l=bt(),a=da(),o=De(s,"item"),v=De(s,"task"),y=k(""),d=i({get:()=>o.value.value,set:async b=>{console.log("input",b),o.value.value=b,console.log("itemref",o.value.value),p()}}),p=()=>{if(!o.value.value)a.deleteParams(o.value.key);else{const b={keyValue:o.value.key,propertyParams:[{propertyName:"value",propertyValue:o.value.value},{propertyName:"updatedBy",propertyValue:JSON.stringify(l.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};a.addUpdateParams(b)}},u=i(()=>{let b="";return s.generalStyle&&!t.isUndefined(o.value.style)&&(!t.isUndefined(o.value.style.potraitBreakPoint)&&o.value.style.breakPoint!="none"?(b=`col-md-${o.value.style.potraitBreakPoint}`,b=`${b} col-lg-${o.value.style.breakPoint}`):(b=`col-md-${o.value.style.potraitBreakPoint}`,b=`${b} col-lg-${o.value.style.breakPoint}`)),b}),g=i(()=>{const b=o.value.categoryItemType=="targetRating";let f=!0;!t.isUndefined(v.value.updatedBy)&&!t.isUndefined(v.value.updatedBy.id)&&(l.employee.id==v.value.updatedBy.id?f=!0:f=!1);let F=!0;!t.isUndefined(o.value.updatedBy)&&!t.isUndefined(o.value.updatedBy.id)&&(l.employee.id==o.value.updatedBy.id?F=!0:F=!1);let J=!1;!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.visibility)&&o.value.style.visibility=="readonly"&&(J=!0);let _=!0,O;return o.value.category=="cbmCalculateAvg"&&(l.stateSelectedSubGroups.find(V=>V.taskGroup.some(K=>K.task.some(q=>q.items.some(A=>(A.key==o.value.targetCalculateKeyId&&(O=A),A.key==o.value.targetCalculateKeyId))))),!t.isUndefined(O.updatedBy)&&!t.isUndefined(O.updatedBy.id)&&(l.employee.id==O.updatedBy.id?_=!0:_=!1)),b||!f||J||!F||!_}),h=i(()=>s.generalStyle?!t.isUndefined(o.value.style)&&o.value.style.breakPoint!="none"?`col-${o.value.style.breakPoint}`:"col":""),w=i(()=>{let b="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(b=""),b}),U=i(()=>{var P,I,x,T;const b=!t.isUndefined(o.value.style)&&o.value.style.bgColor!="none"?`background-color: ${o.value.style.bgColor}; `:"",f=!t.isUndefined(o.value.style)&&o.value.style.fontColor!="none"?`color: ${o.value.style.fontColor}; `:"",F=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.border)&&o.value.style.border.top!="none"?`border-top: ${o.value.style.border.top}; `:"",J=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.border)&&o.value.style.border.right!="none"?`border-right: ${o.value.style.border.right}; `:"";let _=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.border)&&o.value.style.border.bottom!="none"?`border-bottom: ${o.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((P=s.task)==null?void 0:P.isShowAdjustmentRow)&&((I=s.task)!=null&&I.isShowAdjustmentRow))_="";else{let L=0;(x=s.task)==null||x.items.forEach(z=>{var ue;t.isUndefined(z.style)||(t.isUndefined(z.style.border)?t.isUndefined(z.style.border)&&(L=L+Number(z.style.breakPoint)):((z.style.border.right=="none"||t.isUndefined(z.style.border.right))&&(L=L+Number(z.style.breakPoint)),t.isEqual(z,t.last((ue=s.task)==null?void 0:ue.items))&&(L=L+Number(z.style.breakPoint))))}),L==12&&(_=!((T=s.task.updatedBy)!=null&&T.name)&&!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.border)&&o.value.style.border.bottom!="none"?`border-bottom: ${o.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const O=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.border)&&o.value.style.border.left!="none"?`border-left: ${o.value.style.border.left}; `:"",V=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${o.value.style.borderRadius.topRight}; `:"",K=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${o.value.style.borderRadius.bottomRight}; `:"",q=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${o.value.style.borderRadius.topLeft}; `:"",A=!t.isUndefined(o.value.style)&&!t.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${o.value.style.borderRadius.bottomLeft}; `:"";return`${b}${f}${F}${J}${_}${O}${V}${K}${q}${A}`}),m=b=>{if(!e.stateConnectionStatus)e.setSubmitConnectionError(!0),o.value.value=y.value;else{if(g.value)return;const f=b.target.value;o.value.value=f}};return xt(async()=>{y.value=o.value.value,d.value=o.value.value}),(b,f)=>{const F=ne("el-input");return c(),$("div",{class:we([[h.value,u.value,w.value],"px-2 pt-2 input-eform-status"]),style:ce(U.value)},[j(F,{modelValue:d.value,"onUpdate:modelValue":f[0]||(f[0]=J=>d.value=J),rows:5,type:"textarea",placeholder:"Please input",onFocusout:m},null,8,["modelValue"])],6)}}}),Cd={class:"form-floating"},wd=Ue({__name:"InputWithPlaceholder",props:{item:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},task:{type:Object},generalStyle:{type:Boolean,default:!0},itemLoading:{type:Boolean,default:!1}},setup(r){const s=r;Vt();const e=bt(),l=De(s,"item"),a=De(s,"task"),o=k(""),v=i({get:()=>l.value.value,set:async h=>{l.value.value=h}}),y=i(()=>{let h="";return s.generalStyle&&!t.isUndefined(l.value.style)&&(!t.isUndefined(l.value.style.potraitBreakPoint)&&l.value.style.breakPoint!="none"?(h=`col-md-${l.value.style.potraitBreakPoint}`,h=`${h} col-lg-${l.value.style.breakPoint}`):(h=`col-md-${l.value.style.potraitBreakPoint}`,h=`${h} col-lg-${l.value.style.breakPoint}`)),h});i(()=>{const h=l.value.categoryItemType=="targetRating";let w=!0;!t.isUndefined(a.value.updatedBy)&&!t.isUndefined(a.value.updatedBy.id)&&(e.employee.id==a.value.updatedBy.id?w=!0:w=!1);let U=!0;!t.isUndefined(l.value.updatedBy)&&!t.isUndefined(l.value.updatedBy.id)&&(e.employee.id==l.value.updatedBy.id?U=!0:U=!1);let m=!1;!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.visibility)&&l.value.style.visibility=="readonly"&&(m=!0);let b=!0,f;return l.value.category=="cbmCalculateAvg"&&(e.stateSelectedSubGroups.find(F=>F.taskGroup.some(J=>J.task.some(_=>_.items.some(O=>(O.key==l.value.targetCalculateKeyId&&(f=O),O.key==l.value.targetCalculateKeyId))))),!t.isUndefined(f.updatedBy)&&!t.isUndefined(f.updatedBy.id)&&(e.employee.id==f.updatedBy.id?b=!0:b=!1)),h||!w||m||!U||!b});const d=i(()=>s.generalStyle?!t.isUndefined(l.value.style)&&l.value.style.breakPoint!="none"?`col-${l.value.style.breakPoint}`:"col":""),p=i(()=>{let h="pb-2";return!t.isUndefined(s.task.updatedBy.name)&&s.task.updatedBy.name&&(h=""),h}),u=i(()=>{var V,K,q,A;const h=!t.isUndefined(l.value.style)&&l.value.style.bgColor!="none"?`background-color: ${l.value.style.bgColor}; `:"",w=!t.isUndefined(l.value.style)&&l.value.style.fontColor!="none"?`color: ${l.value.style.fontColor}; `:"",U=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.border)&&l.value.style.border.top!="none"?`border-top: ${l.value.style.border.top}; `:"",m=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.border)&&l.value.style.border.right!="none"?`border-right: ${l.value.style.border.right}; `:"";let b=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.border)&&l.value.style.border.bottom!="none"?`border-bottom: ${l.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!t.isUndefined((V=s.task)==null?void 0:V.isShowAdjustmentRow)&&((K=s.task)!=null&&K.isShowAdjustmentRow))b="";else{let P=0;(q=s.task)==null||q.items.forEach(I=>{var x;t.isUndefined(I.style)||(t.isUndefined(I.style.border)?t.isUndefined(I.style.border)&&(P=P+Number(I.style.breakPoint)):((I.style.border.right=="none"||t.isUndefined(I.style.border.right))&&(P=P+Number(I.style.breakPoint)),t.isEqual(I,t.last((x=s.task)==null?void 0:x.items))&&(P=P+Number(I.style.breakPoint))))}),P==12&&(b=!((A=s.task.updatedBy)!=null&&A.name)&&!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.border)&&l.value.style.border.bottom!="none"?`border-bottom: ${l.value.style.border.bottom}; margin-bottom: 1rem;`:"")}const f=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.border)&&l.value.style.border.left!="none"?`border-left: ${l.value.style.border.left}; `:"",F=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.borderRadius)&&l.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${l.value.style.borderRadius.topRight}; `:"",J=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.borderRadius)&&l.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${l.value.style.borderRadius.bottomRight}; `:"",_=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.borderRadius)&&l.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${l.value.style.borderRadius.topLeft}; `:"",O=!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.borderRadius)&&l.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${l.value.style.borderRadius.bottomLeft}; `:"";return`${h}${w}${U}${m}${b}${f}${F}${J}${_}${O}`}),g=i(()=>{let h="Please Input";return!t.isUndefined(l.value.style)&&!t.isUndefined(l.value.style.placeholder)&&(h=l.value.style.placeholder),h});return xt(async()=>{o.value=l.value.value,v.value=l.value.value}),(h,w)=>(c(),$("div",{class:we([[d.value,y.value,p.value],"px-2 pt-2 input-eform-status"]),style:ce(u.value)},[n("div",Cd,[Wt(n("input",{type:"text",class:"form-control",disabled:"","onUpdate:modelValue":w[0]||(w[0]=U=>v.value=U)},null,512),[[ps,v.value]]),n("label",null,Ie(g.value),1)])],6))}}),Ud={key:1,class:"row w-100",style:{height:"25px"}},_d=n("div",{class:"col-1"},null,-1),Id=Ue({__name:"InlineTask",props:{task:{type:Object,required:!0},taskIndex:{type:Number,required:!0},taskGroup:{type:Array,required:!0}},setup(r){const s=r,e=i(()=>{let m=12,b=0;return s.task.items.every(f=>!t.isUndefined(f.style)&&f.style.visibility=="hidden"?(m=Number(m)-Number(f.style.breakPoint),b=Number(b)+Number(f.style.breakPoint),!0):!1),`col-${m} offset-${b}`}),l=k(""),a=k(""),o=i(()=>{let m=0;return s.task.items.forEach((b,f)=>{if(f+1==s.task.items.length&&b.itemType=="dropDown"){const F=s.task.items[f-1];!t.isUndefined(F.style)&&!t.isUndefined(F.style.border)&&F.style.border.right!="none"&&(s.task.items.length==3?m=Number(F.style.breakPoint)-1:s.task.items.forEach((J,_)=>{if(_>1&&_<=f-1){let O=0;if(!t.isUndefined(J.style.potraitBreakPoint))O=J.style.potraitBreakPoint;else{let V=0;J.style.breakPoint=="none"?(s.task.items.forEach((K,q)=>{K.style.breakPoint!="none"&&(V+=Number(K.style.breakPoint))}),O=12-V):O=J.style.breakPoint-V}m+=Number(O)}}))}}),m}),v=i(()=>{let m=0;return s.task.items.forEach((b,f)=>{if(f+1==s.task.items.length&&b.itemType=="dropDown"){const F=s.task.items[f-1];!t.isUndefined(F.style)&&!t.isUndefined(F.style.border)&&F.style.border.right!="none"&&(s.task.items.length==3?m=Number(F.style.breakPoint)-1:s.task.items.forEach((J,_)=>{if(_>1&&_<=f-1){let O=0,V=0;J.style.breakPoint=="none"?(s.task.items.forEach((K,q)=>{K.style.breakPoint!="none"&&(V+=Number(K.style.breakPoint))}),O=12-V):O=J.style.breakPoint-V,m+=Number(O)}}))}}),m}),y=i(()=>{let m=!1,b=!1,f=!1;return s.task.items.forEach((F,J)=>{if(J==1&&!t.isUndefined(F.style)&&!t.isUndefined(F.style.border)&&F.style.border.left!="none"&&(m=!0,l.value=F.style.border.left,!t.isUndefined(F.style)&&!t.isUndefined(F.style.border)&&F.style.border.bottom!="none"&&(f=!0)),J+1==s.task.items.length&&F.itemType=="dropDown"){const _=s.task.items[J-1];!t.isUndefined(_.style)&&!t.isUndefined(_.style.border)&&_.style.border.right!="none"&&(b=!0,a.value=_.style.border.right)}}),m&&b&&!f}),d=k(!1),p=m=>{d.value=m},u=i(()=>{let m=40;return d.value&&(m=60),m}),g=i(()=>{const m=s.task.items.find(_=>_.style.visibility!="hidden"),b=t.last(s.task.items),f=!t.isUndefined(b.style)&&!t.isUndefined(b.style.border)&&b.style.border.right!="none"?`border-right: ${b.style.border.right}; `:"",F=!t.isUndefined(m.style)&&!t.isUndefined(m.style.border)&&m.style.border.left!="none"?`border-left: ${m.style.border.left}; `:"",J=s.task.updatedBy.name&&!t.isUndefined(b.style)&&!t.isUndefined(b.style.border)&&b.style.border.bottom!="none"?"margin-bottom: 1rem; ":"";return f?`${f}${F}${J}`:`${J}`}),h=i(()=>{var f,F;let m="";const b=t.last(s.task.items);return!t.isUndefined((f=s.task)==null?void 0:f.isShowAdjustmentRow)&&((F=s.task)!=null&&F.isShowAdjustmentRow)?m="":m=s.task.updatedBy.name&&!t.isUndefined(b.style)&&!t.isUndefined(b.style.border)&&b.style.border.bottom!="none"?`border-bottom: ${b.style.border.bottom}; `:"",m}),w=i(()=>{let m="";return t.isUndefined(s.task.generalStyle)||(m=s.task.generalStyle),m}),U=i(()=>{let m="";const b=s.task.customStyle;return t.isUndefined(b)||b.split(" | ").forEach(F=>{F.includes("noteStyle")&&!t.isUndefined(s.taskGroup[s.taskIndex-1].updatedBy.name)&&s.taskGroup[s.taskIndex-1].updatedBy.name&&(m=`${m} ${F.split(" = ")[1]}`)}),m});return(m,b)=>(c(),$(Ve,null,[n("div",{class:"row w-100",style:ce([w.value,U.value])},[(c(!0),$(Ve,null,nt(s.task.items,f=>(c(),$(Ve,{key:f.key},[f.itemType==="image"?(c(),Z(ls,{key:0,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="label"?(c(),Z(os,{key:1,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="dropDown"?(c(),Z(rs,{key:2,item:f,task:r.task,onSetLoading:p},null,8,["item","task"])):D("",!0),f.itemType==="input"?(c(),Z(ns,{key:3,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="smallCamera"?(c(),Z(is,{key:4,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="checkbox"?(c(),Z(us,{key:5,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="html"?(c(),Z(ka,{key:6,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="button"?(c(),Z(ds,{key:7,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="statusInfo"?(c(),Z(ha,{key:8,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="radioButtonWithStatus"?(c(),Z(hd,{key:9,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="textAreaInput"?(c(),Z(Sd,{key:10,item:f,task:r.task},null,8,["item","task"])):D("",!0),f.itemType==="inputWithPlaceholder"?(c(),Z(wd,{key:11,item:f,task:r.task},null,8,["item","task"])):D("",!0)],64))),128))],4),r.task.updatedBy.name?(c(),$("div",{key:0,class:"row w-100 position-absolute pe-3",style:ce(`top: ${u.value}px;`)},[n("div",{class:we(["d-flex justify-content-end pb-1 my-0 timestamp-task",e.value]),style:ce([g.value,h.value])},null,6)],4)):D("",!0),r.task.updatedBy.name?(c(),$("div",Ud,[y.value?(c(),$(Ve,{key:1},[_d,n("div",{class:"col-1",style:ce(`border-left: ${l.value}`)},null,4),n("div",{class:we(`col-md-${o.value} col-lg-${v.value}`),style:ce(`border-right: ${a.value}`)},null,6)],64)):(c(),$("div",{key:0,style:ce(g.value),class:we(e.value)},null,6))])):D("",!0),r.task.isShowAdjustmentRow?(c(),Z(ud,{key:2,task:r.task},null,8,["task"])):D("",!0)],64))}}),$d=Ue({__name:"TableRow",props:{item:{type:Object,required:!0},task:{type:Object},itemLoading:{type:Boolean,default:!1}},setup(r){const s=r,e=i(a=>{const o=[];for(const v in s.item)o.push(s.item[v]);return o}),l=a=>{let o="";return!t.isUndefined(a.style)&&!t.isUndefined(a.style.textvAlign)&&(o=`align-self-${a.style.textvAlign}`),o};return(a,o)=>(c(!0),$(Ve,null,nt(e.value,v=>(c(),$("div",{class:we([l(v),"eform-table-row col px-0"]),key:v.key},[v.itemType==="image"?(c(),Z(ls,{key:0,item:v,task:r.task},null,8,["item","task"])):D("",!0),v.itemType==="label"?(c(),Z(os,{key:1,item:v,task:r.task},null,8,["item","task"])):D("",!0),v.itemType==="input"?(c(),Z(ns,{key:2,item:v,task:r.task,"item-loading":r.itemLoading},null,8,["item","task","item-loading"])):D("",!0),v.itemType==="dropDown"?(c(),Z(rs,{key:3,item:v,task:r.task,"item-loading":r.itemLoading},null,8,["item","task","item-loading"])):D("",!0),v.itemType==="smallCamera"?(c(),Z(is,{key:4,item:r.item,task:r.task},null,8,["item","task"])):D("",!0),r.item.itemType==="checkbox"?(c(),Z(us,{key:5,item:r.item,task:r.task},null,8,["item","task"])):D("",!0),v.itemType==="html"?(c(),Z(ka,{key:6,item:v,task:r.task},null,8,["item","task"])):D("",!0),r.item.itemType==="button"?(c(),Z(ds,{key:7,item:r.item,task:r.task},null,8,["item","task"])):D("",!0),r.item.itemType==="statusInfo"?(c(),Z(ha,{key:8,item:r.item,task:r.task},null,8,["item","task"])):D("",!0)],2))),128))}}),Td={class:"row w-100 mx-0 mb-5"},Rd={key:0,class:"col-1 px-2"},Pd={class:"row text-center task-table__header py-2 w-100"},Bd=Ue({__name:"TableTask",props:{task:{type:Object,required:!0}},setup(r){const s=r,e=i(()=>s.task.header.replaceAll("'","").replace("[","").replace("]","").split(", ")),l=p=>{let u="";return!t.isUndefined(s.task.style)&&!t.isUndefined(s.task.style.borderBottom)&&s.task.style.borderBottom=="none"?u="":u="border-bottom-table",p+1==s.task.items.length&&(u="border-bottom-table"),u},a=bt(),o=i(()=>s.task),v=k(!1),y=i(()=>{let p="";if(t.isUndefined(s.task.disabledByItemKey))return p;const u=a.stateStoredDisableKeyValue.find(g=>g.key==s.task.disabledByItemKey);return t.isUndefined(u)||(p=u.value),p});ke(y,async p=>{p=="3"&&d()},{deep:!0});const d=async()=>{if(!t.isUndefined(s.task.disabledByItemKey)){let p=a.stateStoredDisableKeyValue.find(u=>u.key==s.task.disabledByItemKey);if(t.isUndefined(p)){const u=await a.getValueFromItemKey(s.task.disabledByItemKey);a.pushStoredDisabledItems({key:s.task.disabledByItemKey,value:u})}if(p=a.stateStoredDisableKeyValue.find(u=>u.key==s.task.disabledByItemKey),(p==null?void 0:p.value)=="3"){const u=[];s.task.items.forEach(g=>{for(var h in g){const w=g[h];if(!t.isUndefined(w.disabledByItemKey)&&w.value){const U={keyValue:w.key,propertyParams:[{propertyName:"value",propertyValue:""},{propertyName:"updatedBy",propertyValue:""},{propertyName:"updatedDate",propertyValue:""}]};u.push(U)}}}),u.length>0&&(v.value=!0,await a.updateItemFromTask(u),v.value=!1)}}};return(p,u)=>(c(),$("div",Td,[!W(t.isUndefined)(o.value.style)&&o.value.style.category=="taskTable"?(c(),$("div",Rd)):D("",!0),n("div",{class:we(["task-table",!W(t.isUndefined)(o.value.style)&&o.value.style.category=="taskTable"?"col-11 px-0":"col-12 pe-0"])},[n("label",null,Ie(o.value.description),1),n("div",Pd,[(c(!0),$(Ve,null,nt(e.value,g=>(c(),$("div",{class:"col font-weight-normal task-table__header__item",key:g},Ie(g),1))),128))]),(c(!0),$(Ve,null,nt(o.value.items,(g,h)=>(c(),$("div",{key:g.key,class:we(["row w-100 task-table__body d-flex align-items-start",l(h)])},[j($d,{item:g,task:o.value,"item-loading":v.value},null,8,["item","task","item-loading"])],2))),128))],2)]))}}),cs=$t(Bd,[["__scopeId","data-v-00e91d75"]]),Vd={class:"row w-100 mt-3 mb-3"},Nd={key:0,class:"col-1 px-2"},xd={class:"small-hyperlink-text-style"},Dd=Ue({__name:"CollapsibleTableTask",props:{task:{type:Object,required:!0}},setup(r){const s=r,e=k("open"),l=i(()=>{let a="";return!t.isUndefined(s.task.style)&&!t.isUndefined(s.task.style.defaultCollapse)&&(a=s.task.style.defaultCollapse),a});return(a,o)=>{const v=ne("el-collapse-item"),y=ne("el-collapse");return c(),$("div",Vd,[!W(t.isUndefined)(r.task.style)&&r.task.style.collapseCategory=="taskTable"?(c(),$("div",Nd)):D("",!0),n("div",{class:we(["task-table collapsible-table-container",!W(t.isUndefined)(r.task.style)&&r.task.style.collapseCategory=="taskTable"?"col-11 px-0":"col-12 pe-0"])},[j(y,{class:"task-group general-accordion py-1 px-5",modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value=d)},{default:le(()=>[j(v,{name:l.value},{title:le(()=>[n("span",xd,Ie(r.task.triggerCaption),1)]),default:le(()=>[j(cs,{task:r.task},null,8,["task"])]),_:1},8,["name"])]),_:1},8,["modelValue"])],2)])}}}),Ad=Ue({__name:"TaskGroup",props:{taskGroup:{type:Object,required:!0}},setup(r){const s=r,e=Te(()=>s.taskGroup.key);return(l,a)=>{const o=ne("el-collapse-item"),v=ne("el-collapse");return c(),Z(v,{modelValue:W(e),"onUpdate:modelValue":a[0]||(a[0]=y=>Et(e)?e.value=y:null),class:"task-group e-form-only py-1 px-5 mb-3"},{default:le(()=>[j(o,{title:r.taskGroup.name,name:r.taskGroup.key},{default:le(()=>[(c(!0),$(Ve,null,nt(s.taskGroup.task,(y,d)=>(c(),$("div",{key:y.key,class:"ps-3 position-relative"},[y.taskType=="inline"?(c(),Z(Id,{key:0,task:y,"task-index":d,"task-group":r.taskGroup.task},null,8,["task","task-index","task-group"])):D("",!0),y.taskType==="table"?(c(),Z(cs,{key:1,task:y},null,8,["task"])):D("",!0),y.taskType=="collapsibleTable"?(c(),Z(Dd,{key:2,task:y},null,8,["task"])):D("",!0)]))),128))]),_:1},8,["title","name"])]),_:1},8,["modelValue"])}}}),Fd={class:"ps-0 mt-5"},Od={class:"card"},Ed=Ue({__name:"SubGroup",props:{subGroup:{type:Object,required:!0}},setup(r){const s=r;return(e,l)=>(c(),$("div",Fd,[n("div",Od,[(c(!0),$(Ve,null,nt(s.subGroup.taskGroup,a=>(c(),Z(Ad,{key:a.key,"task-group":a},null,8,["task-group"]))),128))])]))}}),Ld={class:"el-dialog__title"},jd={class:"row text-center pt-5 justify-content-end",style:{"word-break":"normal"}},Md={class:"row px-2"},Hd={class:"col-2"},Kd=Ue({__name:"Index",props:{show:{type:Boolean,required:!0}},emits:["close","onConfrimSubmit"],setup(r,{emit:s}){const e=r,l=s,a=da(),o=Te(()=>e.show),v=Te(()=>{let p=!1;return a.stateValidation.forEach(u=>{if(!u.value||u.value=="false"){console.log("item",u),p=!0;return}}),p}),y=async()=>{const p=Ye.service({lock:!0,text:"Loading the page",background:"rgba(0, 0, 0, 0.7)"});await a.submitForm(),d(),p.close(),await l("onConfrimSubmit")},d=()=>{l("close")};return(p,u)=>{const g=ne("el-button"),h=ne("el-dialog");return c(),Z(h,{modelValue:W(o),"onUpdate:modelValue":u[0]||(u[0]=w=>Et(o)?o.value=w:null),width:"90%","custom-class":"el-defect-crack-form-custom",onClosed:d,"destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},{title:le(()=>[n("span",Ld,Ie(W(a).stateSCCalibration.subGroup[0].name),1)]),default:le(()=>[n("div",jd,[n("div",Md,[(c(!0),$(Ve,null,nt(W(a).stateSCCalibration.subGroup,w=>(c(),Z(Ed,{key:w.key,subGroup:w},null,8,["subGroup"]))),128))]),n("div",Hd,[j(g,{type:"success",disabled:W(v),class:"ok-button",onClick:y},{default:le(()=>[yt("Submit")]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"])}}}),Gd=Ea({id:"InterimSuspensionCylinderForm",state:()=>({stateShowSuspensionCylinderHeightForm:!1,stateShowPreviewSuspensionCylinderHeightForm:!1,stateSCCalibration:{},stateSCHeader:{},stateupdateParams:[],stateValidation:[]}),getters:{ShowSuspensionCylinderHeightForm:r=>r.stateShowSuspensionCylinderHeightForm,ShowPreviewSuspensionCylinderHeightForm:r=>r.stateShowPreviewSuspensionCylinderHeightForm,eformStore:()=>vt(),generalFormStore:()=>Zt()},actions:{toggleShowPreviewSuspensionCylinderHeightForm(r){this.stateShowPreviewSuspensionCylinderHeightForm=r},toggleShowSuspensionCylinderHeightForm(r){this.stateShowSuspensionCylinderHeightForm=r,r||(this.stateupdateParams=[],this.stateValidation=[])},async getSuspensionCalibrationTemplate(r){try{const s=await Ht.post(`${pl}?${new URLSearchParams(_a).toString()}`,r);return this.stateSCCalibration=s.data.result.content.detail,this.stateSCHeader=s.data.result.content.header,!0}catch(s){return ya("IRONS",s),console.log("error getSuspensionCalibrationTemplate",s),!1}},generatePreAnsweredInput(){const r=(s,e)=>({keyValue:e,propertyParams:[{propertyName:"value",propertyValue:s},{propertyName:"updatedBy",propertyValue:JSON.stringify(this.eformStore.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]});this.stateSCCalibration.subGroup.forEach(s=>{s.taskGroup.forEach(e=>{e.task.forEach(l=>{l.items.forEach(a=>{if(a.itemType=="inputWithPlaceholder"&&!t.isUndefined(a.style)&&!t.isUndefined(a.style.placeholder))switch(a.style.placeholder){case"Truck ID Number":a.value=this.stateSCHeader.equipment,this.addUpdateParams(r(a.value,a.key));break;case"Machine SMU":a.value=this.generalFormStore.generalForm.smu,this.addUpdateParams(r(a.value,a.key));break;case"Truck Serial Number":a.value=this.stateSCHeader.serialNumber,this.addUpdateParams(r(a.value,a.key));break;case"Calibration Date":a.value=`${ia(this.generalFormStore.stateTimeZone)} ${this.generalFormStore.stateTimeZoneDesc}`;break}})})})})},addUpdateParams(r){let s=this.stateupdateParams.find(e=>e.keyValue==r.keyValue);t.isUndefined(s)?this.stateupdateParams.push(r):(s=r,this.stateupdateParams.forEach(e=>{e.keyValue==r.keyValue&&(e.propertyParams=r.propertyParams)})),console.log("item after update",this.stateupdateParams)},deleteParams(r){this.stateupdateParams=this.stateupdateParams.filter(s=>s.keyValue!=r),console.log("item after delete",this.stateupdateParams)},generateValidateInput(){console.log("this.stateSCCalibration",this.stateSCCalibration),this.stateSCCalibration.subGroup.forEach(r=>{r.taskGroup.forEach(s=>{s.task.forEach(e=>{e.items.forEach(l=>{if(l.isTaskValue){const a={key:l.key,value:l.value};this.stateValidation.push(a)}})})})}),console.log("statevalidation",this.stateValidation)},updateValidationValue(r){this.stateValidation.forEach(s=>{s.key==r.key&&(s.value=r.value)})},async submitForm(){this.stateSCCalibration.subGroup.forEach(a=>{a.taskGroup.forEach(o=>{o.task.forEach(v=>{v.items.forEach(y=>{if(y.itemType=="inputWithPlaceholder"&&!t.isUndefined(y.style)&&!t.isUndefined(y.style.placeholder)&&y.style.placeholder=="Calibration Date"){const d={keyValue:y.key,propertyParams:[{propertyName:"value",propertyValue:"<<ServerDateTime>>"},{propertyName:"updatedBy",propertyValue:JSON.stringify(this.eformStore.employee)},{propertyName:"updatedDate",propertyValue:"<<ServerDateTime>>"}]};this.addUpdateParams(d)}})})})});const r={headerId:this.stateSCCalibration.headerId,workorder:this.stateSCHeader.workOrder,id:this.stateSCCalibration.id,updateParams:this.stateupdateParams,employee:this.eformStore.employee},s=await Ht.post(`${bl}?${new URLSearchParams(_a).toString()}`,r);console.log("berhasil update detail",s);const e={id:this.stateSCHeader.id,updateParams:[{propertyParams:[{propertyName:"status",propertyValue:"Submitted"}]}],employee:this.eformStore.employee},l=await Ht.post(`${gl}?${new URLSearchParams(_a).toString()}`,e);console.log("berhasil update header",l)}}}),qd=r=>(zt("data-v-95313805"),r=r(),Xt(),r),Yd={class:"navbar navbar-light bg-light"},Jd={class:"container-fluid"},Wd={class:"d-flex"},zd={class:"me-2"},Xd={key:0,class:"h-100 w-100",style:{"background-color":"white"}},Zd={key:1,class:"row m-0 mt-25 p-5 bg-white e-form-container interim-container"},Qd={class:"p-2 flex-fill mt-6"},ec={class:"form-check checkbox-success"},tc=["disabled"],ac=qd(()=>n("label",{class:"fw-bolder",style:{color:"black !important","font-size":"15px"},for:"agreement"}," I have read and understood all safety precautions listed above ",-1)),sc={class:"p-2 py-5 d-flex justify-content-end mt-20 border-top border-top-2"},lc=["disabled"],oc=["disabled"],rc=["disabled"],nc=Ue({__name:"Index",setup(r){const s=Zt(),e=Dt(),l=vt(),a=Ta(),o=Ka(),v=cl(),y=hs(),d=Vt(),p=Gd(),u=i(()=>ft.value?ft.value.name:""),g=i(()=>s.generalUpdated),h=i(()=>l.stateShowSCConfirmToSPC),w=i(()=>l.stateShowConfirmToCalibrateSC),U=i(()=>l.stateShowSCAdjustmentWarning),m=i(()=>l.stateShowPreTaskNotComplete),b=i(()=>l.taskErrorDialog),f=i(()=>l.errorMessageTaskErrorDialog),F=ee=>{l.toggleShowSCConfirmToSPV(ee)},J=()=>{l.toggleShowPreTaskNotComplete(!1),l.handleScrollToUnfilledTask()},_=ee=>{l.toggleShowSCdjustmentWarning(ee)},O=ee=>{l.toggleShowConfirmToCalibrateSC(ee)},V=async()=>{const ee={modelId:l.stateGeneralForm.modelId,psTypeId:l.stateGeneralForm.psTypeId,unitNumber:l.stateGeneralForm.equipment,workOrder:l.stateGeneralForm.workOrder,employee:{id:e.stateUser.EmployeeId,name:e.stateUser.Name}};await p.getSuspensionCalibrationTemplate(ee),p.generateValidateInput(),p.generatePreAnsweredInput(),p.stateSCHeader.status!="Submitted"?p.toggleShowSuspensionCylinderHeightForm(!0):kt.value=!0},K=i(()=>d.stateSubmitConnectionError),q=()=>{d.setSubmitConnectionError(!1)},A=i(()=>l.stateIsFormSelectedByOtherSupervisor),P=()=>{l.changeIsFormSelectedByOtherSupervisor(!1),Ne.value=!0,H.push({name:"ironforms"})},I=async()=>{const ee=Ye.service({lock:!0,text:"Loading the page",background:"rgba(0, 0, 0, 0.7)"});s.updateGeneralUpdated(!0);const re=l.groups.find(Fe=>{if((t.isUndefined(Fe.isDisable)||Fe.isDisable=="false")&&Fe.groupName!="General")return!0});l.setSelectedGroup(re.id),await l.updateGroupByParam(re.groupName),window.scrollTo({top:0,behavior:"smooth"}),ee.close()},x=i(()=>{let ee="";return!t.isUndefined(l.generalForm)&&!t.isUndefined(l.generalForm.version)&&(ee=l.generalForm.version),ee}),T=i(()=>a.Visible),L=i(()=>a.ViewVisible),z=i(()=>l.groups),ue=i(()=>!t.isUndefined(l.generalForm)&&!t.isUndefined(l.generalForm.status)&&l.generalForm.status=="Submited"?!1:!t.isEmpty(l.employee.id)),be=i(()=>l.percentageTaskProgressAllTab),Ee=i(()=>l.ratingNotMapped),Q=()=>{l.toggleNotMapped(!1)},N=k(!1),Y=k(!1),te=k(!1),ie=k(!1),ae=k(!1),Ne=k(!1),Ze=k(!1),Je=k(!1),Qe=k("00:00:00"),ct=k(),B=k(),G=k(!1),me=k(!1),Re=kl(),pe=Ra(),he=k(),xe=k(""),Me=k(null),ot=i(()=>l.formAlreadySubmitted),E=i(()=>l.formAlreadyClose),oe=ee=>{ct.value.timer.reset(),Qe.value=ee,ct.value.timer.updateCLock(ee),ct.value.continueTimer()},ge=i(()=>l.generalForm.hmOffset?Number(l.generalForm.hmOffset):0),Pe=i(()=>{const ee=s.smuActual,re=s.smuTolerance;return Number(Number(ee)+Number(re.min))}),Oe=i(()=>{const ee=s.smuActual,re=s.smuTolerance;return Number(Number(ee)+Number(re.max))}),We=i(()=>{let ee;if(!t.isUndefined(l.generalForm.smu))ee=l.generalForm.smu;else if(!t.isUndefined(s.payload.updateParams)){const qe=s.payload.updateParams.find($e=>$e.keyValue=="GENERAL");if(!t.isUndefined(qe)){const $e=qe.propertyParams.find(at=>at.propertyName=="smu");t.isUndefined($e)||(ee=$e.propertyValue)}}let re=Bt(t.cloneDeep(ee));const Fe=Number(re)+Number(ge.value)>=Pe.value,Ge=Number(re)+Number(ge.value)<=Oe.value;return!!(ee!=""&&Fe&&Ge)}),C=i(()=>{let ee=!1,re=!1,Fe=!0,Ge=!0;if(!We.value&&!t.isUndefined(l.generalForm.imageEquipment)&&(l.generalForm.imageEquipment==""||l.generalForm.imageEquipment.length==0)&&(Ge=!1),!t.isUndefined(l.generalForm.smu)&&l.generalForm.smu!="")ee=!0;else if(!t.isUndefined(s.payload.updateParams)){const qe=s.payload.updateParams.find($e=>$e.keyValue=="GENERAL");if(!t.isUndefined(qe)){const $e=qe.propertyParams.find(at=>at.propertyName=="smu");t.isUndefined($e)||$e.propertyValue!=""&&(ee=!0)}}if(!t.isUndefined(s.payload.updateParams)){const qe=s.payload.updateParams.find($e=>$e.keyValue=="GENERAL");if(!t.isUndefined(qe)){const $e=qe.propertyParams.find(at=>at.propertyName=="servicePersonnels");t.isUndefined($e)||$e.propertyValue!=""&&(re=!0)}}return t.isUndefined(ft.value.id)||ft.value.id==""?re=!1:re=!0,ee&&re&&Ge&&(Fe=!1),G.value&&(Fe=!0),Fe}),H=il(),fe=()=>{ct.value.timer.reset(),ct.value.startTimer()},Se=i(()=>l.taskAlreadyUpdated),ve=i(()=>s.stateIsTruckAlreadyCheckedByOtherFitter),_e=i(()=>!s.generalUpdated),je=ee=>{Qe.value=ee},Ae=ee=>{Qe.value=ee},He=k(!1),Ke=ee=>{d.stateConnectionStatus?(Qe.value=ee,Y.value=!0):d.setSubmitConnectionError(!0)},rt=async()=>{Y.value=!1;const ee=Ye.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{const re=s.CurrentPersoneel;re.serviceEnd="<<ServerDateTime>>";const Fe={propertyName:"servicePersonnels",propertyValue:JSON.stringify(re)};await s.UpdateServiceEndMechanic(Fe)}catch(re){console.log("error filtering service personnel on closing eform",re)}ee.close(),te.value=!0,Ne.value=!0},Ct=()=>{te.value=!1,H.push({name:"ironforms"})},gt=i(()=>(console.log("check",t.isEmpty(l.employee)),t.isEmpty(l.employee))),et=k(!1),R=i(()=>l.isAllTaskDone),X=async()=>{const ee=Ye.service({lock:!0,text:"Loading Interim Form",background:"rgba(0, 0, 0, 0.7)"});if(s.addUpdatedByAndDate(e.user.EmployeeId,e.user.Name),N.value=!1,await s.updateGeneralForm())Ze.value=!0,window.scrollTo({top:0,behavior:"smooth"}),ee.close();else{ws("submitted","true"),await l.postGenerateServiceSheet(e.user.EmployeeId,e.user.Name,e.user.SiteId),l.setSerialNumberGeneral(pe.SerialNumber),s.stateGeneralUpdated=!0;const Fe=l.groups.find(Ge=>{if((t.isUndefined(Ge.isDisable)||Ge.isDisable=="false")&&Ge.groupName!="General")return!0});l.setSelectedGroup(Fe.id),await l.updateGroupByParam(Fe.groupName),window.scrollTo({top:0,behavior:"smooth"}),et.value=!0,ee.close()}Re.updateSelectedWO(l.generalForm.workOrder,l.generalForm.modelId,l.generalForm.equipment,l.generalForm.psTypeId)},de=()=>{Y.value=!1},ye=_t(),Be=()=>{ye.setShowCloseButton(!1),B.value.triggerCamera(),s.setFitterInfoIsIHaveReadChecked(!0),N.value=!1,G.value=!0},ze=()=>{N.value=!1,G.value=!1},it=i(()=>{let ee="";return t.isUndefined(l.generalForm)||t.isUndefined(l.generalForm.form)||(ee=l.generalForm.form),ee.replace("e-Form","")}),pt=i(()=>{let ee=!0,re=!1,Fe=!1,Ge=!0,qe=!1,$e=!1,at=!1,Ut=!1;if(!t.isUndefined(l.generalForm.smu)&&l.generalForm.smu!="")re=!0;else if(!t.isUndefined(s.payload.updateParams)){const M=s.payload.updateParams.find(se=>se.keyValue=="GENERAL");if(!t.isUndefined(M)){const se=M.propertyParams.find(Ce=>Ce.propertyName=="smu");t.isUndefined(se)||se.propertyValue!=""&&(re=!0)}}if(s.IsFitterLoggedInExist)Fe=!0;else if(!t.isUndefined(s.payload.updateParams)){const M=s.payload.updateParams.find(se=>se.keyValue=="GENERAL");if(!t.isUndefined(M)){const se=M.propertyParams.find(Ce=>Ce.propertyName=="servicePersonnels");t.isUndefined(se)||se.propertyValue!=""&&(Fe=!0)}}if(s.IsFitterLoggedInExist?ft.value.id==s.FitterInfo.employee.id&&ut().length>1&&($e=!0):s.IsSelectedFitterAlreadyLoggedIn?$e=!0:$e=s.IsRiskAssesmentPhotoTaken,l.generalForm.checkBeforeTruck.items.forEach(M=>{M.value=="false"&&(Ge=!1)}),t.isUndefined(l.generalForm.swingHour))at=!0;else if(!t.isUndefined(l.generalForm.swingHour)&&l.generalForm.swingHour!="")at=!0;else if(!t.isUndefined(s.payload.updateParams)){const M=s.payload.updateParams.find(se=>se.keyValue=="GENERAL");if(!t.isUndefined(M)){const se=M.propertyParams.find(Ce=>Ce.propertyName=="swingHour");t.isUndefined(se)||se.propertyValue!=""&&(at=!0)}}if(t.isUndefined(l.generalForm.travelHour))Ut=!0;else if(!t.isUndefined(l.generalForm.travelHour)&&l.generalForm.travelHour!="")Ut=!0;else if(!t.isUndefined(s.payload.updateParams)){const M=s.payload.updateParams.find(se=>se.keyValue=="GENERAL");if(!t.isUndefined(M)){const se=M.propertyParams.find(Ce=>Ce.propertyName=="travelHour");t.isUndefined(se)||se.propertyValue!=""&&(Ut=!0)}}let St=!1;(t.isUndefined(l.generalForm.isSwingTravelRequired)||l.generalForm.isSwingTravelRequired=="true"&&at&&Ut||l.generalForm.isSwingTravelRequired=="false"||l.generalForm.isSwingTravelRequired=="")&&(St=!0);let st=!1;(t.isUndefined(l.generalForm.isTravelRequired)||l.generalForm.isTravelRequired=="true"&&Ut||l.generalForm.isTravelRequired=="false"||l.generalForm.isTravelRequired=="")&&(st=!0);let S=!1;return(t.isUndefined(l.generalForm.isSwingRequired)||l.generalForm.isSwingRequired=="true"&&at||l.generalForm.isSwingRequired=="false"||l.generalForm.isSwingRequired=="")&&(S=!0),G.value&&(qe=!0),re&&Fe&&Ge&&qe&&$e&&St&&S&&st&&(ee=!1),ee}),wt=i(()=>l.selectedSubGroups),Xe=i(()=>l.generalForm),ut=()=>{let ee=[];if(!Array.isArray(s.generalForm.riskAssesment[0].value))return ee;const re=l.employee;return ee=s.generalForm.riskAssesment[0].value.filter(Fe=>{const Ge=Fe;if(Ge.updatedBy.id==re.id)return Ge}),ee.slice(0,2)},dt=()=>{var ee,re,Fe,Ge;if(G.value){let qe=!1,$e=!1,at=!1,Ut=!1,St=!1;if(t.isUndefined(Xe.value.swingHour))qe=!0;else if(Xe.value.swingHour===""){const st=l.generalForm.isSwingTravelRequired,S=l.generalForm.isSwingRequired,M=st&&String(st)==="true",se=S&&String(S)==="true";M||se?(ee=Me.value)==null||ee.showSwingRequired():(re=Me.value)==null||re.hideSwingRequired()}else qe=!0;if(t.isUndefined(Xe.value.travelHour))$e=!0;else if(Xe.value.travelHour===""){const st=l.generalForm.isSwingTravelRequired,S=l.generalForm.isTravelRequired,M=st&&String(st)==="true",se=S&&String(S)==="true";M||se?(Fe=Me.value)==null||Fe.showTravelRequired():(Ge=Me.value)==null||Ge.hideTravelRequired()}else $e=!0;if((t.isUndefined(l.generalForm.isSwingTravelRequired)||l.generalForm.isSwingTravelRequired=="false")&&(at=!0),l.generalForm.isSwingTravelRequired&&l.generalForm.isSwingTravelRequired=="true"&&qe&&$e&&(at=!0),(t.isUndefined(l.generalForm.isTravelRequired)||l.generalForm.isTravelRequired=="false")&&(Ut=!0),(t.isUndefined(l.generalForm.isSwingRequired)||l.generalForm.isSwingRequired=="false")&&(St=!0),l.generalForm.isTravelRequired&&l.generalForm.isTravelRequired=="true"&&$e&&(Ut=!0),l.generalForm.isSwingRequired&&l.generalForm.isSwingRequired=="true"&&qe&&(St=!0),!at||!Ut||!St){G.value=!1,hl("travel-swing");return}s.IsSelectedFitterAlreadyLoggedIn||(ut().length==0?xe.value="Take <strong>front page</strong> photo of your completed pre-task risk assessment.":xe.value="Take <strong>back page</strong> photo of your completed pre-task risk assessment.",N.value=!0)}},kt=k(!1),mt=()=>{xe.value="Take <strong>back page</strong> photo of your completed pre-task risk assessment.",N.value=!0},tt=async()=>{const ee=Ye.service({lock:!0,text:"Submitting e-form",background:"rgba(0, 0, 0, 0.7)"});kt.value=!1,await l.submitEform(),ee.close(),te.value=!0,Ne.value=!0},Lt=()=>{kt.value=!1},Qt=async()=>{const ee=Ye.service({lock:!0,text:"Opening Calibration form",background:"rgba(0, 0, 0, 0.7)"});await V(),ee.close()},Tt=async ee=>{ee&&(l.stateStoredSuspensionCylinderValue.filter(Fe=>Fe.value=="Out of spec"||Fe.value=="Out Spec").length>0&&l.stateStoredAdjustedSuspensionCylinderValue.length>0&&(l.stateStoredAdjustmentOptionValue=="2"||l.stateStoredAdjustmentOptionValue=="Yes")?await Qt():kt.value=!0)},ea=()=>{ie.value=!1},Gt=()=>{ae.value=!1},At=k(!1),ta=()=>{At.value=!1,window.location.href.includes("#!")||(window.location.href+="#!",H.currentRoute.value.hash="#!")},aa=()=>{const ee=s.generalForm.status,re=Ye.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});ee.toLowerCase()=="open"&&s.updateServiceSheetHeaderToTrue(),At.value=!1,re.close(),H.push({name:"ironforms"})},sa=()=>{const ee=H.currentRoute.value,re=window.location.href,Fe=ee.hash;re.includes("#!")||(window.location.href+="#!"),Fe.includes("#!")||(H.currentRoute.value.hash="#!");const Ge=ee.path;window.onpopstate=qe=>{Ge=="/ironforms/interim-engine-service"&&!H.currentRoute.value.hash.includes("#")&&qe.state&&(At.value=!0)}};$a(()=>{l.resetMechanic(),l.toogleTaskErrorDialog(!1)}),xt(async()=>{await s.getShiftListData(),a.resetInstance(),s.resetGeneral(),l.resetMechanic(),Ss("submitted");const ee=document.getElementById("offcanvasNavbar");ee!=null&&ee.addEventListener("show.bs.offcanvas",async()=>{if(me.value===!1){me.value=!0;const re=Ye.service({lock:!0,text:"Loading historical data",background:"rgba(0, 0, 0, 0.7)",target:ee});await y.getHistoricalFormData(l.statePsTypeId,l.stateModelId,l.stateUnitNumber),await y.getHistoricalDefectData(l.statePsTypeId,l.stateModelId,l.stateUnitNumber),re.close()}}),l.clearTruckCheckBoxes(),sa()});const ht=async()=>{s.setIsFitterLoggedInExist(!1)},ft=i(()=>l.employee);ke(ft,async ee=>{s.IsFitterLoggedInExist&&s.FitterInfo.employee.id==ee.id?G.value=s.FitterInfo.isIHaveReadChecked:G.value=!1},{deep:!0}),Ia(async()=>{var re,Fe;he.value=Ye.service({lock:!0,text:"Loading Interim Form",background:"rgba(0, 0, 0, 0.7)"}),Ne.value=!0,l.toggleIsShowCalibrationConfirm(!1),await v.getPositionDMA(),await s.getSMUTolerance(),l.getGroups(),l.getSubGroups(),await o.getPersonalLabours();const ee=await l.postGenerateServiceSheet(e.user.EmployeeId,e.user.Name,e.user.SiteId);s.getHmOffsetValue(e.user.SiteId),await pe.getOwnershipDefectForm(l.stateUnitNumber),l.setSerialNumberGeneral(pe.SerialNumber),l.stateGroups.forEach(Ge=>{Ge.groupName=="MECHANICAL_SERVICE"&&Ge.subGroup.forEach(qe=>{qe.key=="MECHANICAL_SERVICE"&&qe.taskGroup.forEach($e=>{if($e.key=="MECHANICAL_SERVICE_SUSPENSION"){let at=[],Ut=[];$e.task.forEach(St=>{St.items.forEach(st=>{st.categoryItemType=="suspensionTargetRating"&&at.push({key:st.key,value:st.value}),st.categoryItemType=="adjustmentSuspensionTargetRating"&&Ut.push({key:st.key,value:st.value})}),t.isUndefined(St.showParameter)||St.showParameter=="suspensionCylinder"&&l.updateStoredAdjustmentOptionValue(St.taskValue)}),l.pushDataToAdjustedSuspensionCylinderStoredValue(Ut),l.pushDataToSuspensionCylinderStoredValue(at)}})})}),l.updateStoredDisableKeyValue([]),!ee&&!l.stateIsFormSelectedByOtherSupervisor&&(Ne.value=!0,(re=he.value)==null||re.close(),he.value=void 0,Je.value=!0),s.setGeneralForm(l.generalForm),await ht(),await l.getEhmsRating(),await l.getOilTolerance(),y.reset(),s.setPayloadId(Xe.value.id,e.user.EmployeeId,e.user.Name),Ne.value=!1,(Fe=he.value)==null||Fe.close(),he.value=void 0});const Ft=()=>{l.toggleFormAlreadySubmitted(!1),rt()},Rt=()=>{l.toggleFormAlreadyClose(!1)},Ot=()=>{Je.value=!1,H.push({name:"ironforms"})},qt=async()=>{s.toggleIsTruckAlreadyCheckedByOtherFitter(!1)},jt=async()=>{var re;l.toggleTaskAlreadyUpdatedStatus(!1),l.toogleTaskErrorDialog(!1);const ee=Ye.service({lock:!0,text:"Reloading e-Form",background:"rgba(0, 0, 0, 0.7)"});await l.updateGroupByParam((re=l.selectedGroup)==null?void 0:re.groupName),l.getTaskProgress(),ee.close()},la=()=>{At.value=!0};return(ee,re)=>{var qe;const Fe=ne("NwImg"),Ge=ne("el-dialog");return c(),$(Ve,null,[n("nav",Yd,[n("div",Jd,[n("div",{class:"logo-wrapper d-flex align-items-center ms-1",onClick:la},[j(Fe,{style:{cursor:"pointer"},src:"/media/logos/logo-whitebg.png",class:"h-40px logo"})]),n("div",Wd,[n("div",zd,[j(ml)])])])]),Ne.value?(c(),$("div",Xd)):(c(),$("div",Zd,[j(Cs,{formName:`${it.value} (Ver. ${x.value})`,"form-status":Xe.value&&Xe.value.status,"percentage-progress":be.value,mechanicName:u.value,isGeneralUpdated:g.value},null,8,["formName","form-status","percentage-progress","mechanicName","isGeneralUpdated"]),j(_l,{groups:z.value},null,8,["groups"]),j(Js,{ref_key:"timer",ref:ct,onOnStart:je,onOnChange:Ae,onOnStop:Ke,visibility:ue.value,"is-disabled":_e.value},null,8,["visibility","is-disabled"]),(c(!0),$(Ve,null,nt(wt.value,$e=>(c(),$(Ve,{key:$e.key},[j(kr,{subGroup:$e},null,8,["subGroup"]),j(uu,{onSubmit:Tt,disabled:W(l).selectedGroup.doneTask!=W(l).selectedGroup.totalTask||gt.value},null,8,["disabled"])],64))),128)),((qe=z.value.find($e=>$e.isSelected))==null?void 0:qe.groupName)==="General"&&W(l).isSet?(c(),$(Ve,{key:0},[j(ti,{ref_key:"cardEquipment",ref:Me,data:Xe.value,timer:ct.value,onOnPersonelSelected:fe,onUpdateTimer:oe},null,8,["data","timer"]),j(tl,{data:Xe.value.safetyPrecaution},null,8,["data"]),n("div",Qd,[n("div",ec,[Wt(n("input",{class:"form-check-input",disabled:C.value,type:"checkbox","onUpdate:modelValue":re[0]||(re[0]=$e=>G.value=$e),id:"agreement",onChange:dt},null,40,tc),[[pa,G.value]]),ac])]),j(Yi,{ref_key:"riskAssesmet",ref:B,ready:W(l).isSet,onOnFrontPageTaken:mt},null,8,["ready"]),j(vi,{data:Xe.value.checkBeforeTruck,isAggrementChecked:G.value},null,8,["data","isAggrementChecked"]),n("div",sc,[j(Ws,{clock:Qe.value},null,8,["clock"]),W(l).generalForm.status=="Submited"?(c(),$("button",{key:0,class:"btn btn-success",disabled:pt.value,style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},onClick:I},"Enter",8,lc)):(c(),$(Ve,{key:1},[!R.value||!et.value?(c(),$("button",{key:0,class:"btn btn-success",disabled:pt.value,style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},onClick:X},"Enter",8,oc)):D("",!0)],64)),et.value&&R.value?(c(),$("button",{key:2,type:"button",class:"btn btn-success",disabled:pt.value,style:{background:"#18af4a","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},onClick:Tt}," Submit ",8,rc)):D("",!0)])],64)):D("",!0)])),j(Ns,{visibility:L.value},null,8,["visibility"]),j(lu,{visibility:T.value},null,8,["visibility"]),j(Ts),j(bs,{visibility:W(ye).isVisible},null,8,["visibility"]),j(Ga,{visibility:N.value,caption:xe.value,"yes-label":"Take a Photo","no-label":"Cancel",onOnNoConfirm:ze,onOnYesConfirm:Be,yesButtonBackroundColor:"#18AF4A"},null,8,["visibility","caption"]),j(Jt,{visibility:Y.value,caption:"Is your work finished?",onOnNoConfirm:de,onOnYesConfirm:rt},null,8,["visibility"]),j(Jt,{visibility:kt.value,caption:"Are you sure want to submit this form?",onOnNoConfirm:Lt,onOnYesConfirm:tt},null,8,["visibility"]),j(zs,{show:te.value,onClose:Ct,time:Qe.value,isTimerStopped:He.value},null,8,["show","time","isTimerStopped"]),j(Yt,{"modal-type":"alreadySubmitted",show:ot.value,onClose:Ft},null,8,["show"]),j(Yt,{"modal-type":"alreadyClose",show:E.value,onClose:Rt},null,8,["show"]),j(Yt,{"modal-type":"notReady",show:Je.value,onClose:Ot},null,8,["show"]),j(Yt,{"modal-type":"taskError",show:b.value,onClose:jt,message:f.value},null,8,["show","message"]),j(Yt,{"modal-type":"alreadyUpdated",show:Se.value,onClose:jt},null,8,["show"]),j(Yt,{"modal-type":"alreadyUpdated",show:ve.value,onClose:qt},null,8,["show"]),j(vu,{show:A.value,onClose:P},null,8,["show"]),j(Ge,{modelValue:ie.value,"onUpdate:modelValue":re[1]||(re[1]=$e=>ie.value=$e),"destroy-on-close":!0,fullscreen:!0,onClosed:ea},{default:le(()=>[j(dl,{title:"Historical e-Form"})]),_:1},8,["modelValue"]),j(mu,{show:Ee.value,onClose:Q},null,8,["show"]),j(Ge,{modelValue:ae.value,"onUpdate:modelValue":re[2]||(re[2]=$e=>ae.value=$e),"destroy-on-close":!0,fullscreen:!0,"custom-class":"dialog-header-noborder",onClosed:Gt},{default:le(()=>[j(ul)]),_:1},8,["modelValue"]),j(Jt,{visibility:At.value,caption:"Are you sure want to leave this page?",onOnNoConfirm:ta,onOnYesConfirm:aa},null,8,["visibility"]),j(Fa,{show:K.value,onClose:q,"title-pop-up":"No internet connection"},null,8,["show"]),j(fa,{show:h.value,onClose:re[3]||(re[3]=$e=>F(!1)),"title-pop-up":"Please confirm with supervisor if a suspension cylinder adjustment is required.",confirmLabel:"Continue"},null,8,["show"]),j(fa,{show:U.value,onClose:re[4]||(re[4]=$e=>_(!1)),"title-pop-up":"Suspension has defect, please confirm to supervisor and reliability engineer.",confirmLabel:"Continue"},null,8,["show"]),j(fa,{show:m.value,onClose:J,"title-pop-up":"All Pre Service Operational check must be completed prior to continuing on to the next section.",confirmLabel:"Ok"},null,8,["show"]),j(fa,{show:w.value,onClose:re[5]||(re[5]=$e=>O(!1)),"title-pop-up":"Please ensure you complete a payload calibration at the end of the service, before the unit returns to work.",confirmLabel:"Confirm"},null,8,["show"]),W(p).ShowSuspensionCylinderHeightForm?(c(),Z(Kd,{key:2,show:W(p).ShowSuspensionCylinderHeightForm,onClose:re[6]||(re[6]=()=>W(p).toggleShowSuspensionCylinderHeightForm(!1)),onOnConfrimSubmit:tt},null,8,["show"])):D("",!0)],64)}}}),Zf=$t(nc,[["__scopeId","data-v-95313805"]]);export{Zf as default};

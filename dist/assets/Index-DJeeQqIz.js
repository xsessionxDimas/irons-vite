import{u as xt}from"./vuex-BbOKrtVp.js";import{a as Tt}from"./breadcrumb-BYmEOf4C.js";import{c as R,a as dt,J as W,I as ut,z as J,A as wt}from"./index-BuVmIl8K.js";import{P as gt}from"./Pagination-D-xfdYmn.js";import{F as It}from"./FilterIconButton-Bj0WTbms.js";import{h as kt,A as Ct,U as Lt}from"./excel-generator-DMHRo93s.js";import{D as At}from"./DownloadIconButton-CIQp-YG7.js";import{_ as b,b as vt}from"./element-plus-BeWdvTRa.js";import{q as O,w as N,x as ht,y as Ot}from"./date-format-8-IvfSl3.js";import{P as Z}from"./Pagination-BiobnanQ.js";import{C as ft,L as $t,E as Bt,U as Rt,B as Ht,a as Nt}from"./urls-hWHEBXep.js";import{d as ct}from"./pinia-BjOS2_Ao.js";import{m as rt,d as qt}from"./mapOption-CeGMwmH0.js";import{k as H,bL as zt,r as j,u as o,y as z,p as F,aa as Y,q as T,x as m,Y as at,R as I,s as e,aB as u,C as G,a0 as et,c as A,B as w,A as st,T as _t,bd as jt,bb as Gt,a7 as Kt,L as Xt,F as Jt}from"./@vue-BypzYtbH.js";import{a as Yt,d as Qt}from"./table-sort-Bpdq_Uwn.js";import{_ as q}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{_ as $}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CCwjwK39.js";import{_ as L}from"./AutoComplete.vue_vue_type_script_setup_true_lang-DJ43pGTI.js";import{a as St}from"./vee-validate-C_msoaAA.js";import{c as bt,f as nt,d as lt,a as Q,b as tt}from"./yup-C6P98bvY.js";import"./property-expr-DEi1ZLzV.js";import{E as yt}from"./ErrorAlert-CMKGfwAi.js";import{e as Wt}from"./lodash-DrHMlsdo.js";import{_ as Zt}from"./FileDropZone.vue_vue_type_style_index_0_lang-C5PyimC7.js";import{m as ta}from"./map-anything-abi6NY2Z.js";import{_ as aa}from"./nw-img-vue-CR837WER.js";import{F as ea}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./useMenuStore-CD5Gmvif.js";import"./PageEnum-DUtfSNQS.js";import"./xlsx-C4maHrMm.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-NSxIV7Fb.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";const it={Parameter:"",ParameterTo:"",ValueMin:"",ValueMinTo:"",ValueMax:"",ValueMaxTo:"",Uom:"",UomTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},K=ct({id:"smutolerancesetting",state:()=>({stateFilterData:{...it},stateLastUsedFilterData:{...it},statePageName:"smuToleranceSetting",stateDisplayData:[],statePagination:new Z,stateLoading:!1,statePaginationLoading:!1,stateParameterOption:[],stateValueMinOption:[],stateValueMaxOption:[],stateUomOption:[],stateUomFormOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,parameterOption:t=>t.stateParameterOption,valueMinOption:t=>t.stateValueMinOption,valueMaxOption:t=>t.stateValueMaxOption,uomOption:t=>t.stateUomOption,UomFormOption:t=>t.stateUomFormOption},actions:{async getData(t=!0){const l={Parameter:this.stateFilterData.Parameter,ParameterTo:this.stateFilterData.ParameterTo,ValueMin:this.stateFilterData.ValueMin,ValueMinTo:this.stateFilterData.ValueMinTo,ValueMax:this.stateFilterData.ValueMax,ValueMaxTo:this.stateFilterData.ValueMaxTo,Uom:this.stateFilterData.Uom,UomTo:this.stateFilterData.UomTo,StartDate:this.stateFilterData.StartDate?O(this.stateFilterData.StartDate):"",StartDateTo:this.stateFilterData.StartDateTo?O(this.stateFilterData.StartDateTo):"",EndDate:this.stateFilterData.EndDate?O(this.stateFilterData.EndDate):"",EndDateTo:this.stateFilterData.EndDateTo?O(this.stateFilterData.EndDateTo):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const a=await R.get(ft,"",new URLSearchParams(l).toString());this.stateDisplayData=a.data.result.content,this.setTotalPage(a.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(a){console.log(a)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const l=await R.get($t,"",new URLSearchParams(t).toString());this.stateParameterOption=rt(l.data.result.content.parameter),this.stateValueMinOption=rt(l.data.result.content.valueMin),this.stateValueMaxOption=rt(l.data.result.content.valueMax),this.stateUomOption=qt(l.data.result.content.uom,"uomId","uom"),this.stateUomFormOption=l.data.result.content.masterUomList.map(a=>({label:a.uomDescription,value:a}))}catch(l){console.log(l)}},async export(){const t={ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await R.getBlob(Bt,"",new URLSearchParams(t).toString())).data}catch(l){console.log(l)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:l}){if(!t&&!l)this.stateFilterData.Order="";else{const a=l=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${a}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setParameter(t){this.stateFilterData.Parameter=t},setParameterTo(t){this.stateFilterData.ParameterTo=t},setValueMin(t){this.stateFilterData.ValueMin=t},setValueMinTo(t){this.stateFilterData.ValueMinTo=t},setValueMax(t){this.stateFilterData.ValueMax=t},setValueMaxTo(t){this.stateFilterData.ValueMaxTo=t},setUom(t){this.stateFilterData.Uom=t},setUomTo(t){this.stateFilterData.UomTo=t},setStartDate(t){this.stateFilterData.StartDate=t},setStartDateTo(t){this.stateFilterData.StartDateTo=t},setEndDate(t){this.stateFilterData.EndDate=t},setEndDateTo(t){this.stateFilterData.EndDateTo=t},async resetFilter(){this.stateFilterData.Parameter="",this.stateFilterData.ParameterTo="",this.stateFilterData.ValueMin="",this.stateFilterData.ValueMinTo="",this.stateFilterData.ValueMax="",this.stateFilterData.ValueMaxTo="",this.stateFilterData.Uom="",this.stateFilterData.UomTo="",this.stateFilterData.StartDate="",this.stateFilterData.StartDateTo="",this.stateFilterData.EndDate="",this.stateFilterData.EndDateTo="";const t=this.stateLastUsedFilterData.Parameter!=="",l=this.stateLastUsedFilterData.ParameterTo!=="",a=this.stateLastUsedFilterData.ValueMin!=="",g=this.stateLastUsedFilterData.ValueMinTo!=="",i=this.stateLastUsedFilterData.ValueMax!=="",d=this.stateLastUsedFilterData.ValueMaxTo!=="",p=this.stateLastUsedFilterData.Uom!=="",f=this.stateLastUsedFilterData.UomTo!=="",r=this.stateLastUsedFilterData.StartDate!=="",y=this.stateLastUsedFilterData.StartDateTo!=="",_=this.stateLastUsedFilterData.EndDate!=="",v=this.stateLastUsedFilterData.EndDateTo!=="";(t||l||a||g||i||d||p||f||r||y||_||v)&&await this.getData()},resetState(){this.stateFilterData={...it},this.stateDisplayData=[],this.statePagination=new Z,this.stateLoading=!1,this.statePaginationLoading=!1}}}),Dt={mdSMUToleranceSettingId:0,parameter:"",valueMin:"",ValueMax:"",Uom:"",uomId:0,isActive:!0,startDate:N(new Date),endDate:N(new Date("12/31/9999"))},ot=ct({id:"smuToleranceSettingForm",state:()=>({stateFormData:{...Dt},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading},actions:{async insertData(t){try{this.stateLoading=!0;const l={userAccount:t,ver:"v1"},a={mdSMUToleranceSettingId:this.stateFormData.mdSMUToleranceSettingId,parameter:parseInt(this.stateFormData.parameter),valueMin:parseInt(this.stateFormData.valueMin),ValueMax:parseInt(this.stateFormData.ValueMax),Uom:this.stateFormData.Uom,uomId:this.stateFormData.uomId,isActive:this.stateFormData.isActive,startDate:O(N(new Date(this.stateFormData.startDate))),endDate:O(N(new Date(this.stateFormData.endDate)))},g=await R.post(`${ft}?${new URLSearchParams(l).toString()}`,a);g.data.title==="Error"?(this.stateErrors.push(g.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(l){this.stateError=l,this.stateErrors.push(l.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const l={userAccount:t,ver:"v1"},a={mdSMUToleranceSettingId:this.stateFormData.mdSMUToleranceSettingId,parameter:parseInt(this.stateFormData.parameter),valueMin:parseInt(this.stateFormData.valueMin),ValueMax:parseInt(this.stateFormData.ValueMax),Uom:this.stateFormData.Uom,uomId:this.stateFormData.uomId,isActive:this.stateFormData.isActive,startDate:O(N(new Date(this.stateFormData.startDate))),endDate:O(N(new Date(this.stateFormData.endDate)))},g=await R.post(`${Rt}?${new URLSearchParams(l).toString()}`,a);g.data.title==="Error"?(this.stateErrors.push(g.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(l){this.stateError=l,this.stateErrors.push(l.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.mdSMUToleranceSettingId=t.mdSmuToleranceSettingId||0,this.stateFormData.parameter=t.parameter||"",this.stateFormData.valueMin=t.valueMin||"",this.stateFormData.ValueMax=t.valueMax||"",this.stateFormData.Uom=t.uom||"",this.stateFormData.uomId=t.uomId||0,this.stateFormData.startDate=t.startDate||"",this.stateFormData.endDate=t.endDate||"",this.stateFormData.isActive=t.isActive||!1},resetState(){this.stateFormData={...Dt},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),sa={key:0,style:{height:"100px"}},oa={key:0,class:"row justify-content-center"},ra={key:1,class:"row justify-content-center"},na={class:"row justify-content-center"},ia=["onClick"],la=H({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:l}){const a=t,g=K(),i=ot(),d=l,p=zt(()=>(a.page-1)*10+1),f=j(""),r=v=>{f.value=v.order;const M={prop:v.prop,order:v.order};g.setSort(M)},y=(v,M,S)=>Yt(v[S],M[S],f.value),_=v=>{i.setFormData(v),d("show-dialog",null)};return(v,M)=>{const S=I("inline-svg"),E=I("el-tooltip"),P=at("loading");return o(g).loading?z((F(),Y("div",sa,null,512)),[[P,o(g).loading]]):z((F(),T(o(vt),{key:1,data:a.listData,style:{width:"100%"},onSortChange:r,"empty-text":"No Data"},{default:m(()=>[e(o(b),{label:"No",width:"90",align:"center"},{default:m(n=>[u("span",null,G(o(p)+n.$index),1)]),_:1}),e(o(b),{prop:"parameter",label:"Parameter",width:"200",sortable:"","sort-method":(n,c)=>y(n,c,"parameter")},null,8,["sort-method"]),e(o(b),{prop:"valueMin",label:"Value Min",width:"110",sortable:"","sort-method":(n,c)=>y(n,c,"valueMin")},null,8,["sort-method"]),e(o(b),{prop:"valueMax",label:"Value Max",width:"110",sortable:"","sort-method":(n,c)=>y(n,c,"valueMax")},null,8,["sort-method"]),e(o(b),{prop:"uom",label:"Uom",width:"100",sortable:"","sort-method":(n,c)=>y(n,c,"uom")},null,8,["sort-method"]),e(o(b),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:m(n=>[u("span",null,G(o(ht)(n.row.startDate)),1)]),_:1}),e(o(b),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:m(n=>[u("span",null,G(o(ht)(n.row.endDate)),1)]),_:1}),e(o(b),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:m(n=>[n.row.isActive?(F(),Y("div",oa,[e(S,{src:"/media/svg/tables/rows/check.svg"})])):(F(),Y("div",ra,[e(S,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),e(o(b),{prop:"changedOn",label:"Changed on",align:"center",width:"150",sortable:""},{default:m(n=>[u("span",null,G(o(Ot)(n.row.changedOn)),1)]),_:1}),e(o(b),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(n,c)=>y(n,c,"changedBy")},null,8,["sort-method"]),e(o(b),{label:"",width:"80"},{default:m(n=>[u("div",na,[e(E,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:m(()=>[u("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:c=>_(n.row)},[e(S,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,ia)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[P,o(g).loading]])}}}),da={class:"col-md-6 fv-row fv-plugins-icon-container"},ua={class:"col-md-6 fv-row fv-plugins-icon-container"},ca={class:"dialog-footer"},ma=H({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:l}){const a=t,g=l,i=ot(),d=K(),p=dt(),f=et(a,"visibility"),r=A(()=>i.formData),y=A(()=>i.errors),_=A(()=>i.isError),v=bt().shape({parameter:nt().required("Parameter is mandatory").typeError("Parameter should be number"),valueMin:nt().required("Value Min is mandatory").typeError("Value min should be negative or positive number"),ValueMax:nt().required("Value Max is mandatory").typeError("Value max should be negative or positive number").min(lt("valueMin"),"Value max must be bigger than value min"),Uom:Q().required("Uom is mandatory"),startDate:tt().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:tt().required("End Date is mandatory").min(lt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),M=()=>{E(""),P(""),n(""),c(""),h(""),k("")},S=(s=!1)=>{D(),M(),i.resetState(),g("handle-close",s)},E=s=>{r.value.parameter=s},P=s=>{r.value.valueMin=s},n=s=>{r.value.ValueMax=s},c=s=>{r.value.Uom=s.uomDescription,r.value.uomId=s.masterUomId},h=s=>{r.value.startDate=s},k=s=>{r.value.endDate=s},V=async()=>{D(),await v.validate(r.value,{abortEarly:!1}).catch(s=>{i.setErrors(s.errors)}),!_.value&&W("Are you sure you want to submit ?").then(async s=>{s.isConfirmed&&i.insertData(p.user.Name).then(()=>{i.isError||ut("Form has been successfully submitted!","Ok").then(()=>{S(!0)})})})},D=()=>{i.setErrors([])};return(s,U)=>{const x=I("el-button"),B=I("el-dialog"),C=at("loading");return z((F(),T(B,{modelValue:f.value,"onUpdate:modelValue":U[0]||(U[0]=X=>f.value=X),title:"New Data",width:"40%",onClose:U[1]||(U[1]=X=>S())},{footer:m(()=>[u("span",ca,[e(x,{type:"primary",onClick:V,disabled:o(i).loading},{default:m(()=>[w("Submit")]),_:1},8,["disabled"]),e(x,{type:"secondary",onClick:S,disabled:o(i).loading},{default:m(()=>[w("Close")]),_:1},8,["disabled"])])]),default:m(()=>[e(_t,{name:"fade"},{default:m(()=>[_.value?(F(),T(yt,{key:0,errorMessages:y.value,onResetForm:D},null,8,["errorMessages"])):st("",!0)]),_:1}),z((F(),T(o(St),{id:"kt_filter_form",class:"row g-9 my-4"},{default:m(()=>[e(q,{value:r.value.parameter,margin:!1,placeholder:"Add Parameter",label:"Parameter",name:"parameter",max:10,onHandleChange:E},null,8,["value"]),e(q,{value:r.value.valueMin,placeholder:"Add Value Min",label:"Value Min",name:"ValueMin",max:10,onHandleChange:P},null,8,["value"]),e(q,{value:r.value.ValueMax,placeholder:"Add Value Max",label:"Value Max",name:"Value Max",max:10,onHandleChange:n},null,8,["value"]),e(L,{value:r.value.Uom,placeholder:"Add Uom",label:"Uom",name:"Uom",max:10,onHandleChange:c,options:o(d).UomFormOption},null,8,["value","options"]),u("div",da,[e($,{value:r.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:h},null,8,["value"])]),u("div",ua,[e($,{value:r.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:k},null,8,["value"])])]),_:1})),[[C,o(i).loading]])]),_:1},8,["modelValue"])),[[C,o(i).loading]])}}}),pa={class:"col-md-6 fv-row fv-plugins-icon-container"},ha={class:"col-md-6 fv-row fv-plugins-icon-container"},Da={class:"dialog-footer"},ga=H({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:l}){const a=t,g=l,i=ot(),d=K(),p=dt(),f=et(a,"visibility"),r=A(()=>i.formData),y=A(()=>i.errors),_=A(()=>i.isError),v=bt().shape({valueMin:Q().required("Value Min is mandatory"),ValueMax:Q().required("Value Max is mandatory"),Uom:Q().required("Uom is mandatory"),startDate:tt().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:tt().required("End Date is mandatory").min(lt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),M=()=>{r.value.mdSMUToleranceSettingId=0,r.value.parameter="",r.value.valueMin="",r.value.ValueMax="",r.value.Uom="",r.value.uomId=0,r.value.startDate="",r.value.endDate="",r.value.isActive=!0},S=(D=!1)=>{M(),i.resetState(),V(),g("handle-close",D)},E=D=>{r.value.valueMin=D},P=D=>{r.value.ValueMax=D},n=D=>{r.value.Uom=D.uomDescription,r.value.uomId=D.masterUomId},c=D=>{r.value.startDate=D},h=D=>{r.value.endDate=D},k=async()=>{V(),await v.validate(r.value,{abortEarly:!1}).catch(D=>{i.setErrors(D.errors)}),!_.value&&W("Are you sure you want to submit ?").then(async D=>{D.isConfirmed&&i.updateData(p.user.Name).then(()=>{i.isError||ut("Form has been successfully submitted!","Ok").then(()=>{S(!0)})})})},V=()=>{i.setErrors([])};return(D,s)=>{const U=I("el-button"),x=I("el-dialog"),B=at("loading");return z((F(),T(x,{modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=C=>f.value=C),title:"Update Data",width:"40%",onClose:s[1]||(s[1]=C=>S())},{footer:m(()=>[u("span",Da,[e(U,{type:"primary",onClick:k,disabled:o(i).loading},{default:m(()=>[w("Submit")]),_:1},8,["disabled"]),e(U,{type:"secondary",onClick:S,disabled:o(i).loading},{default:m(()=>[w("Close")]),_:1},8,["disabled"])])]),default:m(()=>[e(_t,{name:"fade"},{default:m(()=>[_.value?(F(),T(yt,{key:0,errorMessages:y.value,onResetForm:V},null,8,["errorMessages"])):st("",!0)]),_:1}),e(o(St),{id:"kt_filter_form",class:"row g-9 my-4"},{default:m(()=>[e(q,{value:r.value.parameter,margin:!1,placeholder:"Add Parameter",label:"Parameter",name:"parameter",max:10,disabled:!0},null,8,["value"]),e(q,{value:r.value.valueMin,placeholder:"Add Value Min",label:"Value Min",name:"ValueMin",max:10,onHandleChange:E},null,8,["value"]),e(q,{value:r.value.ValueMax,placeholder:"Add Value Max",label:"Value Max",name:"Value Max",max:10,onHandleChange:P},null,8,["value"]),e(L,{value:r.value.Uom,placeholder:"Add Uom",label:"Uom",name:"Uom",max:10,onHandleChange:n,options:o(d).UomFormOption},null,8,["value","options"]),u("div",pa,[e($,{value:r.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:c},null,8,["value"])]),u("div",ha,[e($,{value:r.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:h},null,8,["value"])])]),_:1})]),_:1},8,["modelValue"])),[[B,o(i).loading]])}}}),mt=ct({id:"smutoleranceSettingbulk",state:()=>({statePagination:new Z,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const l={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const a=await R.post(`${Ht}?${new URLSearchParams(l).toString()}`,this.stateBulkData);this.stateError=a.data.result.isError?a.data.result.message:"",this.stateIsError=a.data.result.isError}catch(a){console.log(a)}this.stateLoading=!1},async upload({userAccount:t,excelFile:l}){const a={userAccount:t,ver:"v1"},g=`${Nt}?${new URLSearchParams(a).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const i=await R.postImages(g,l);i.data.statusCode==200?i.data.result.isError?(this.stateIsError=!0,this.stateError=i.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=i.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=Wt.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=i.data.result.isError,this.stateError=i.data.result.message)}catch(i){console.log(i),this.stateIsError=!0,this.stateError=i.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(Qt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new Z,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),va={class:"icon"},fa=H({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const l=t,a=mt(),g=A(()=>(l.page-1)*10+1),i=d=>{const p={prop:d.prop,order:d.order};a.setSort(p)};return(d,p)=>{const f=I("inline-svg");return F(),T(o(vt),{data:l.listData,style:{width:"100%"},onSortChange:i,"empty-text":"No Data"},{default:m(()=>[e(o(b),{label:"No",width:"60",align:"center"},{default:m(r=>[u("span",null,G(g.value+r.$index),1)]),_:1}),e(o(b),{prop:"parameter",label:"Parameter",width:"200",sortable:""}),e(o(b),{prop:"valueMin",label:"Value Min",width:"200",sortable:""}),e(o(b),{prop:"valueMax",label:"Value Max",width:"150",sortable:""}),e(o(b),{prop:"uom",label:"Uom",width:"150",sortable:""}),e(o(b),{prop:"startDate",label:"Start Date",width:"120",sortable:""}),e(o(b),{prop:"endDate",label:"End Date",width:"100",sortable:""}),e(o(b),{prop:"validationReason",label:"Remark",width:"200",sortable:""}),e(o(b),{prop:"isValid",label:"Status","min-width":"100",align:"center",sortable:""},{default:m(r=>[u("div",va,[e(f,{src:r.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),pt=t=>(jt("data-v-85f27cbf"),t=t(),Gt(),t),_a=pt(()=>u("div",{class:"text-center"},null,-1)),Sa=pt(()=>u("div",{class:"mb-3"},[u("span",null,[w(" Download template "),u("a",{href:"documents/MasterDataSmuToleranceSetting.xlsx",target:"_blank",id:"link-download"},"here"),w(" before uploading file ")])],-1)),ba=pt(()=>u("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[u("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),ya={class:"card"},Ma={class:"card-body grid-padding"},Ua={class:"dialog-footer"},Fa=H({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:l}){const a=t,g=l,i=dt(),d=mt(),p=et(a,"visibility"),f=()=>{const n=ta(d.validatedData,c=>{console.log(c);const h=c;return{mdSMUToleranceSettingId:0,parameter:h.parameter,valueMin:h.valueMin,valueMax:h.valueMax,uom:h.uom,uomId:h.uomId,isActive:h.isActive,startDate:h.startDate,endDate:h.endDate}});return Object.values(n)},r=()=>{const n=document.getElementById("link-download");n&&n.click()},y=()=>{d.validatedData.length>0?W("Cancel Upload Data?","Confirm").then(c=>{c.isConfirmed&&v()}):v()},_=async n=>{await d.upload({userAccount:i.user.Name,excelFile:n}),d.stateError&&J(d.error)},v=(n=!1)=>{d.resetState(),g("handle-close",n)},M=n=>{d.setIsUploadedState(n)},S=n=>{d.setPage(n)},E=()=>{if(d.validatedData.length<1){r();return}const n=["PARAMETER","VALUE MIN","VALUE MAX","UOM","START DATE","END DATE","REMARK","STATUS"],c=d.validatedData.map(h=>({parameter:h.parameter,valueMin:h.valueMin,valueMax:h.valueMax,uom:h.uom,startDate:h.startDate,endDate:h.endDate,remark:h.validationReason,status:h.isValid?"OK":"Error"}));kt("SmuToleranceSetting",n,c)},P=async()=>{if(d.displayData.length<1){J("There is no data to submit");return}if(d.isError){J("There is still invalid row(s)");return}W("Are you sure you want to submit ?").then(async n=>{if(n.isConfirmed){const c=f();if(d.setBulkData(c),await d.bulkInsert(i.user.Name),d.isError){J(d.stateError);return}ut("Form has been successfully submitted!","Ok").then(()=>{v(!0)})}})};return(n,c)=>{const h=I("el-button"),k=I("el-dialog"),V=at("loading");return F(),T(k,{title:"Upload Bulk Data",modelValue:p.value,"onUpdate:modelValue":c[1]||(c[1]=D=>p.value=D),"before-close":y,width:"70%","custom-class":"upload-modal"},{footer:m(()=>[u("div",null,[u("span",Ua,[e(h,{type:"success",onClick:E},{default:m(()=>[w("Download")]),_:1}),e(h,{type:"primary",onClick:P},{default:m(()=>[w("Upload")]),_:1}),e(h,{type:"success",onClick:y},{default:m(()=>[w("Cancel")]),_:1})])])]),default:m(()=>[_a,Sa,z(e(Zt,{isSubmissionUploadSuccess:o(d).isUploaded,onHandleCloseUploadedFile:y,onHandleUpload:_,onHandleSetIsExcelFileUploaded:M},null,8,["isSubmissionUploadSuccess"]),[[V,o(d).uploadLoading]]),ba,u("div",ya,[u("div",Ma,[e(fa,{"list-data":o(d).displayData,page:o(d).pagination.currentPage},null,8,["list-data","page"])])]),o(d).displayData.length>0?(F(),T(gt,{key:0,onRaisePageChange:c[0]||(c[0]=D=>S(D)),currentPage:o(d).pagination.currentPage,totalPage:o(d).pagination.totalPage,totalPageSize:o(d).pagination.totalPageSize,startPaginationIndex:o(d).pagination.startPaginationIndex,endPaginationIndex:o(d).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):st("",!0)]),_:1},8,["modelValue"])}}}),Pa=aa(Fa,[["__scopeId","data-v-85f27cbf"]]),Ea={class:"row g-9 my-4"},Va={class:"col-md-6 fv-row fv-plugins-icon-container"},xa={class:"col-md-6 fv-row fv-plugins-icon-container"},Ta={class:"col-md-6 fv-row fv-plugins-icon-container"},wa={class:"col-md-6 fv-row fv-plugins-icon-container"},Ia={class:"col-md-6 fv-row fv-plugins-icon-container"},ka={class:"col-md-6 fv-row fv-plugins-icon-container"},Ca={class:"col-md-6 fv-row fv-plugins-icon-container"},La={class:"col-md-6 fv-row fv-plugins-icon-container"},Aa={class:"col-md-6 fv-row fv-plugins-icon-container"},Oa={class:"col-md-6 fv-row fv-plugins-icon-container"},$a={class:"col-md-6 fv-row fv-plugins-icon-container"},Ba={class:"col-md-6 fv-row fv-plugins-icon-container"},Ra={class:"dialog-footer"},Ha=H({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:l}){const a=K(),g=t,i=l,d=et(g,"visibility"),p=A(()=>a.filterData),f=()=>{r(),a.resetFilter()},r=()=>{i("handle-close",!1)},y=s=>{a.setParameter(s)},_=s=>{a.setParameterTo(s)},v=s=>{a.setValueMin(s)},M=s=>{a.setValueMinTo(s)},S=s=>{a.setValueMax(s)},E=s=>{a.setValueMaxTo(s)},P=s=>{a.setUom(s)},n=s=>{a.setUomTo(s)},c=s=>{a.setStartDate(s)},h=s=>{a.setStartDateTo(s)},k=s=>{a.setEndDate(s)},V=s=>{a.setEndDateTo(s)},D=()=>{const s=a.lastUsedFilterData.Parameter!==a.filterData.Parameter,U=a.lastUsedFilterData.ParameterTo!==a.filterData.ParameterTo,x=a.lastUsedFilterData.ValueMin!==a.filterData.ValueMin,B=a.lastUsedFilterData.ValueMinTo!==a.filterData.ValueMinTo,C=a.lastUsedFilterData.ValueMax!==a.filterData.ValueMax,X=a.lastUsedFilterData.ValueMaxTo!==a.filterData.ValueMaxTo,Mt=a.lastUsedFilterData.Uom!==a.filterData.Uom,Ut=a.lastUsedFilterData.UomTo!==a.filterData.UomTo,Ft=a.lastUsedFilterData.StartDate!==a.filterData.StartDate,Pt=a.lastUsedFilterData.StartDateTo!==a.filterData.StartDateTo,Et=a.lastUsedFilterData.EndDate!==a.filterData.EndDate,Vt=a.lastUsedFilterData.EndDateTo!==a.filterData.EndDateTo;i("handle-close",s||U||x||B||C||X||Mt||Ut||Ft||Pt||Et||Vt)};return(s,U)=>{const x=I("el-button"),B=I("el-dialog");return F(),T(B,{modelValue:d.value,"onUpdate:modelValue":U[0]||(U[0]=C=>d.value=C),title:"Filter",width:"60%",onClose:U[1]||(U[1]=C=>r())},{footer:m(()=>[u("span",Ra,[e(x,{type:"secondary",onClick:f},{default:m(()=>[w("Reset")]),_:1}),e(x,{type:"primary",onClick:D},{default:m(()=>[w("Filter")]),_:1})])]),default:m(()=>[u("div",Ea,[u("div",Va,[e(L,{value:p.value.Parameter,label:"Parameter From",name:"",options:o(a).parameterOption,onHandleChange:y},null,8,["value","options"])]),u("div",xa,[e(L,{value:p.value.ParameterTo,label:"Parameter To",name:"ParameterTo",options:o(a).parameterOption,onHandleChange:_},null,8,["value","options"])]),u("div",Ta,[e(L,{value:p.value.ValueMin,label:"Value Min From",name:"ValueMin",options:o(a).valueMinOption,onHandleChange:v},null,8,["value","options"])]),u("div",wa,[e(L,{value:p.value.ValueMinTo,label:"Value Min To",name:"ValueMinTo",options:o(a).valueMinOption,onHandleChange:M},null,8,["value","options"])]),u("div",Ia,[e(L,{value:p.value.ValueMax,label:"Value Max From",name:"ValueMax",options:o(a).valueMaxOption,onHandleChange:S},null,8,["value","options"])]),u("div",ka,[e(L,{value:p.value.ValueMaxTo,label:"Value Max To",name:"ValueMaxTo",options:o(a).valueMaxOption,onHandleChange:E},null,8,["value","options"])]),u("div",Ca,[e(L,{value:p.value.Uom,label:"Uom From",name:"Uom",options:o(a).uomOption,onHandleChange:P},null,8,["value","options"])]),u("div",La,[e(L,{value:p.value.UomTo,label:"Uom To",name:"UomTo",options:o(a).uomOption,onHandleChange:n},null,8,["value","options"])]),u("div",Aa,[e($,{value:p.value.StartDate,label:"Start Date From",name:"StartDateFrom",placeholder:"Pick a date",onHandleChange:c},null,8,["value"])]),u("div",Oa,[e($,{value:p.value.StartDateTo,label:"Start Date To",name:"StartDateFrom",placeholder:"Pick a date",onHandleChange:h},null,8,["value"])]),u("div",$a,[e($,{value:p.value.EndDate,label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChange:k},null,8,["value"])]),u("div",Ba,[e($,{value:p.value.EndDateTo,label:"End Date To",name:"EndDateTo",placeholder:"Pick a date",onHandleChange:V},null,8,["value"])])])]),_:1},8,["modelValue"])}}}),Na={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},qa=u("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),za={class:"d-flex justify-content-between align-items-center"},ja={class:"card"},Ga={class:"card-body grid-padding"},Ka={class:"my-5"},rs=H({__name:"Index",setup(t){const l=xt(),a=K(),g=ot(),i=mt(),d=j(!1),p=j(!1),f=j(!1),r=j(!1),y=A(()=>a.displayData),_=A(()=>a.pagination),v=s=>{a.setPage(s)};Kt(async()=>{l[wt.ACTIVE_PAGE]("IronLake"),Tt("SMU Tolerance Setting",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Parameter",pageRoute:"smutolerancesetting"},{pageName:"SMU Tolerance Setting",pageRoute:"smutolerancesetting"}]),a.setPage(1),await a.getLookup()}),Xt(async()=>{a.resetState(),g.resetState(),i.resetState()});const M=async()=>{await a.setPage(1),await a.getLookup()},S=()=>{d.value=!0},E=async s=>{d.value=!1,s&&await M()},P=()=>{p.value=!0},n=async s=>{p.value=!1,s&&await M()},c=()=>{f.value=!0},h=async s=>{f.value=!1,s&&await M()},k=async()=>{const s=await a.export();ea.saveAs(new Blob([s],{type:"application/octet-stream"}),"SMU Tolerance Setting.xlsx")},V=()=>{r.value=!0},D=async s=>{r.value=!1,s&&await M()};return(s,U)=>(F(),Y(Jt,null,[u("div",Na,[qa,u("div",za,[e(Ct,{onShowDialog:S}),e(It,{onShowDialog:c}),e(At,{onHandleDownload:k}),e(Lt,{onShowDialog:V})])]),u("div",ja,[u("div",Ga,[e(la,{"list-data":y.value,page:_.value.currentPage,onShowDialog:P},null,8,["list-data","page"])])]),u("div",Ka,[o(a).paginationLoading?st("",!0):(F(),T(gt,{key:0,onRaisePageChange:U[0]||(U[0]=x=>v(x)),currentPage:_.value.currentPage,totalPage:_.value.totalPage,totalPageSize:_.value.totalPageSize,startPaginationIndex:_.value.startPaginationIndex,endPaginationIndex:_.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),e(ma,{visibility:d.value,onHandleClose:E},null,8,["visibility"]),e(ga,{visibility:p.value,onHandleClose:n},null,8,["visibility"]),e(Ha,{visibility:f.value,onHandleClose:h},null,8,["visibility"]),e(Pa,{visibility:r.value,onHandleClose:D},null,8,["visibility"])],64))}});export{rs as default};

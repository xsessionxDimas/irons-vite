import{u as Vt}from"./vuex-BbOKrtVp.js";import{a as Rt}from"./breadcrumb-D-Q4Tk9w.js";import{b as A,u as dt,i as W,h as ct,j as Y,A as It}from"./index-BCnwA6yE.js";import{P as gt}from"./Pagination-CVDIvnOM.js";import{F as xt}from"./FilterIconButton-Bj0WTbms.js";import{h as Ot,A as At,U as $t}from"./excel-generator-CRLIz6fw.js";import{D as Bt}from"./DownloadIconButton-CIQp-YG7.js";import{_ as L,b as bt}from"./element-plus-C5R56mia.js";import{f as O,n as N,a as Z,b as Ht}from"./date-format-BASVuupi.js";import{P as tt,d as Nt,a as qt}from"./table-sort-VnBD5Hfa.js";import{C as ft,L as Mt,E as zt,U as jt,B as Kt,a as Gt}from"./urls-B8AUZ1MD.js";import{d as ut}from"./pinia-BjOS2_Ao.js";import{a as M,m as Xt}from"./mapOption-sP4IrA4W.js";import{L as Yt}from"./urls-w1X_96ba.js";import{L as Jt}from"./urls-D--VoWL5.js";import{k as B,bL as Qt,r as z,u as s,y as q,p as C,aa as Q,q as k,x as c,Y as ot,R,s as a,aB as u,C as $,a0 as st,c as x,B as V,A as nt,T as vt,bd as Wt,bb as Zt,a7 as te,L as ee,F as ae}from"./@vue-BypzYtbH.js";import{_ as j}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{_ as et}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-DQfguttb.js";import{_ as lt}from"./AutoComplete.vue_vue_type_script_setup_true_lang-D4CTLiQF.js";import{a as _t}from"./vee-validate-C_msoaAA.js";import{c as St,a as K,f as yt,b as at,d as Lt}from"./yup-BRaPd8dh.js";import"./property-expr-DEi1ZLzV.js";import{E as Ft}from"./ErrorAlert-CMKGfwAi.js";import{e as oe}from"./lodash-Cr9vlq0V.js";import{_ as se}from"./FileDropZone.vue_vue_type_style_index_0_lang-Ct77XTnP.js";import{m as ne}from"./map-anything-abi6NY2Z.js";import{_ as re}from"./nw-img-vue-CR837WER.js";import{_ as J}from"./AutoComplete.vue_vue_type_style_index_0_lang-CRR6Z--K.js";import{_ as ht}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-DO0pIl2P.js";import{F as ie}from"./file-saver-DhbZvGod.js";import"./vue-router-iNp9kJ0K.js";import"./object-path-BACu75q6.js";import"./attr-accept-BWI1aNlo.js";import"./crypto-js-BZehCumu.js";import"./cron-Ci8nYs3o.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-N3crNZ6y.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-DK0FVkv3.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./dayjs-C7SXsQPH.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-xcxZ5rdH.js";import"./mitt-C1xD_ZTF.js";import"./@popperjs-WhmJkuoZ.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./vue-i18n-CE6bnohq.js";import"./@intlify-CjZh8qSI.js";import"./PageEnum-BoOqFyRq.js";import"./xlsx-CpbwoZfi.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-CalJriC0.js";import"./vue3-dropzone-DPWU9yJt.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";const it={Component:"",ComponentTo:"",RecommendedLubricant:"",RecommendedLubricantTo:"",Value:"",ValueTo:"",Uom:"",UomTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},rt=ut({id:"componentLubricant",state:()=>({stateFilterData:{...it},stateLastUsedFilterData:{...it},statePageName:"componentLubricant",stateDisplayData:[],statePagination:new tt,stateLoading:!1,statePaginationLoading:!1,stateComponentOption:[],stateRecommendedLubricantOption:[],stateValueOption:[],stateUomOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,componentOption:t=>t.stateComponentOption,recommendedLubricantOption:t=>t.stateRecommendedLubricantOption,valueOption:t=>t.stateValueOption,uomOption:t=>t.stateUomOption},actions:{async getData(t=!0){const i={Component:this.stateFilterData.Component,ComponentTo:this.stateFilterData.ComponentTo,RecommendedLubricant:this.stateFilterData.RecommendedLubricant,RecommendedLubricantTo:this.stateFilterData.RecommendedLubricantTo,Value:this.stateFilterData.Value,ValueTo:this.stateFilterData.ValueTo,Uom:this.stateFilterData.Uom,UomTo:this.stateFilterData.UomTo,StartDate:this.stateFilterData.StartDate?O(this.stateFilterData.StartDate):"",StartDateTo:this.stateFilterData.StartDateTo?O(this.stateFilterData.StartDateTo):"",EndDate:this.stateFilterData.EndDate?O(this.stateFilterData.EndDate):"",EndDateTo:this.stateFilterData.EndDateTo?O(this.stateFilterData.EndDateTo):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await A.get(ft,"",new URLSearchParams(i).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const i=await A.get(Mt,"",new URLSearchParams(t).toString());this.stateComponentOption=M(i.data.result.content.component),this.stateRecommendedLubricantOption=M(i.data.result.content.recommendedLubricant),this.stateValueOption=M(i.data.result.content.value),this.stateUomOption=M(i.data.result.content.uom)}catch(i){console.log(i)}},async export(){const t={ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await A.getBlob(zt,"",new URLSearchParams(t).toString())).data}catch(i){console.log(i)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:i}){if(!t&&!i)this.stateFilterData.Order="";else{const e=i=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setComponent(t){this.stateFilterData.Component=t},setComponentTo(t){this.stateFilterData.ComponentTo=t},setRecommendedLubricant(t){this.stateFilterData.RecommendedLubricant=t},setRecommendedLubricantTo(t){this.stateFilterData.RecommendedLubricantTo=t},setValue(t){this.stateFilterData.Value=t},setValueTo(t){this.stateFilterData.ValueTo=t},setUom(t){this.stateFilterData.Uom=t},setUomTo(t){this.stateFilterData.UomTo=t},setStartDate(t){this.stateFilterData.StartDate=t},setStartDateTo(t){this.stateFilterData.StartDateTo=t},setEndDate(t){this.stateFilterData.EndDate=t},setEndDateTo(t){this.stateFilterData.EndDateTo=t},async resetFilter(){this.stateFilterData.Component="",this.stateFilterData.ComponentTo="",this.stateFilterData.RecommendedLubricant="",this.stateFilterData.RecommendedLubricantTo="",this.stateFilterData.Value="",this.stateFilterData.ValueTo="",this.stateFilterData.Uom="",this.stateFilterData.UomTo="",this.stateFilterData.StartDate="",this.stateFilterData.StartDateTo="",this.stateFilterData.EndDate="",this.stateFilterData.EndDateTo="";const t=this.stateLastUsedFilterData.Component!=="",i=this.stateLastUsedFilterData.ComponentTo!=="",e=this.stateLastUsedFilterData.RecommendedLubricant!=="",h=this.stateLastUsedFilterData.RecommendedLubricantTo!=="",n=this.stateLastUsedFilterData.Value!=="",l=this.stateLastUsedFilterData.ValueTo!=="",f=this.stateLastUsedFilterData.Uom!=="",o=this.stateLastUsedFilterData.UomTo!=="",b=this.stateLastUsedFilterData.StartDate!=="",v=this.stateLastUsedFilterData.StartDateTo!=="",F=this.stateLastUsedFilterData.EndDate!=="",_=this.stateLastUsedFilterData.EndDateTo!=="";(t||i||e||h||n||l||f||o||b||v||F||_)&&await this.getData()},resetState(){this.stateFilterData={...it},this.stateDisplayData=[],this.statePagination=new tt,this.stateLoading=!1,this.statePaginationLoading=!1}}}),Dt={componentLubricantId:0,component:"",recomLubri:"",value:0,uom:"",startDate:N(new Date),endDate:N(new Date("12/31/9999"))},G=ut({id:"componentLubricantForm",state:()=>({stateFormData:{...Dt},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1,stateComponentFormOption:[],stateUomFormOption:[]}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading,componentFormOption:t=>t.stateComponentFormOption,uomFormOption:t=>t.stateUomFormOption},actions:{async getFormOptions(t){const i={ver:"v1"};try{const e=await A.get(t=="component"?Jt:Yt,"",new URLSearchParams(i).toString());t=="component"?this.stateComponentFormOption=Xt(e.data.result.content,"component","componentDescription"):this.stateUomFormOption=M(e.data.result.content.uom)}catch(e){console.log(e)}},async insertData(t){try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"},e={componentLubricantId:this.stateFormData.componentLubricantId,component:this.stateFormData.component,recomLubri:this.stateFormData.recomLubri,value:this.stateFormData.value,uom:this.stateFormData.uom,startDate:O(N(new Date(this.stateFormData.startDate))),endDate:O(N(new Date(this.stateFormData.endDate)))},h=await A.post(`${ft}?${new URLSearchParams(i).toString()}`,e);h.data.title==="Error"?(this.stateErrors.push(h.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"},e={componentLubricantId:this.stateFormData.componentLubricantId,component:this.stateFormData.component,recomLubri:this.stateFormData.recomLubri,value:this.stateFormData.value,uom:this.stateFormData.uom,startDate:O(N(new Date(this.stateFormData.startDate))),endDate:O(N(new Date(this.stateFormData.endDate)))},h=await A.post(`${jt}?${new URLSearchParams(i).toString()}`,e);h.data.title==="Error"?(this.stateErrors.push(h.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.componentLubricantId=t.componentLubricantId||0,this.stateFormData.component=t.component||"",this.stateFormData.recomLubri=t.recommendedLubricant||"",this.stateFormData.value=t.value||0,this.stateFormData.uom=t.uom||"",this.stateFormData.startDate=t.startDate||"",this.stateFormData.endDate=t.endDate||""},resetState(){this.stateFormData={...Dt},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),le={key:0,style:{height:"100px"}},de={key:0,class:"row justify-content-center"},ce={key:1,class:"row justify-content-center"},ue={class:"row justify-content-center"},me=["onClick"],pe=B({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:i}){const e=t,h=rt(),n=G(),l=i,f=Qt(()=>(e.page-1)*10+1),o=z(""),b=_=>{o.value=_.order;const y={prop:_.prop,order:_.order};h.setSort(y)},v=(_,y,E)=>Nt(_[E],y[E],o.value),F=_=>{n.setFormData(_),l("show-dialog",null)};return(_,y)=>{const E=R("inline-svg"),w=R("el-tooltip"),U=ot("loading");return s(h).loading?q((C(),Q("div",le,null,512)),[[U,s(h).loading]]):q((C(),k(s(bt),{key:1,data:e.listData,style:{width:"100%"},onSortChange:b,"empty-text":"No Data"},{default:c(()=>[a(s(L),{label:"No",width:"90",align:"center"},{default:c(r=>[u("span",null,$(s(f)+r.$index),1)]),_:1}),a(s(L),{prop:"component",label:"Component",width:"200",sortable:"","sort-method":(r,m)=>v(r,m,"component")},null,8,["sort-method"]),a(s(L),{prop:"recommendedLubricant",label:"Recommended Lubricant",width:"250",sortable:"","sort-method":(r,m)=>v(r,m,"recommendedLubricant")},null,8,["sort-method"]),a(s(L),{prop:"value",label:"Value",width:"110",sortable:"","sort-method":(r,m)=>v(r,m,"value")},null,8,["sort-method"]),a(s(L),{prop:"uom",label:"Uom",width:"100",sortable:"","sort-method":(r,m)=>v(r,m,"uom")},null,8,["sort-method"]),a(s(L),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:c(r=>[u("span",null,$(s(Z)(r.row.startDate)),1)]),_:1}),a(s(L),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:c(r=>[u("span",null,$(s(Z)(r.row.endDate)),1)]),_:1}),a(s(L),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:c(r=>[r.row.isActive?(C(),Q("div",de,[a(E,{src:"/media/svg/tables/rows/check.svg"})])):(C(),Q("div",ce,[a(E,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),a(s(L),{prop:"changedOn",label:"Changed on",align:"center",width:"150",sortable:""},{default:c(r=>[u("span",null,$(s(Ht)(r.row.changedOn)),1)]),_:1}),a(s(L),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(r,m)=>v(r,m,"changedBy")},null,8,["sort-method"]),a(s(L),{label:"",width:"80"},{default:c(r=>[u("div",ue,[a(w,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:c(()=>[u("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:m=>F(r.row)},[a(E,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,me)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[U,s(h).loading]])}}}),he={class:"col-md-6 fv-row fv-plugins-icon-container"},De={class:"col-md-6 fv-row fv-plugins-icon-container"},ge={class:"dialog-footer"},be=B({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=t,h=i,n=G(),l=dt(),f=st(e,"visibility"),o=x(()=>n.formData),b=x(()=>n.errors),v=x(()=>n.isError),F=St().shape({component:K().required("Component is mandatory"),recomLubri:K().required("Recommended Lubricant is mandatory"),value:yt().required("Value is mandatory").typeError("Value should be number"),uom:K().required("Uom is mandatory"),startDate:at().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:at().required("End Date is mandatory").min(Lt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),_=()=>{E(""),w(""),U(0),r(""),m(""),D("")},y=(p=!1)=>{g(),_(),n.resetState(),h("handle-close",p)},E=p=>{o.value.component=p},w=p=>{o.value.recomLubri=p},U=p=>{o.value.value=p},r=p=>{o.value.uom=p},m=p=>{o.value.startDate=p},D=p=>{o.value.endDate=p},P=async()=>{g(),await F.validate(o.value,{abortEarly:!1}).catch(p=>{n.setErrors(p.errors)}),!v.value&&W("Are you sure you want to submit ?").then(async p=>{p.isConfirmed&&n.insertData(l.user.Name).then(()=>{n.isError||ct("Form has been successfully submitted!","Ok").then(()=>{y(!0)})})})},g=()=>{n.setErrors([])};return(p,S)=>{const d=R("el-button"),T=R("el-dialog"),I=ot("loading");return q((C(),k(T,{modelValue:f.value,"onUpdate:modelValue":S[0]||(S[0]=H=>f.value=H),title:"New Data",width:"40%",onClose:S[1]||(S[1]=H=>y())},{footer:c(()=>[u("span",ge,[a(d,{type:"primary",onClick:P,disabled:s(n).loading},{default:c(()=>[V("Submit")]),_:1},8,["disabled"]),a(d,{type:"secondary",onClick:y,disabled:s(n).loading},{default:c(()=>[V("Close")]),_:1},8,["disabled"])])]),default:c(()=>[a(vt,{name:"fade"},{default:c(()=>[v.value?(C(),k(Ft,{key:0,errorMessages:b.value,onResetForm:g},null,8,["errorMessages"])):nt("",!0)]),_:1}),q((C(),k(s(_t),{id:"kt_filter_form",class:"row g-9 my-4"},{default:c(()=>[a(lt,{value:o.value.component,placeholder:"Add Component",label:"Component",name:"Component",max:10,onHandleChange:E,options:s(n).componentFormOption},null,8,["value","options"]),a(j,{value:o.value.recomLubri,margin:!1,placeholder:"Add Recommended Lubricant",label:"Recommended Lubricant",name:"RecommendedLubricant",max:250,onHandleChange:w},null,8,["value"]),a(j,{value:o.value.value,placeholder:"Add Value",label:"Value",name:"Value",max:10,onHandleChange:U},null,8,["value"]),a(lt,{value:o.value.uom,placeholder:"Add Uom",label:"Uom",name:"Uom",max:10,onHandleChange:r,options:s(n).uomFormOption},null,8,["value","options"]),u("div",he,[a(et,{value:o.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:m},null,8,["value"])]),u("div",De,[a(et,{value:o.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:D},null,8,["value"])])]),_:1})),[[I,s(n).loading]])]),_:1},8,["modelValue"])),[[I,s(n).loading]])}}}),fe={class:"col-md-6 fv-row fv-plugins-icon-container"},ve={class:"col-md-6 fv-row fv-plugins-icon-container"},_e={class:"dialog-footer"},Se=B({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=t,h=i,n=G();rt();const l=dt(),f=st(e,"visibility"),o=x(()=>n.formData),b=x(()=>n.errors),v=x(()=>n.isError),F=St().shape({recomLubri:K().required("Recommended Lubricant is mandatory"),value:yt().required("Value is mandatory").typeError("Value should be number"),uom:K().required("Uom is mandatory"),startDate:at().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:at().required("End Date is mandatory").min(Lt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),_=()=>{o.value.componentLubricantId=0,o.value.component="",o.value.recomLubri="",o.value.value=0,o.value.uom="",o.value.startDate="",o.value.endDate=""},y=(g=!1)=>{_(),n.resetState(),P(),h("handle-close",g)},E=g=>{o.value.recomLubri=g},w=g=>{o.value.value=g},U=g=>{o.value.uom=g},r=g=>{o.value.startDate=g},m=g=>{o.value.endDate=g},D=async()=>{P(),await F.validate(o.value,{abortEarly:!1}).catch(g=>{n.setErrors(g.errors)}),!v.value&&W("Are you sure you want to submit ?").then(async g=>{g.isConfirmed&&n.updateData(l.user.Name).then(()=>{n.isError||ct("Form has been successfully submitted!","Ok").then(()=>{y(!0)})})})},P=()=>{n.setErrors([])};return(g,p)=>{const S=R("el-button"),d=R("el-dialog"),T=ot("loading");return q((C(),k(d,{modelValue:f.value,"onUpdate:modelValue":p[0]||(p[0]=I=>f.value=I),title:"Update Data",width:"40%",onClose:p[1]||(p[1]=I=>y())},{footer:c(()=>[u("span",_e,[a(S,{type:"primary",onClick:D,disabled:s(n).loading},{default:c(()=>[V("Submit")]),_:1},8,["disabled"]),a(S,{type:"secondary",onClick:y,disabled:s(n).loading},{default:c(()=>[V("Close")]),_:1},8,["disabled"])])]),default:c(()=>[a(vt,{name:"fade"},{default:c(()=>[v.value?(C(),k(Ft,{key:0,errorMessages:b.value,onResetForm:P},null,8,["errorMessages"])):nt("",!0)]),_:1}),a(s(_t),{id:"kt_filter_form",class:"row g-9 my-4"},{default:c(()=>[a(j,{value:o.value.component,margin:!1,placeholder:"Add Component",label:"Component",name:"Component",max:10,disabled:!0},null,8,["value"]),a(j,{value:o.value.recomLubri,margin:!1,placeholder:"Add Recommended Lubricant",label:"Recommended Lubricant",name:"RecommendedLubricant",max:250,onHandleChange:E},null,8,["value"]),a(j,{value:o.value.value,placeholder:"Add Value",label:"Value",name:"Value",max:10,onHandleChange:w},null,8,["value"]),a(lt,{value:o.value.uom,placeholder:"Add Uom",label:"Uom",name:"Uom",max:10,onHandleChange:U,options:s(n).uomFormOption},null,8,["value","options"]),u("div",fe,[a(et,{value:o.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:r},null,8,["value"])]),u("div",ve,[a(et,{value:o.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:m},null,8,["value"])])]),_:1})]),_:1},8,["modelValue"])),[[T,s(n).loading]])}}}),mt=ut({id:"componentLubricantBulk",state:()=>({statePagination:new tt,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const i={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const e=await A.post(`${Kt}?${new URLSearchParams(i).toString()}`,this.stateBulkData);this.stateError=e.data.result.isError?e.data.result.message:"",this.stateIsError=e.data.result.isError}catch(e){console.log(e)}this.stateLoading=!1},async upload({userAccount:t,excelFile:i}){const e={userAccount:t,ver:"v1"},h=`${Gt}?${new URLSearchParams(e).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const n=await A.postImages(h,i);n.data.statusCode==200?n.data.result.isError?(this.stateIsError=!0,this.stateError=n.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=n.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=oe.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=n.data.result.isError,this.stateError=n.data.result.message)}catch(n){console.log(n),this.stateIsError=!0,this.stateError=n.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(qt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new tt,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),ye={class:"icon"},Le=B({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const i=t,e=mt(),h=x(()=>(i.page-1)*10+1),n=l=>{const f={prop:l.prop,order:l.order};e.setSort(f)};return(l,f)=>{const o=R("inline-svg");return C(),k(s(bt),{data:i.listData,style:{width:"100%"},onSortChange:n,"empty-text":"No Data"},{default:c(()=>[a(s(L),{label:"No",width:"60",align:"center"},{default:c(b=>[u("span",null,$(h.value+b.$index),1)]),_:1}),a(s(L),{prop:"component",label:"component",width:"200",sortable:""}),a(s(L),{prop:"recomLubri",label:"Recommended Lubricant",width:"250",sortable:""}),a(s(L),{prop:"value",label:"Value",width:"150",sortable:""}),a(s(L),{prop:"uom",label:"Uom",width:"150",sortable:""}),a(s(L),{prop:"startDate",label:"Start Date",width:"120",sortable:""},{default:c(b=>[u("span",null,$(s(Z)(b.row.startDate)),1)]),_:1}),a(s(L),{prop:"endDate",label:"End Date",width:"100",sortable:""},{default:c(b=>[u("span",null,$(s(Z)(b.row.endDate)),1)]),_:1}),a(s(L),{prop:"validationReason",label:"Remark",width:"200",sortable:""}),a(s(L),{prop:"isValid",label:"Status","min-width":"100",align:"center",sortable:""},{default:c(b=>[u("div",ye,[a(o,{src:b.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),pt=t=>(Wt("data-v-533923f5"),t=t(),Zt(),t),Fe=pt(()=>u("div",{class:"text-center"},null,-1)),Ee=pt(()=>u("div",{class:"mb-3"},[u("span",null,[V(" Download template "),u("a",{href:"documents/MasterDataComponentLubricant.xlsx",target:"_blank",id:"link-download"},"here"),V(" before uploading file ")])],-1)),Ce=pt(()=>u("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[u("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),Ue={class:"card"},we={class:"card-body grid-padding"},Te={class:"dialog-footer"},Pe=B({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:i}){const e=t,h=i,n=dt(),l=mt(),f=st(e,"visibility"),o=()=>{const r=ne(l.validatedData,m=>{console.log(m);const D=m;return{componentLubricantId:0,component:D.component,recomLubri:D.recomLubri,value:parseInt(D.value),uom:D.uom,startDate:D.startDate,endDate:D.endDate}});return Object.values(r)},b=()=>{const r=document.getElementById("link-download");r&&r.click()},v=()=>{l.validatedData.length>0?W("Cancel Upload Data?","Confirm").then(m=>{m.isConfirmed&&_()}):_()},F=async r=>{await l.upload({userAccount:n.user.Name,excelFile:r}),l.stateError&&Y(l.error)},_=(r=!1)=>{l.resetState(),h("handle-close",r)},y=r=>{l.setIsUploadedState(r)},E=r=>{l.setPage(r)},w=()=>{if(l.validatedData.length<1){b();return}const r=["PARAMETER","VALUE MIN","VALUE MAX","UOM","START DATE","END DATE","REMARK","STATUS"],m=l.validatedData.map(D=>({component:D.component,recomLubri:D.recomLubri,value:D.value,uom:D.uom,startDate:D.startDate,endDate:D.endDate,remark:D.validationReason,status:D.isValid?"OK":"Error"}));Ot("ComponentLubricant",r,m)},U=async()=>{if(l.displayData.length<1){Y("There is no data to submit");return}if(l.isError){Y("There is still invalid row(s)");return}W("Are you sure you want to submit ?").then(async r=>{if(r.isConfirmed){const m=o();if(l.setBulkData(m),await l.bulkInsert(n.user.Name),l.isError){Y(l.stateError);return}ct("Form has been successfully submitted!","Ok").then(()=>{_(!0)})}})};return(r,m)=>{const D=R("el-button"),P=R("el-dialog"),g=ot("loading");return C(),k(P,{title:"Upload Bulk Data",modelValue:f.value,"onUpdate:modelValue":m[1]||(m[1]=p=>f.value=p),"before-close":v,width:"70%","custom-class":"upload-modal"},{footer:c(()=>[u("div",null,[u("span",Te,[a(D,{type:"success",onClick:w},{default:c(()=>[V("Download")]),_:1}),a(D,{type:"primary",onClick:U},{default:c(()=>[V("Upload")]),_:1}),a(D,{type:"success",onClick:v},{default:c(()=>[V("Cancel")]),_:1})])])]),default:c(()=>[Fe,Ee,q(a(se,{isSubmissionUploadSuccess:s(l).isUploaded,onHandleCloseUploadedFile:v,onHandleUpload:F,onHandleSetIsExcelFileUploaded:y},null,8,["isSubmissionUploadSuccess"]),[[g,s(l).uploadLoading]]),Ce,u("div",Ue,[u("div",we,[a(Le,{"list-data":s(l).displayData,page:s(l).pagination.currentPage},null,8,["list-data","page"])])]),s(l).displayData.length>0?(C(),k(gt,{key:0,onRaisePageChange:m[0]||(m[0]=p=>E(p)),currentPage:s(l).pagination.currentPage,totalPage:s(l).pagination.totalPage,totalPageSize:s(l).pagination.totalPageSize,startPaginationIndex:s(l).pagination.startPaginationIndex,endPaginationIndex:s(l).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):nt("",!0)]),_:1},8,["modelValue"])}}}),ke=re(Pe,[["__scopeId","data-v-533923f5"]]),Ve={class:"row g-9 my-4"},Re={class:"dialog-footer"},Ie=B({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=rt(),h=G(),n=t,l=i,f=st(n,"visibility"),o=x(()=>e.filterData),b=()=>{v(),e.resetFilter()},v=()=>{l("handle-close",!1)},F=d=>{e.setComponent(d)},_=d=>{e.setComponentTo(d)},y=d=>{e.setRecommendedLubricant(d)},E=d=>{e.setRecommendedLubricantTo(d)},w=d=>{e.setValue(d)},U=d=>{e.setValueTo(d)},r=d=>{e.setUom(d)},m=d=>{e.setUomTo(d)},D=d=>{e.setStartDate(d)},P=d=>{e.setStartDateTo(d)},g=d=>{e.setEndDate(d)},p=d=>{e.setEndDateTo(d)},S=()=>{const d=e.lastUsedFilterData.Component!==e.filterData.Component,T=e.lastUsedFilterData.ComponentTo!==e.filterData.ComponentTo,I=e.lastUsedFilterData.RecommendedLubricant!==e.filterData.RecommendedLubricant,H=e.lastUsedFilterData.RecommendedLubricantTo!==e.filterData.RecommendedLubricantTo,X=e.lastUsedFilterData.Value!==e.filterData.Value,Et=e.lastUsedFilterData.ValueTo!==e.filterData.ValueTo,Ct=e.lastUsedFilterData.Uom!==e.filterData.Uom,Ut=e.lastUsedFilterData.UomTo!==e.filterData.UomTo,wt=e.lastUsedFilterData.StartDate!==e.filterData.StartDate,Tt=e.lastUsedFilterData.StartDateTo!==e.filterData.StartDateTo,Pt=e.lastUsedFilterData.EndDate!==e.filterData.EndDate,kt=e.lastUsedFilterData.EndDateTo!==e.filterData.EndDateTo;l("handle-close",d||T||I||H||X||Et||Ct||Ut||wt||Tt||Pt||kt)};return(d,T)=>{const I=R("el-button"),H=R("el-dialog");return C(),k(H,{modelValue:f.value,"onUpdate:modelValue":T[0]||(T[0]=X=>f.value=X),title:"Filter",width:"60%",onClose:T[1]||(T[1]=X=>v())},{footer:c(()=>[u("span",Re,[a(I,{type:"secondary",onClick:b},{default:c(()=>[V("Reset")]),_:1}),a(I,{type:"primary",onClick:S},{default:c(()=>[V("Filter")]),_:1})])]),default:c(()=>[u("div",Ve,[a(J,{"value-from":o.value.Component,"value-to":o.value.ComponentTo,label:"Component",name:"Component",options:s(h).componentFormOption,onHandleChangeFrom:F,onHandleChangeTo:_},null,8,["value-from","value-to","options"]),a(J,{"value-from":o.value.RecommendedLubricant,"value-to":o.value.RecommendedLubricantTo,label:"Recommended Lubricant",name:"RecommendedLubricant",options:s(e).recommendedLubricantOption,onHandleChangeFrom:y,onHandleChangeTo:E},null,8,["value-from","value-to","options"]),a(J,{"value-from":o.value.Value,"value-to":o.value.ValueTo,label:"Value",name:"Value",options:s(e).valueOption,onHandleChangeFrom:w,onHandleChangeTo:U},null,8,["value-from","value-to","options"]),a(J,{"value-from":o.value.Uom,"value-to":o.value.UomTo,label:"Uom",name:"Uom",options:s(e).uomOption,onHandleChangeFrom:r,onHandleChangeTo:m},null,8,["value-from","value-to","options"]),a(ht,{"value-from":o.value.StartDate?o.value.StartDate.toString():"","value-to":o.value.StartDateTo?o.value.StartDateTo.toString():"",label:"Start Date",name:"StartDate",placeholder:"Pick a date",onHandleChangeFrom:D,onHandleChangeTo:P},null,8,["value-from","value-to"]),a(ht,{"value-from":o.value.EndDate?o.value.EndDate.toString():"","value-to":o.value.EndDateTo?o.value.EndDateTo.toString():"",label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChangeFrom:g,onHandleChangeTo:p},null,8,["value-from","value-to"])])]),_:1},8,["modelValue"])}}}),xe={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},Oe=u("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),Ae={class:"d-flex justify-content-between align-items-center"},$e={class:"card"},Be={class:"card-body grid-padding"},He={class:"my-5"},Ja=B({__name:"Index",setup(t){const i=Vt(),e=rt(),h=G(),n=mt(),l=z(!1),f=z(!1),o=z(!1),b=z(!1),v=x(()=>e.displayData),F=x(()=>e.pagination),_=S=>{e.setPage(S)};te(async()=>{i.dispatch(It.ACTIVE_PAGE,"IronLake"),Rt("Component Lubricant",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Parameter",pageRoute:"componentlubricant"},{pageName:"Component Lubricant",pageRoute:"componentlubricant"}]),e.setPage(1),await e.getLookup(),await h.getFormOptions("component"),await h.getFormOptions("uom")}),ee(()=>{e.resetState(),h.resetState(),n.resetState()});const y=async()=>{await e.setPage(1),await e.getLookup(),await h.getFormOptions("component"),await h.getFormOptions("uom")},E=()=>{l.value=!0},w=async S=>{l.value=!1,S&&await y()},U=()=>{f.value=!0},r=async S=>{f.value=!1,S&&await y()},m=()=>{o.value=!0},D=async S=>{o.value=!1,S&&await y()},P=async()=>{const S=await e.export();ie.saveAs(new Blob([S],{type:"application/octet-stream"}),"Component Lubricant.xlsx")},g=()=>{b.value=!0},p=async S=>{b.value=!1,S&&await y()};return(S,d)=>(C(),Q(ae,null,[u("div",xe,[Oe,u("div",Ae,[a(At,{onShowDialog:E}),a(xt,{onShowDialog:m}),a(Bt,{onHandleDownload:P}),a($t,{onShowDialog:g})])]),u("div",$e,[u("div",Be,[a(pe,{"list-data":v.value,page:F.value.currentPage,onShowDialog:U},null,8,["list-data","page"])])]),u("div",He,[s(e).paginationLoading?nt("",!0):(C(),k(gt,{key:0,onRaisePageChange:d[0]||(d[0]=T=>_(T)),currentPage:F.value.currentPage,totalPage:F.value.totalPage,totalPageSize:F.value.totalPageSize,startPaginationIndex:F.value.startPaginationIndex,endPaginationIndex:F.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),a(be,{visibility:l.value,onHandleClose:w},null,8,["visibility"]),a(Se,{visibility:f.value,onHandleClose:r},null,8,["visibility"]),a(Ie,{visibility:o.value,onHandleClose:D},null,8,["visibility"]),a(ke,{visibility:b.value,onHandleClose:p},null,8,["visibility"])],64))}});export{Ja as default};

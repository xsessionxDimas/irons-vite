import{u as vt}from"./vuex-BbOKrtVp.js";import{a as Ct}from"./breadcrumb-BYmEOf4C.js";import{c as A,a as et,J as K,I as st,z as M,A as _t}from"./index-BuVmIl8K.js";import{P as ut}from"./Pagination-D-xfdYmn.js";import{F as Tt}from"./FilterIconButton-Bj0WTbms.js";import{h as St,A as Et,U as bt}from"./excel-generator-DMHRo93s.js";import{D as wt}from"./DownloadIconButton-CIQp-YG7.js";import{_ as E,b as ht}from"./element-plus-BeWdvTRa.js";import{q as P,w as $,x as nt,y as Vt}from"./date-format-8-IvfSl3.js";import{P as G}from"./Pagination-BiobnanQ.js";import{C as pt,a as Ft,E as Pt,U as kt,B as Lt,b as It}from"./urls-DwU4yR0D.js";import{L as Ut}from"./urls-DTUjp4BB.js";import{d as rt}from"./pinia-BjOS2_Ao.js";import{a as lt}from"./mapOption-CeGMwmH0.js";import{k as x,bL as $t,r as N,u as s,y as B,p as w,aa as j,q as k,x as h,Y as W,R as I,s as e,aB as c,C as q,a0 as Z,c as U,B as L,A as tt,T as mt,bd as At,bb as xt,a7 as Ot,L as Rt,F as Bt}from"./@vue-BypzYtbH.js";import{a as Ht,d as Nt}from"./table-sort-Bpdq_Uwn.js";import{a as Dt}from"./vee-validate-C_msoaAA.js";import{c as gt,a as Y,b as J,d as yt}from"./yup-C6P98bvY.js";import"./property-expr-DEi1ZLzV.js";import{E as ft}from"./ErrorAlert-CMKGfwAi.js";import{_ as X}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CCwjwK39.js";import{_ as Q}from"./AutoComplete.vue_vue_type_script_setup_true_lang-DJ43pGTI.js";import{e as qt}from"./lodash-DrHMlsdo.js";import{_ as zt}from"./FileDropZone.vue_vue_type_style_index_0_lang-C5PyimC7.js";import{m as Mt}from"./map-anything-abi6NY2Z.js";import{_ as jt}from"./nw-img-vue-CR837WER.js";import{_ as ct}from"./AutoComplete.vue_vue_type_style_index_0_lang-DrAAOf71.js";import{_ as dt}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-CJ7rJST9.js";import{F as Kt}from"./file-saver-CwTBvle_.js";import"./object-path-DPahbflh.js";import"./@popperjs-BaMZbQYT.js";import"./deepmerge-oeePEK50.js";import"./vue-router-iNp9kJ0K.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./useMenuStore-CD5Gmvif.js";import"./PageEnum-DUtfSNQS.js";import"./xlsx-C4maHrMm.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-NSxIV7Fb.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";const z=rt({id:"CharacteristicTypeValueList",state:()=>({stateFilterData:{CharacteristicType:"",CharacteristicValue:"",CharacteristicTypeTo:"",CharacteristicValueTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},stateLastUsedFilterData:{CharacteristicType:"",CharacteristicValue:"",CharacteristicTypeTo:"",CharacteristicValueTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},statePageName:"CharacteristicType",stateDisplayData:[],statePagination:new G,stateLoading:!1,statePaginationLoading:!1,stateCharacteristicTypeOption:[],stateCharacteristicValueOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,CharacteristicTypeOption:t=>t.stateCharacteristicTypeOption,CharacteristicValueOption:t=>t.stateCharacteristicValueOption},actions:{async getData(t=!0){const i={CharacteristicType:this.stateFilterData.CharacteristicType,CharacteristicValue:this.stateFilterData.CharacteristicValue,CharacteristicTypeTo:this.stateFilterData.CharacteristicTypeTo,CharacteristicValueTo:this.stateFilterData.CharacteristicValueTo,StartDateTo:this.stateFilterData.StartDateTo?P(this.stateFilterData.StartDateTo.toLocaleString()):"",EndDateTo:this.stateFilterData.EndDateTo?P(this.stateFilterData.EndDateTo.toLocaleString()):"",StartDate:this.stateFilterData.StartDate?P(this.stateFilterData.StartDate.toLocaleString()):"",EndDate:this.stateFilterData.EndDate?P(this.stateFilterData.EndDate.toLocaleString()):"",Page:this.stateFilterData.Page.toString(),PageSize:this.stateFilterData.PageSize.toString(),Order:this.stateFilterData.Order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const a=await A.get(pt,"",new URLSearchParams(i).toString());this.stateDisplayData=a.data.result.content,this.setTotalPage(a.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(a){console.log(a)}this.stateLoading=!1},async getLookupType(){const t={ver:this.stateFilterData.ver};try{const i=await A.get(Ft,"",new URLSearchParams(t).toString());this.stateCharacteristicTypeOption=lt(i.data.result.content,"characteristicType","characteristicTypeDesc")}catch(i){console.log(i)}},async getLookupValue(){const t={ver:this.stateFilterData.ver};try{const i=await A.get(Ut,"",new URLSearchParams(t).toString());this.stateCharacteristicValueOption=lt(i.data.result.content,"characteristicValue","characteristicValueDescription")}catch(i){console.log(i)}},async export(){const t={CharacteristicType:this.stateFilterData.CharacteristicType,CharacteristicValue:this.stateFilterData.CharacteristicValue,CharacteristicTypeTo:this.stateFilterData.CharacteristicTypeTo,CharacteristicValueTo:this.stateFilterData.CharacteristicValueTo,StartDateTo:this.stateFilterData.StartDateTo?P(this.stateFilterData.StartDateTo.toLocaleString()):"",EndDateTo:this.stateFilterData.EndDateTo?P(this.stateFilterData.EndDateTo.toLocaleString()):"",StartDate:this.stateFilterData.StartDate?P(this.stateFilterData.StartDate.toLocaleString()):"",EndDate:this.stateFilterData.EndDate?P(this.stateFilterData.EndDate.toLocaleString()):"",ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await A.getBlob(Pt,"",new URLSearchParams(t).toString())).data}catch(i){console.log(i)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:i}){if(!t&&!i)this.stateFilterData.Order="";else{const a=i=="ascending"?"asc":"desc";this.stateFilterData.Order=`${t}_${a}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.Page=this.statePagination.currentPage,await this.getData(!1)},setCharacteristicType(t){this.stateFilterData.CharacteristicType=t},setCharacteristicValue(t){this.stateFilterData.CharacteristicValue=t},setCharacteristicTypeTo(t){this.stateFilterData.CharacteristicTypeTo=t},setCharacteristicValueTo(t){this.stateFilterData.CharacteristicValueTo=t},setStartDate(t){this.stateFilterData.StartDate=t},setStartDateTo(t){this.stateFilterData.StartDateTo=t},setEndDate(t){this.stateFilterData.EndDate=t},setEndDateTo(t){this.stateFilterData.EndDateTo=t},async resetFilter(){this.stateFilterData.CharacteristicType="",this.stateFilterData.CharacteristicValue="",this.stateFilterData.CharacteristicTypeTo="",this.stateFilterData.CharacteristicValueTo="",this.stateFilterData.StartDate="",this.stateFilterData.StartDateTo="",this.stateFilterData.EndDate="",this.stateFilterData.EndDateTo="";const t=this.stateLastUsedFilterData.CharacteristicTypeTo!=="",i=this.stateLastUsedFilterData.CharacteristicValueTo!=="",a=this.stateLastUsedFilterData.CharacteristicType!=="",g=this.stateLastUsedFilterData.CharacteristicValue!=="",r=this.stateLastUsedFilterData.StartDate!=="",o=this.stateLastUsedFilterData.StartDateTo!=="",m=this.stateLastUsedFilterData.EndDate!=="",y=this.stateLastUsedFilterData.EndDateTo!=="";(t||i||a||g||r||o||m||y)&&await this.getData()},resetState(){this.stateFilterData={CharacteristicType:"",CharacteristicValue:"",CharacteristicTypeTo:"",CharacteristicValueTo:"",StartDate:"",StartDateTo:"",EndDate:"",EndDateTo:"",ver:"v1",Page:1,PageSize:10,Order:""},this.stateDisplayData=[],this.statePagination=new G,this.stateLoading=!1,this.statePaginationLoading=!1}}}),at=rt({id:"CharacteristicTypeValueForm",state:()=>({stateFormData:{mdCharacteristicTypeValueId:0,startDate:$(new Date),endDate:$(new Date("12/31/9999"))},stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1}),getters:{formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading},actions:{async insertData(t){this.stateFormData.startDate=P($(new Date(this.stateFormData.startDate))),this.stateFormData.endDate=P($(new Date(this.stateFormData.endDate)));try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"},a=await A.post(`${pt}?${new URLSearchParams(i).toString()}`,this.stateFormData);a.data.title==="Error"?(this.stateErrors.push(a.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},async updateData(t){this.stateFormData.startDate=P($(new Date(this.stateFormData.startDate))),this.stateFormData.endDate=P($(new Date(this.stateFormData.endDate)));try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"},a=await A.post(`${kt}?${new URLSearchParams(i).toString()}`,this.stateFormData);a.data.title==="Error"?(this.stateErrors.push(a.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.mdCharacteristicTypeValueId=t.mdCharacteristicTypeValueId||0,this.stateFormData.characteristicType=t.characteristicType||"",this.stateFormData.characteristicValue=t.characteristicValue||"",this.stateFormData.startDate=t.startDate||"",this.stateFormData.endDate=t.endDate||""},resetState(){this.stateFormData={mdCharacteristicTypeValueId:0,startDate:$(new Date),endDate:$(new Date("12/31/9999"))},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),Gt={key:0,style:{height:"100px"}},Yt={key:0,class:"row justify-content-center"},Jt={key:1,class:"row justify-content-center"},Xt={class:"row justify-content-center"},Qt=["onClick"],Wt=x({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["show-dialog"],setup(t,{emit:i}){const a=t,g=z(),r=at(),o=i,m=$t(()=>(a.page-1)*10+1),y=N(""),l=f=>{y.value=f.order;const S={prop:f.prop,order:f.order};g.setSort(S)},b=(f,S,v)=>Ht(f[v],S[v],y.value),_=f=>{r.setFormData(f),o("show-dialog",null)};return(f,S)=>{const v=I("inline-svg"),F=I("el-tooltip"),V=W("loading");return s(g).loading?B((w(),j("div",Gt,null,512)),[[V,s(g).loading]]):B((w(),k(s(ht),{key:1,data:a.listData,style:{width:"100%"},onSortChange:l,"empty-text":"No Data"},{default:h(()=>[e(s(E),{label:"No",width:"90",align:"center"},{default:h(n=>[c("span",null,q(s(m)+n.$index),1)]),_:1}),e(s(E),{prop:"characteristicType",label:"Characteristic Type",width:"250",sortable:"","sort-method":(n,p)=>b(n,p,"characteristicType")},null,8,["sort-method"]),e(s(E),{prop:"characteristicValue",label:"Characteristic Value","min-width":"250",sortable:"","sort-method":(n,p)=>b(n,p,"characteristicValue")},null,8,["sort-method"]),e(s(E),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:h(n=>[c("span",null,q(s(nt)(n.row.startDate)),1)]),_:1}),e(s(E),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:h(n=>[c("span",null,q(s(nt)(n.row.endDate)),1)]),_:1}),e(s(E),{prop:"isActive",label:"Is Active",width:"100",sortable:""},{default:h(n=>[n.row.isActive?(w(),j("div",Yt,[e(v,{src:"/media/svg/tables/rows/check.svg"})])):(w(),j("div",Jt,[e(v,{src:"/media/svg/tables/rows/minus.svg"})]))]),_:1}),e(s(E),{prop:"changedOn",label:"Changed on",align:"center",width:"170",sortable:""},{default:h(n=>[c("span",null,q(s(Vt)(n.row.changedOn)),1)]),_:1}),e(s(E),{prop:"changedBy",label:"Changed by",sortable:"",width:"300","sort-method":(n,p)=>b(n,p,"changedBy")},null,8,["sort-method"]),e(s(E),{label:"",width:"80"},{default:h(n=>[c("div",Xt,[e(F,{class:"box-item",effect:"dark",content:"Edit",placement:"top"},{default:h(()=>[c("button",{class:"btn btn-sm btn-icon btn-bg-light me-1",onClick:p=>_(n.row)},[e(v,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,Qt)]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[V,s(g).loading]])}}}),Zt={class:"row g-4 my-4"},ta={class:"col-md-6 fv-row fv-plugins-icon-container"},aa={class:"col-md-6 fv-row fv-plugins-icon-container"},ea={class:"col-md-6 fv-row fv-plugins-icon-container"},sa={class:"col-md-6 fv-row fv-plugins-icon-container"},ra={class:"dialog-footer"},ia=x({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const a=t,g=i,r=at(),o=et(),m=z(),y=Z(a,"visibility"),l=U(()=>r.formData),b=U(()=>r.errors),_=U(()=>r.isError),f=gt().shape({characteristicType:Y().required("Characteristic Type is mandatory"),characteristicValue:Y().required("Characteristic Value is mandatory"),startDate:J().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:J().required("End Date is mandatory").min(yt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),S=()=>{F(""),V(""),n(""),p("")},v=(u=!1)=>{T(),S(),r.resetState(),g("handle-close",u)},F=u=>{l.value.characteristicType=u},V=u=>{l.value.characteristicValue=u},n=u=>{l.value.startDate=u},p=u=>{l.value.endDate=u},d=async()=>{T(),await f.validate(l.value,{abortEarly:!1}).catch(u=>{r.setErrors(u.errors)}),!_.value&&K("Are you sure you want to submit ?").then(async u=>{u.isConfirmed&&r.insertData(o.user.Name).then(()=>{r.isError||st("Form has been successfully submitted!","Ok").then(()=>{v(!0)})})})},T=()=>{r.setErrors([])};return(u,C)=>{const D=I("el-button"),O=I("el-dialog"),R=W("loading");return B((w(),k(O,{modelValue:y.value,"onUpdate:modelValue":C[0]||(C[0]=H=>y.value=H),title:"New Data",width:"40%",onClose:C[1]||(C[1]=H=>v())},{footer:h(()=>[c("span",ra,[e(D,{type:"primary",onClick:d,disabled:s(r).loading},{default:h(()=>[L("Submit")]),_:1},8,["disabled"]),e(D,{type:"secondary",onClick:v,disabled:s(r).loading},{default:h(()=>[L("Close")]),_:1},8,["disabled"])])]),default:h(()=>[e(mt,{name:"fade"},{default:h(()=>[_.value?(w(),k(ft,{key:0,errorMessages:b.value,onResetForm:T},null,8,["errorMessages"])):tt("",!0)]),_:1}),B((w(),k(s(Dt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:h(()=>[c("div",Zt,[c("div",ta,[e(Q,{value:l.value.characteristicType,label:"Characteristic Type",placeholder:"Add Characteristic Type",name:"CharacteristicType",options:s(m).CharacteristicTypeOption,onHandleChange:F},null,8,["value","options"])]),c("div",aa,[e(Q,{value:l.value.characteristicValue,label:"Characteristic Value",placeholder:"Add Characteristic Value",name:"CharacteristicValue",options:s(m).CharacteristicValueOption,onHandleChange:V},null,8,["value","options"])]),c("div",ea,[e(X,{value:l.value.startDate?l.value.startDate.toString():"",placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:n},null,8,["value"])]),c("div",sa,[e(X,{value:l.value.endDate?l.value.endDate.toString():"",placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:p},null,8,["value"])])])]),_:1})),[[R,s(r).loading]])]),_:1},8,["modelValue"])),[[R,s(r).loading]])}}}),oa={class:"row g-4 my-4"},na={class:"col-md-6 fv-row fv-plugins-icon-container"},la={class:"col-md-6 fv-row fv-plugins-icon-container"},ca={class:"col-md-6 fv-row fv-plugins-icon-container"},da={class:"col-md-6 fv-row fv-plugins-icon-container"},ua={class:"dialog-footer"},ha=x({__name:"FormEditDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const a=t,g=i,r=at(),o=z(),m=et(),y=Z(a,"visibility"),l=U(()=>r.formData),b=U(()=>r.errors),_=U(()=>r.isError),f=gt().shape({characteristicType:Y().required("Characteristic Type is mandatory"),characteristicValue:Y().required("Characteristic Value is mandatory"),startDate:J().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:J().required("End Date is mandatory").min(yt("startDate"),"End date must be later than start date").typeError("End Date is mandatory")}),S=()=>{l.value.mdCharacteristicTypeValueId=0,l.value.characteristicType="",l.value.characteristicValue="",l.value.startDate="",l.value.endDate=""},v=(u=!1)=>{S(),r.resetState(),T(),g("handle-close",u)},F=u=>{l.value.characteristicValue=u},V=u=>{l.value.characteristicType=u},n=u=>{l.value.startDate=u},p=u=>{l.value.endDate=u},d=async()=>{T(),await f.validate(l.value,{abortEarly:!1}).catch(u=>{r.setErrors(u.errors)}),!_.value&&K("Are you sure you want to submit ?").then(async u=>{u.isConfirmed&&r.updateData(m.user.Name).then(()=>{r.isError||st("Form has been successfully submitted!","Ok").then(()=>{v(!0)})})})},T=()=>{r.setErrors([])};return(u,C)=>{const D=I("el-button"),O=I("el-dialog"),R=W("loading");return B((w(),k(O,{modelValue:y.value,"onUpdate:modelValue":C[0]||(C[0]=H=>y.value=H),title:"Update Data",width:"40%",onClose:C[1]||(C[1]=H=>v())},{footer:h(()=>[c("span",ua,[e(D,{type:"primary",onClick:d,disabled:s(r).loading},{default:h(()=>[L("Submit")]),_:1},8,["disabled"]),e(D,{type:"secondary",onClick:v,disabled:s(r).loading},{default:h(()=>[L("Close")]),_:1},8,["disabled"])])]),default:h(()=>[e(mt,{name:"fade"},{default:h(()=>[_.value?(w(),k(ft,{key:0,errorMessages:b.value,onResetForm:T},null,8,["errorMessages"])):tt("",!0)]),_:1}),e(s(Dt),{id:"kt_filter_form",class:"row g-9 my-4"},{default:h(()=>[c("div",oa,[c("div",na,[e(Q,{value:l.value.characteristicType,label:"Characteristic Type",placeholder:"Add Characteristic Type",name:"CharacteristicType",options:s(o).CharacteristicTypeOption,onHandleChange:V},null,8,["value","options"])]),c("div",la,[e(Q,{value:l.value.characteristicValue,label:"Characteristic Value",placeholder:"Add Characteristic Value",name:"CharacteristicValue",options:s(o).CharacteristicValueOption,onHandleChange:F},null,8,["value","options"])]),c("div",ca,[e(X,{value:l.value.startDate?l.value.startDate.toString():"",placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:n},null,8,["value"])]),c("div",da,[e(X,{value:l.value.endDate?l.value.endDate.toString():"",placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:p},null,8,["value"])])])]),_:1})]),_:1},8,["modelValue"])),[[R,s(r).loading]])}}}),it=rt({id:"CharacteristicTypeValueBulk",state:()=>({statePagination:new G,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const i={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const a=await A.post(`${Lt}?${new URLSearchParams(i).toString()}`,this.stateBulkData);this.stateError=a.data.result.isError?a.data.result.message:"",this.stateIsError=a.data.result.isError}catch(a){console.log(a)}this.stateLoading=!1},async upload({userAccount:t,excelFile:i}){const a={userAccount:t,ver:"v1"},g=`${It}?${new URLSearchParams(a).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const r=await A.postImages(g,i);r.data.statusCode==200?r.data.result.isError?(this.stateIsError=!0,this.stateError=r.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=r.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=qt.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=r.data.result.isError,this.stateError=r.data.result.message)}catch(r){console.log(r),this.stateIsError=!0,this.stateError=r.response.data.result.message}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(Nt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new G,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),pa={class:"icon"},ma=x({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const i=t,a=it(),g=U(()=>(i.page-1)*10+1),r=o=>{const m={prop:o.prop,order:o.order};a.setSort(m)};return(o,m)=>{const y=I("inline-svg");return w(),k(s(ht),{data:i.listData,style:{width:"100%"},onSortChange:r,"empty-text":"No Data"},{default:h(()=>[e(s(E),{label:"No",width:"60",align:"center"},{default:h(l=>[c("span",null,q(g.value+l.$index),1)]),_:1}),e(s(E),{prop:"characteristicType",label:"Characteristic Type",width:"300",sortable:""}),e(s(E),{prop:"characteristicValue",label:"Characteristic Value",sortable:""}),e(s(E),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""}),e(s(E),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""}),e(s(E),{prop:"validationReason",label:"Remark","min-width":"300",sortable:""}),e(s(E),{prop:"isValid",label:"Status",width:"100",sortable:""},{default:h(l=>[c("div",pa,[e(y,{src:l.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),ot=t=>(At("data-v-fdd3e9fb"),t=t(),xt(),t),Da=ot(()=>c("div",{class:"text-center"},null,-1)),ga=ot(()=>c("div",{class:"mb-3"},[c("span",null,[L(" Download template "),c("a",{href:"documents/MasterDataCharacteristicTypeValue.xlsx",target:"_blank",id:"link-download"},"here"),L(" before uploading file ")])],-1)),ya=ot(()=>c("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[c("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),fa={class:"card"},va={class:"card-body grid-padding"},Ca={class:"dialog-footer"},_a=x({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:i}){const a=t,g=i,r=et(),o=it(),m=Z(a,"visibility"),y=()=>{const n=Mt(o.validatedData,p=>{const d=p;return{mdCharacteristicTypeValueId:0,characteristicType:d.characteristicType,characteristicValue:d.characteristicValue,startDate:d.startDate,endDate:d.endDate}});return Object.values(n)},l=()=>{const n=document.getElementById("link-download");n&&n.click()},b=()=>{o.validatedData.length>0?K("Cancel Upload Data?","Confirm").then(p=>{p.isConfirmed&&f()}):f()},_=async n=>{await o.upload({userAccount:r.user.Name,excelFile:n}),o.stateError&&M(o.error)},f=(n=!1)=>{o.resetState(),g("handle-close",n)},S=n=>{o.setIsUploadedState(n)},v=n=>{o.setPage(n)},F=()=>{if(o.validatedData.length<1){l();return}const n=["CHARACTERISTIC TYPE","CHARACTERISTIC VALUE","START DATE","END DATE","REMARK","STATUS"],p=o.validatedData.map(d=>({CharacteristicType:d.characteristicType,CharacteristicValue:d.characteristicValue,StartDate:d.startDate,EndDate:d.endDate,remark:d.validationReason,status:d.isValid?"OK":"Error"}));St("Characteristic Type Value",n,p)},V=async()=>{if(o.displayData.length<1){M("There is no data to submit");return}if(o.isError){M("There is still invalid row(s)");return}K("Are you sure you want to submit ?").then(async n=>{if(n.isConfirmed){const p=y();if(o.setBulkData(p),await o.bulkInsert(r.user.Name),o.isError){M(o.stateError);return}st("Form has been successfully submitted!","Ok").then(()=>{f(!0)})}})};return(n,p)=>{const d=I("el-button"),T=I("el-dialog"),u=W("loading");return w(),k(T,{title:"Upload Bulk Data",modelValue:m.value,"onUpdate:modelValue":p[1]||(p[1]=C=>m.value=C),"before-close":b,width:"70%","custom-class":"upload-modal"},{footer:h(()=>[c("div",null,[c("span",Ca,[e(d,{type:"success",onClick:F},{default:h(()=>[L("Download")]),_:1}),e(d,{type:"primary",onClick:V},{default:h(()=>[L("Upload")]),_:1}),e(d,{type:"success",onClick:b},{default:h(()=>[L("Cancel")]),_:1})])])]),default:h(()=>[Da,ga,B(e(zt,{isSubmissionUploadSuccess:s(o).isUploaded,onHandleCloseUploadedFile:b,onHandleUpload:_,onHandleSetIsExcelFileUploaded:S},null,8,["isSubmissionUploadSuccess"]),[[u,s(o).uploadLoading]]),ya,c("div",fa,[c("div",va,[e(ma,{"list-data":s(o).displayData,page:s(o).pagination.currentPage},null,8,["list-data","page"])])]),s(o).displayData.length>0?(w(),k(ut,{key:0,onRaisePageChange:p[0]||(p[0]=C=>v(C)),currentPage:s(o).pagination.currentPage,totalPage:s(o).pagination.totalPage,totalPageSize:s(o).pagination.totalPageSize,startPaginationIndex:s(o).pagination.startPaginationIndex,endPaginationIndex:s(o).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):tt("",!0)]),_:1},8,["modelValue"])}}}),Ta=jt(_a,[["__scopeId","data-v-fdd3e9fb"]]),Sa={class:"row g-9 my-4"},Ea={class:"w-100 fv-row fv-plugins-icon-container"},ba={class:"w-100 fv-row fv-plugins-icon-container"},wa={class:"w-100 fv-row fv-plugins-icon-container"},Va={class:"w-100 fv-row fv-plugins-icon-container"},Fa={class:"dialog-footer"},Pa=x({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const a=z(),g=t,r=i,o=Z(g,"visibility"),m=U(()=>a.filterData),y=()=>{l(),a.resetFilter()},l=()=>{r("handle-close",!1)},b=d=>{a.setCharacteristicType(d)},_=d=>{a.setCharacteristicValue(d)},f=d=>{a.setCharacteristicTypeTo(d)},S=d=>{a.setCharacteristicValueTo(d)},v=d=>{a.setStartDate(d)},F=d=>{a.setStartDateTo(d)},V=d=>{a.setEndDate(d)},n=d=>{a.setEndDateTo(d)},p=()=>{const d=a.lastUsedFilterData.CharacteristicType!==a.filterData.CharacteristicType,T=a.lastUsedFilterData.CharacteristicValue!==a.filterData.CharacteristicValue,u=a.lastUsedFilterData.StartDate!==a.filterData.StartDate,C=a.lastUsedFilterData.EndDate!==a.filterData.EndDate;r("handle-close",d||T||u||C)};return(d,T)=>{const u=I("el-button"),C=I("el-dialog");return w(),k(C,{modelValue:o.value,"onUpdate:modelValue":T[0]||(T[0]=D=>o.value=D),title:"Filter",width:"60%",onClose:T[1]||(T[1]=D=>l())},{footer:h(()=>[c("span",Fa,[e(u,{type:"secondary",onClick:y},{default:h(()=>[L("Reset")]),_:1}),e(u,{type:"primary",onClick:p},{default:h(()=>[L("Filter")]),_:1})])]),default:h(()=>[c("div",Sa,[c("div",Ea,[e(ct,{"value-from":m.value.CharacteristicType,"value-to":m.value.CharacteristicTypeTo,label:"Characteristic Type",name:"CharacteristicType",options:s(a).CharacteristicTypeOption,onHandleChangeFrom:b,onHandleChangeTo:f},null,8,["value-from","value-to","options"])]),c("div",ba,[e(ct,{"value-from":m.value.CharacteristicValue,"value-to":m.value.CharacteristicValueTo,label:"Characteristic Type",name:"CharacteristicValue",options:s(a).CharacteristicValueOption,onHandleChangeFrom:_,onHandleChangeTo:S},null,8,["value-from","value-to","options"])]),c("div",wa,[e(dt,{"value-from":m.value.StartDate,"value-to":m.value.StartDateTo,label:"Start Date",onHandleChangeFrom:v,onHandleChangeTo:F},null,8,["value-from","value-to"])]),c("div",Va,[e(dt,{"value-from":m.value.EndDate,"value-to":m.value.EndDateTo,label:"End Date",onHandleChangeFrom:V,onHandleChangeTo:n},null,8,["value-from","value-to"])])])]),_:1},8,["modelValue"])}}}),ka={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},La=c("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),Ia={class:"d-flex justify-content-between align-items-center"},Ua={class:"card"},$a={class:"card-body grid-padding"},Aa={class:"my-5"},Ye=x({__name:"Index",setup(t){const i=vt(),a=z(),g=at(),r=it(),o=N(!1),m=N(!1),y=N(!1),l=N(!1),b=U(()=>a.displayData),_=U(()=>a.pagination),f=D=>{a.setPage(D)};Ot(async()=>{i[_t.ACTIVE_PAGE]("IronLake"),Ct("Characteristic Type Value",[{pageName:"Iron Lake",pageRoute:"ironlake"},{pageName:"Equipment",pageRoute:"characteristictypevalue"},{pageName:"Characteristic Type Value",pageRoute:"characteristictypevalue"}]),a.setPage(1),a.getLookupType(),a.getLookupValue()}),Rt(()=>{a.resetState(),g.resetState(),r.resetState()});const S=async()=>{await a.setPage(1),a.getLookupType(),a.getLookupValue()},v=()=>{o.value=!0},F=async D=>{o.value=!1,D&&await S()},V=()=>{m.value=!0},n=async D=>{m.value=!1,D&&await S()},p=()=>{y.value=!0},d=async D=>{y.value=!1,D&&await S()},T=async()=>{const D=await a.export();Kt.saveAs(new Blob([D],{type:"application/octet-stream"}),"Characteristic Type Value.xlsx")},u=()=>{l.value=!0},C=async D=>{l.value=!1,D&&await S()};return(D,O)=>(w(),j(Bt,null,[c("div",ka,[La,c("div",Ia,[e(Et,{onShowDialog:v}),e(Tt,{onShowDialog:p}),e(wt,{onHandleDownload:T}),e(bt,{onShowDialog:u})])]),c("div",Ua,[c("div",$a,[e(Wt,{"list-data":b.value,page:_.value.currentPage,onShowDialog:V},null,8,["list-data","page"])])]),c("div",Aa,[s(a).paginationLoading?tt("",!0):(w(),k(ut,{key:0,onRaisePageChange:O[0]||(O[0]=R=>f(R)),currentPage:_.value.currentPage,totalPage:_.value.totalPage,totalPageSize:_.value.totalPageSize,startPaginationIndex:_.value.startPaginationIndex,endPaginationIndex:_.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),e(ia,{visibility:o.value,onHandleClose:F},null,8,["visibility"]),e(ha,{visibility:m.value,onHandleClose:n},null,8,["visibility"]),e(Pa,{visibility:y.value,onHandleClose:d},null,8,["visibility"]),e(Ta,{visibility:l.value,onHandleClose:C},null,8,["visibility"])],64))}});export{Ye as default};

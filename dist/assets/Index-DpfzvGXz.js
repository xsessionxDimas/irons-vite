import{k as wa,r as o,c as w,d as Yt,p as v,aa as p,aB as e,s as u,x as y,F as _e,n as So,R as ae,y as We,a5 as Rt,u as ee,A as $,C as K,q as me,bd as yt,bb as bt,a0 as Kt,B as q,a2 as it,$ as Pe,P as Ne,b4 as Ca,b6 as xo,bL as ol,K as il,o as Oo,a7 as $o,a1 as Ro,Y as No}from"./@vue-BypzYtbH.js";import{_ as ft}from"./GeneralDialog.vue_vue_type_style_index_0_lang-Bvj3I9QR.js";import{O as Ao}from"./OnlineStatus-Bhk3CA8-.js";import{_ as Po,a as To,C as Eo}from"./CBMInfo-DnVHi8xN.js";import{_ as Uo}from"./Toast.vue_vue_type_style_index_0_lang-OOgaHWFE.js";import{d as nl,e as Rl,f as Nl,u as Fo,G as qo,C as wl,_ as Bo,a as Lo,D as Ho,b as jo,N as Yo,c as Go}from"./useInterventionNAStore-JmmvsR31.js";import{a as Wo,_ as Ko,O as Jo}from"./OfflineDialog.vue_vue_type_style_index_0_lang-BzWRyL8K.js";import{a as Qo,V as zo}from"./ViewOnlyNAReasonDialog-DR-Uz59p.js";import{f as Ht,r as Ie,c as nt,i as $t,m as pt,a as Al}from"./number-format-BdMuQVyW.js";import{S as Xo}from"./SelectSearchWithLabel-CWBDKtLo.js";import{i as Ce,A as Zo,p as ei,J as Vl}from"./date-format-8-IvfSl3.js";import{e as U}from"./lodash-DrHMlsdo.js";import{_ as ai}from"./ImagePreview.vue_vue_type_style_index_0_lang-DrcOCjy4.js";import{o as gt,n as rl,l as ul,p as Jt,A as Gt,t as cl,s as ti,e as li,j as si,H as oi}from"./helpers-wUOLw-dU.js";import{i as ii}from"./disabled-state-O9W-ZY8y.js";import{_ as _t}from"./nw-img-vue-CR837WER.js";import{_ as ca}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{d as Qt}from"./manipulate-html-string-DqTEGh-F.js";import{h as Wt,s as Ml,b as dl,i as ni}from"./urls-CPQ2HRXU.js";import{_ as ya}from"./Textarea.vue_vue_type_style_index_0_lang-v94SEJmi.js";import{v as ht}from"./uuid-SoommWqA.js";import{S as Il}from"./SMUDetailDialog-Bs-98WGo.js";import{F as ri,T as ui,a as ci,b as di,_ as Sl}from"./ProcessingTimePopUp.vue_vue_type_style_index_0_lang-DeJTSv0v.js";import{_ as xl}from"./MessageBox.vue_vue_type_style_index_0_lang-DfpcTVNJ.js";import{A as vi}from"./AdditionalInformation-C83cAnT5.js";import{b as mi,_ as fi}from"./UploadImageFailureDialog.vue_vue_type_style_index_0_lang-DVBJv3c1.js";import{_ as pi}from"./ErrorDialog.vue_vue_type_style_index_0_lang-uqoYzc1f.js";import{_ as Ol}from"./ToastWithIcon.vue_vue_type_style_index_0_lang-wfM94fOM.js";import{N as gi}from"./NAReasonDialog-Bb7Vw_qI.js";import{a as hi,e as yi,d as bi,D as _i}from"./useComponentInterventionHeaderStore-CbC-c2Z5.js";import{u as ki}from"./useInterventionDefectStore-CSZwjVeC.js";import{a as Di,L as Ci,f as jt}from"./index-BuVmIl8K.js";import{u as wi}from"./vue-router-iNp9kJ0K.js";import{u as Vi}from"./useMasterStore-CzSO06fn.js";import{u as Mi}from"./useAttachmentStore-DqM3autD.js";import{a as xe}from"./element-plus-BeWdvTRa.js";import{_ as $l}from"./PhotoDescription.vue_vue_type_style_index_0_lang-1F5CAfuD.js";import{s as sl}from"./string-to-imageinfo-converter-Cdr1iOkP.js";import{_ as Ii}from"./ErrorBox.vue_vue_type_style_index_0_lang-Bysg_zE3.js";import{i as ua}from"./internet-connection-CnLQPjRt.js";import{C as Si}from"./CameraIdEnum-C2Xl0HNE.js";import{M as xi}from"./MachineSMUEnum-CgiCo9nf.js";import"./useGlobalConnectionStore-DV9B81de.js";import"./pinia-BjOS2_Ao.js";import"./cbm-helper-BxJZ9NTc.js";import"./Repair-zyV2di4A.js";import"./document_download-C1p7j0nJ.js";import"./helpers-BS1ZZpAr.js";import"./useDefectsFormStore-41UTMhiG.js";import"./DefectNoClass-BqGKOkzR.js";import"./urls-CvqtYZA-.js";import"./prev-val-handler-DvA3D_kF.js";import"./urls-B0Rq9QQ3.js";import"./urls-hWHEBXep.js";import"./urls-D8F5Tyyp.js";import"./authentication-handler-Pueb_EI7.js";import"./useCameraStore-BwXVJhPe.js";import"./useHistoricalEformDmaStore-Fo4tKNgB.js";import"./CommentPanel-D0ptrEBp.js";import"./simple-vue-camera-D9MGhAeE.js";import"./@popperjs-BaMZbQYT.js";import"./vue-BzYgrL08.js";import"./vue-drawing-canvas-CzCJUKem.js";import"./FullScreenDialog.vue_vue_type_style_index_0_lang-DXRDt27h.js";import"./@vueuse-DFoNmIyu.js";import"./PDFViewerDialog.vue_vue_type_style_index_0_lang-GWz8s3FD.js";import"./InformationPopUp.vue_vue_type_style_index_0_lang-O2xYF9Pq.js";import"./ReferenceInline.vue_vue_type_script_setup_true_lang-DqEUurUl.js";import"./reference-file-C1vLEEpf.js";import"./pdf-DNpyvVEz.js";import"./image-close-button-red-B1UxWyBV.js";import"./PDFViewerDialog.vue_vue_type_style_index_0_lang-DqiQYePb.js";import"./moment-C5S46NFB.js";import"./webp-converter-browser-C3MD88Lp.js";import"./compressorjs-Cmz8Y9J9.js";import"./file-saver-CwTBvle_.js";import"./OfflineFullScreenDialog.vue_vue_type_style_index_0_lang-C2GTRJsq.js";import"./green-checklist-BWMKprFt.js";import"./vue3-dropzone-_NG5IwbJ.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept-DLIfoYC7.js";import"./urls-RITu66bD.js";import"./useComponentInterventionDefectsStore-CA75rH_W.js";import"./useComponentInterventionEformStore-CMy33xkJ.js";import"./CrackNoClass-0DSU7BAn.js";import"./CrackYesClass-COntz77m.js";import"./object-path-DPahbflh.js";import"./deepmerge-oeePEK50.js";import"./crypto-js-BeOoaXQg.js";import"./cron-De-pTz2b.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./vuex-BbOKrtVp.js";import"./axios-CU9oF0EU.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-CppYEwAE.js";import"./@azure-DwL0pga8.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./vee-validate-C_msoaAA.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./btech-analytics-wrapper-DOvMtwpJ.js";import"./posthog-js-CbYOvutT.js";import"./vue-i18n-CbVMwo04.js";import"./@intlify-YGwFW6EB.js";import"./prismjs-BrsEfPfk.js";import"./dayjs-D0x2Df_K.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-D6ofg2JO.js";import"./mitt-C1xD_ZTF.js";import"./async-validator-DK9uouaC.js";const kt=f=>(yt("data-v-b08d3fd4"),f=f(),bt(),f),Oi={class:"mt-5 ps-0"},$i=kt(()=>e("h4",{class:"subtitle ps-3"},"Intervention Labour Personnel",-1)),Ri={class:"p-2 me-0"},Ni={class:"row",style:{width:"101%"}},Ai={class:"col-12 pe-0"},Pi={class:"d-flex flex-row justify-content-between"},Ti={class:"p-2 d-flex flex-row flex-grow-1"},Ei={class:"d-flex w-100"},Ui={class:"flex-fill"},Fi={class:"form-floating mb-3"},qi=kt(()=>e("label",null,"Intervention Start Date",-1)),Bi={class:"flex-fill ps-3"},Li={class:"form-floating mb-3"},Hi=["value"],ji=kt(()=>e("label",null,"Serial Number",-1)),Yi={class:"flex-fill ps-3"},Gi={class:"form-floating mb-3 position-relative"},Wi=["value"],Ki=["disabled","value"],Ji={key:2,class:"ms-2 position-absolute",style:{top:"2px",right:"0"}},Qi=kt(()=>e("img",{src:Qo,style:{width:"1.25rem",height:"1.25rem"}},null,-1)),zi=[Qi],Xi=kt(()=>e("label",{for:"floatingInput2",class:"text-nowrap"},"Machine SMU",-1)),Zi={key:0,class:"text-danger ps-2 font-weight-bold"},en={class:"ms-2"},an=["disabled"],tn={key:0,class:"ms-2"},ln={class:"p-3 justify-items-center rounded",style:{background:"#18af4a"}},sn={key:0,class:"d-flex flex-row justify-content-end timestamp-task"},on={class:"d-flex flex-row"},nn={class:"flex-fill ps-3"},rn={class:"form-floating mb-3"},un=["value"],cn=kt(()=>e("label",{for:"floatingInput2",class:"text-nowrap"},"Hour Meter Offset",-1)),dn=wa({__name:"CardPersonnel",props:{personnel:{required:!0,type:Object},fitter:{required:!0,type:Object},intervention:{required:!0,type:Object},generalSubmitted:{required:!0,type:Boolean},validation:{required:!0,type:Object},formAgreement:{required:!1,type:Boolean,default:!1},reRender:{type:Boolean,default:!1},serialNumber:{required:!0,type:String},hasOpenedDialog:{required:!0,type:Boolean}},emits:["onPersonnelSelected","onSMUChanged","onCameraClicked","onImageDownloaded","onImageDeleted","onSMUReviseIconClicked"],setup(f,{expose:fe,emit:_}){const d=f,c=_,C=o(""),b=o("Intervention Labour Personnel"),Y=o(d.intervention.interventionSMU??""),O=o(d.intervention.hmOffset??"0"),k=o(d.intervention.serviceStart),H=o(!1),W=o(),ye=w(()=>{const B=[d.intervention.interventionExecution,d.intervention.imageEquipment];return ii(...B)||!d.fitter});w(()=>d.intervention.interventionSMU);const re=w(()=>d.intervention.serviceStart),ke=w(()=>d.generalSubmitted),we=w(()=>d.intervention.imageEquipment),ue=w(()=>{let B=Ht(Y.value);return B=="0"&&(B=""),B}),F=w(()=>d.intervention.smuBy),te=w(()=>d.intervention.smuDate),de=B=>{let De=B.keyCode?B.keyCode:B.which;if((De<48||De>57)&&De!=46&&B.preventDefault(),De==13){W.value.blur();return}},pe=()=>{C.value="relative-hidder"},D=()=>{C.value=""},ve=B=>{k.value||(k.value=Ce());const De={option:U.cloneDeep(B),serviceStart:k.value};c("onPersonnelSelected",De)},j=()=>{const B={};B.type="imageEquipment",B.key=d.intervention.key,c("onCameraClicked",B)},A=B=>{c("onImageDownloaded",B)},M=B=>{c("onImageDeleted",B)},V=B=>{B.target.value=gt(B.target.value)},G=B=>B!="Not Applicable"?Ht(B):"Not Applicable",z=()=>{Y.value="",W.value.value="",So(()=>{W.value.focus()})};let X;const be=async B=>{if(B.target.value=Ht(Ie(B.target.value)),clearTimeout(X),B.target.value=="")return!1;X=setTimeout(async()=>{c("onSMUChanged",B.target.value)},0)},ge=()=>{H.value=!1};fe({resetInputSMU:z,onCameraClicked:j,onCloseImagePreview:ge});const qe=()=>{c("onSMUReviseIconClicked")};return Yt(k,()=>{re.value&&(k.value=re.value)}),Yt(()=>d.intervention,B=>{B&&(k.value=d.intervention.serviceStart??"")}),(B,De)=>{const ea=ae("NwImg"),Te=ae("el-collapse-item"),Ve=ae("el-collapse");return v(),p(_e,null,[e("div",Oi,[u(Ve,{modelValue:b.value,"onUpdate:modelValue":De[2]||(De[2]=Ke=>b.value=Ke),class:"general-accordion task-group py-1 px-5 mb-3"},{default:y(()=>[u(Te,{name:"Intervention Labour Personnel"},{title:y(()=>[$i]),default:y(()=>{var Ke,ra;return[e("div",Ri,[e("div",Ni,[e("div",Ai,[u(Xo,{"field-label":"Labour Personnel Name",placeholder:"Select your name",data:f.personnel,value:(Ke=f.fitter)==null?void 0:Ke.name,"display-label":!0,onOnFocus:pe,onOnLostFocus:D,onOnSelected:ve,disabled:ke.value},null,8,["data","value","disabled"])])])]),e("div",Pi,[e("div",Ti,[e("div",Ei,[e("div",Ui,[e("div",Fi,[We(e("input",{type:"text",class:"form-control","onUpdate:modelValue":De[0]||(De[0]=da=>k.value=da),disabled:""},null,512),[[Rt,k.value]]),qi])]),e("div",Bi,[e("div",Li,[e("input",{type:"text",class:"form-control",value:f.serialNumber,disabled:""},null,8,Hi),ji])]),e("div",Yi,[e("div",Gi,[f.intervention.interventionSMU||!f.fitter?(v(),p("input",{key:0,type:"text",class:"form-control",placeholder:"Machine SMU",disabled:"",value:ee(Ht)(f.intervention.interventionSMU||Y.value),pattern:"[0-9]*",inputmode:"numeric"},null,8,Wi)):(v(),p("input",{key:1,type:"text",name:"machine-smu",ref_key:"machineSMUField",ref:W,class:"form-control",placeholder:"Machine SMU",disabled:f.hasOpenedDialog,onKeypress:de,onInput:V,onFocusout:be,value:ue.value,pattern:"[0-9]*",inputmode:"numeric"},null,40,Ki)),!f.intervention.isApprovedSmu&&f.intervention.interventionSMU&&((ra=f.fitter)!=null&&ra.name)?(v(),p("div",Ji,[e("button",{class:"btn p-4 justify-items-center rounded cursor-pointer svg-icon svg-icon-btech-primary-500",onClick:qe},zi)])):$("",!0),Xi]),f.validation.SMU?(v(),p("label",Zi,K(f.validation.SMU),1)):$("",!0)]),e("div",en,[e("button",{class:"btn p-4 justify-items-center rounded",disabled:ye.value,style:{background:"#f4f6f8",cursor:"pointer"},onClick:j},[we.value&&we.value.length>0?(v(),me(ea,{key:0,src:"/media/svg/dma/camera/e-form/png/cam-user.png",style:{height:"20px",width:"24px"},alt:"camera"})):ye.value?(v(),me(ea,{key:1,src:"/media/svg/dma/camera/e-form/png/cam-read.png",style:{height:"20px",width:"24px"},alt:"camera"})):(v(),me(ea,{key:2,src:"/media/svg/dma/camera/e-form/png/cam-active.png",style:{height:"20px",width:"24px"},alt:"camera"}))],8,an)]),we.value&&we.value.length>0?(v(),p("div",tn,[e("div",ln,[e("span",{style:{"font-weight":"700",color:"white",cursor:"pointer"},onClick:De[1]||(De[1]=()=>H.value=!0)},"+"+K(we.value.length),1)])])):$("",!0)])])]),F.value&&te.value?(v(),p("div",sn,K(F.value.name)+", "+K(te.value),1)):$("",!0),e("div",on,[e("div",nn,[e("div",rn,[e("input",{type:"text",class:"form-control",placeholder:"Hour Meter Offset",disabled:"",value:G(f.intervention.hmOffset||O.value)},null,8,un),cn])])])]}),_:1})]),_:1},8,["modelValue"])]),u(ai,{"re-render":f.reRender,images:we.value,"show-delete-button":!0,visibility:H.value,type:"imageEquipment","show-mandatory-caption":!1,onOnClose:ge,onOnDownloaded:A,onOnDelete:M},null,8,["re-render","images","visibility"])],64)}}}),vn=_t(dn,[["__scopeId","data-v-b08d3fd4"]]),J=f=>(yt("data-v-4e44e942"),f=f(),bt(),f),mn={class:"el-dialog__title"},fn={key:0,class:"red-bg text-dark-red p-1"},pn={key:1,class:"status-badge-dialog-header approved-badge p-1"},gn=["innerHTML"],hn={key:0,class:"mt-1 py-2"},yn={class:"d-flex flex-column"},bn={class:"row mb-1"},_n={class:"col"},kn={class:"form-floating declined-text-box"},Dn={class:"form-control"},Cn=J(()=>e("label",null,"Declined Reason*",-1)),wn={key:0,class:"mb-2 text-end"},Vn={key:1,class:"mt-1 py-2"},Mn={class:"row mb-1"},In={class:"col"},Sn={key:0,class:"form-floating approved-text-box"},xn={class:"form-control",style:{"white-space":"break-spaces"}},On=J(()=>e("label",null,"Approved",-1)),$n={class:"d-flex flex-row justify-content-between"},Rn={class:"py-2 d-flex flex-row flex-grow-1"},Nn={class:"flex-fill"},An={class:"form-floating"},Pn=["innerHTML"],Tn=J(()=>e("label",{for:"floatingInput"},"Asset Number",-1)),En={class:"flex-fill ps-3"},Un={class:"form-floating"},Fn=["innerHTML"],qn=J(()=>e("label",{for:"floatingInput"},"Serial Number",-1)),Bn={class:"flex-fill ps-3"},Ln={class:"form-floating"},Hn=["innerHTML"],jn=J(()=>e("label",{for:"floatingInput"},"Ownership",-1)),Yn={class:"d-flex flex-row justify-content-between"},Gn={class:"mt-1 py-2"},Wn={class:"mt-1 py-2"},Kn={class:"row"},Jn={class:"col pe-0"},Qn={class:"form-floating"},zn=["value"],Xn=J(()=>e("label",null,"Raised By",-1)),Zn={class:"mt-1 py-2"},er={class:"row"},ar={class:"col-4 pe-0 date"},tr={class:"form-floating"},lr=["value"],sr=J(()=>e("label",null,"Date Raised",-1)),or={class:"col pe-0 d-flex"},ir={class:"d-flex flex-column flex-fill"},nr={class:"form-floating"},rr=["value","disabled"],ur=J(()=>e("label",{class:"text-nowrap"},"How long will this defect repair take?",-1)),cr={key:0,class:"mt-2"},dr={class:"ms-2 d-flex align-items-center"},vr={class:"mt-1 py-2"},mr=J(()=>e("div",{class:"mt-2"},null,-1)),fr=J(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-3"},"Priority"),e("div",{class:"col-6"},"Action"),e("div",{class:"col-3 text-break"},"Person Responsible")],-1)),pr={class:"row p-3 m-1 priority-container"},gr={class:"col-3"},hr={class:"form-check"},yr=["disabled"],br=J(()=>e("label",{class:"form-check-label text-nowrap"}," (P1) Immediate ",-1)),_r=J(()=>e("div",{class:"col-6 word-breaker"},"Shall shut machine down and undertake repairs.",-1)),kr=J(()=>e("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),Dr={class:"row p-3 m-1 priority-container"},Cr={class:"col-3"},wr={class:"form-check"},Vr=["disabled"],Mr=J(()=>e("label",{class:"form-check-label text-nowrap"}," (P2) Urgent ",-1)),Ir=J(()=>e("div",{class:"col-6 word-breaker"},"Shall complete within 7 days.",-1)),Sr=J(()=>e("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),xr={class:"row p-3 m-1 priority-container"},Or={class:"col-3"},$r={class:"form-check"},Rr=["disabled"],Nr=J(()=>e("label",{class:"form-check-label text-nowrap"}," (P3) Routine ",-1)),Ar=J(()=>e("div",{class:"col-6 word-breaker"},"Shall complete within 60 days.",-1)),Pr=J(()=>e("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),Tr={class:"row p-3 m-1 priority-container"},Er={class:"col-3"},Ur={class:"form-check"},Fr=["disabled"],qr=J(()=>e("label",{class:"form-check-label text-nowrap"}," (P4) Monitor ",-1)),Br=J(()=>e("div",{class:"col-6 word-breaker"},"Shall continue to inspect and monitor for 90 days.",-1)),Lr=J(()=>e("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),Hr=J(()=>e("div",{class:"mt-2"},null,-1)),jr=J(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-3"},"Part Number"),e("div",{class:"col-5"},"Part Description"),e("div",{class:"col-1"},"Qty"),e("div",{class:"col"}),e("div",{class:"col"})],-1)),Yr={class:"col-3 ps-0"},Gr={class:"d-flex flex-column"},Wr=["value","disabled"],Kr={class:"col-5"},Jr={class:"d-flex flex-column"},Qr=["value","onChange","disabled"],zr={key:0,class:"mt-2"},Xr={class:"col-1 px-1 d-flex justify-content-start"},Zr={class:"d-flex flex-column"},eu=["value","onInput","disabled"],au={key:0,class:"mt-2"},tu={class:"col px-1 d-flex flex-column justify-content-start"},lu={class:"row p-0 m-0 h-100 w-100 align-items-center"},su={class:"col px-1 d-flex flex-column justify-content-start position-relative"},ou={class:"row p-0 m-0 h-100 w-100 align-items-center"},iu={key:0,class:"position-absolute",style:{top:"10px",right:"0px"}},nu=["onClick"],ru=J(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),uu=J(()=>e("div",{class:"mt-2"},null,-1)),cu=J(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-6"},"Labour Activity"),e("div",{class:"col-2"},"Qty"),e("div",{class:"col-2"},"Hours Each"),e("div",{class:"col-2"},"Total Hours")],-1)),du={class:"col-6 px-0"},vu={class:"d-flex flex-column"},mu={key:0,class:"mt-2"},fu={class:"col-2 d-flex justify-content-start"},pu={class:"d-flex flex-column"},gu=["value","onInput","disabled"],hu={key:0,class:"mt-2"},yu={class:"col-2 d-flex justify-content-start"},bu={class:"d-flex flex-column"},_u=["value","onInput","disabled"],ku={key:0,class:"mt-2"},Du={class:"col-2 d-flex justify-content-start"},Cu={class:"d-flex flex-column"},wu=["value"],Vu=["onClick"],Mu=J(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Iu=J(()=>e("div",{class:"mt-2"},null,-1)),Su={class:"d-flex flex-fill flex-column"},xu=["value","placeholder","onChange","disabled"],Ou={key:0,class:"mt-2"},$u=["onClick"],Ru=J(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Nu=J(()=>e("div",{class:"mt-2"},null,-1)),Au={class:"d-flex flex-fill flex-column"},Pu={key:0,class:"mt-2"},Tu={key:1,class:"mt-2"},Eu=["onClick"],Uu=J(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Fu=J(()=>e("div",{class:"mt-2"},null,-1)),qu={class:"d-flex flex-fill flex-column"},Bu={key:0,class:"mt-2"},Lu={key:1,class:"mt-2"},Hu=["onClick"],ju=J(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Yu={key:3,class:"my-5 w-100 d-flex justify-content-around"},Gu=["disabled"],Wu=wa({__name:"DefectEditForm",props:{visibility:{required:!0,type:Boolean},task:{required:!0,type:Object},taskNo:{required:!0,type:String},taskDesc:{required:!0,type:String},defectData:{required:!0,type:Object},currentFitter:{type:Object,required:!0},positions:{type:Array},symptomOptions:{type:Array},causeOptions:{type:Array},defectImages:{type:Array,required:!0},reRender:{type:Boolean,default:!1},status:{required:!0,type:String},declineReason:{required:!1,type:String,default:""},declineDate:{required:!1,type:String,default:""},declineBy:{required:!1,type:Object,default:{}},approvedDate:{required:!1,type:String,default:""},approvedBy:{required:!1,type:Object,default:{}},ownership:{type:String,default:""},serialNumber:{type:String,default:""},isNeed30Minutes:{default:!1},generic:{required:!1,type:Boolean,default:!1},generalSubmitted:{required:!0,type:Boolean}},emits:["onCameraClick","onImageDeleted","onImageDownloaded","onSubmit","onCancel","onClose","onResetImage","onAttachmentClicked","onImageDeleted","onImagePartDeleted","onAttachmentPartDeleted","OnSetFlagFromDeleteAction"],setup(f,{expose:fe,emit:_}){var mt,Pa,I,L;const d=f,c=_,C=o(!0),b=o("Priority"),Y=o("Parts"),O=o("Labour"),k=o(""),H=o("Symptom"),W=o("Cause"),ye=o(),re=o(!1),ke=Kt(d,"visibility"),we=o(!1),ue=o(!1),F=o({value:((mt=d.defectData)==null?void 0:mt.description)??"",isValid:!0,errorMessage:""}),te=o({value:((Pa=d.defectData)==null?void 0:Pa.instruction)??"",isValid:!0,errorMessage:""}),de=o(!0),pe=o(),D=o({value:((I=d.defectData)==null?void 0:I.plannedDuration)??"",isValid:!0,errorMessage:""}),ve=o(((L=d.defectData)==null?void 0:L.priority)??"P1"),j=o([]),A=o([]),M=o([]),V=o([{value:"",isValid:!0,errorMessage:""}]),G=o([{value:"",isValid:!0,errorMessage:""}]),z=o([{value:"",isValid:!0,errorMessage:""}]),X=o([{value:"",isValid:!0,errorMessage:""}]),be=o(ht()),ge=o(),qe=w(()=>d.status=="Decline"),B=w(()=>d.status=="Acknowledge"),De=w(()=>"Defect Identified Description"),ea=w(()=>"Defect Repair Instructions"),Te=a=>{de.value=!0,c("onCameraClick",a)},Ve=a=>{d.defectImages.length==1?(de.value=!1,c("OnSetFlagFromDeleteAction",!0),ge.value.handleClickCamera(),ge.value.handleHideModal()):c("onImageDeleted",a)},Ke=a=>{c("onImageDownloaded",a)},ra=a=>{F.value.value=a.value,da()},da=()=>{let a=!0;return F.value.value===""?(F.value.isValid=!1,F.value.errorMessage="Required",a=!1):(F.value.isValid=!0,F.value.errorMessage=""),a},ba=()=>d.defectImages.length>=1?(de.value=!0,!0):(de.value=!1,!1),Fa=a=>{a.target.value=gt(a.target.value),D.value.value=Ie(a.target.value),Va()},Va=()=>{let a=!0;if(D.value.value==="")D.value.isValid=!1,D.value.errorMessage="Required",a=!1;else{let n=!$t(D.value.value);if(n)D.value.isValid=!0,D.value.errorMessage="";else return D.value.isValid=!1,D.value.errorMessage="Invalid format",a=!1,a;n=pt(D.value.value),n?d.isNeed30Minutes&&(Number(D.value.value)<=.5?(D.value.isValid=!1,D.value.errorMessage="Must more than half an hour",a=!1):(D.value.isValid=!0,D.value.errorMessage="")):(D.value.isValid=!1,D.value.errorMessage="Out of range (max 5 digit and 2 fraction)",a=!1)}return a},$e=a=>{te.value.value=a.value,P()},P=()=>{let a=!0;return te.value.value===""?(te.value.isValid=!1,te.value.errorMessage="Required",a=!1):(te.value.isValid=!0,te.value.errorMessage=""),a},Se=(a,n)=>{j.value[n].partDescription.value=a.target.value,Be(j.value[n].partDescription)},Be=a=>{let n=!0;return a.value===""?(a.isValid=!1,a.errorMessage="Required",n=!1):(a.isValid=!0,a.errorMessage=""),n},Ma=(a,n)=>{j.value[n].partQty.value=Ie(a.target.value),Je(j.value[n].partQty)},Je=a=>{let n=!0;if(a.value==="")a.isValid=!1,a.errorMessage="Required",n=!1;else{let g=!$t(a.value);if(g)a.isValid=!0,a.errorMessage="";else return a.isValid=!1,a.errorMessage="Invalid format",n=!1,n;g=pt(a.value),g?(a.isValid=!0,a.errorMessage=""):(a.isValid=!1,a.errorMessage="Out of range (max 5 digit and 2 fraction)",n=!1)}return n},Ae=()=>{let a=!0;const n=[];return j.value.forEach(g=>{const R=[];R.push(Be(g.partDescription)),R.push(Je(g.partQty)),n.push(R.every(le=>le==!0))}),a=n.every(g=>g==!0),a},Ue=()=>{Ae()&&j.value.push({partNumber:"",partDescription:{value:"",isValid:!0,errorMessage:""},partQty:{value:"",isValid:!0,errorMessage:""},images:[],attachment:[]})},Ia=a=>{j.value.splice(a,1)},je=a=>{c("onImagePartDeleted",a.filename),j.value[a.index].images=U.cloneDeep(j.value[a.index].images).filter(n=>n.filename!=a.filename)},Qe=a=>{c("onAttachmentClicked",a)},Le=a=>{c("onAttachmentPartDeleted",a.filename),j.value[a.index].attachment=U.cloneDeep(j.value[a.index].attachment).filter(n=>n.url!=a.filename)},qa=(a,n)=>{const g=a.split("-")[0];U.isEmpty(j.value[g].images)&&(j.value[g].images=[]),j.value[g].images=[...j.value[g].images,...n]},Ba=(a,n)=>{const g=a.split("-")[0];U.isEmpty(j.value[g].attachment)&&(j.value[g].attachment=[]),j.value[g].attachment=[...j.value[g].attachment,n]},La=a=>{let n=!0;return a.value===""||A.value.filter(R=>R.position.value==a.value).length>1?(a.isValid=!1,a.errorMessage="Required",n=!1):(a.isValid=!0,a.errorMessage=""),n},Sa=(a,n)=>{a.target.value=gt(a.target.value),A.value[n].qty.value=Ie(a.target.value),xa(A.value[n].qty),Ha(n)},xa=a=>{let n=!0;if(a.value==="")a.isValid=!1,a.errorMessage="Required",n=!1;else{let g=!$t(a.value);if(g)a.isValid=!0,a.errorMessage="";else return a.isValid=!1,a.errorMessage="Invalid format",n=!1,n;g=Al(a.value),g?(a.isValid=!0,a.errorMessage=""):(a.isValid=!1,a.errorMessage="Out of range (max 5 digits)",n=!1)}return n},Oa=(a,n)=>{a.target.value=gt(a.target.value),A.value[n].hourEach.value=Ie(a.target.value),aa(A.value[n].hourEach),Ha(n)},aa=a=>{let n=!0;if(a.value==="")a.isValid=!1,a.errorMessage="Required",n=!1;else{let g=!$t(a.value);if(g)a.isValid=!0,a.errorMessage="";else return a.isValid=!1,a.errorMessage="Invalid format",n=!1,n;g=pt(a.value),g?(a.isValid=!0,a.errorMessage=""):(a.isValid=!1,a.errorMessage="Out of range (max 5 digit and 2 fraction)",n=!1)}return n},Ha=a=>{if(A.value[a].qty.isValid&&A.value[a].qty.value!=""&&A.value[a].hourEach.isValid&&A.value[a].hourEach.value!=""){const n=+A.value[a].qty.value,g=+A.value[a].hourEach.value,R=n*g;A.value[a].qty.value.includes(".")||A.value[a].hourEach.value.includes(".")?A.value[a].totalHour=R.toFixed(2).toString():A.value[a].totalHour=R.toString()}else A.value[a].totalHour=""},va=()=>{let a=!0;const n=[];return A.value.forEach(g=>{const R=[];R.push(La(g.position)),R.push(xa(g.qty)),R.push(aa(g.hourEach)),n.push(R.every(le=>le))}),a=n.every(g=>g),a},ma=a=>{let n=!1;const g=A.value[a].position.value;for(let R=0;R<a;R++){if(R==a)continue;A.value[R].position.value==g?(A.value[R].position.isValid=!1,A.value[R].position.errorMessage="Duplicate position",A.value[a].position.isValid=!1,A.value[a].position.errorMessage="Duplicate position",n=!0):(A.value[R].position.isValid=!0,A.value[R].position.errorMessage="",n||(A.value[a].position.isValid=!0,A.value[a].position.errorMessage=""))}},Fe=()=>{va()&&A.value.push({position:{value:"",isValid:!0,errorMessage:""},qty:{value:"",isValid:!0,errorMessage:""},hourEach:{value:"",isValid:!0,errorMessage:""},totalHour:""})},ze=a=>{A.value.splice(a,1)},He=(a,n)=>{a.preventDefault(),M.value[n].value=a.target.value,Ya()},ja=a=>{let n=!0;return a.value===""&&M.value.length>1?(a.isValid=!1,a.errorMessage="Required",n=!1):M.value.filter(R=>R.value==a.value).length>1?(a.isValid=!1,a.errorMessage="Duplicate resource",n=!1):(a.isValid=!0,a.errorMessage=""),n},Ya=()=>{let a=!0;const n=[];return M.value.forEach(g=>{const R=[];R.push(ja(g)),n.push(R.every(le=>le))}),a=n.every(g=>g),a},rt=()=>{let a=!0;const n=[];return M.value.forEach(g=>{const R=[];R.push(ut(g)),n.push(R.every(le=>le))}),a=n.every(g=>g),a},ut=a=>{let n=!0;return a.value===""?(a.isValid=!1,a.errorMessage="Required",n=!1):M.value.filter(R=>R.value==a.value).length>1?(a.isValid=!1,a.errorMessage="Duplicate resource",n=!1):(a.isValid=!0,a.errorMessage=""),n},Ga=()=>{rt()&&M.value.push({value:"",isValid:!0,errorMessage:""})},$a=a=>{M.value.splice(a,1),M.value.length==1&&M.value[0].value==""&&(M.value[0].isValid=!0,M.value[0].errorMessage="")},Wa=(a,n)=>{Ra(V.value[n])},Ka=a=>{a.index!=null&&(G.value[a.index].value=a.value,Ja(G.value[a.index],V.value[a.index].value))},Ra=a=>{let n=!0;return a.value===""?(a.isValid=!1,a.errorMessage="Required",n=!1):V.value.filter(R=>R.value==a.value).length>1?(a.isValid=!1,a.errorMessage="Duplicate symptom",n=!1):(a.isValid=!0,a.errorMessage=""),n},Ja=(a,n)=>{let g=!0;return a.value===""&&n=="Other"?(a.isValid=!1,a.errorMessage="Required",g=!1):(a.isValid=!0,a.errorMessage=""),g},Qa=()=>{let a=!0;const n=[];return V.value.forEach((g,R)=>{const le=[];le.push(Ra(g)),le.push(Ja(G.value[R],g.value)),n.push(le.every(Ta=>Ta))}),a=n.every(g=>g),a},za=()=>{Qa()&&(V.value.push({value:"",isValid:!0,errorMessage:""}),G.value.push({value:"",isValid:!0,errorMessage:""}))},Xa=a=>{V.value.splice(a,1),G.value.splice(a,1)},Xe=(a,n)=>{Oe(z.value[n])},ta=a=>{a.index!=null&&(X.value[a.index].value=a.value,Na(X.value[a.index],z.value[a.index].value))},Na=(a,n)=>{let g=!0;return a.value===""&&n=="Other"?(a.isValid=!1,a.errorMessage="Required",g=!1):(a.isValid=!0,a.errorMessage=""),g},Oe=a=>{let n=!0;return a.value==""?(a.isValid=!1,a.errorMessage="Required",n=!1):z.value.filter(R=>R.value==a.value).length>1?(a.isValid=!1,a.errorMessage="Duplicate cause",n=!1):(a.isValid=!0,a.errorMessage=""),n},_a=()=>{let a=!0;const n=[];return z.value.forEach((g,R)=>{const le=[];le.push(Oe(g)),le.push(Na(X.value[R],g.value)),n.push(le.every(Ta=>Ta))}),a=n.every(g=>g),a},la=()=>{_a()&&(z.value.push({value:"",isValid:!0,errorMessage:""}),X.value.push({value:"",isValid:!0,errorMessage:""}))},Za=a=>{z.value.splice(a,1),X.value.splice(a,1)},sa=()=>{Wt(be.value),M.value.length<1&&M.value.push({value:"",isValid:!0,errorMessage:""}),k.value="Other Resource (optional)",ye.value={images:U.cloneDeep(d.defectImages),description:U.cloneDeep(F.value.value),priority:U.cloneDeep(ve.value),instruction:U.cloneDeep(te.value.value),plannedDuration:U.cloneDeep(D.value.value),parts:U.cloneDeep(j.value),labours:U.cloneDeep(A.value),resources:U.cloneDeep(M.value),symptoms:U.cloneDeep(V.value),causes:U.cloneDeep(z.value)},C.value=!1},Ze=()=>{ka(),Me(),ia(),pa(),na(),lt(),C.value=!0},ct=()=>j.value.map(a=>({partNumber:a.partNumber,partDescription:a.partDescription.value,qty:Ie(a.partQty.value),images:a.images??[],attachment:a.attachment??[]})),fa=()=>A.value.map(a=>({position:a.position.value,qty:Ie(a.qty.value),hireEach:Ie(a.hourEach.value),totalHours:Ie(a.totalHour)})),oa=()=>{b.value="Priority",Y.value="Parts",O.value="Labour",k.value="Other Resource (optional)",H.value="Symptom",W.value="Cause"},et=()=>{let a=[];if(a.push(ba()),a.push(da()),a.push(Va()),a.push(P()),a.push(Ae()),a.push(va()),a.push(Ya()),a.push(Qa()),a.push(_a()),!a.every(g=>g==!0)){oa(),dl("edit-form-defect-yes");return}ue.value=!0},Aa=()=>{const a={};a.isNeed30Minutes=d.isNeed30Minutes,a.type="YES",a.assetNumber=d.defectData.assetNumber,a.raisedBy=d.currentFitter.name,a.date=d.defectData.date,a.description=F.value.value,a.plannedDuration=Ie(D.value.value),a.instruction=te.value.value,a.priority=ve.value,a.parts=ct(),a.labours=fa(),a.resources=M.value.filter(g=>g.value!="").map(g=>g.value),a.symptoms=V.value.map((g,R)=>g.value.includes("Other")?`${g.value}:${G.value[R].value}`:g.value),a.causes=z.value.map((g,R)=>g.value.includes("Other")?`${g.value}:${X.value[R].value}`:g.value),a.taskDesc=d.taskDesc,a.taskNo=d.taskNo;const n={};n.employee=d.currentFitter,n.taskKey=d.task.key,n.taskCategory=d.task.category,n.itemKey=d.task.key,n.type="NORMAL",n.value="3",n.timeStamp=Ce(),n.task=d.task,a.task=n,c("onSubmit",a),we.value=!0,ue.value=!1},at=()=>{ue.value=!1},tt=async()=>{c("onClose",we.value)},ka=()=>{F.value.value=d.defectData.description,F.value.isValid=!0,F.value.errorMessage="",D.value.value=d.defectData.plannedDuration,D.value.isValid=!0,D.value.errorMessage="",te.value.value=d.defectData.instruction,te.value.isValid=!0,te.value.errorMessage="",ve.value=d.defectData.priority,c("onResetImage",d.defectData.images)},Me=()=>{j.value=[],JSON.parse(d.defectData.parts).forEach(n=>{j.value.push({partNumber:n.partNumber,partDescription:{value:n.partDescription,isValid:!0,errorMessage:""},partQty:{value:n.qty,isValid:!0,errorMessage:""},images:n.images??[],attachment:n.attachment??[]})})},ia=()=>{A.value=[],JSON.parse(d.defectData.labours).forEach(n=>{A.value.push({position:{value:n.position,isValid:!0,errorMessage:""},qty:{value:n.qty,isValid:!0,errorMessage:""},hourEach:{value:n.hireEach,isValid:!0,errorMessage:""},totalHour:n.totalHours})})},pa=()=>{k.value="",M.value=[],JSON.parse(d.defectData.resources).forEach(n=>{M.value.push({value:n,isValid:!0,errorMessage:""})}),M.value.length>0&&(k.value="Other Resource (optional)")},na=()=>{V.value=[],G.value=[],JSON.parse(d.defectData.symptoms).forEach(n=>{V.value.push({value:n.split(":")[0],isValid:!0,errorMessage:""}),G.value.push({value:Ml(n),isValid:!0,errorMessage:""})})},lt=()=>{z.value=[],X.value=[],JSON.parse(d.defectData.causes).forEach(n=>{z.value.push({value:n.split(":")[0],isValid:!0,errorMessage:""}),X.value.push({value:Ml(n),isValid:!0,errorMessage:""})})},st=()=>{C.value=!0,Jt(pe.value);try{ka(),Me(),ia(),pa(),na(),lt(),Wt(be.value)}catch(a){console.log(a)}};w(()=>!!(d.task.updatedBy&&d.task.updatedBy.id==d.currentFitter.id)),w(()=>{const a=d.status=="Acknowledge",n=d.status=="Decline";return!(a||n)});const Dt=w(()=>!(!d.generalSubmitted||d.approvedBy&&d.approvedBy.name)),Ct=a=>{const n=a.which?a.which:a.keyCode;(n<48||n>57)&&(n!==46||a.target.value.indexOf(".")!==-1)&&a.preventDefault()},Da=["images","description","priority","instruction","plannedDuration","parts","labours","resources","symptoms","causes"],l=w(()=>({images:d.defectImages,description:F.value.value,priority:ve.value,instruction:te.value.value,plannedDuration:D.value.value,parts:j.value,labours:A.value,resources:M.value,symptoms:V.value,causes:z.value})),r=w(()=>C.value?!1:rl(Da,ye.value,l.value)),h=()=>{C.value?c("onClose"):r.value?re.value=!0:c("onClose")},T=()=>{re.value=!1},ce=()=>{re.value=!1,c("onClose")},ga=w(()=>{const a=d.ownership;return ul(a)}),dt=w(()=>d.generic?d.taskDesc:Qt(d.taskDesc,!0));return fe({handlePartImage:qa,handlePartAttachment:Ba}),(a,n)=>{const g=ae("Label"),R=ae("el-collapse-item"),le=ae("el-collapse"),Ta=ae("el-option"),wt=ae("el-select"),m=ae("el-dialog");return v(),me(m,{modelValue:ke.value,"onUpdate:modelValue":n[11]||(n[11]=he=>ke.value=he),"custom-class":`defectform el-defect-crack-form-custom edit-form-defect-yes ${be.value}`,width:"90%",center:"","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":h,onClosed:tt,onOpened:st,"destroy-on-close":!0},{title:y(()=>[e("span",mn,[q("Detailed Information for Defect Identification "),qe.value?(v(),p("span",fn,"Declined")):B.value?(v(),p("span",pn,"Approved")):$("",!0)]),e("span",{class:"el-dialog__title task-title",innerHTML:dt.value,ref_key:"defectDetailRef",ref:pe},null,8,gn)]),default:y(()=>{var he,Nt,Ye,At;return[e("div",null,[qe.value?(v(),p("div",hn,[e("div",yn,[e("div",bn,[e("div",_n,[e("div",kn,[e("div",Dn,K(f.declineReason),1),Cn])])]),f.declineBy&&f.declineDate?(v(),p("div",wn,K(f.declineBy.name)+", "+K(f.declineDate),1)):$("",!0)])])):B.value?(v(),p("div",Vn,[e("div",Mn,[e("div",In,[f.approvedBy&&f.approvedDate?(v(),p("div",Sn,[e("div",xn,K(f.approvedDate)+" â€” "+K(f.approvedBy.name),1),On])):$("",!0)])])])):$("",!0),e("div",$n,[e("div",Rn,[e("div",Nn,[e("div",An,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:(he=f.defectData)==null?void 0:he.assetNumber},null,8,Pn),Tn])]),e("div",En,[e("div",Un,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:f.serialNumber},null,8,Fn),qn])]),e("div",Bn,[e("div",Ln,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:ga.value},null,8,Hn),jn])])])]),e("div",Yn,[u(nl,{ref_key:"defectCameraRef",ref:ge,task:f.task,"re-render":f.reRender,"defect-images":f.defectImages||[],type:"defect",disabled:C.value,"allow-delete":!C.value,onOnImageDownloaded:Ke,onOnCameraClicked:Te,onOnImageDelete:Ve,"has-submitted":!de.value},null,8,["task","re-render","defect-images","disabled","allow-delete","has-submitted"])]),de.value?$("",!0):(v(),me(g,{key:2,class:"error-label"},{default:y(()=>[q("Required")]),_:1})),e("div",Gn,[u(ya,{disabled:C.value,value:(Nt=F.value)==null?void 0:Nt.value,label:De.value,name:"defectPlaceholder",errorMessage:F.value.errorMessage,"is-valid":F.value.isValid,onHandleChange:ra},null,8,["disabled","value","label","errorMessage","is-valid"])]),e("div",Wn,[e("div",Kn,[e("div",Jn,[e("div",Qn,[e("input",{type:"text",class:"form-control",disabled:"",value:(Ye=f.defectData)==null?void 0:Ye.raisedBy},null,8,zn),Xn])])])]),e("div",Zn,[e("div",er,[e("div",ar,[e("div",tr,[e("input",{type:"text",class:"form-control",disabled:"",value:(At=f.defectData)==null?void 0:At.date},null,8,lr),sr])]),e("div",or,[e("div",ir,[e("div",nr,[e("input",{type:"text",class:"form-control",pattern:"[0-9]*",inputmode:"numeric",value:ee(nt)(D.value.value),onInput:Fa,disabled:C.value},null,40,rr),ur]),D.value.isValid?$("",!0):(v(),p("div",cr,[u(g,{class:"error-label"},{default:y(()=>[q(K(D.value.errorMessage),1)]),_:1})]))]),e("div",dr,[u(g,null,{default:y(()=>[q("Hours")]),_:1})])])])]),e("div",vr,[u(ya,{value:te.value.value,label:ea.value,name:"instruction",disabled:C.value,isValid:te.value.isValid,errorMessage:te.value.errorMessage,onHandleChange:$e},null,8,["value","label","disabled","isValid","errorMessage"])]),mr,u(le,{class:"task-group general-accordion py-1 px-5",modelValue:b.value,"onUpdate:modelValue":n[4]||(n[4]=S=>b.value=S)},{default:y(()=>[u(R,{title:"Priority",name:"Priority"},{default:y(()=>[fr,e("div",pr,[e("div",gr,[e("div",hr,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":n[0]||(n[0]=S=>ve.value=S),value:"P1",disabled:C.value},null,8,yr),[[it,ve.value]]),br])]),_r,kr]),e("div",Dr,[e("div",Cr,[e("div",wr,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":n[1]||(n[1]=S=>ve.value=S),value:"P2",disabled:C.value},null,8,Vr),[[it,ve.value]]),Mr])]),Ir,Sr]),e("div",xr,[e("div",Or,[e("div",$r,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":n[2]||(n[2]=S=>ve.value=S),value:"P3",disabled:C.value},null,8,Rr),[[it,ve.value]]),Nr])]),Ar,Pr]),e("div",Tr,[e("div",Er,[e("div",Ur,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":n[3]||(n[3]=S=>ve.value=S),value:"P4",disabled:C.value},null,8,Fr),[[it,ve.value]]),qr])]),Br,Lr])]),_:1})]),_:1},8,["modelValue"]),Hr,u(le,{class:"task-group general-accordion py-1 px-5",modelValue:Y.value,"onUpdate:modelValue":n[5]||(n[5]=S=>Y.value=S)},{default:y(()=>[u(R,{title:"Parts",name:"Parts"},{default:y(()=>[jr,(v(!0),p(_e,null,Pe(j.value,(S,Z)=>(v(),p("div",{key:S,class:"row p-3 m-1 priority-container px-0"},[e("div",Yr,[e("div",Gr,[e("input",{type:"text",class:"form-control",value:S.partNumber,disabled:C.value},null,8,Wr)])]),e("div",Kr,[e("div",Jr,[e("input",{type:"text",class:"form-control",value:S.partDescription.value,onChange:E=>Se(E,Z),disabled:C.value},null,40,Qr),S.partDescription.isValid?$("",!0):(v(),p("div",zr,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.partDescription.errorMessage),1)]),_:2},1024)]))])]),e("div",Xr,[e("div",Zr,[e("input",{pattern:"[0-9]*",inputmode:"numeric",class:"form-control",value:ee(nt)(S.partQty.value),onInput:E=>Ma(E,Z),disabled:C.value},null,40,eu),S.partQty.isValid?$("",!0):(v(),p("div",au,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.partQty.errorMessage),1)]),_:2},1024)]))])]),e("div",tu,[e("div",lu,[u(Rl,{mode:"edit",index:Z,"item-value":S.images||[],onOnCameraClicked:Te,onOnImageDelete:je,isDisabled:C.value},null,8,["index","item-value","isDisabled"])])]),e("div",su,[e("div",ou,[u(Nl,{mode:"edit",index:Z,"item-value":S.attachment||[],onOnAttachmentClicked:Qe,onOnAttachmentDelete:Le,isDisabled:C.value},null,8,["index","item-value","isDisabled"])]),C.value?$("",!0):(v(),p("div",iu,[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(E=>Ia(Z),["prevent"])},null,8,nu)]))])]))),128)),C.value?$("",!0):(v(),p("button",{key:0,class:"my-3 btn-add-new",onClick:Ue},[ru,q(" Add more parts ")]))]),_:1})]),_:1},8,["modelValue"]),uu,u(le,{class:"task-group general-accordion py-1 px-5",modelValue:O.value,"onUpdate:modelValue":n[7]||(n[7]=S=>O.value=S)},{default:y(()=>[u(R,{title:"Labour",name:"Labour"},{default:y(()=>[cu,(v(!0),p(_e,null,Pe(A.value,(S,Z)=>(v(),p("div",{key:S,class:"row p-3 m-1 priority-container px-0"},[e("div",du,[e("div",vu,[u(wt,{modelValue:S.position.value,"onUpdate:modelValue":E=>S.position.value=E,filterable:"",placeholder:"Choose Labour",onChange:E=>ma(Z),class:"w-100",disabled:C.value},{default:y(()=>[(v(!0),p(_e,null,Pe(f.positions,E=>(v(),me(Ta,{key:E.value,label:E.label,value:E.label},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"]),S.position.isValid?$("",!0):(v(),p("div",mu,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.position.errorMessage),1)]),_:2},1024)]))])]),e("div",fu,[e("div",pu,[e("input",{pattern:"[0-9]*",inputmode:"numeric",class:"form-control",onKeypress:n[6]||(n[6]=(...E)=>ee(Gt)&&ee(Gt)(...E)),value:ee(nt)(S.qty.value),onInput:E=>Sa(E,Z),disabled:C.value},null,40,gu),S.qty.isValid?$("",!0):(v(),p("div",hu,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.qty.errorMessage),1)]),_:2},1024)]))])]),e("div",yu,[e("div",bu,[e("input",{pattern:"[0-9]*",inputmode:"numeric",class:"form-control",onKeypress:Ct,value:ee(nt)(S.hourEach.value),onInput:E=>Oa(E,Z),disabled:C.value},null,40,_u),S.hourEach.isValid?$("",!0):(v(),p("div",ku,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.hourEach.errorMessage),1)]),_:2},1024)]))])]),e("div",Du,[e("div",Cu,[e("input",{class:"form-control",value:S.totalHour,disabled:""},null,8,wu)]),e("div",{class:Ca(["ms-4 d-flex align-items-center",Z===0||C.value?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(E=>ze(Z),["prevent"])},null,8,Vu)],2)])]))),128)),C.value?$("",!0):(v(),p("button",{key:0,class:"my-3 btn-add-new",onClick:Fe},[Mu,q(" Add more labour ")]))]),_:1})]),_:1},8,["modelValue"]),Iu,u(le,{class:"task-group general-accordion py-1 px-5",modelValue:k.value,"onUpdate:modelValue":n[8]||(n[8]=S=>k.value=S)},{default:y(()=>[u(R,{title:"Other Resource (optional)",name:"Other Resource (optional)"},{default:y(()=>[(v(!0),p(_e,null,Pe(M.value,(S,Z)=>(v(),p("div",{class:"p-2 d-flex",key:S.value},[e("div",Su,[e("input",{type:"text",class:"form-control",value:S.value,placeholder:`Resource${Z+1}`,onChange:E=>He(E,Z),disabled:C.value},null,40,xu),S.isValid?$("",!0):(v(),p("div",Ou,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.errorMessage),1)]),_:2},1024)]))]),e("div",{class:Ca(["ms-4 d-flex align-items-center",Z===0||C.value?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(E=>$a(Z),["prevent"])},null,8,$u)],2)]))),128)),C.value?$("",!0):(v(),p("button",{key:0,class:"my-3 btn-add-new",onClick:Ga},[Ru,q(" Add new resource ")]))]),_:1})]),_:1},8,["modelValue"]),Nu,u(le,{class:"task-group general-accordion py-1 px-5",modelValue:H.value,"onUpdate:modelValue":n[9]||(n[9]=S=>H.value=S)},{default:y(()=>[u(R,{title:"Symptom",name:"Symptom"},{default:y(()=>[(v(!0),p(_e,null,Pe(V.value,(S,Z)=>(v(),p("div",{class:"p-2 d-flex",key:S.value},[e("div",Au,[u(wt,{modelValue:S.value,"onUpdate:modelValue":E=>S.value=E,placeholder:"Select Symptom",filterable:"",onChange:E=>Wa(E,Z),class:"w-100",disabled:C.value},{default:y(()=>[(v(!0),p(_e,null,Pe(f.symptomOptions,E=>(v(),me(Ta,{key:E.id,label:E.symptom,value:E.symptom},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"]),S.isValid?$("",!0):(v(),p("div",Pu,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.errorMessage),1)]),_:2},1024)])),S.value.includes("Other")?(v(),p("div",Tu,[u(ya,{value:G.value[Z]&&G.value[Z].value,label:"Description",name:"Description",errorMessage:"Required",disabled:C.value,"is-valid":G.value[0].isValid,index:Z,onHandleChange:Ka},null,8,["value","disabled","is-valid","index"])])):$("",!0)]),e("div",{class:Ca(["ms-4 d-flex align-items-center",Z===0||C.value?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(E=>Xa(Z),["prevent"])},null,8,Eu)],2)]))),128)),C.value?$("",!0):(v(),p("button",{key:0,class:"my-3 btn-add-new",onClick:Ne(za,["prevent"])},[Uu,q(" Add another symptom ")]))]),_:1})]),_:1},8,["modelValue"]),Fu,u(le,{class:"task-group general-accordion py-1 px-5",modelValue:W.value,"onUpdate:modelValue":n[10]||(n[10]=S=>W.value=S)},{default:y(()=>[u(R,{title:"Cause",name:"Cause"},{default:y(()=>[(v(!0),p(_e,null,Pe(z.value,(S,Z)=>(v(),p("div",{class:"p-2 d-flex",key:S.value},[e("div",qu,[u(wt,{modelValue:S.value,"onUpdate:modelValue":E=>S.value=E,placeholder:"Select Cause",filterable:"",onChange:E=>Xe(E,Z),class:"w-100",disabled:C.value},{default:y(()=>[(v(!0),p(_e,null,Pe(f.causeOptions,E=>(v(),me(Ta,{key:E.id,label:E.causes,value:E.causes},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"]),S.isValid?$("",!0):(v(),p("div",Bu,[u(g,{class:"error-label"},{default:y(()=>[q(K(S.errorMessage),1)]),_:2},1024)])),S.value.includes("Other")?(v(),p("div",Lu,[u(ya,{value:X.value[Z]&&X.value[Z].value,label:"Description",name:"Description",errorMessage:"Required","is-valid":X.value[0].isValid,index:Z,disabled:C.value,onHandleChange:ta},null,8,["value","is-valid","index","disabled"])])):$("",!0)]),e("div",{class:Ca(["ms-4 d-flex align-items-center",Z===0||C.value?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(E=>Za(Z),["prevent"])},null,8,Hu)],2)]))),128)),C.value?$("",!0):(v(),p("button",{key:0,class:"my-3 btn-add-new",onClick:la},[ju,q(" Add another cause ")]))]),_:1})]),_:1},8,["modelValue"]),Dt.value?(v(),p("div",Yu,[C.value?$("",!0):(v(),p("button",{key:0,class:"btn btn-light w-100",onClick:Ne(Ze,["prevent"]),style:{background:"rgb(255, 255, 255)",border:"1px solid rgba(145, 158, 171, 0.24)","box-shadow":"rgba(0, 171, 85, 0.24) 0px 8px 16px",color:"black"}},"Cancel")),C.value?$("",!0):(v(),p("button",{key:1,class:"ms-3 btn btn-success w-100",onClick:Ne(et,["prevent"]),disabled:C.value,style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},"Submit",8,Gu)),C.value?(v(),p("button",{key:2,class:"btn btn-warning w-100",onClick:Ne(sa,["prevent"]),style:{background:"rgb(255, 193, 7)","box-shadow":"rgba(0, 171, 85, 0.24) 0px 8px 16px",color:"black"}},"Modify")):$("",!0)])):$("",!0)]),u(ca,{visibility:ue.value,caption:"Please confirm this defect information is correct.",onOnNoConfirm:at,onOnYesConfirm:Aa},null,8,["visibility"]),u(ca,{visibility:re.value,caption:"Are you sure want to close the defect form? <br /> Note: By closing the defect form, you will lose your defect data that you have already inputted.",onOnNoConfirm:T,onOnYesConfirm:ce},null,8,["visibility"])]}),_:1},8,["modelValue","custom-class"])}}}),Ku=_t(Wu,[["__scopeId","data-v-4e44e942"]]),Ju={class:"caption"},Qu={class:"dialog-footer",style:{display:"block","text-align":"right"}},zu=wa({__name:"TakeMoreImageConfirmation",props:{visibility:{required:!0,type:Boolean},caption:{required:!0,type:String},yesLabel:{default:"Yes"},noLabel:{default:"No"},hideNo:{default:!1},hideYes:{default:!1},disableYes:{default:!1},disableNo:{default:!1},yesButtonBackroundColor:{default:"#18AF4A"}},emits:["onNoConfirm","onYesConfirm"],setup(f,{emit:fe}){const _=f,d=fe,c=w(()=>_.visibility),C=()=>{d("onNoConfirm")},b=()=>{d("onYesConfirm")};return(Y,O)=>{const k=ae("el-button"),H=ae("el-dialog");return v(),me(H,{modelValue:c.value,"onUpdate:modelValue":O[0]||(O[0]=W=>c.value=W),center:"",top:"30vh","close-on-click-modal":!1,"show-close":!1,"custom-class":"confirmation","append-to-body":""},{footer:y(()=>[e("span",Qu,[f.hideNo?$("",!0):(v(),me(k,{key:0,disabled:f.disableNo,onClick:C,type:"success",style:xo(`background:${f.yesButtonBackroundColor}; box-shadow: 0px 8px 16px rgba(0, 171, 85, 0.24); color: white`)},{default:y(()=>[q(K(f.noLabel),1)]),_:1},8,["disabled","style"])),f.hideYes?$("",!0):(v(),me(k,{key:1,disabled:f.disableYes,class:"button-OK-confirmation",onClick:Ne(b,["prevent"]),style:{"box-shadow":"0px 24px 48px rgba(145, 158, 171, 0.2)"}},{default:y(()=>[q(K(f.yesLabel),1)]),_:1},8,["disabled"]))])]),default:y(()=>[e("span",Ju,K(f.caption),1)]),_:1},8,["modelValue"])}}}),Pl=f=>(yt("data-v-b9d50769"),f=f(),bt(),f),Xu=Pl(()=>e("span",{class:"el-dialog__title"},"Not Applicable",-1)),Zu=["innerHTML"],ec={class:"mt-1 p-2"},ac={class:"d-flex flex-column"},tc=Pl(()=>e("label",null,"Why could you not complete the required service item?",-1)),lc={key:0,class:"mt-1 p-2"},sc={class:"my-5 w-100"},oc=["disabled"],ic=wa({__name:"NAForm",props:{task:{type:Object,required:!0},visibility:{type:Boolean,required:!0},conditions:{type:Array}},emits:["onSubmit","onCancel","onClose"],setup(f,{emit:fe}){const _=f,d=fe,c=Kt(_,"visibility"),C=o(""),b=o(!0),Y=o(!1),O=o(""),k=o(!0),H=o(!1),W=o(null),ye=w(()=>cl(_.task)),re=()=>{Y.value=C.value.includes("Other"),k.value=C.value.includes("Other")},ke=pe=>{O.value=pe.value,k.value=O.value==""},we=()=>{H.value=!0},ue=()=>{const pe={};pe.reason=C.value,pe.reasonDesc=O.value,pe.taskDesc=_.task.description,pe.taskNo=_.task.interventionSequence,d("onSubmit",pe),H.value=!1},F=()=>{H.value=!1},te=async()=>{d("onClose",null)},de=()=>{C.value="",b.value=!0,Y.value=!1,O.value="",k.value=!0,Jt(W.value)};return(pe,D)=>{const ve=ae("el-option"),j=ae("el-select"),A=ae("el-dialog");return v(),p(_e,null,[u(A,{modelValue:c.value,"onUpdate:modelValue":D[1]||(D[1]=M=>c.value=M),width:"90%",center:"",onClosed:te,onOpened:de,"custom-class":"el-defect-crack-form-custom","destroy-on-close":!0},{title:y(()=>[Xu,e("span",{class:"el-dialog__title task-title",innerHTML:ee(Qt)(ye.value,!0),ref_key:"defectDetailRef",ref:W},null,8,Zu)]),default:y(()=>[e("div",null,[e("div",ec,[e("div",ac,[tc,u(j,{modelValue:C.value,"onUpdate:modelValue":D[0]||(D[0]=M=>C.value=M),filterable:"",onChange:re,class:"w-100"},{default:y(()=>[(v(!0),p(_e,null,Pe(f.conditions,M=>(v(),me(ve,{key:M.id,label:M.naCondition,value:M.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),Y.value?(v(),p("div",lc,[u(ya,{value:O.value,label:"Description",name:"InstructionPlaceholder",errorMessage:"Required","is-valid":b.value,onHandleChange:ke},null,8,["value","is-valid"])])):$("",!0),e("div",sc,[e("button",{class:"btn btn-success w-100",onClick:we,disabled:k.value,style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},"Submit",8,oc)])])]),_:1},8,["modelValue"]),u(ca,{visibility:H.value,caption:"Please confirm this is the reason you could not do the service item.",onOnNoConfirm:F,onOnYesConfirm:ue},null,8,["visibility"])],64)}}}),nc=_t(ic,[["__scopeId","data-v-b9d50769"]]),rc={class:"row pt-3 pb-3 text-dark modal-title"},uc=e("h3",{style:{"word-break":"break-word"}}," Please select if any of the questions below are applicable to this defect before submitting. Please note neither may be applicable and you can still submit and continue. ",-1),cc=e("span",{style:{"word-break":"break-word"},innerHTML:"Does the defect identified require > 30 minutes in labour to repair?"},null,-1),dc={class:"dialog-footer",style:{display:"block","text-align":"right"}},vc=wa({__name:"DefectConfirmationDialog",props:["show","checkListArr"],emits:["close","updateCheckList","submit"],setup(f,{emit:fe}){const _=f,d=fe,c=ol({get:()=>_.checkListArr,set:O=>{d("updateCheckList",O)}}),C=()=>{d("submit")},b=ol(()=>_.show),Y=()=>{d("close")};return(O,k)=>{const H=ae("el-checkbox"),W=ae("el-checkbox-group"),ye=ae("el-button"),re=ae("el-dialog");return v(),me(re,{modelValue:ee(b),"onUpdate:modelValue":k[1]||(k[1]=ke=>il(b)?b.value=ke:null),width:"50%","show-close":!1,"custom-class":"oil-not-in-range__header defect__confirmation_container",top:"30vh",center:!0,onClose:Y},{footer:y(()=>[e("span",dc,[u(ye,{onClick:Y,style:{"box-shadow":"0px 24px 48px rgba(145, 158, 171, 0.2)"}},{default:y(()=>[q("Cancel")]),_:1}),u(ye,{class:"button-OK-confirmation",type:"success",onClick:Ne(C,["prevent"]),style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},{default:y(()=>[q("Submit")]),_:1})])]),default:y(()=>[e("div",rc,[uc,u(W,{modelValue:ee(c),"onUpdate:modelValue":k[0]||(k[0]=ke=>il(c)?c.value=ke:null),class:"d-flex flex-column defect-checkbox"},{default:y(()=>[u(H,{label:"Does the defect identified require > 30 minutes in labour to repair?"},{default:y(()=>[cc]),_:1}),u(H,{label:"Does the defect identified require > $250 in parts to repair?"})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}}),Q=f=>(yt("data-v-1382e321"),f=f(),bt(),f),mc=Q(()=>e("span",{class:"el-dialog__title"},"Detailed Information for Defect Identification",-1)),fc=["innerHTML"],pc={key:0,class:"d-flex flex-column justify-content-between"},gc={class:"py-2 d-flex flex-row flex-grow-1"},hc={class:"flex-fill"},yc={class:"form-floating"},bc=Q(()=>e("label",{for:"floatingInput"},"Task Description",-1)),_c={class:"mt-2"},kc={class:"d-flex flex-row justify-content-between"},Dc={class:"py-2 d-flex flex-row flex-grow-1"},Cc={class:"flex-fill"},wc={class:"form-floating"},Vc=["innerHTML"],Mc=Q(()=>e("label",{for:"floatingInput"},"Asset Number",-1)),Ic={class:"flex-fill ps-3"},Sc={class:"form-floating"},xc=["innerHTML"],Oc=Q(()=>e("label",{for:"floatingInput"},"Serial Number",-1)),$c={class:"flex-fill ps-3"},Rc={class:"form-floating"},Nc=["innerHTML"],Ac=Q(()=>e("label",{for:"floatingInput"},"Ownership",-1)),Pc={class:"d-flex flex-row justify-content-between"},Tc={class:"mt-1 py-2"},Ec={class:"mt-1 py-2"},Uc={class:"row"},Fc={class:"col pe-0"},qc={class:"form-floating"},Bc=["value"],Lc=Q(()=>e("label",null,"Raised By",-1)),Hc={class:"mt-1 py-2"},jc={class:"row"},Yc={class:"col-4 pe-0 date"},Gc={class:"form-floating"},Wc=["value"],Kc=Q(()=>e("label",null,"Date Raised",-1)),Jc={class:"col pe-0 d-flex"},Qc={class:"d-flex flex-column flex-fill"},zc={class:"form-floating"},Xc=["value"],Zc=Q(()=>e("label",{class:"text-nowrap"},"How long will this defect repair take?",-1)),ed={key:0,class:"mt-2"},ad={class:"ms-2 d-flex align-items-center"},td={class:"mt-1 py-2"},ld=Q(()=>e("div",{class:"mt-2"},null,-1)),sd=Q(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-3"},"Priority"),e("div",{class:"col-6"},"Action"),e("div",{class:"col-3 text-break"},"Person Responsible")],-1)),od={class:"row p-3 m-1 priority-container"},id={class:"col-3"},nd={class:"form-check"},rd=Q(()=>e("label",{class:"form-check-label text-nowrap"}," (P1) Immediate ",-1)),ud=Q(()=>e("div",{class:"col-6 word-breaker"},"Shall shut machine down and undertake repairs.",-1)),cd=Q(()=>e("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),dd={class:"row p-3 m-1 priority-container"},vd={class:"col-3"},md={class:"form-check"},fd=Q(()=>e("label",{class:"form-check-label text-nowrap"}," (P2) Urgent ",-1)),pd=Q(()=>e("div",{class:"col-6 word-breaker"},"Shall complete within 7 days.",-1)),gd=Q(()=>e("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),hd={class:"row p-3 m-1 priority-container"},yd={class:"col-3"},bd={class:"form-check"},_d=Q(()=>e("label",{class:"form-check-label text-nowrap"}," (P3) Routine ",-1)),kd=Q(()=>e("div",{class:"col-6 word-breaker"},"Shall complete within 60 days.",-1)),Dd=Q(()=>e("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),Cd={class:"row p-3 m-1 priority-container"},wd={class:"col-3"},Vd={class:"form-check"},Md=Q(()=>e("label",{class:"form-check-label text-nowrap"}," (P4) Monitor ",-1)),Id=Q(()=>e("div",{class:"col-6 word-breaker"},"Shall continue to inspect and monitor for 90 days.",-1)),Sd=Q(()=>e("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),xd=Q(()=>e("div",{class:"mt-2"},null,-1)),Od=Q(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-3"},"Part Number"),e("div",{class:"col-5"},"Part Description"),e("div",{class:"col-1"},"Qty"),e("div",{class:"col"}),e("div",{class:"col"})],-1)),$d={class:"col-3 px-0"},Rd={class:"d-flex flex-column"},Nd=["onUpdate:modelValue"],Ad={class:"col-5"},Pd={class:"d-flex flex-column"},Td=["onUpdate:modelValue","onChange"],Ed={key:0,class:"mt-2"},Ud={class:"col-1 px-1 d-flex justify-content-start"},Fd={class:"d-flex flex-column"},qd=["value","onInput"],Bd={key:0,class:"mt-2"},Ld={class:"col px-1 d-flex flex-column justify-content-start"},Hd={class:"row p-0 m-0 h-100 w-100 align-items-center"},jd={class:"col px-1 d-flex flex-column justify-content-start position-relative"},Yd={class:"row p-0 m-0 h-100 w-100 align-items-center"},Gd={class:"position-absolute",style:{top:"10px",right:"0px"}},Wd=["onClick"],Kd=Q(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Jd=Q(()=>e("div",{class:"mt-2"},null,-1)),Qd=Q(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-6"},"Labour Activity"),e("div",{class:"col-2"},"Qty"),e("div",{class:"col-2 word-breaker"},"Hours Each"),e("div",{class:"col-2 word-breaker"},"Total Hours")],-1)),zd={class:"col-6 px-0"},Xd={class:"d-flex flex-column"},Zd={key:0,class:"mt-2"},ev={class:"col-2 d-flex justify-content-start"},av={class:"d-flex flex-column"},tv=["value","onInput"],lv={key:0,class:"mt-2"},sv={class:"col-2 d-flex justify-content-start"},ov={class:"d-flex flex-column"},iv=["value","onInput"],nv={key:0,class:"mt-2"},rv={class:"col-2 d-flex justify-content-start"},uv={class:"d-flex flex-column"},cv=["value"],dv=["onClick"],vv=Q(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),mv=Q(()=>e("div",{class:"mt-2"},null,-1)),fv={class:"d-flex flex-fill flex-column"},pv=["value","placeholder","onChange"],gv={key:0,class:"mt-2"},hv=["onClick"],yv=Q(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),bv=Q(()=>e("div",{class:"mt-2"},null,-1)),_v={class:"d-flex flex-fill flex-column"},kv={key:0,class:"mt-2"},Dv={key:1,class:"mt-2"},Cv={key:2,class:"mt-2"},wv=["onClick"],Vv=Q(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Mv=Q(()=>e("div",{class:"mt-2"},null,-1)),Iv={class:"d-flex flex-fill flex-column"},Sv={key:0,class:"mt-2"},xv={key:1,class:"mt-2"},Ov={key:2,class:"mt-2"},$v=["onClick"],Rv=Q(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Nv={class:"my-5 w-100"},Av=wa({__name:"DefectYesForm",props:{visibility:{type:Boolean,required:!0},assetNumber:{type:String,required:!0},task:{type:Object,required:!0},currentFitter:{type:Object,required:!0},positions:{type:Array},symptomOptions:{type:Array},causeOptions:{type:Array},defectImages:{type:Array,required:!0},reRender:{type:Boolean,default:!1},ownership:{type:String,default:""},serialNumber:{type:String,default:""},generic:{required:!1,type:Boolean,default:!1},generatedID:{required:!1,type:String,default:""},isNeed30Minutes:{default:!1}},emits:["onCameraClick","onAttachmentClicked","onImageDeleted","onImagePartDeleted","onAttachmentPartDeleted","onSubmit","onCancel","onClose","OnSetFlagFromDeleteAction"],setup(f,{expose:fe,emit:_}){const d=f,c=_,C=o("Priority"),b=o("Parts Required"),Y=o("Labour Required"),O=o("Other Resources Required (optional)"),k=o("Defect Symptom"),H=o("Defect Cause"),W=o(!1),ye=o(!1),re=o(!1),ke=Kt(d,"visibility"),we=o(Ce()),ue=o({value:"",isValid:!0,errorMessage:""}),F=o({value:"",isValid:!0,errorMessage:""}),te=o([]),de=o(!0),pe=o(),D=o({value:"",isValid:!0,errorMessage:""}),ve=o(ht()),j=o(),A=o("P1"),M=o([]),V=o([{position:{value:"Diesel Fitter",isValid:!0,errorMessage:""},qty:{value:"",isValid:!0,errorMessage:""},hourEach:{value:"",isValid:!0,errorMessage:""},totalHour:""}]),G=o([{value:"",isValid:!0,errorMessage:""}]),z=o([{value:"",isValid:!0,errorMessage:""}]),X=o([{value:"",isValid:!0,errorMessage:""}]),be=o([{value:"",isValid:!0,errorMessage:""}]),ge=o([{value:"",isValid:!0,errorMessage:""}]),qe=o(),B=["images","description","priority","instruction","plannedDuration","parts","labours","resources","symptoms","causes"],De=w(()=>({images:d.defectImages,description:ue.value.value,priority:A.value,instruction:F.value.value,plannedDuration:D.value.value,parts:M.value,labours:V.value,resources:G.value,symptoms:z.value,causes:be.value})),ea=w(()=>rl(B,qe.value,De.value)),Te=()=>{Je()},Ve=o({isValid:!0,errorMessage:"",value:""}),Ke=w(()=>cl(d.task)),ra=w(()=>"Defect Identified Description"),da=w(()=>"Defect Repair Instructions"),ba=l=>{de.value=!0,c("onCameraClick",l)},Fa=l=>{d.defectImages.length==1?(de.value=!1,c("OnSetFlagFromDeleteAction",!0),j.value.handleClickCamera(),j.value.handleHideModal()):c("onImageDeleted",l)},Va=l=>{c("onImagePartDeleted",l.filename);const r=M.value[l.index].images;r&&(M.value[l.index].images=U.cloneDeep(r).filter(h=>h.filename!=l.filename))},$e=l=>{c("onAttachmentClicked",l)},P=l=>{c("onAttachmentPartDeleted",l.filename);const r=M.value[l.index].attachment;r&&(M.value[l.index].attachment=U.cloneDeep(r).filter(h=>h.url!=l.filename))},Se=l=>{ue.value.value=l.value,Be()},Be=()=>{let l=!0;return ue.value.value===""?(ue.value.isValid=!1,ue.value.errorMessage="Required",l=!1):(ue.value.isValid=!0,ue.value.errorMessage=""),l},Ma=()=>d.defectImages.length>=1?(de.value=!0,!0):(de.value=!1,!1),Je=()=>{let l=!0;return Ve.value.value==""?(Ve.value.isValid=!1,Ve.value.errorMessage="Required",l=!1):(Ve.value.isValid=!0,Ve.value.errorMessage=""),l},Ae=l=>{D.value.value=Ie(l.target.value),Ue()},Ue=()=>{let l=!0;if(D.value.value==="")D.value.isValid=!1,D.value.errorMessage="Required",l=!1;else{let r=!$t(D.value.value);if(r)D.value.isValid=!0,D.value.errorMessage="";else return D.value.isValid=!1,D.value.errorMessage="Invalid format",l=!1,l;r=pt(D.value.value),r?d.isNeed30Minutes&&(Number(D.value.value)<=.5?(D.value.isValid=!1,D.value.errorMessage="Must more than half an hour",l=!1):(D.value.isValid=!0,D.value.errorMessage="")):(D.value.isValid=!1,D.value.errorMessage="Out of range (max 5 digit and 2 fraction)",l=!1)}return l},Ia=l=>{F.value.value=l.value,je()},je=()=>{let l=!0;return F.value.value===""?(F.value.isValid=!1,F.value.errorMessage="Required",l=!1):(F.value.isValid=!0,F.value.errorMessage=""),l},Qe=(l,r)=>{M.value[r].partDescription.value=l.target.value,Le(M.value[r].partDescription)},Le=l=>{let r=!0;return l.value===""?(l.isValid=!1,l.errorMessage="Required",r=!1):(l.isValid=!0,l.errorMessage=""),r},qa=(l,r)=>{M.value[r].partQty.value=Ie(l.target.value),Ba(M.value[r].partQty)},Ba=l=>{let r=!0;return l.value===""?(l.isValid=!1,l.errorMessage="Required",r=!1):pt(l.value)?(l.isValid=!0,l.errorMessage=""):(l.isValid=!1,l.errorMessage="Out of range (max 5 digit and 2 fraction)",r=!1),r},La=()=>{let l=!0;const r=[];return M.value.forEach(h=>{const T=[];T.push(Le(h.partDescription)),T.push(Ba(h.partQty)),r.push(T.every(ce=>ce))}),l=r.every(h=>h),l},Sa=()=>{La()&&M.value.push({partNumber:"",partDescription:{value:"",isValid:!0,errorMessage:""},partQty:{value:"",isValid:!0,errorMessage:""}})},xa=l=>{M.value.splice(l,1)},Oa=l=>{let r=!0;return l.value===""?(l.isValid=!1,l.errorMessage="Required",r=!1):V.value.filter(T=>T.position.value==l.value).length>1?(l.isValid=!1,l.errorMessage="Duplicate position",r=!1):(l.isValid=!0,l.errorMessage=""),r},aa=(l,r)=>{l.target.value=gt(l.target.value),V.value[r].qty.value=Ie(l.target.value),Ha(V.value[r].qty),Fe(r)},Ha=l=>{let r=!0;return l.value===""?(l.isValid=!1,l.errorMessage="Required",r=!1):Al(l.value)?(l.isValid=!0,l.errorMessage=""):(l.isValid=!1,l.errorMessage="Out of range (max 5 digits)",r=!1),r},va=(l,r)=>{l.target.value=gt(l.target.value),V.value[r].hourEach.value=Ie(l.target.value),ma(V.value[r].hourEach),Fe(r)},ma=l=>{let r=!0;return l.value===""?(l.isValid=!1,l.errorMessage="Required",r=!1):pt(l.value)?(l.isValid=!0,l.errorMessage=""):(l.isValid=!1,l.errorMessage="Out of range (max 5 digit and 2 fraction)",r=!1),r},Fe=l=>{if(V.value[l].qty.isValid&&V.value[l].qty.value!=""&&V.value[l].hourEach.isValid&&V.value[l].hourEach.value!=""){const r=+V.value[l].qty.value,h=+V.value[l].hourEach.value,T=r*h;V.value[l].qty.value.includes(".")||V.value[l].hourEach.value.includes(".")?V.value[l].totalHour=T.toFixed(2).toString():V.value[l].totalHour=T.toString()}else V.value[l].totalHour=""},ze=()=>{let l=!0;const r=[];return V.value.forEach(h=>{const T=[];T.push(Oa(h.position)),T.push(Ha(h.qty)),T.push(ma(h.hourEach)),r.push(T.every(ce=>ce))}),l=r.every(h=>h),l},He=l=>{let r=!1;const h=V.value[l].position.value;for(let T=0;T<l;T++){if(T==l)continue;V.value[T].position.value==h?(V.value[T].position.isValid=!1,V.value[T].position.errorMessage="Duplicate position",V.value[l].position.isValid=!1,V.value[l].position.errorMessage="Duplicate position",r=!0):(V.value[T].position.isValid=!0,V.value[T].position.errorMessage="",r||(V.value[l].position.isValid=!0,V.value[l].position.errorMessage=""))}},ja=()=>{ze()&&V.value.push({position:{value:"",isValid:!0,errorMessage:""},qty:{value:"",isValid:!0,errorMessage:""},hourEach:{value:"",isValid:!0,errorMessage:""},totalHour:""})},Ya=l=>{V.value.splice(l,1)},rt=(l,r)=>{l.preventDefault(),G.value[r].value=l.target.value,Ga()},ut=l=>{let r=!0;return l.value===""&&G.value.length>1?(l.isValid=!1,l.errorMessage="Required",r=!1):G.value.filter(T=>T.value==l.value).length>1?(l.isValid=!1,l.errorMessage="Duplicate resource",r=!1):(l.isValid=!0,l.errorMessage=""),r},Ga=()=>{let l=!0;const r=[];return G.value.forEach(h=>{const T=[];T.push(ut(h)),r.push(T.every(ce=>ce))}),l=r.every(h=>h),l},$a=()=>{let l=!0;const r=[];return G.value.forEach(h=>{const T=[];T.push(Wa(h)),r.push(T.every(ce=>ce))}),l=r.every(h=>h),l},Wa=l=>{let r=!0;return l.value===""?(l.isValid=!1,l.errorMessage="Required",r=!1):G.value.filter(T=>T.value==l.value).length>1?(l.isValid=!1,l.errorMessage="Duplicate resource",r=!1):(l.isValid=!0,l.errorMessage=""),r},Ka=()=>{$a()&&G.value.push({value:"",isValid:!0,errorMessage:""})},Ra=l=>{if(G.value.splice(l,1),G.value.length==1&&G.value[0].value==""){G.value[0].isValid=!0,G.value[0].errorMessage="";return}},Ja=(l,r)=>{za(z.value[r])},Qa=l=>{l.index!=null&&(X.value[l.index].value=l.value,Xa(X.value[l.index],z.value[l.index].value))},za=l=>{let r=!0;return l.value===""?(l.isValid=!1,l.errorMessage="Required",r=!1):z.value.filter(T=>T.value==l.value).length>1?(l.isValid=!1,l.errorMessage="Duplicate symptom",r=!1):(l.isValid=!0,l.errorMessage=""),r},Xa=(l,r)=>{let h=!0;return l.value===""&&r=="Other"?(l.isValid=!1,l.errorMessage="Required",h=!1):(l.isValid=!0,l.errorMessage=""),h},Xe=()=>{let l=!0;const r=[];return z.value.forEach((h,T)=>{const ce=[];ce.push(za(h)),ce.push(Xa(X.value[T],h.value)),r.push(ce.every(ga=>ga))}),l=r.every(h=>h),l},ta=()=>{Xe()&&(z.value.push({value:"",isValid:!0,errorMessage:""}),X.value.push({value:"",isValid:!0,errorMessage:""}))},Na=l=>{z.value.splice(l,1),X.value.splice(l,1)},Oe=(l,r)=>{Za(be.value[r])},_a=l=>{l.index!=null&&(ge.value[l.index].value=l.value,la(ge.value[l.index],be.value[l.index].value))},la=(l,r)=>{let h=!0;return l.value===""&&r=="Other"?(l.isValid=!1,l.errorMessage="Required",h=!1):(l.isValid=!0,l.errorMessage=""),h},Za=l=>{let r=!0;return l.value==""?(l.isValid=!1,l.errorMessage="Required",r=!1):be.value.filter(T=>T.value==l.value).length>1?(l.isValid=!1,l.errorMessage="Duplicate cause",r=!1):(l.isValid=!0,l.errorMessage=""),r},sa=()=>{let l=!0;const r=[];return be.value.forEach((h,T)=>{const ce=[];ce.push(Za(h)),ce.push(la(ge.value[T],h.value)),r.push(ce.every(ga=>ga))}),l=r.every(h=>h),l},Ze=()=>{sa()&&(be.value.push({value:"",isValid:!0,errorMessage:""}),ge.value.push({value:"",isValid:!0,errorMessage:""}))},ct=l=>{be.value.splice(l,1),ge.value.splice(l,1)},fa=()=>{let l=[];if(d.generic&&l.push(Je()),l.push(Ma()),l.push(Be()),l.push(Ue()),l.push(je()),l.push(La()),l.push(ze()),l.push(Ga()),l.push(Xe()),l.push(sa()),!l.every(h=>h)){ia(),dl();return}re.value=!0},oa=()=>M.value.map(l=>({partNumber:l.partNumber,partDescription:l.partDescription.value,qty:Ie(l.partQty.value),images:l.images,attachment:l.attachment})),et=()=>V.value.map(l=>({position:l.position.value,qty:Ie(l.qty.value),hireEach:Ie(l.hourEach.value),totalHours:Ie(l.totalHour)})),Aa=()=>{const l={};l.type="YES",l.isNeed30Minutes=d.isNeed30Minutes,l.assetNumber=d.assetNumber,l.raisedBy=d.currentFitter.name,l.date=we.value,l.description=ue.value.value,l.plannedDuration=Ie(D.value.value),l.instruction=F.value.value,l.priority=A.value,l.parts=oa(),l.labours=et(),l.resources=G.value.filter(r=>r.value!="").map(r=>r.value),l.symptoms=z.value.map((r,h)=>r.value=="Other"?`${r.value}:${X.value[h].value}`:r.value),l.causes=be.value.map((r,h)=>r.value=="Other"?`${r.value}:${ge.value[h].value}`:r.value),d.generic?(l.taskDesc=Ve.value.value,l.taskNo=""):(l.taskDesc=d.task.description,l.taskNo=d.task.interventionSequence),c("onSubmit",l),ye.value=!0,re.value=!1,Ve.value={isValid:!0,errorMessage:"",value:""}},at=()=>{re.value=!1},tt=async()=>{Ve.value={isValid:!0,errorMessage:"",value:""},c("onClose",ye.value)},ka=()=>{ye.value=!1,we.value=Ce(),ue.value={value:"",isValid:!0,errorMessage:""},F.value={value:"",isValid:!0,errorMessage:""},te.value=[],de.value=!0,D.value={value:"",isValid:!0,errorMessage:""},A.value="P1",M.value=[],V.value=[{position:{value:"Diesel Fitter",isValid:!0,errorMessage:""},qty:{value:"",isValid:!0,errorMessage:""},hourEach:{value:"",isValid:!0,errorMessage:""},totalHour:""}],G.value=[{value:"",isValid:!0,errorMessage:""}],z.value=[{value:"",isValid:!0,errorMessage:""}],X.value=[{value:"",isValid:!0,errorMessage:""}],be.value=[{value:"",isValid:!0,errorMessage:""}],ge.value=[{value:"",isValid:!0,errorMessage:""}]},Me=()=>{Ve.value={isValid:!0,errorMessage:"",value:""};try{ka(),d.generic||Jt(pe.value),Wt(ve.value)}catch(l){console.log(l)}qe.value={images:U.cloneDeep(d.defectImages),description:U.cloneDeep(ue.value.value),priority:U.cloneDeep(A.value),instruction:U.cloneDeep(F.value.value),plannedDuration:U.cloneDeep(D.value.value),parts:U.cloneDeep(M.value),labours:U.cloneDeep(V.value),resources:U.cloneDeep(G.value),symptoms:U.cloneDeep(z.value),causes:U.cloneDeep(be.value)}},ia=()=>{C.value="Priority",b.value="Parts Required",Y.value="Labour Required",O.value="Other Resources Required (optional)",k.value="Defect Symptom",H.value="Defect Cause"},pa=l=>{const r=l.which?l.which:l.keyCode;(r<48||r>57)&&(r!==46||l.target.value.indexOf(".")!==-1)&&l.preventDefault()},na=()=>{ea.value?W.value=!0:c("onCancel")},lt=()=>{W.value=!1},st=()=>{W.value=!1,c("onCancel")};fe({handlePartImage:(l,r)=>{const h=l.split("-")[0];U.isEmpty(M.value[h].images)&&(M.value[h].images=[]),M.value[h].images=[...M.value[h].images,...r]},handlePartAttachment:(l,r)=>{const h=l.split("-")[0];U.isEmpty(M.value[h].attachment)&&(M.value[h].attachment=[]),M.value[h].attachment=[...M.value[h].attachment,r]}});const Da=w(()=>{const l=d.ownership;return ul(l)});return(l,r)=>{const h=ae("Label"),T=ae("el-collapse-item"),ce=ae("el-collapse"),ga=ae("el-option"),dt=ae("el-select"),mt=ae("el-dialog");return v(),me(mt,{modelValue:ke.value,"onUpdate:modelValue":r[12]||(r[12]=Pa=>ke.value=Pa),width:"90%",center:"",onClosed:tt,onOpened:Me,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":na,"custom-class":`el-defect-crack-form-custom form-defect-yes ${ve.value}`,"destroy-on-close":!0},{title:y(()=>[mc,f.generic?$("",!0):(v(),p("span",{key:0,class:"el-dialog__title task-title",innerHTML:ee(Qt)(Ke.value,!0),ref_key:"defectDetailRef",ref:pe},null,8,fc))]),default:y(()=>{var Pa;return[e("div",null,[f.generic?(v(),p("div",pc,[e("div",gc,[e("div",hc,[e("div",yc,[We(e("input",{type:"text",class:"form-control","onUpdate:modelValue":r[0]||(r[0]=I=>Ve.value.value=I),onChange:Te},null,544),[[Rt,Ve.value.value]]),bc]),e("div",_c,[Ve.value.isValid?$("",!0):(v(),me(h,{key:0,class:"error-label"},{default:y(()=>[q(K(Ve.value.errorMessage),1)]),_:1}))])])])])):$("",!0),e("div",kc,[e("div",Dc,[e("div",Cc,[e("div",wc,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:f.assetNumber},null,8,Vc),Mc])]),e("div",Ic,[e("div",Sc,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:f.serialNumber},null,8,xc),Oc])]),e("div",$c,[e("div",Rc,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:Da.value},null,8,Nc),Ac])])])]),e("div",Pc,[u(nl,{ref_key:"defectCameraRef",ref:j,task:f.task,"generated-i-d":f.generatedID,"re-render":f.reRender,"defect-images":f.defectImages,type:"defect",disabled:!1,"allow-delete":!0,onOnCameraClicked:ba,onOnImageDelete:Fa,"has-submitted":!de.value},null,8,["task","generated-i-d","re-render","defect-images","has-submitted"])]),de.value?$("",!0):(v(),me(h,{key:1,class:"error-label"},{default:y(()=>[q("Required")]),_:1})),e("div",Tc,[u(ya,{value:(Pa=ue.value)==null?void 0:Pa.value,label:ra.value,name:"defectPlaceholder",errorMessage:ue.value.errorMessage,"is-valid":ue.value.isValid,onHandleChange:Se},null,8,["value","label","errorMessage","is-valid"])]),e("div",Ec,[e("div",Uc,[e("div",Fc,[e("div",qc,[e("input",{type:"text",class:"form-control",disabled:"",value:f.currentFitter.name},null,8,Bc),Lc])])])]),e("div",Hc,[e("div",jc,[e("div",Yc,[e("div",Gc,[e("input",{type:"text",class:"form-control",disabled:"",value:we.value},null,8,Wc),Kc])]),e("div",Jc,[e("div",Qc,[e("div",zc,[e("input",{type:"text",class:"form-control",pattern:"[0-9]*",inputmode:"numeric",value:ee(nt)(D.value.value),onInput:Ae},null,40,Xc),Zc]),D.value.isValid?$("",!0):(v(),p("div",ed,[u(h,{class:"error-label"},{default:y(()=>[q(K(D.value.errorMessage),1)]),_:1})]))]),e("div",ad,[u(h,null,{default:y(()=>[q("Hours")]),_:1})])])])]),e("div",td,[u(ya,{value:F.value.value,label:da.value,name:"InstructionPlaceholder",errorMessage:F.value.errorMessage,"is-valid":F.value.isValid,onHandleChange:Ia},null,8,["value","label","errorMessage","is-valid"])]),ld,u(ce,{class:"task-group general-accordion py-1 px-5",modelValue:C.value,"onUpdate:modelValue":r[5]||(r[5]=I=>C.value=I)},{default:y(()=>[u(T,{title:"Priority",name:"Priority"},{default:y(()=>[sd,e("div",od,[e("div",id,[e("div",nd,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":r[1]||(r[1]=I=>A.value=I),value:"P1"},null,512),[[it,A.value]]),rd])]),ud,cd]),e("div",dd,[e("div",vd,[e("div",md,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":r[2]||(r[2]=I=>A.value=I),value:"P2"},null,512),[[it,A.value]]),fd])]),pd,gd]),e("div",hd,[e("div",yd,[e("div",bd,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":r[3]||(r[3]=I=>A.value=I),value:"P3"},null,512),[[it,A.value]]),_d])]),kd,Dd]),e("div",Cd,[e("div",wd,[e("div",Vd,[We(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":r[4]||(r[4]=I=>A.value=I),value:"P4"},null,512),[[it,A.value]]),Md])]),Id,Sd])]),_:1})]),_:1},8,["modelValue"]),xd,u(ce,{class:"task-group general-accordion py-1 px-5",modelValue:b.value,"onUpdate:modelValue":r[6]||(r[6]=I=>b.value=I)},{default:y(()=>[u(T,{title:"Parts Required",name:"Parts Required"},{default:y(()=>[Od,(v(!0),p(_e,null,Pe(M.value,(I,L)=>(v(),p("div",{key:I,class:"row p-3 m-1 priority-container px-0"},[e("div",$d,[e("div",Rd,[We(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a=>M.value[L].partNumber=a},null,8,Nd),[[Rt,M.value[L].partNumber]])])]),e("div",Ad,[e("div",Pd,[We(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a=>I.partDescription.value=a,onChange:a=>Qe(a,L)},null,40,Td),[[Rt,I.partDescription.value]]),I.partDescription.isValid?$("",!0):(v(),p("div",Ed,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.partDescription.errorMessage),1)]),_:2},1024)]))])]),e("div",Ud,[e("div",Fd,[e("input",{pattern:"[0-9]*",inputmode:"numeric",class:"form-control",value:ee(nt)(I.partQty.value),onInput:a=>qa(a,L)},null,40,qd),I.partQty.isValid?$("",!0):(v(),p("div",Bd,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.partQty.errorMessage),1)]),_:2},1024)]))])]),e("div",Ld,[e("div",Hd,[u(Rl,{index:L,"item-value":I.images||[],onOnCameraClicked:ba,onOnImageDelete:Va},null,8,["index","item-value"])])]),e("div",jd,[e("div",Yd,[u(Nl,{index:L,"item-value":I.attachment||[],onOnAttachmentClicked:$e,onOnAttachmentDelete:P},null,8,["index","item-value"])]),e("div",Gd,[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(a=>xa(L),["prevent"])},null,8,Wd)])])]))),128)),e("button",{class:"my-3 btn-add-new",onClick:Sa},[Kd,q(" Add more parts ")])]),_:1})]),_:1},8,["modelValue"]),Jd,u(ce,{class:"task-group general-accordion py-1 px-5",modelValue:Y.value,"onUpdate:modelValue":r[8]||(r[8]=I=>Y.value=I)},{default:y(()=>[u(T,{title:"Labour Required",name:"Labour Required"},{default:y(()=>[Qd,(v(!0),p(_e,null,Pe(V.value,(I,L)=>(v(),p("div",{class:"row p-3 m-1 priority-container ps-0",key:I.position.value},[e("div",zd,[e("div",Xd,[u(dt,{modelValue:I.position.value,"onUpdate:modelValue":a=>I.position.value=a,filterable:"",onChange:a=>He(L),placeholder:"Choose Labour",class:"w-100"},{default:y(()=>[(v(!0),p(_e,null,Pe(f.positions,a=>(v(),me(ga,{key:a.value,label:a.label,value:a.label},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),I.position.isValid?$("",!0):(v(),p("div",Zd,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.position.errorMessage),1)]),_:2},1024)]))])]),e("div",ev,[e("div",av,[e("input",{pattern:"[0-9]*",inputmode:"numeric",class:"form-control",value:ee(nt)(I.qty.value),onKeypress:r[7]||(r[7]=(...a)=>ee(Gt)&&ee(Gt)(...a)),onInput:a=>aa(a,L)},null,40,tv),I.qty.isValid?$("",!0):(v(),p("div",lv,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.qty.errorMessage),1)]),_:2},1024)]))])]),e("div",sv,[e("div",ov,[e("input",{pattern:"[0-9]*",inputmode:"numeric",class:"form-control",onKeypress:pa,value:ee(nt)(I.hourEach.value),onInput:Ne(a=>va(a,L),["prevent"])},null,40,iv),I.hourEach.isValid?$("",!0):(v(),p("div",nv,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.hourEach.errorMessage),1)]),_:2},1024)]))])]),e("div",rv,[e("div",uv,[e("input",{class:"form-control",value:I.totalHour,disabled:""},null,8,cv)]),e("div",{class:Ca(["ms-4 d-flex align-items-center",L===0?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(a=>Ya(L),["prevent"])},null,8,dv)],2)])]))),128)),e("button",{class:"my-3 btn-add-new",onClick:ja},[vv,q(" Add more labour ")])]),_:1})]),_:1},8,["modelValue"]),mv,u(ce,{class:"task-group general-accordion py-1 px-5",modelValue:O.value,"onUpdate:modelValue":r[9]||(r[9]=I=>O.value=I)},{default:y(()=>[u(T,{title:"Other Resources Required (optional)",name:"Other Resources Required (optional)"},{default:y(()=>[(v(!0),p(_e,null,Pe(G.value,(I,L)=>(v(),p("div",{class:"p-2 d-flex",key:L},[e("div",fv,[e("input",{type:"text",class:"form-control",value:I.value,placeholder:`Resource${L+1}`,onChange:a=>rt(a,L)},null,40,pv),I.isValid?$("",!0):(v(),p("div",gv,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.errorMessage),1)]),_:2},1024)]))]),e("div",{class:Ca(["ms-4 d-flex align-items-center",L===0?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(a=>Ra(L),["prevent"])},null,8,hv)],2)]))),128)),e("button",{class:"my-3 btn-add-new",onClick:Ka},[yv,q(" Add new resource ")])]),_:1})]),_:1},8,["modelValue"]),bv,u(ce,{class:"task-group general-accordion py-1 px-5",modelValue:k.value,"onUpdate:modelValue":r[10]||(r[10]=I=>k.value=I)},{default:y(()=>[u(T,{title:"Defect Symptom",name:"Defect Symptom"},{default:y(()=>[(v(!0),p(_e,null,Pe(z.value,(I,L)=>(v(),p("div",{class:"p-2 d-flex",key:I.value},[e("div",_v,[u(dt,{modelValue:I.value,"onUpdate:modelValue":a=>I.value=a,placeholder:"Select Symptom",filterable:"",onChange:a=>Ja(a,L),class:"w-100"},{default:y(()=>[(v(!0),p(_e,null,Pe(f.symptomOptions,a=>(v(),me(ga,{key:a.id,label:a.symptom,value:a.symptom},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),I.isValid?$("",!0):(v(),p("div",kv,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.errorMessage),1)]),_:2},1024)])),I.value.includes("Other")?(v(),p("div",Dv,[u(ya,{value:X.value[L].value,label:"Description",name:"Description",errorMessage:"Required","is-valid":X.value[0].isValid,index:L,onHandleChange:Qa},null,8,["value","is-valid","index"])])):$("",!0),X.value[L].isValid?$("",!0):(v(),p("div",Cv,[u(h,{class:"error-label"},{default:y(()=>[q(K(X.value[L].errorMessage),1)]),_:2},1024)]))]),e("div",{class:Ca(["ms-4 d-flex align-items-center",L===0?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(a=>Na(L),["prevent"])},null,8,wv)],2)]))),128)),e("button",{class:"my-3 btn-add-new",onClick:Ne(ta,["prevent"])},[Vv,q(" Add another symptom ")])]),_:1})]),_:1},8,["modelValue"]),Mv,u(ce,{class:"task-group general-accordion py-1 px-5",modelValue:H.value,"onUpdate:modelValue":r[11]||(r[11]=I=>H.value=I)},{default:y(()=>[u(T,{title:"Defect Cause",name:"Defect Cause"},{default:y(()=>[(v(!0),p(_e,null,Pe(be.value,(I,L)=>(v(),p("div",{class:"p-2 d-flex",key:I.value},[e("div",Iv,[u(dt,{modelValue:I.value,"onUpdate:modelValue":a=>I.value=a,placeholder:"Select Cause",filterable:"",onChange:a=>Oe(a,L),class:"w-100"},{default:y(()=>[(v(!0),p(_e,null,Pe(f.causeOptions,a=>(v(),me(ga,{key:a.id,label:a.causes,value:a.causes},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),I.isValid?$("",!0):(v(),p("div",Sv,[u(h,{class:"error-label"},{default:y(()=>[q(K(I.errorMessage),1)]),_:2},1024)])),I.value.includes("Other")?(v(),p("div",xv,[u(ya,{value:ge.value[L].value,label:"Description",name:"Description",errorMessage:"Required","is-valid":ge.value[0].isValid,index:L,onHandleChange:_a},null,8,["value","is-valid","index"])])):$("",!0),ge.value[L].isValid?$("",!0):(v(),p("div",Ov,[u(h,{class:"error-label"},{default:y(()=>[q(K(ge.value[L].errorMessage),1)]),_:2},1024)]))]),e("div",{class:Ca(["ms-4 d-flex align-items-center",L===0?"hidden":""]),style:{height:"46px"}},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(a=>ct(L),["prevent"])},null,8,$v)],2)]))),128)),e("button",{class:"my-3 btn-add-new",onClick:Ze},[Rv,q(" Add another cause ")])]),_:1})]),_:1},8,["modelValue"]),e("div",Nv,[e("button",{class:"btn btn-success w-100",onClick:Ne(fa,["prevent"]),style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},"Submit")])]),u(ca,{visibility:re.value,caption:"Please confirm this defect information is correct.",onOnNoConfirm:at,onOnYesConfirm:Aa},null,8,["visibility"]),u(ca,{visibility:W.value,caption:"Are you sure want to close the defect form? <br /> Note: By closing the defect form, you will lose your defect data that you have already inputted.",onOnNoConfirm:lt,onOnYesConfirm:st},null,8,["visibility"])]}),_:1},8,["modelValue","custom-class"])}}}),Pv=_t(Av,[["__scopeId","data-v-1382e321"]]),Ua=f=>(yt("data-v-6a065d3a"),f=f(),bt(),f),Tv=Ua(()=>e("span",{class:"el-dialog__title"},"Detailed Information for Defect Identification",-1)),Ev=["innerHTML"],Uv={key:0,class:"d-flex flex-column justify-content-between"},Fv={class:"py-2 d-flex flex-row flex-grow-1"},qv={class:"flex-fill"},Bv={class:"form-floating"},Lv=Ua(()=>e("label",{for:"floatingInput"},"Task Description",-1)),Hv={class:"mt-2"},jv={class:"d-flex flex-row justify-content-between"},Yv={class:"py-2 d-flex flex-row flex-grow-1"},Gv={class:"flex-fill"},Wv={class:"form-floating"},Kv=["innerHTML"],Jv=Ua(()=>e("label",{for:"floatingInput"},"Asset Number",-1)),Qv={class:"flex-fill ps-3"},zv={class:"form-floating"},Xv=["innerHTML"],Zv=Ua(()=>e("label",{for:"floatingInput"},"Serial Number",-1)),em={class:"flex-fill ps-3"},am={class:"form-floating"},tm=["innerHTML"],lm=Ua(()=>e("label",{for:"floatingInput"},"Ownership",-1)),sm={class:"d-flex flex-row justify-content-between"},om={class:"mt-1 py-2"},im={class:"d-flex flex-column"},nm={class:"mt-1 py-2"},rm={class:"row",style:{width:"101%"}},um={class:"col-6 pe-0"},cm={class:"form-floating"},dm=["value"],vm=Ua(()=>e("label",null,"Raised By",-1)),mm={class:"col-6 pe-0"},fm={class:"form-floating"},pm=["value"],gm=Ua(()=>e("label",null,"Date Raised",-1)),hm=Ua(()=>e("div",{class:"mt-2"},null,-1)),ym={class:"d-flex flex-fill flex-column"},bm={class:"mt-2"},_m=["onClick"],km=Ua(()=>e("em",{class:"fa fa-plus me-2"},null,-1)),Dm=wa({__name:"DefectNoForm",props:{visibility:{type:Boolean,required:!0},assetNumber:{type:String,required:!0},task:{type:Object,required:!0},currentFitter:{type:Object,required:!0},defectImages:{type:Array,required:!0},reRender:{type:Boolean,default:!1},ownership:{type:String,default:""},serialNumber:{type:String,default:""},generic:{required:!1,type:Boolean,default:!1},generatedID:{required:!1,type:String,default:""}},emits:["onCameraClick","onImageDeleted","onSubmit","onCancel","onClose","OnSetFlagFromDeleteAction"],setup(f,{emit:fe}){const _=f,d=fe,c=o(!1),C=o("Repairs Completed"),b=o(!1),Y=Kt(_,"visibility"),O=o(Ce()),k=o({value:"",isValid:!0,errorMessage:""});o(!0);const H=o([{value:"",isValid:!0,errorMessage:""}]),W=o(!0),ye=o(),re=o(ht()),ke=o(!1),we=o(),ue=["images","description","actions"],F=o(),te=w(()=>({images:_.defectImages,description:k.value.value,actions:H.value})),de=w(()=>rl(ue,we.value,te.value)),pe=()=>{be()},D=o({isValid:!0,errorMessage:"",value:""}),ve=w(()=>"Defect Identified Description"),j=w(()=>cl(_.task)),A=P=>{W.value=!0,d("onCameraClick",P)},M=P=>{_.defectImages.length==1?(W.value=!1,d("OnSetFlagFromDeleteAction",!0),F.value.handleClickCamera(),F.value.handleHideModal()):d("onImageDeleted",P)},V=()=>{c.value=!1,W.value=!0,O.value=Ce(),k.value.value="",k.value.isValid=!0,k.value.errorMessage="",H.value=[{value:"",isValid:!0,errorMessage:""}]},G=P=>{k.value.value=P.value},z=()=>{let P=!0;return k.value.value===""?(k.value.isValid=!1,k.value.errorMessage="Required",P=!1):(k.value.isValid=!0,k.value.errorMessage=""),P},X=()=>_.defectImages.length>=1?(W.value=!0,!0):(W.value=!1,!1),be=()=>{let P=!0;return D.value.value==""?(D.value.isValid=!1,D.value.errorMessage="Required",P=!1):(D.value.isValid=!0,D.value.errorMessage=""),P},ge=P=>{let Se=!0;return P.value===""?(P.isValid=!1,P.errorMessage="Required",Se=!1):(P.isValid=!0,P.errorMessage=""),Se},qe=()=>{let P=!0;return H.value.forEach(Se=>{P=ge(Se)}),P},B=P=>{H.value[P.index].value=P.value,ge(H.value[P.index])},De=()=>{qe()&&H.value.push({value:"",isValid:!0,errorMessage:""})},ea=P=>{H.value.splice(P,1)},Te=()=>{let P=[];if(_.generic&&P.push(be()),P.push(X()),P.push(z()),P.push(qe()),!P.every(Be=>Be==!0)){dl("form-defect-no-intervention-form");return}b.value=!0},Ve=()=>{const P={};P.type="NO",P.assetNumber=_.assetNumber,P.raisedBy=_.currentFitter.name,P.date=O.value,P.description=k.value.value,P.actions=H.value.map(Se=>Se.value),_.generic?(P.taskDesc=D.value.value,P.taskNo=""):(P.taskDesc=_.task.description,P.taskNo=_.task.interventionSequence),d("onSubmit",P),c.value=!0,b.value=!1,D.value={isValid:!0,errorMessage:"",value:""}},Ke=()=>{b.value=!1},ra=async()=>{D.value={isValid:!0,errorMessage:"",value:""},d("onClose",c.value)},da=()=>{Wt(re.value),D.value={isValid:!0,errorMessage:"",value:""};try{V(),_.generic||Jt(ye.value)}catch(P){console.log(P)}we.value={images:U.cloneDeep(_.defectImages),description:U.cloneDeep(k.value.value),actions:U.cloneDeep(H.value)}},ba=()=>{de.value?ke.value=!0:d("onCancel")},Fa=()=>{ke.value=!1},Va=()=>{ke.value=!1,d("onCancel")},$e=w(()=>{const P=_.ownership;return ul(P)});return(P,Se)=>{const Be=ae("Label"),Ma=ae("el-collapse-item"),Je=ae("el-collapse"),Ae=ae("el-dialog");return v(),me(Ae,{modelValue:Y.value,"onUpdate:modelValue":Se[2]||(Se[2]=Ue=>Y.value=Ue),width:"90%",center:"",onClosed:ra,onOpened:da,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":ba,"custom-class":`el-defect-crack-form-custom form-defect-no-intervention-form ${re.value}`,"destroy-on-close":!0},{title:y(()=>[Tv,f.generic?$("",!0):(v(),p("span",{key:0,class:"el-dialog__title task-title",innerHTML:ee(Qt)(j.value,!0),ref_key:"defectDetailRef",ref:ye},null,8,Ev))]),default:y(()=>{var Ue,Ia,je;return[e("div",null,[f.generic?(v(),p("div",Uv,[e("div",Fv,[e("div",qv,[e("div",Bv,[We(e("input",{type:"text",class:"form-control","onUpdate:modelValue":Se[0]||(Se[0]=Qe=>D.value.value=Qe),onChange:pe},null,544),[[Rt,D.value.value]]),Lv]),e("div",Hv,[D.value.isValid?$("",!0):(v(),me(Be,{key:0,class:"error-label"},{default:y(()=>[q(K(D.value.errorMessage),1)]),_:1}))])])])])):$("",!0),e("div",jv,[e("div",Yv,[e("div",Gv,[e("div",Wv,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:f.assetNumber},null,8,Kv),Jv])]),e("div",Qv,[e("div",zv,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:f.serialNumber},null,8,Xv),Zv])]),e("div",em,[e("div",am,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:$e.value},null,8,tm),lm])])])]),e("div",sm,[u(nl,{ref_key:"defectCameraRef",ref:F,"re-render":f.reRender,task:f.task,"defect-images":f.defectImages,type:"defect",disabled:!1,"generated-i-d":f.generatedID,"allow-delete":!0,onOnCameraClicked:A,onOnImageDelete:M,"has-submitted":!W.value},null,8,["re-render","task","defect-images","generated-i-d","has-submitted"])]),W.value?$("",!0):(v(),me(Be,{key:1,class:"error-label"},{default:y(()=>[q("Required")]),_:1})),e("div",om,[e("div",im,[u(ya,{value:(Ue=k.value)==null?void 0:Ue.value,label:ve.value,name:"DefectPlaceholder",errorMessage:(Ia=k.value)==null?void 0:Ia.errorMessage,"is-valid":(je=k.value)==null?void 0:je.isValid,onHandleChange:G},null,8,["value","label","errorMessage","is-valid"])])]),e("div",nm,[e("div",rm,[e("div",um,[e("div",cm,[e("input",{type:"text",class:"form-control",disabled:"",value:f.currentFitter.name},null,8,dm),vm])]),e("div",mm,[e("div",fm,[e("input",{type:"text",class:"form-control",disabled:"",value:O.value},null,8,pm),gm])])])]),hm,u(Je,{class:"task-group general-accordion py-1 px-5",modelValue:C.value,"onUpdate:modelValue":Se[1]||(Se[1]=Qe=>C.value=Qe)},{default:y(()=>[u(Ma,{title:"Repairs Completed",name:"Repairs Completed"},{default:y(()=>[(v(!0),p(_e,null,Pe(H.value,(Qe,Le)=>(v(),p("div",{class:"p-2 d-flex",key:Le},[e("div",ym,[e("div",bm,[u(ya,{value:Qe.value,label:"Description of Repairs Completed",name:"DescriptionofRepairsCompleted",errorMessage:"Required","is-valid":Qe.isValid,index:Le,onHandleChange:B},null,8,["value","is-valid","index"])])]),e("div",{class:Ca(["ms-4 d-flex align-items-center",Le===0?"hidden":""])},[e("em",{class:"fa fa-times",style:{color:"gray",cursor:"pointer"},onClick:Ne(qa=>ea(Le),["prevent"])},null,8,_m)],2)]))),128)),e("button",{class:"my-3 btn-add-new",onClick:De},[km,q(" Add new repair action ")])]),_:1})]),_:1},8,["modelValue"]),e("div",{class:"my-5 w-100"},[e("button",{class:"btn btn-success w-100",onClick:Te,style:{background:"#18AF4A","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"}},"Submit")])]),u(ca,{visibility:b.value,caption:"Please confirm this defect information is correct.",onOnNoConfirm:Ke,onOnYesConfirm:Ve},null,8,["visibility"]),u(ca,{visibility:ke.value,caption:"Are you sure want to close the defect form? <br /> Note: By closing the defect form, you will lose your defect data that you have already inputted.",onOnNoConfirm:Fa,onOnYesConfirm:Va},null,8,["visibility"])]}),_:1},8,["modelValue","custom-class"])}}}),Cm=_t(Dm,[["__scopeId","data-v-6a065d3a"]]),wm=e("div",{class:"row text-center pt-3 pb-3 text-dark modal-title"},[e("h3",null,"Please take a photo")],-1),Vm={class:"row text-center pt-5"},Mm=wa({__name:"MandatoryPhotoPopUp",props:{visibility:{type:Boolean,required:!0}},emits:["onOk"],setup(f,{emit:fe}){const _=f,d=fe,c=ol(()=>_.visibility),C=()=>{d("onOk",null)};return(b,Y)=>{const O=ae("el-button"),k=ae("el-dialog");return v(),me(k,{modelValue:ee(c),"onUpdate:modelValue":Y[0]||(Y[0]=H=>il(c)?c.value=H:null),width:"40%","show-close":!1,"custom-class":"mandatory_photo_pop_up",top:"30vh",center:!0,"close-on-click-modal":!1,"close-on-press-escape":!1},{default:y(()=>[wm,e("div",Vm,[u(O,{type:"success",style:{"background-color":"#18AF4A"},onClick:C},{default:y(()=>[q("OK")]),_:1})])]),_:1},8,["modelValue"])}}}),Im=wa({__name:"AttachmentUploader",emits:["onDropAttachment","onFileDialogCancel"],setup(f,{expose:fe,emit:_}){const d=_,c=o(null),C=()=>{d("onFileDialogCancel")},b=async O=>{d("onDropAttachment",O)};return fe({handleAttachmentClicked:()=>{c.value&&c.value.openUploadDialog()}}),(O,k)=>(v(),me(mi,{ref_key:"singlePDFUploader",ref:c,"is-multiple":!1,"accepted-file":"application/pdf",onOnFileDropped:b,onOnFileCancelled:C},null,512))}}),Tl=f=>(yt("data-v-8537820d"),f=f(),bt(),f),Sm={class:"navbar navbar-light bg-light"},xm={class:"container-fluid"},Om={class:"d-flex"},$m={class:"me-2"},Rm={key:0,class:"row m-0 mt-25 p-5 bg-white e-form-container"},Nm={class:"row w-100 pe-0 header-form"},Am=Tl(()=>e("div",{class:"col-5"},[e("h4",{class:"title"},"Intervention Form")],-1)),Pm=["innerHTML"],Tm={key:2,class:"form-name"},Em={class:"p-2 flex-fill mt-6"},Um={class:"form-check checkbox-success"},Fm=["disabled"],qm=Tl(()=>e("label",{class:"fw-bolder",style:{color:"black !important","font-size":"15px"},for:"agreement"}," I have read and understood all safety precautions listed above ",-1)),Bm={key:0,class:"p-2 py-5 d-flex justify-content-end mt-20 border-top border-top-2"},Lm=["disabled"],Hm={key:1},jm={key:0,class:"p-2 py-5 d-flex justify-content-end mt-20 border-top border-top-2"},Ym=["disabled"],Gm={key:0,class:"row justify-content-end mt-3"},Wm={class:"col-3 col-sm-2 col-xl-1"},Km={class:"row justify-content-end"},Jm=["disabled"],Qm={key:0,class:"row justify-content-end"},zm={class:"col-3 col-sm-2 col-xl-1"},Xm={class:"row justify-content-end"},Zm=["disabled"],ef=wa({__name:"Index",setup(f){const fe=wi(),_=hi(),d=yi(),c=bi(),C=Fo(),b=ki(),Y=Vi(),O=Di(),k=Ci(),H=Mi(),W=o({SMU:""}),ye=o(!1),re=o(""),ke=o(""),we=o(!1),ue=o(!1),F=o(!1),te=o(!1),de=o(!1),pe=o(!1),D=o(!1),ve=o(""),j=o(),A=o(!1),M=o([]),V=o(""),G=o(!1),z=o(!1),X=o(!1),be=o(),ge=o(!1),qe=o(!1),B=o(""),De=o(!1),ea=o(!1),Te=o({}),Ve=o(!1),Ke=Si.SMU_REVISE,ra=o({}),da=o({}),ba=o(!1),Fa=o({}),Va=o({}),$e=o(),P=o(!1),Se=o(!1),Be=o(!1),Ma=o(!1),Je=o(!1),Ae=o(),Ue=o(),Ia=o([]),je=o(),Qe=o(),Le=o(!1),qa=o(!1),Ba=o(!1),La=o(!1),Sa=o(!1),xa=o(!1),Oa=o([]),aa=o(""),Ha=o(""),va=o(""),ma=o(""),Fe=o(""),ze=o(!1),He=o(!0),ja=o(!1),Ya=o(""),rt=o(!1),ut=o(!1),Ga=o(!1),$a=o(!1),Wa=o(!1),Ka=o(!1),Ra=o(!1),Ja=o(""),Qa=o(),za=o(""),Xa=o("Not-Confirm"),Xe=o(),ta=o(""),Na=o(!1),Oe=o(),_a=o(!1),la=o(""),Za=o(""),sa=o(""),Ze=o(""),ct=o(),fa=o(),oa=o(""),et=o(""),Aa=o(""),at=o(!1),tt=o(!1),ka=o(),Me=o(!1),ia=o(""),pa=o(!1),na=o(""),lt=o();let st=!1;const Dt=o(""),Ct=o(""),Da=o(!1),l=o(),r=o(!1),h=o("00:00:00"),T=o(),ce=o(!1),ga=t=>{h.value=t},dt=t=>{h.value=t},mt=t=>{h.value=t,r.value=!0},Pa=()=>{r.value=!1},I=async()=>{r.value=!1;const t=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{const s={};s.id=m.value.id,s.key=m.value.key,s.employee={id:O.user.EmployeeId,name:O.user.Name},s.status="On Progress",await _.UpdateServiceEndMechanic(s),te.value=!0}catch(s){console.log("error filtering service personnel on closing eform",s)}t.close()},L=o(),a=o(),n=o(""),g=w(()=>k.IsVisible),R=w(()=>k.CurrentType),le=w(()=>_.SelectedWorkOrder),Ta=w(()=>_.SelectedShortWO),wt=w(()=>_.IsBusy),m=w(()=>c.Intervention),he=w(()=>_.Log),Nt=w(()=>{const t=he.value;return t&&t.employee?t.employee.name:""}),Ye=w(()=>_.GeneralSubmitted),At=w(()=>U.orderBy(Y.Fitters,["label"])),S=w(()=>c.Groups),Z=w(()=>{const t=d.defectIdentifiedData;let s=0;return Object.keys(t).forEach(i=>{Array.isArray(t[i])&&(s+=t[i].length)}),s}),E=w(()=>c.Group),se=w(()=>c.Task),vl=w(()=>c.TaskProgress),Vt=w(()=>!Ye.value||vl.value.filter(t=>t.taskDone!=t.taskTotal).length>0?!0:!c.IsFilledAllRequiredItem),El=w(()=>{var x,N,oe,Ge,Ee,Re;const t=ti(m.value.interventionExecution,c.percentageTaskProgressAllTab),s=`${(x=m.value)==null?void 0:x.equipment} <span class="${((oe=(N=m.value)==null?void 0:N.sampleStatus)==null?void 0:oe.toLowerCase())=="caution"?"yellow":((Ee=(Ge=m.value)==null?void 0:Ge.sampleStatus)==null?void 0:Ee.toLowerCase())=="normal"?"green":"red"}">${(Re=m.value)==null?void 0:Re.sampleStatus}</span>`;return`<span>${`<span class='status-badge p-1 ${li(t)}'>${t}</span>`} ${s}</span>`}),Ul=w(()=>{const t=W.value.SMU=="",s=!U.isEmpty(he.value.employee),i=re.value!="",x=ye.value,N=ml.value.length>1;return!(t&&s&&i&&x&&N)}),Mt=w(()=>se.value?Me.value?Fe.value==""?b.DefectImages[ia.value]||[]:b.DefectImages[Fe.value]||[]:b.DefectImages[se.value.key]:[]),Fl=w(()=>{var t,s;return!!(W.value.SMU!=""||U.isEmpty(he.value)||re.value==""||ye.value||(t=ka.value)!=null&&t.riskPhotos&&((s=ka.value)==null?void 0:s.riskPhotos.length)==2)}),ql=w(()=>c.LoadingTask),Pt=w(()=>c.RiskAssessmentImages),ml=w(()=>{var s;return(s=he.value)!=null&&s.employee?Pt.value.filter(i=>i.updatedBy.id==he.value.employee.id):[]}),Bl=w(()=>c.ItemTriggerDisabledValue),Ll=w(()=>d.defectIdentifiedData??new _i),Hl=w(()=>d.defectIdentifiedCommentData),jl=w(()=>c.taskErrorDialog),Yl=w(()=>c.errorMessageTaskErrorDialog),Gl=w(()=>c.formSubmittedDialog),Wl=w(()=>c.formCloseDialog),fl=w(()=>m.value.interventionExecution=="Submited"),Tt=w(()=>!ua()),Kl=w(()=>fl.value),zt=w(()=>_.smuTolerance),Et=w(()=>{const t=m.value.smuDue,s=zt.value;return Number(Number(t)+Number(s.min))}),Ut=w(()=>{const t=m.value.smuDue,s=zt.value;return Number(Number(t)+Number(s.max))});w(()=>Et.value-Number(m.value.hmOffset)),w(()=>Ut.value-Number(m.value.hmOffset));const Jl=async t=>{const s={};s.id=m.value.id,s.status=m.value.interventionExecution,s.key=m.value.key,s.value=t.newDetail.machineSMU,s.employee={id:O.user.EmployeeId,name:O.user.Name};const i=!t.newDetail.title.toLowerCase().includes("not");s.isInRange=i,U.isEmpty(ra.value)||await _.updateEquipmentImage(ra.value),Te.value=s,await It(),d.setDefectIdentifiedData(m.value.sapWorkOrder),t.callback()},Ql=()=>{ot({type:Ke,key:"value"})},zl=t=>{Oa.value=t},Xl=()=>{_a.value=!0},pl=()=>{_a.value=!1},gl=t=>{la.value=t,_a.value=!1},Ft=()=>{k.setCameraVisible(!1),k.setShowCloseButton(!0),k.setCurrentType(""),de.value=!1,ve.value="",j.value=void 0,V.value=""},Zl=()=>{ja.value=!1,k.setCameraVisible(!0)},ot=t=>{(t.type=="defect"&&Mt.value.length==0||t.type=="value")&&(He.value=!1),k.setCameraVisible(!0),k.setCurrentType(t.type),V.value=t.key},hl=t=>{He.value=!0,c.setSelectedTask(t.task),$e.value=t,$e.value.headerId=m.value.id,$e.value.id=m.value.id,t.type=="cbmAdjustment"?(V.value=t.itemKey,b.initCBMImages(V.value,t.value)):(V.value=se.value.key,b.initCBMImages(V.value,se.value.images)),k.setCurrentType(t.type?t.type:"cbm"),k.setCameraVisible(!0)},es=async t=>{var s;pa.value=!1,c.setSelectedTask(t.task.task),$e.value=t.task,$e.value.headerId=m.value.id,$e.value.id=m.value.id,((s=t.task.task.images)==null?void 0:s.length)==1?(pa.value=!0,hl(t.task)):(t.task.type=="cbmAdjustment"&&se.value.adjustment?(V.value=t.task.itemKey,b.initCBMImages(V.value,se.value.adjustment.pictures)):(V.value=se.value.key,b.initCBMImages(V.value,se.value.images)),await b.deleteCBMImage(V.value,t.filename),await b.submitCBMImageData($e.value))},as=()=>{V.value=se.value.key,z.value=!1,X.value&&se.value.adjustment?(b.initCBMImages(se.value.adjustment.key,se.value.adjustment.pictures),k.setCurrentType("cbmAdjustment"),X.value=!1):(b.initCBMImages(V.value,se.value.images),k.setCurrentType("cbm")),He.value=!1,k.setCameraVisible(!0)},ts=t=>{Na.value=t},ls=()=>{k.setCameraVisible(!1),setTimeout(()=>{k.setCameraVisible(!0)},100)},ss=()=>{k.setCameraVisible(!1),He.value=!0,Na.value=!1,pa.value=!1,Ft()},os=(t,s=!1)=>{k.setCameraVisible(!1),Na.value=!1,He.value=!0,Ft(),s&&(Pt.value.filter(x=>x.updatedBy.id==he.value.employee.id).length>1?(rt.value=!0,setTimeout(()=>{var x;(x=ka.value)==null||x.reRender(),rt.value=!1},1e3)):(et.value="Take <strong>back page</strong> photo of your completed pre-task risk assessment.",He.value=!1,F.value=!0))},is=t=>{j.value=t;const s=URL.createObjectURL(t);de.value=!0,ve.value=s},ns=async t=>{if(M.value=[],t.length<1)return;const s=xe.service({lock:!0,text:"Uploading",background:"rgba(0, 0, 0, 0.7)"});let i=!0;if(["image/gif","image/jpeg","image/png"].includes(t[0].type)||(i=!1,M.value.push(t[0].name)),!i)M.value.length>0&&(k.setCameraVisible(!1),A.value=!0,s.close());else{j.value=t[0],n.value=t[0].name;const N=URL.createObjectURL(t[0]);de.value=!0,ve.value=N,s.close()}},rs=async(t,s)=>{const i=xe.service({lock:!0,text:"Uploading Picture",background:"rgba(0, 0, 0, 0.7)"});let x=tl(15);t&&(la.value=encodeURI(t));const N={filename:x,description:la.value,originalFilename:n.value};let oe=s;try{const Re=await si(oe);oe=new File([Re.file],`${x}.webp`)}catch(Re){console.error(Re.message)}if(await cs([N],[oe]),la.value="",["cbm","cbmAdjustment"].includes(R.value))de.value=!1,k.setCameraVisible(!1),He.value=!0,ja.value=!0;else{const Re=R.value=="value";os(!0,Re)}i.close(),pa.value=!1},Xt=t=>{pa.value=t},yl=t=>{H.setCurrentKey(t.key),H.setMode(t.mode),na.value="PDF",lt.value.handleAttachmentClicked()},us=async t=>{M.value=[];const s=xe.service({lock:!0,text:"Uploading",background:"rgba(0, 0, 0, 0.7)"});let i=!0;const x=["application/pdf"];if((t[0].size>2097152||!x.includes(t[0].type))&&(i=!1,M.value.push(t[0].name)),!i)M.value.length>0&&(A.value=!0);else{const N=new Blob([t[0]],{type:"application/pdf"});let oe=tl(15);const Ge=new FormData;Ge.append("files",N,encodeURI(`${oe}.pdf`)),Ge.append("userAccount",O.user.Email);let Ee;Ee=await jt.pendingTaskFile.add({module:"Intervention",key:se.value.key,workorder:m.value.sapWorkOrder,type:"defect",fileType:"pdf",createdBy:_.ActiveFitter.id,email:O.user.Email,filename:oe,originalFilename:oe,blob:N,syncDate:Zo(),syncStatus:"Pending"}),ua()||(Ee=await H.uploadAttachment(Ge,O.user.Email)),Promise.all([Ee]).then(Re=>{(typeof Re[0]=="string"&&!ua()||ua())&&(H.mode=="edit"?a.value.handlePartAttachment(H.currentKey,{filename:t[0].name,url:oe}):L.value.handlePartAttachment(H.currentKey,{filename:t[0].name,url:oe}),na.value="")})}s.close()},cs=async(t,s)=>{const i={};i.id=m.value.id,Me.value&&Fe.value!=""?i.key=Fe.value:i.key=V.value,i.type=R.value,i.employee=he.value.employee,i.files=t,i.blobs=s,i.submitDate=Ce(),i.email=O.user.Email;let x={};if(R.value=="cbm"?(x=U.cloneDeep($e.value),x.type="images"):R.value=="cbmAdjustment"&&(x=U.cloneDeep($e.value),x.type="images",x.taskCategory="Adjustment",i.key=x.itemKey),x.workOrder=m.value.sapWorkOrder,at.value=ml.value.length>0,pa.value)switch(R.value){case"cbmAdjustment":case"cbm":await b.defineNewCBMImages(i),await b.submitCBMImageData(x);break;case"defect":await b.defineNewDefectImages(i);break}else try{switch(R.value){case"imageEquipment":k.setShowCloseButton(!0),await _.updateEquipmentImage(i),De.value=!0,setTimeout(()=>{De.value=!1},2e3),U.isEmpty(Te.value)?await It(!0):await It();break;case"value":await _.updateRiskAssesmentImage(i,at.value);break;case"defect":await b.addNewDefectImages(i);break;case"parts":i.taskKey=se.value.key,await b.addNewPartImages(i),await L.value.handlePartImage(i.key,i.files),na.value="";break;case"parts-edit":i.taskKey=se.value.key,await b.addNewPartImages(i),await a.value.handlePartImage(i.key,i.files),na.value="";break;case"cbmAdjustment":case"cbm":await b.addNewCBMImages(i),await b.submitCBMImageData(x);break;case Ke:i.key=m.value.key,i.type="imageEquipment",ra.value={...i},da.value={Id:Ke,ImageBlobs:s,ImageInfos:t},na.value="";break}}catch(N){console.log(N)}},ds=async t=>{if(m.value.imageEquipment&&m.value.imageEquipment.length==1)be.value.onCameraClicked(),be.value.onCloseImagePreview();else{const s=xe.service({lock:!0,text:"Uploading Picture",background:"rgba(0, 0, 0, 0.7)"});await c.deleteImageFromEquipmentImage(t),s.close()}},vs=async t=>{const s=xe.service({lock:!0,text:"Deleting image",background:"rgba(0, 0, 0, 0.7)"}),i={};i.id=m.value.id,i.key=m.value.riskAssesment[0].key,i.employee=he.value.employee,i.submitDate=Ce(),i.filename=t,await _.deleteRiskAssesmentImage(i),s.close(),He.value=!1,na.value="image",ot({type:"value",key:m.value.riskAssesment[0].key})},Zt=async t=>{const s=xe.service({lock:!0,text:"Uploading Picture",background:"rgba(0, 0, 0, 0.7)"});Me.value?Fe.value!=""?await b.deleteDefectImage(Fe.value,t):await b.deleteDefectImage(ia.value,t):await b.deleteDefectImage(se.value.key,t),s.close()},bl=async t=>{await b.deletePartImage(t)},ms=t=>{t&&(Me.value?b.setExistingDefectImages(Fe.value,JSON.parse(t)):b.setExistingDefectImages(se.value.key,JSON.parse(t)))},vt=async t=>{t.index==0&&(ze.value=!1);const s=t.image,i={};i.id=m.value.id,s.type=="imageEquipment"?i.key=m.value.key:s.type=="value"?i.key=m.value.riskAssesment[0].key:i.key=V.value,i.type=s.type,i.employee={id:O.user.EmployeeId,name:O.user.Name};const x=sl([s.filename]);i.files=x,i.blobs=[s.blob],i.submitDate=Ce(),await _.storeImageLocal(i),t.index==t.length-1&&(ze.value=!0)},fs=()=>{de.value=!1,ve.value="",la.value=""},ps=()=>{$a.value=!0},gs=()=>{const t=xe.service({lock:!0,text:"Scrolling to unfilled task",background:"rgba(0, 0, 0, 0.7)"});Ga.value=!Ga.value,ni("task-required",500),t.close()},hs=async t=>{c.setSelectedGroup(t);const s=await jt.pendingTask.where({workorder:c.Intervention.sapWorkOrder,module:"Intervention"}).toArray();t.group=="Identified Defects"&&(ua()||s)&&await d.getCommentFromServiceSheet(c.Intervention.sapWorkOrder)},ys=async t=>{if(Ka.value=!1,_.SMUToleranceNotMapped){W.value.SMU="SMU tolerance not yet mapped",ea.value=!0;return}let s=null;const i=async()=>{const N={};N.id=m.value.id,N.status=m.value.interventionExecution,N.key=m.value.key,N.value=re.value,N.employee={id:O.user.EmployeeId,name:O.user.Name},N.isInRange=!0,N.submitDate=Ce(),m.value.imageEquipment.length>0?(Te.value=N,await It()):(qe.value=!0,Te.value=N)};if(ua()){const x=Ie(t);if(x[x.length-1]=="."){W.value.SMU="Invalid format";return}W.value.SMU="",re.value=Ie(t),await i()}else{s=xe.service({lock:!0,text:"Check SMU Value",background:"rgba(0, 0, 0, 0.7)"});try{const N=await _.getExisitingSMU({id:c.Intervention.id,key:c.Intervention.key,propertyName:"interventionSMU"});if(N){Ka.value=!0,t=N,s.close();return}}catch{}const x=Ie(t);if(x[x.length-1]=="."){W.value.SMU="Invalid format",s.close();return}W.value.SMU="",re.value=Ie(t),await i(),s.close()}},bs=()=>{qe.value=!1;const t={};t.type="imageEquipment",t.key=m.value.key,k.setShowCloseButton(!1),He.value=!1,ot(t)},_s=()=>{ge.value=!1,be.value.resetInputSMU()},It=async(t=!1)=>{if(t){if(await b.checkDataInterventionSMU()){const i={};i.id=m.value.id,i.status=m.value.interventionExecution,i.key=m.value.key,i.value=m.value.interventionSMU,i.employee={id:O.user.EmployeeId,name:O.user.Name},i.submitDate=Ce(),i.detail={isInRange:!0,range:{minRange:Et.value,maxRange:Ut.value},serialNumber:Ze.value},i.idGenerated=ht(),b.createDefectSMU(i)}}else{const s={};s.id=m.value.id,s.status=m.value.interventionExecution,s.key=m.value.key,s.value=Te.value.value,s.employee={id:O.user.EmployeeId,name:O.user.Name},s.submitDate=Ce(),Te.value.submitDate=s.submitDate,await _.updateSMU(U.omit(Te.value,["isInRange"])),s.detail={isInRange:Te.value.isInRange,range:{minRange:Et.value,maxRange:Ut.value},serialNumber:Ze.value},s.idGenerated=ht(),b.createDefectSMU(s),Te.value={}}},ks=async()=>{ge.value=!1,m.value.imageEquipment.length>0?(It(),await c.getCountIdentifiedDefect()):qe.value=!0},Ds=()=>{Ka.value=!1},Cs=t=>{var oe;const s=(oe=m.value.log)==null?void 0:oe.find(Ge=>Ge.employee.id==t.option.value),i={};i.employee={id:t.option.value,name:t.option.label};const x=ei("+10.00");i.shift=x,i.timeLoggedIn=Ce(),i.riskPhotos=s?sl(s.riskPhotos):[],i.isIHaveReadChecked=s==null?void 0:s.isIHaveReadChecked;const N={};N.key=tl(10),N.mechanic=i.employee,N.shift=x,N.serviceStart=Ce(),N.serviceEnd="",_.setServicePersonnel(N),_.setLog(i),ke.value=t.serviceStart,ye.value=i.isIHaveReadChecked,ce.value=!0,T.value.timer.reset(),T.value.startTimer()},ws=()=>{He.value=!1,Pt.value.filter(s=>s.updatedBy.id==he.value.employee.id).length==0?et.value="Take <strong>front page</strong> photo of your completed pre-task risk assessment.":(et.value="Take <strong>back page</strong> photo of your completed pre-task risk assessment.",at.value=!0),F.value=!0},Vs=async()=>{if(m.value.interventionExecution!="Submited"){const t=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),s={};s.id=m.value.id,s.key=m.value.key,s.employee={id:O.user.EmployeeId,name:O.user.Name},s.submitDate=Ce(),s.serviceStart=ke.value,s.status="On Progress",s.smu=re.value,s.log={},s.log.employee=he.value.employee,s.log.timeLoggedIn=ke.value,s.log.isIHaveReadChecked=!0,s.log.shift="Day Shift",s.log.riskPhotos=[],s.history={},s.history.status="On Progress",s.history.updatedBy=he.value.employee,s.history.updatedDate=s.submitDate,s.history.tsUpdatedDate=Vl();try{await _.submitGeneral(s),c.setSelectedGroup(S.value[1]),window.scrollTo({top:0,behavior:"smooth"})}catch{t.close()}t.close()}else{const t=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});_.setInterventionGeneralSubmited(!0),c.setSelectedGroup(S.value[1]),window.scrollTo({top:0,behavior:"smooth"}),t.close()}},Ms=async()=>{const t={};t.id=m.value.id,t.employee={id:O.user.EmployeeId,name:O.user.Name},t.serviceEnd=Ce(),t.status="Submited",t.history={},t.history.status="Submited",t.history.updatedBy=he.value.employee,t.history.updatedDate=t.serviceEnd,t.history.tsUpdatedDate=Vl(),t.additionalInformation=Aa.value;try{await _.submitForm(t),G.value=!1}catch{G.value=!0}},el=async()=>{await c.checIsReadySubmitInterventionData()?we.value=!0:c.toogleFormSubmittedDialog(!0)},Is=()=>{tt.value=!1},Ss=()=>{tt.value=!1,al(fa.value,!0)},al=async(t,s=!1)=>{var x,N,oe,Ge,Ee,Re,Lt;Dt.value="";const i=t.data;if(Ct.value=i.itemKey,c.setSelectedTask(i.task),i.model=m.value.equipmentModel,$e.value=i,Me.value=!1,s||(oa.value=""),m.value.interventionExecution=="On Progress"){const Mo=["NORMAL","CBM"],Io=oi(t.data.task.updatedBy||"",he.value.employee);if(Mo.includes(i.taskCategory)&&i.type=="condition"){const ie=i.task.taskValue;if(ie!=i.value)if(ie=="4"&&!s&&!Io){const ne=await C.getNADetail(i.task.key,m.value.trInterventionHeaderId,m.value.sapWorkOrder);ne&&(Ae.value=JSON.parse(ne.defectData)),ct.value=i,fa.value=t,Ra.value=!0}else if(ie=="3"&&!s)fa.value=t,tt.value=!0;else switch(i.value){case"1":case"2":if(await c.updateTask(i),i.task.rating=="AUTOMATIC_REPLACEMENT"||i.task.rating=="AUTOMATIC_REPLACEMENT_GAP"){const ne=await c.getReplacementDefaultValueByTask(i.task);_l(ne,i.task.key)}b.deleteLocalDefect({interventionId:m.value.id,taskId:i.task.key});break;case"3":Le.value=!0;break;case"4":qa.value=!0;break}}else if(["CBM","CBM-NORMAL"].includes(i.taskCategory)&&i.type=="rating"){l.value||(l.value=xe.service({lock:!0,text:"Updating...",background:"rgba(0, 0, 0, 0.7)"}));try{switch(i.value){case"":case"A":case"B":await c.updateTask(i),c.IsError||await b.updateLocalDefect(St(i)),await c.getCountIdentifiedDefect(),i.task.images==""&&i.task.rating!="AUTOMATIC"&&i.task.rating!="AUTOMATIC_REPLACEMENT"&&i.task.rating!="AUTOMATIC_REPLACEMENT_GAP"&&(z.value=!0);break;case"C":case"X":await b.submitDefectCBM(St(i));try{await c.getCountIdentifiedDefect(),ua()||await c.updateFormDataFromServer(),i.task.images==""&&i.task.rating!="AUTOMATIC"&&i.task.rating!="AUTOMATIC_REPLACEMENT"&&i.task.rating!="AUTOMATIC_REPLACEMENT_GAP"&&(z.value=!0)}catch(ie){console.log(ie)}break;case"In spec":case"Out of spec":await c.updateTask(i),await c.getCountIdentifiedDefect()}}catch(ie){console.log(ie)}finally{(x=l.value)==null||x.close(),l.value=void 0}}else if(i.taskCategory=="CBM"&&i.type=="inputUom"){l.value=xe.service({lock:!0,text:"Updating...",background:"rgba(0, 0, 0, 0.7)"});const ie=U.cloneDeep(i),ne=await b.getCBMResult(i);if(ne.rating||(ie.value=""),await c.updateTask(ie),c.IsError&&((N=l.value)==null||N.close(),l.value=void 0,t.helper()),t.asyncfunction(),!ne.rating){(oe=l.value)==null||oe.close(),l.value=void 0;let ha=!0;(i.task.rating=="AUTOMATIC_REPLACEMENT"||i.task.rating=="AUTOMATIC_REPLACEMENT_GAP")&&((Ge=i.task.items[7])==null?void 0:Ge.value)=="4"&&(ha=!1),!ne.isError&&ha&&(Da.value=!0),setTimeout(()=>{var Ea;(Ea=ka.value)==null||Ea.reRender(),Da.value=!1},2e3)}if(ne.isError){(Ee=l.value)==null||Ee.close(),l.value=void 0,xa.value=!0;return}await c.updateLocalAutoCBM(ne.task),(Re=l.value)==null||Re.close(),l.value=void 0}else if(i.taskCategory=="CBM-NORMAL"&&i.type=="inputUom"){if(l.value=xe.service({lock:!0,text:"Updating...",background:"rgba(0, 0, 0, 0.7)"}),await c.updateTask(i),i.task.taskValue&&["C","X"].includes(i.task.taskValue)){const ie=U.cloneDeep(i),ne=U.find(i.task.items,{valueItemType:"rating"});if(ne){const ha=U.findIndex(i.task.items,{valueItemType:"inputUom"});ie.cbmMeasurement=i.value,ie.uomValue=i.task.items[ha+1].value,ie.type=ne.valueItemType,ie.itemKey=ne.key,ie.value=ne.value;const Ea=St(ie);Ea.task.itemKey=ne.key,Ea.task.type=ne.valueItemType,Ea.task.value=ne.value,Ea.task.uomValue=i.task.items[ha+1].value,await b.submitDefectCBM(Ea)}}(Lt=l.value)==null||Lt.close(),l.value=void 0}else if(i.taskCategory=="Adjustment"&&i.type=="inputUom"){if(i.value){t.helper.setLoadingMeasurement(!0);const ie=U.cloneDeep(i),ne=await b.getCBMResult(i,!0);if(!ne.isError&&!ne.rating&&(ie.isOutOfRange=!0,ie.value=""),await c.updateTask(ie),c.IsError){t.helper.setLoadingMeasurement(!1);return}if(t.helper.setLoadingMeasurement(!1),t.asyncfunction(),t.helper.setLoadingRating(!0),!ne.isError&&!ne.rating&&(Da.value=!0,setTimeout(()=>{Da.value=!1},2e3)),ne.isError){xa.value=!0;return}const ha=i;switch(ha.value=ne.rating,ha.type="rating",X.value=!0,ne.rating){case"":case"A":case"B":case"C":case"X":try{t.helper.setLoadingRating(!0),await b.submitDefectCBM(St(i)),t.helper.setLoadingRating(!1),ua()||await c.updateFormDataFromServer()}catch{t.helper.setLoadingRating(!1);return}break}}}else if(i.taskCategory=="Adjustment"&&i.type=="reset"){const ie={...i};se.value.items.every(ha=>ha.valueItemType=="rating"?(ie.value=ha.value,!1):!0);const ne=St(ie);switch(ne.task.value=ie.value,i.value){case"A":case"B":case"C":case"X":await b.resetDefectCBMAdjustment(ne),await c.updateTask(ie,!1,!0);break}ie.type="images",b.resetCBMImages(ie.itemKey,m.value.sapWorkOrder).then(()=>{b.submitCBMImageData(ie)}),t.asyncfunction()}else i.taskCategory=="Adjustment"&&i.type=="commentValue"?(t.helper.setLoadingComment(!0),await c.updateTask(i),t.helper.setLoadingComment(!1)):await c.updateTask(i);d.setDefectIdentifiedData(m.value.sapWorkOrder)}else c.toogleFormSubmittedDialog(!0)},St=t=>{const s={};return s.cbmMeasurement=t.cbmMeasurement,s.uomValue=t.uomValue,s.taskDesc=se.value.description,s.taskNo=se.value.interventionSequence,s.submitDate=Ce(),s.task=$e.value,s.task.headerId=m.value.id,s.task.id=m.value.id,t.correctedMeasurement&&(s.correctedMeasurement=t.correctedMeasurement),t.correctedValue&&(s.correctedValue=t.correctedValue),t.correctedUom&&(s.correctedUom=t.correctedUom),s},xs=async t=>{await C.submitNA(t)},Os=async()=>{const t=xe.service({lock:!0,text:"Submitting Intervention Form",background:"rgba(0, 0, 0, 0.7)"});we.value=!1,await Ms(),await c.getCountIdentifiedDefect(),_.reset(),t.close(),ua()?ue.value=!0:te.value=!0},$s=async()=>{G.value||(ue.value=!1,fe.push({name:"ironforms"}))},Rs=()=>{te.value=!1,fe.push({name:"ironforms"})},Ns=()=>{st=!1,b.initDefectImages(se.value.key),Oa.value.length<1?Ps():(Oa.value.includes("Does the defect identified require > 30 minutes in labour to repair?")&&(st=!0),As()),Oa.value=[]},As=()=>{Le.value=!1,Ba.value=!0},Ps=()=>{Le.value=!1,La.value=!0},Ts=()=>{Le.value=!1},xt=async t=>{t||await b.resetDefectImages(se.value.key,m.value.sapWorkOrder),ia.value="",Ba.value=!1},Es=()=>{xt(!1)},Us=async t=>{const s=xe.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});Me.value?(t.task={taskKey:"",taskCategory:"NORMAL",itemKey:"",type:"YES",value:"",defectType:"Generic",timeStamp:Ce(),model:m.value.equipmentModel,headerId:m.value.id,id:m.value.id,supervisor:{id:O.user.EmployeeId,name:O.user.Name},employee:he.value.employee,task:{}},t.submitDate=Ce(),t.idGenerated=ia.value,await b.submitDefectYes(t,!0)||(await c.getCountIdentifiedDefect(),xt(!0),aa.value="Defect Information Successfully Submitted",pe.value=!0),s.close()):(t.task=$e.value,oa.value&&(t.reason=oa.value),oa.value="",t.task.headerId=m.value.id,t.task.id=m.value.id,t.task.supervisor={id:O.user.EmployeeId,name:O.user.Name},t.submitDate=Ce(),await b.submitDefectYes(t,!1)||(await c.getCountIdentifiedDefect(),s.close(),xt(!0),aa.value="Defect Information Successfully Submitted",pe.value=!0),s.close()),Me.value=!1},Fs=async t=>{t.task.headerId=m.value.id,t.task.id=m.value.id,t.task.supervisor={id:O.user.EmployeeId,name:O.user.Name},t.submitDate=Ce(),Me.value&&(t.defectHeaderId=Fe.value);try{await b.updateDefectDetail(t,Me.value),await d.setDefectIdentifiedData(m.value.sapWorkOrder),Je.value=!1,aa.value="Defect Information Successfully Submitted",pe.value=!0}catch(s){ua()||s&&(ut.value=!0,Za.value=s.response.data.result.message,setTimeout(async()=>{ut.value=!1,Za.value="",Je.value=!1,_.setBusyState(!0),await d.getDefectsData(m.value.id,m.value.sapWorkOrder),await d.setDefectIdentifiedData(m.value.sapWorkOrder),_.setBusyState(!1)},2e3))}},qs=()=>{A.value=!1,na.value=="PDF"?lt.value.handleAttachmentClicked():k.setCameraVisible(!0)},Ot=async t=>{t||await b.resetDefectImages(se.value.key,m.value.sapWorkOrder),La.value=!1,oa.value=""},Bs=()=>{Ot(!1)},Ls=async t=>{const s=xe.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});oa.value&&(t.reason=oa.value),oa.value="",Me.value?(t.task={taskKey:"",taskCategory:"NORMAL",itemKey:"",type:"NO",value:"",defectType:"Generic",timeStamp:"06/09/23 19:36:51 (AEST)",model:m.value.equipmentModel,headerId:m.value.id,id:m.value.id,supervisor:{id:O.user.EmployeeId,name:O.user.Name},employee:he.value.employee,task:{}},t.submitDate=Ce(),t.idGenerated=ia.value,await b.submitDefectNo(t,!0)||(await c.getCountIdentifiedDefect(),Ot(!0),aa.value="Defect Information Successfully Submitted",pe.value=!0),s.close()):(t.task=$e.value,t.task.headerId=m.value.id,t.task.id=m.value.id,t.task.supervisor={id:O.user.EmployeeId,name:O.user.Name},t.submitDate=Ce(),await b.submitDefectNo(t,!1)||(await c.getCountIdentifiedDefect(),s.close(),Ot(!0),aa.value="Defect Information Successfully Submitted",pe.value=!0),s.close()),Me.value=!1},qt=()=>{qa.value=!1},Hs=()=>{qt()},js=async t=>{const s=xe.service({lock:!0,text:"Processing...",background:"rgba(0, 0, 0, 0.7)"});t.task=$e.value,t.task.headerId=m.value.id,t.task.id=m.value.id,t.task.supervisor={id:O.user.EmployeeId,name:O.user.Name},t.submitDate=Ce(),await C.submitNA(t)||(await c.getCountIdentifiedDefect(),s.close(),qt(),aa.value="Data successfully submitted",D.value=!0,setTimeout(()=>{to()},2e3),(t.task.task.rating=="AUTOMATIC_REPLACEMENT"||t.task.task.rating=="AUTOMATIC_REPLACEMENT_GAP")&&_l("",t.task.task.key)),s.close()},_l=(t,s)=>{for(const i of S.value)if(i.group=="Intervention Checks"){for(const x of i.sections)for(const N of x.tasks)if(N.key==s){for(const oe of N.items)if(oe.categoryItemType=="paramRating"){oe.value=t;break}}}},Ys=async({param:t,task:s={}})=>{switch(t.key){case"na":Xs(t);break;case"defect":Gs(t),s&&c.setSelectedTask(s);break}},Gs=async t=>{const s=await b.getDefectDetail(t.value,m.value.trInterventionHeaderId,m.value.sapWorkOrder,"taskKey"),i=await b.getDefectHeader(t.value,m.value.trInterventionHeaderId,m.value.sapWorkOrder,"taskKey");if(s.type=="NO")Ae.value=s,Be.value=!0;else{Oe.value={},Ae.value=s;const x=await b.getDefectDecline(t.value);Oe.value.isDecline=x.isDecline,Oe.value.declineReason=x.declineReason,Oe.value.declineDate=x.declineDate,Oe.value.declineBy=x.declineBy,Xe.value=i.approvedBy,ta.value=i.approvedDate??"",Se.value=!0}},Ws=()=>{F.value=!1,ye.value=!1,at.value=!1},Ks=()=>{F.value=!1,k.setCameraVisible(!0),k.setCurrentType("value"),V.value=m.value.riskAssesment[0].key},Js=()=>{Se.value=!1},Qs=()=>{Je.value=!1},zs=()=>{Be.value=!1},Xs=async t=>{const s=await C.getNADetail(t.value,m.value.trInterventionHeaderId,m.value.sapWorkOrder);s&&(Ae.value=JSON.parse(s.defectData),Xa.value=s.cbmNAStatus,Oe.value={},Oe.value.declineReason=s.declineReason||"",Oe.value.declineDate=s.declineDate||"",Oe.value.declineBy=s.declineBy||{},Xe.value=s.approvedBy,ta.value=s.approvedDate||"",P.value=!0)},Zs=()=>{P.value=!1,Oe.value={},Xe.value={},ta.value=""},eo=()=>{Ma.value=!1},ao=async()=>{if(pe.value=!1,aa.value="",E.value.group=="Identified Defects"){const t=xe.service({lock:!0,text:"getting defects data",background:"rgba(0, 0, 0, 0.7)"});await d.getDefectsData(m.value.id,m.value.sapWorkOrder),t.close()}},to=()=>{D.value=!1,aa.value=""},tl=t=>{let s="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",x=i.length;for(let N=0;N<t;N++)s+=i.charAt(Math.floor(Math.random()*x));return s},lo=t=>{Aa.value=t},so=t=>{c.updateLoading(t)},oo=()=>{Sa.value=!1},io=async()=>{Sa.value=!1,_.setBusyState(!0);try{await kl()}catch{const t=await _.getWorkOrderFromDB(le.value);t!=null&&(Ha.value=t.sapWorkOrder),Sa.value=!0}_.setBusyState(!1)},kl=async()=>{const t=await _.getWorkOrderDetailById(le.value);if(!t)throw new ReferenceError("intervention not valid");c.initGroup(t),re.value=t.interventionSMU??"",ke.value=c.Intervention.serviceStart??"",Aa.value=c.Intervention.additionalInformation??""},no=async t=>{switch(Me.value=!1,t.type){case"machineSMU":vo(t);break;case"defect":co(t);break;case"defectGeneric":ro(t);break;case"na":mo(t.taskId);break;case"cbm":fo(t.taskId);break}},ro=t=>{va.value="",ma.value="",Fe.value="",Me.value=!0;const s=d.getDefectGenericData(t.defectHeaderId);if(s){if(Fe.value=s.defectHeaderId,JSON.parse(s.defectData).type=="YES"){const i=JSON.parse(s.defectData),x={key:"",category:"NORMAL",updatedBy:s.createdBy};c.setSelectedTask(x),je.value=i;const N=je.value.images?JSON.parse(je.value.images):[];b.setExistingDefectImages(Fe.value,N),va.value=t.taskNo,ma.value=t.taskDesc,Ya.value=t.taskStatus??"",Ja.value=t.taskDeclineReason??"",za.value=t.taskDeclineDate??"",Qa.value=t.taskDeclineBy??{},ta.value=t.taskApprovedDate??"",Xe.value=t.taskApprovedBy??{},Je.value=!0}else if(JSON.parse(s.defectData).type=="NO"){const i=JSON.parse(s.defectData);Ae.value=i,Be.value=!0}}},uo=()=>{va.value="",ma.value="",Fe.value="",Me.value=!0,Le.value=!0,ia.value=ht()},co=t=>{va.value="",ma.value="";const s=d.getDefectDetailData(t.taskId);if(s)if(s.type=="YES"){const i=c.getTaskById(t.taskId);c.setSelectedTask(i),je.value=s;const x=je.value.images?JSON.parse(je.value.images):[];b.setExistingDefectImages(t.taskId,x),va.value=t.taskNo,ma.value=t.taskDesc,Ya.value=t.taskStatus??"",Ja.value=t.taskDeclineReason??"",za.value=t.taskDeclineDate??"",Qa.value=t.taskDeclineBy??{},ta.value=t.taskApprovedDate??"",Xe.value=t.taskApprovedBy??{},Je.value=!0}else s.type=="NO"&&(Ae.value=s,Be.value=!0)},vo=t=>{ba.value=!0,Fa.value=t.smuDetail,Va.value=t.approvalSPVData},mo=t=>{const s=d.getNADetailData(t);s&&(Ae.value=JSON.parse(s.defectData),Xa.value=s.cbmNAStatus,Oe.value={},Oe.value.declineReason=s.declineReason||"",Oe.value.declineDate=s.declineDate||"",Oe.value.declineBy=s.declineBy||{},Xe.value=s.approvedBy,ta.value=s.approvedDate||"",P.value=!0)},fo=async t=>{var Ge;const s=m.value.details[0].tasks,i=d.getCBMDetailData(t);let x,N=[];if(s.every(Ee=>(x=Ee.tasks.find(Re=>Re.key==t),!x)),x){if(x.psType){const Ee=await jt.cbmMapping.where({model:m.value.equipmentModel,psType:x.psType}).first(),Re=Ee==null?void 0:Ee.detail.filter(Lt=>Lt.taskKey==x.key);Qe.value=U.orderBy(Re,["uom","cbmRating","minValue"])}else Qe.value=[];(Ge=x.adjustment)!=null&&Ge.pictures?N=x.adjustment.pictures:N=x.images}Ue.value=i;const oe=d.stateDefectHeader.find(Ee=>{var Re;return Ee.id==((Re=Ue.value)==null?void 0:Re.defectHeaderId)});oe&&(oe.appSPVBy&&(Ue.value.appSPVBy=oe.appSPVBy,Ue.value.appSPVDate=oe.appSPVDate),oe.appPlannerBy&&(Ue.value.appPlannerBy=oe.appPlannerBy,Ue.value.appPlannerDate=oe.appPlannerDate)),Ia.value=sl(N),Ma.value=!0},po=()=>{$a.value=!1,window.location.href.includes("#!")||(window.location.href+="#!",fe.currentRoute.value.hash="#!")},go=()=>{const t=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});$a.value=!1,m.value.interventionSMU||c.discardGeneralChanges(),t.close(),fe.push({name:"ironforms"})},ho=()=>{const t=fe.currentRoute.value,s=window.location.href,i=t.hash;s.includes("#!")||(window.location.href+="#!"),i.includes("#!")||(fe.currentRoute.value.hash="#!");const x=t.path;window.onpopstate=N=>{x=="/ironforms/component-intervention-forms"&&!fe.currentRoute.value.hash.includes("#")&&N.state&&($a.value=!0)}},Bt=o(!1),ll=t=>{Bt.value=t,Tt.value&&Bt.value&&setTimeout(()=>{Tt.value&&(Bt.value=!1)},3e3)},yo=t=>{const s=Y.Ownership.find(i=>i.equipmentNumber==t);sa.value=(s==null?void 0:s.ownership)??"",Ze.value=(s==null?void 0:s.serialNumber)??""};Oo(async()=>{c.resetLoading(),d.reset(),Ft(),ho()}),$o(async()=>{if(!le.value)Wa.value=!0;else{c.resetIntervention(),_.reset(),_.setBusyState(!0),await Y.getFitters(),await _.getSMUTolerance();let t;if(Tt.value||ll(!0),ua())t=await jt.interventionDetail.where("keyPbi").equals(le.value).first(),c.initGroup(t),re.value=t.interventionSMU??"",ke.value=c.Intervention.serviceStart??"",Aa.value=c.Intervention.additionalInformation??"",_.setBusyState(!1);else{try{await kl(),await c.getCountIdentifiedDefect(),await d.getDefectsData(m.value.id,m.value.sapWorkOrder),await c.saveReplacementPreviousValue()}catch{const s=await _.getWorkOrderFromDB(le.value);s!=null&&(Ha.value=s.sapWorkOrder),Sa.value=!0}_.setBusyState(!1),_.syncWithIronPortalData(),_.getLatestSyncDate()}yo(m.value.equipment)}});const Dl=()=>{_.reset();const t=xe.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(()=>{t.close(),te.value=!0},500)},bo=()=>{_.reset(),Wa.value=!1,fe.push({name:"ironforms"})},_o=async()=>{if(c.toogleTaskErrorDialog(!1),xt(!1),Ot(!1),qt(),!ua()){const t=xe.service({lock:!0,text:"Reloading",background:"rgba(0, 0, 0, 0.7)"}),s=await _.getWorkOrderDetailById(le.value);c.initGroup(s,1),t.close()}},ko=async t=>{const s=t.selectedReason+":"+t.desc,i=ct.value;switch(i.value){case"1":case"2":i.reason=s,await c.updateTask(i),ct.value=void 0,fa.value=void 0,t.afterSubmit();break;case"3":oa.value=s,fa.value.data.task.reason=s,al(fa.value,!0),fa.value=void 0,Ra.value=!1;break}},Cl=()=>{Ae.value=void 0,Ra.value=!1},Do=()=>{Cl()},Co=()=>{ea.value=!1},wo=()=>{Ve.value=!0},Vo=w(()=>({title:xi.MACHINESMUTITLE(),machineSMU:m.value.interventionSMU,minRange:Et.value,maxRange:Ut.value,smuDue:m.value.smuDue,assetNumber:m.value.equipment,serialNumber:Ze.value,images:JSON.stringify(m.value.imageEquipment),hmOffset:m.value.hmOffset??"0",key:"",type:"",reason:""}));return Yt(()=>E.value.group,async t=>{t=="Identified Defects"&&(_.setBusyState(!0),await d.getDefectsData(m.value.id,m.value.sapWorkOrder),await d.setDefectIdentifiedData(m.value.sapWorkOrder),_.setBusyState(!1))}),Yt(Tt,()=>{ll(!0)},{deep:!0}),(t,s)=>{const i=ae("NwImg"),x=No("loading");return v(),p(_e,null,[e("nav",Sm,[e("div",xm,[e("div",{class:"logo-wrapper d-flex align-items-center ms-1",onClick:ps},[u(i,{style:{cursor:"pointer"},src:"/media/logos/logo-whitebg.png",class:"h-40px logo"})]),e("div",Om,[e("div",$m,[u(Ao)])])])]),Wa.value?$("",!0):We((v(),p("div",Rm,[e("div",Nm,[Am,e("div",{class:Ca({"d-flex justify-content-between mt-1 mb-4":Ye.value,"col-7 text-right":!Ye.value})},[Ye.value?(v(),me(ri,{key:0,mechanicName:Nt.value},null,8,["mechanicName"])):$("",!0),m.value.sampleStatus?(v(),p("h4",{key:1,class:"form-name",innerHTML:El.value},null,8,Pm)):(v(),p("h4",Tm,"(Ver.)"))],2)]),u(qo,{groups:S.value,"selected-group":E.value,"general-submitted":Ye.value,"task-progress":vl.value,"count-identified-defect":Z.value,onGroupChange:hs,onOnGoToOpenRequiredTask:gs},null,8,["groups","selected-group","general-submitted","task-progress","count-identified-defect"]),u(ui,{ref_key:"timer",ref:T,onOnStart:ga,onOnChange:dt,onOnStop:mt,visibility:!fl.value&&ce.value,"is-disabled":!Ye.value},null,8,["visibility","is-disabled"]),E.value.group=="General"?(v(),p(_e,{key:0},[u(vn,{ref_key:"cardPersonel",ref:be,intervention:m.value,personnel:At.value,"general-submitted":Ye.value,"re-render":ze.value,fitter:he.value.employee,validation:W.value,formAgreement:ye.value,smuTolerance:zt.value,hasOpenedDialog:ge.value||qe.value,onOnPersonnelSelected:Cs,onOnSMUChanged:ys,"serial-number":Ze.value,onOnCameraClicked:ot,onOnImageDownloaded:vt,onOnImageDeleted:ds,onOnSMUReviseIconClicked:wo},null,8,["intervention","personnel","general-submitted","re-render","fitter","validation","formAgreement","smuTolerance","hasOpenedDialog","serial-number"]),u(wl,{intervention:m.value},null,8,["intervention"]),u(Bo,{tasks:m.value.safetyPrecaution},null,8,["tasks"]),e("div",Em,[e("div",Um,[We(e("input",{class:"form-check-input",disabled:Fl.value,type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=N=>ye.value=N),id:"agreement",onChange:ws},null,40,Fm),[[Ro,ye.value]]),qm])]),u(Lo,{ref_key:"preRiskComponent",ref:ka,"general-submitted":Ye.value,intervention:m.value,fitter:he.value.employee,"fitter-photos":Pt.value,"re-render":ze.value,onOnCameraClicked:ot,onOnImageDownloaded:vt,onOnImageDeleted:vs},null,8,["general-submitted","intervention","fitter","fitter-photos","re-render"]),Ye.value?(v(),p("div",Hm,[Vt.value?$("",!0):(v(),p("div",jm,[e("button",{type:"button",disabled:Vt.value,class:"btn btn-success",onClick:el,style:{"background-color":"#18af4a"}}," SUBMIT ",8,Ym)]))])):(v(),p("div",Bm,[u(ci,{clock:h.value},null,8,["clock"]),e("button",{class:"btn btn-success",disabled:Ul.value,style:{background:"#18af4a","box-shadow":"0px 8px 16px rgba(0, 171, 85, 0.24)",color:"white"},onClick:Vs}," Enter ",8,Lm)]))],64)):E.value.group=="Identified Defects"?(v(),p(_e,{key:1},[u(Po,{data:Ll.value,comments:Hl.value,"general-submitted":Ye.value,onOnViewDetailInformation:no,onOnAddGenericDefect:uo,"defect-detail":ee(d).DefectDetail},null,8,["data","comments","general-submitted","defect-detail"]),m.value.interventionExecution!="Submited"&&!Vt.value?(v(),p("div",Gm,[e("div",Wm,[e("div",Km,[e("button",{type:"button",disabled:Vt.value,class:"btn btn-success",onClick:el,style:{"background-color":"#18af4a"}}," SUBMIT ",8,Jm)])])])):$("",!0)],64)):E.value.group!="General"&&E.value.group!="Identified Defects"?(v(),p(_e,{key:2},[u(wl,{intervention:m.value,"default-accordion-open":!1},null,8,["intervention"]),(v(!0),p(_e,null,Pe(E.value.sections,N=>(v(),me(Go,{key:N.key,"re-render":ze.value,"defect-images":Mt.value,intervention:m.value,section:N,"current-fitter":he.value.employee,validation:Dt.value,"loading-indicator":ql.value,"item-trigger-disabled-value":Bl.value,currInputTyped:Ct.value,"expand-all":Ga.value,onOnTaskChanged:al,onOnNACreated:xs,"is-read-only":Kl.value,onOnDefectView:Ys,onOnInitLoadingItem:so,onOnSmallCameraClicked:hl,onOnImageDeleted:es,onOnImageDownloaded:vt,"general-submitted":Ye.value},null,8,["re-render","defect-images","intervention","section","current-fitter","validation","loading-indicator","item-trigger-disabled-value","currInputTyped","expand-all","is-read-only","general-submitted"]))),128)),u(vi,{"property-name":"Provide additional information if required","property-value":Aa.value,onOnInputChanged:lo,"is-disabled":m.value.interventionExecution=="Submited"},null,8,["property-value","is-disabled"]),m.value.interventionExecution!="Submited"?(v(),p("div",Qm,[e("div",zm,[e("div",Xm,[e("button",{type:"button",disabled:Vt.value,class:"btn btn-success",onClick:el,style:{"background-color":"#18af4a"}}," Submit ",8,Zm)])])])):$("",!0)],64)):$("",!0),Bt.value?(v(),me(Jo,{key:3,onOnToggleIndicator:ll})):$("",!0)])),[[x,wt.value]]),u(di,{show:te.value,onClose:Rs},null,8,["show"]),u(ca,{visibility:we.value,caption:"Are you sure want to submit this form?",onOnNoConfirm:s[1]||(s[1]=()=>{we.value=!1}),onOnYesConfirm:Os},null,8,["visibility"]),u(ca,{visibility:r.value,caption:"Is your work finished?",onOnNoConfirm:Pa,onOnYesConfirm:I},null,8,["visibility"]),u(Sl,{visibility:F.value,caption:et.value,"yes-label":"Take a Photo","no-label":"Cancel",onOnNoConfirm:Ws,onOnYesConfirm:Ks,yesButtonBackroundColor:"#18AF4A"},null,8,["visibility","caption"]),u(Wo,{error:G.value,"work-order":m.value.sapWorkOrder,visibility:ue.value,onClose:$s},null,8,["error","work-order","visibility"]),u(Pv,{ref_key:"defectYesFormRef",ref:L,"asset-number":m.value.equipment,task:se.value,"re-render":ze.value,"defect-images":Mt.value,visibility:Ba.value,"current-fitter":he.value.employee,positions:ee(Y).Positions,"generated-i-d":ia.value,ownership:sa.value,isNeed30Minutes:ee(st),serialNumber:Ze.value,"symptom-options":ee(Y).Symptoms,"cause-options":ee(Y).Causes,onOnSubmit:Us,onOnCancel:Es,onOnClose:xt,onOnCameraClick:ot,onOnImageDeleted:Zt,onOnImagePartDeleted:bl,generic:Me.value,onOnAttachmentClicked:yl,onOnSetFlagFromDeleteAction:Xt},null,8,["asset-number","task","re-render","defect-images","visibility","current-fitter","positions","generated-i-d","ownership","isNeed30Minutes","serialNumber","symptom-options","cause-options","generic"]),u(Cm,{"asset-number":m.value.equipment,"re-render":ze.value,task:se.value,visibility:La.value,"generated-i-d":ia.value,ownership:sa.value,serialNumber:Ze.value,"current-fitter":he.value.employee,"defect-images":Mt.value,onOnSubmit:Ls,onOnCancel:Bs,onOnClose:Ot,onOnCameraClick:ot,onOnImageDeleted:Zt,generic:Me.value,onOnSetFlagFromDeleteAction:Xt},null,8,["asset-number","re-render","task","visibility","generated-i-d","ownership","serialNumber","current-fitter","defect-images","generic"]),u(To,{"show-close-button":He.value,"is-visible":g.value,"is-preview":de.value,"image-url":ve.value,"camera-type":R.value,"switch-camera":Na.value,"image-description":la.value,onOnCameraSwitch:ts,onOnCloseCamera:ss,onOnSnapshotCreated:is,onOnBackToCapture:fs,onOnSnapshotSave:rs,onOnFileDropped:ns,onOnAddDescription:Xl,onOnRetryCamera:ls},null,8,["show-close-button","is-visible","is-preview","image-url","camera-type","switch-camera","image-description"]),u($l,{"is-visible":_a.value,description:la.value,onOnClose:pl,onOnSaveDesc:gl},null,8,["is-visible","description"]),u(vc,{show:Le.value,"check-list-arr":Oa.value,onUpdateCheckList:zl,onSubmit:Ns,onClose:Ts},null,8,["show","check-list-arr"]),u(nc,{task:se.value,conditions:ee(Y).NAConditions,visibility:qa.value,onOnSubmit:js,onOnClose:qt,onOnCancel:Hs},null,8,["task","conditions","visibility"]),u(Ho,{"re-render":ze.value,task:se.value,decline:Oe.value,visibility:Se.value,"approved-by":Xe.value,"approved-date":ta.value,ownership:sa.value,serialNumber:Ze.value,data:Ae.value,onOnImageDownloaded:vt,onOnClose:Js,naReasonOptions:ee(Y).NAConditions},null,8,["re-render","task","decline","visibility","approved-by","approved-date","ownership","serialNumber","data","naReasonOptions"]),u(jo,{"re-render":ze.value,task:se.value,generic:Me.value,visibility:Be.value,data:Ae.value,ownership:sa.value,serialNumber:Ze.value,onOnImageDownloaded:vt,onOnClose:zs,naReasonOptions:ee(Y).NAConditions},null,8,["re-render","task","generic","visibility","data","ownership","serialNumber","naReasonOptions"]),u(Yo,{visibility:P.value,status:Xa.value,"approved-by":Xe.value,"approved-date":ta.value,declineData:Oe.value,data:Ae.value,onOnClose:Zs},null,8,["visibility","status","approved-by","approved-date","declineData","data"]),u(Eo,{cbmData:Ue.value??{},images:Ia.value,visibility:Ma.value,ratingFormula:Qe.value,onOnClose:eo,onOnDownloaded:vt},null,8,["cbmData","images","visibility","ratingFormula"]),u(Ku,{ref_key:"defectEditYesFormRef",ref:a,isNeed30Minutes:ee(st),visibility:Je.value,"current-fitter":he.value.employee,defectData:je.value??{},"defect-images":Mt.value,ownership:sa.value,serialNumber:Ze.value,positions:ee(Y).Positions,"symptom-options":ee(Y).Symptoms,"cause-options":ee(Y).Causes,task:se.value,"task-no":va.value,"task-desc":ma.value,status:Ya.value,"decline-reason":Ja.value,generic:Me.value,"decline-by":Qa.value,"decline-date":za.value,"approved-by":Xe.value,"approved-date":ta.value,"general-submitted":Ye.value,onOnImageDownloaded:vt,onOnImageDeleted:Zt,onOnCameraClick:ot,onOnSubmit:Fs,onOnClose:Qs,onOnResetImage:ms,onOnImagePartDeleted:bl,onOnAttachmentClicked:yl,onOnSetFlagFromDeleteAction:Xt},null,8,["isNeed30Minutes","visibility","current-fitter","defectData","defect-images","ownership","serialNumber","positions","symptom-options","cause-options","task","task-no","task-desc","status","decline-reason","generic","decline-by","decline-date","approved-by","approved-date","general-submitted"]),u(zo,{"is-intervention":!0}),u(fi,{show:A.value,imageList:M.value,onClose:qs,"file-type":na.value},null,8,["show","imageList","file-type"]),u($l,{description:la.value,"is-visible":_a.value,onOnClose:pl,onOnSaveDesc:gl},null,8,["description","is-visible"]),u(xl,{show:pe.value,onClose:ao},null,8,["show"]),u(Ko,{show:D.value},null,8,["show"]),u(Mm,{visibility:z.value,onOnOk:as},null,8,["visibility"]),u(pi,{visibility:Sa.value,caption:`Detail data of work order ${Ta.value} is failed to be retrieved, please retry!`,onOnYesConfirm:io,onOnNoConfirm:oo},null,8,["visibility","caption"]),u(xl,{show:xa.value,icon:"/media/svg/dma/alert.svg",message:"Rating for this task has not been mapped yet, please insert mapping on IronLake first",onClose:s[2]||(s[2]=()=>{xa.value=!1})},null,8,["show"]),u(ca,{visibility:$a.value,caption:"Are you sure want to leave this page?",onOnNoConfirm:po,onOnYesConfirm:go},null,8,["visibility"]),u(zu,{visibility:ja.value,caption:"The photo successfully taken, would you like to take another photo?",onOnNoConfirm:s[3]||(s[3]=()=>{ja.value=!1}),onOnYesConfirm:Zl},null,8,["visibility"]),u(ft,{"modal-type":"taskError",show:jl.value,onClose:_o,message:Yl.value},null,8,["show","message"]),u(ft,{"modal-type":"alreadySubmitted",show:Gl.value,onClose:Dl},null,8,["show"]),u(ft,{"modal-type":"alreadyClose",show:Wl.value,onClose:Dl},null,8,["show"]),u(ft,{"modal-type":"notReady",show:Wa.value,onClose:bo},null,8,["show"]),u(ft,{"modal-type":"notMapped",show:ea.value,onClose:Co},null,8,["show"]),u(Uo,{visibility:rt.value,caption:"Pre-Task Risk Assessment Photo Sucessfully Taken"},null,8,["visibility"]),u(Ol,{show:ut.value,message:Za.value,icon:"/media/svg/dma/alert.svg"},null,8,["show","message"]),u(ft,{"modal-type":"alreadyFilled",show:Ka.value,onClose:Ds},null,8,["show"]),u(gi,{"na-detail":Ae.value,visibility:Ra.value,onOnSave:ko,onOnClose:Cl,onOnCancel:Do,isIntervention:!0},null,8,["na-detail","visibility"]),u(ca,{visibility:tt.value,caption:"Are you sure to change this data? Defect data that already recorded will be deleted.",onOnNoConfirm:Is,onOnYesConfirm:Ss},null,8,["visibility"]),u(Im,{ref_key:"attachmentUploader",ref:lt,onOnDropAttachment:us},null,512),u(Ii,{visibility:Da.value,isCloseButtonShow:!1,caption:"Out Of Range",onOnClose:s[4]||(s[4]=()=>{Da.value=!1})},null,8,["visibility"]),u(Sl,{visibility:ge.value,caption:B.value,onOnNoConfirm:_s,onOnYesConfirm:ks},null,8,["visibility","caption"]),u(ca,{visibility:qe.value,caption:"Please take photo of Machine SMU in the cabin dashboard","yes-label":"Take a Photo","hide-no":!0,onOnYesConfirm:bs},null,8,["visibility"]),u(Ol,{show:De.value,message:"Machine SMU photo has been taken"},null,8,["show"]),u(Il,{show:Ve.value,"onUpdate:show":s[5]||(s[5]=N=>Ve.value=N),detailDefect:Vo.value,ownership:sa.value,"view-only":m.value.isApprovedSmu,isFitter:!0,"cameras-image":da.value,onUpdateDefectDetailSMU:Jl,onRetakePhoto:Ql,onResetPhoto:Ft,isIntevention:!0},null,8,["show","detailDefect","ownership","view-only","cameras-image"]),u(Il,{show:ba.value,"onUpdate:show":s[6]||(s[6]=N=>ba.value=N),detailDefect:Fa.value,ownership:sa.value,"approval-s-p-v-data":Va.value,"view-only":!0,isFitter:!0,isIntevention:!0},null,8,["show","detailDefect","ownership","approval-s-p-v-data"])],64)}}}),ig=_t(ef,[["__scopeId","data-v-8537820d"]]);export{ig as default};

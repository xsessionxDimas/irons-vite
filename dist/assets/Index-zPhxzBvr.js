import{u as xt}from"./vuex-BbOKrtVp.js";import{b as it}from"./vue-router-iNp9kJ0K.js";import{a as Ot}from"./breadcrumb-D-Q4Tk9w.js";import{b as q,u as N,s as z,i as Q,h as rt,j as W,A as At}from"./index-BCnwA6yE.js";import{P as St}from"./Pagination-CVDIvnOM.js";import{F as Rt}from"./FilterIconButton-Bj0WTbms.js";import{h as $t,A as Nt,U as Bt}from"./excel-generator-CRLIz6fw.js";import{D as Vt}from"./DownloadIconButton-CIQp-YG7.js";import{k as G,c as L,r as j,u as n,y as Y,p as f,aa as A,s as o,x as d,T as Ut,q as T,F as yt,Y as lt,R as V,A as st,aB as u,C as M,P as ht,a0 as dt,B,bd as Ht,bb as Mt,a7 as qt,L as zt}from"./@vue-BypzYtbH.js";import{_ as b,b as wt}from"./element-plus-C5R56mia.js";import{P as Z,b as X,a as jt}from"./table-sort-VnBD5Hfa.js";import{G as Gt,L as Kt,E as Yt,a as Wt,I as Xt,U as Jt,B as Qt,b as Zt}from"./urls-DrpWsKIM.js";import{d as ut}from"./pinia-BjOS2_Ao.js";import{a as K}from"./mapOption-sP4IrA4W.js";import{f as C,n as _,a as vt}from"./date-format-BASVuupi.js";import{c as Pt,a as tt,b as et,d as Ft}from"./yup-BRaPd8dh.js";import"./property-expr-DEi1ZLzV.js";import{E as _t}from"./ErrorAlert-CMKGfwAi.js";import{_ as te}from"./AutoComplete.vue_vue_type_script_setup_true_lang-BJG-QfZq.js";import{_ as at}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-DQfguttb.js";import{_ as ot}from"./TextInput.vue_vue_type_script_setup_true_lang-oAh_qqu1.js";import{_ as It}from"./NumberInput.vue_vue_type_script_setup_true_lang-DQgMY3Op.js";import{a as ee}from"./vee-validate-C_msoaAA.js";import{_ as ae}from"./AutoComplete.vue_vue_type_script_setup_true_lang-D4CTLiQF.js";import{e as oe}from"./lodash-Cr9vlq0V.js";import{_ as se}from"./FileDropZone.vue_vue_type_style_index_0_lang-Ct77XTnP.js";import{m as ie}from"./map-anything-abi6NY2Z.js";import{_ as ne}from"./nw-img-vue-CR837WER.js";import{_ as J}from"./AutoComplete.vue_vue_type_style_index_0_lang-CRR6Z--K.js";import{_ as ft}from"./DatePickerInput.vue_vue_type_script_setup_true_lang-DO0pIl2P.js";import{F as re}from"./file-saver-DhbZvGod.js";import"./object-path-BACu75q6.js";import"./attr-accept-BWI1aNlo.js";import"./crypto-js-BZehCumu.js";import"./cron-Ci8nYs3o.js";import"./luxon-C_T8jI2d.js";import"./dexie-CWyjz2Lo.js";import"./axios-N3crNZ6y.js";import"./vue-axios-BaogFJPH.js";import"./sweetalert2-DK0FVkv3.js";import"./@azure-DwL0pga8.js";import"./uuid-SoommWqA.js";import"./vue-inline-svg-Bgl3eqMC.js";import"./@microsoft-C248spM2.js";import"./@nevware21-CKApUIxW.js";import"./dayjs-C7SXsQPH.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./normalize-wheel-xcxZ5rdH.js";import"./mitt-C1xD_ZTF.js";import"./@popperjs-WhmJkuoZ.js";import"./async-validator-DK9uouaC.js";import"./language-BriOOvyN.js";import"./vue-i18n-CE6bnohq.js";import"./@intlify-CjZh8qSI.js";import"./PageEnum-BoOqFyRq.js";import"./xlsx-CpbwoZfi.js";import"./moment-C5S46NFB.js";import"./nanoclone-BAWie4i9.js";import"./toposort-CalJriC0.js";import"./vue3-dropzone-DPWU9yJt.js";import"./file-selector-CuD-TRe-.js";import"./tslib-DTLQ5SHO.js";const nt={interventionStatus:"",interventionStatusTo:"",interventionStatusDesc:"",interventionStatusDescTo:"",followUpPriority:"",followUpPriorityTo:"",followUpPriorityUom:"",followUpPriorityUomTo:"",startDate:"",startDateTo:"",endDate:"",endDateTo:"",ver:"v1",page:1,pageSize:10,order:""},ct=ut({id:"interventionStatusList",state:()=>({stateFilterData:{...nt},stateLastUsedFilterData:{...nt},statePageName:"interventionStatus",stateDisplayData:[],statePagination:new Z,stateLoading:!1,statePaginationLoading:!1,stateInterventionStatusOption:[],stateInterventionStatusDescOption:[],stateFollowUpPriorityOption:[],stateFollowUpPriorityUomOption:[]}),getters:{pageName:t=>t.statePageName,pagination:t=>t.statePagination,displayData:t=>t.stateDisplayData,filterData:t=>t.stateFilterData,lastUsedFilterData:t=>t.stateLastUsedFilterData,loading:t=>t.stateLoading,paginationLoading:t=>t.statePaginationLoading,interventionStatusOption:t=>t.stateInterventionStatusOption,interventionStatusDescOption:t=>t.stateInterventionStatusDescOption,followUpPriorityOption:t=>t.stateFollowUpPriorityOption,followUpPriorityUomOption:t=>t.stateFollowUpPriorityUomOption},actions:{async getData(t=!0){const i={interventionStatus:this.stateFilterData.interventionStatus,interventionStatusTo:this.stateFilterData.interventionStatusTo,interventionStatusDesc:this.stateFilterData.interventionStatusDesc,interventionStatusDescTo:this.stateFilterData.interventionStatusDescTo,followUpPriority:this.stateFilterData.followUpPriority,followUpPriorityTo:this.stateFilterData.followUpPriorityTo,followUpPriorityUom:this.stateFilterData.followUpPriorityUom,followUpPriorityUomTo:this.stateFilterData.followUpPriorityUomTo,startDate:this.stateFilterData.startDate?C(_(new Date(this.stateFilterData.startDate))):"",startDateTo:this.stateFilterData.startDateTo?C(_(new Date(this.stateFilterData.startDateTo))):"",endDate:this.stateFilterData.endDate?C(_(new Date(this.stateFilterData.endDate))):"",endDateTo:this.stateFilterData.endDateTo?C(_(new Date(this.stateFilterData.endDateTo))):"",page:this.stateFilterData.page.toString(),pageSize:this.stateFilterData.pageSize.toString(),order:this.stateFilterData.order,ver:this.stateFilterData.ver};try{t&&(this.stateLoading=!0),t||(this.stateDisplayData=[]);const e=await q.get(Gt,"intervention_status",new URLSearchParams(i).toString());this.stateDisplayData=e.data.result.content,this.setTotalPage(e.data.result.total),this.stateLastUsedFilterData={...this.stateFilterData}}catch(e){e.response.data.statusCode==401&&N().setLoggedIn(!1),z("IRONS",e),console.log(e)}this.stateLoading=!1},async getLookup(){const t={ver:this.stateFilterData.ver};try{const i=await q.get(Kt,"",new URLSearchParams(t).toString());this.stateInterventionStatusOption=K(i.data.result.content.interventionStatus),this.stateInterventionStatusDescOption=K(i.data.result.content.interventionStatusDesc),this.stateFollowUpPriorityOption=K(i.data.result.content.followUpPriority),this.stateFollowUpPriorityUomOption=K(i.data.result.content.followUpPriorityUom)}catch(i){i.response.data.statusCode==401&&N().setLoggedIn(!1),z("IRONS",i),console.log(i)}},async export(){const t={interventionStatus:this.stateFilterData.interventionStatus,interventionStatusTo:this.stateFilterData.interventionStatusTo,interventionStatusDesc:this.stateFilterData.interventionStatusDesc,interventionStatusDescTo:this.stateFilterData.interventionStatusDescTo,followUpPriority:this.stateFilterData.followUpPriority,followUpPriorityTo:this.stateFilterData.followUpPriorityTo,followUpPriorityUom:this.stateFilterData.followUpPriorityUom,followUpPriorityUomTo:this.stateFilterData.followUpPriorityUomTo,startDate:this.stateFilterData.startDate?C(_(new Date(this.stateFilterData.startDate))):"",startDateTo:this.stateFilterData.startDateTo?C(_(new Date(this.stateFilterData.startDateTo))):"",endDate:this.stateFilterData.endDate?C(_(new Date(this.stateFilterData.endDate))):"",endDateTo:this.stateFilterData.endDateTo?C(_(new Date(this.stateFilterData.endDateTo))):"",order:this.stateFilterData.order,ver:this.stateFilterData.ver,Gmt:new Date().toTimeString().slice(12,17)};try{return(await q.getBlob(Yt,"",new URLSearchParams(t).toString())).data}catch(i){z("IRONS",i),console.log(i)}},setTotalPage(t){this.pagination.totalPage=t,this.pagination.getPaginationStartIndex(),this.pagination.getPaginationLastIndex()},async setPage(t){this.statePaginationLoading=!0,this.statePagination.handleCurrentPageChange(t),this.stateFilterData.page=this.statePagination.currentPage,await this.getData(!1),setTimeout(()=>{this.statePaginationLoading=!1},200)},async setSort({prop:t,order:i}){if(!t&&!i)this.stateFilterData.order="";else{const e=i=="ascending"?"asc":"desc";this.stateFilterData.order=`${t}_${e}`}this.statePagination.handleCurrentPageChange(1),this.stateFilterData.page=this.statePagination.currentPage,await this.getData(!1)},setInterventionStatus(t){this.stateFilterData.interventionStatus=t},setInterventionStatusTo(t){this.stateFilterData.interventionStatusTo=t},setInterventionStatusDesc(t){this.stateFilterData.interventionStatusDesc=t},setInterventionStatusDescTo(t){this.stateFilterData.interventionStatusDescTo=t},setFollowUpPriority(t){this.stateFilterData.followUpPriority=t},setFollowUpPriorityTo(t){this.stateFilterData.followUpPriorityTo=t},setFollowUpPriorityUom(t){this.stateFilterData.followUpPriorityUom=t},setFollowUpPriorityUomTo(t){this.stateFilterData.followUpPriorityUomTo=t},setStartDate(t){this.stateFilterData.startDate=t},setStartDateTo(t){this.stateFilterData.startDateTo=t},setEndDate(t){this.stateFilterData.endDate=t},setEndDateTo(t){this.stateFilterData.endDateTo=t},async resetFilter(){this.stateFilterData.interventionStatus="",this.stateFilterData.interventionStatusTo="",this.stateFilterData.interventionStatusDesc="",this.stateFilterData.interventionStatusDescTo="",this.stateFilterData.followUpPriority="",this.stateFilterData.followUpPriorityTo="",this.stateFilterData.followUpPriorityUom="",this.stateFilterData.followUpPriorityUomTo="",this.stateFilterData.startDate="",this.stateFilterData.startDateTo="",this.stateFilterData.endDate="",this.stateFilterData.endDateTo="";const t=this.stateLastUsedFilterData.interventionStatus!=="",i=this.stateLastUsedFilterData.interventionStatusTo!=="",e=this.stateLastUsedFilterData.interventionStatusDesc!=="",m=this.stateLastUsedFilterData.interventionStatusDescTo!=="",r=this.stateLastUsedFilterData.followUpPriority!=="",s=this.stateLastUsedFilterData.followUpPriorityTo!=="",l=this.stateLastUsedFilterData.followUpPriorityUom!=="",v=this.stateLastUsedFilterData.followUpPriorityUomTo!=="",S=this.stateLastUsedFilterData.startDate!=="",y=this.stateLastUsedFilterData.startDateTo!=="",E=this.stateLastUsedFilterData.endDate!=="",I=this.stateLastUsedFilterData.endDateTo!=="";(t||i||e||m||r||s||l||v||S||y||E||I)&&await this.getData()},resetState(){this.stateFilterData={...nt},this.stateDisplayData=[],this.statePagination=new Z,this.stateLoading=!1,this.statePaginationLoading=!1}}}),gt={interventionStatusId:0,interventionStatus:"",interventionStatusDesc:"",followUpPriority:"",followUpPriorityUom:"",startDate:_(new Date),endDate:_(new Date("12/31/9999"))},pt=ut({id:"interventionStatusForm",state:()=>({stateFormData:{...gt},stateFollowUpPriorityUomOption:[],stateIsError:!1,stateError:"",stateErrors:[],stateLoading:!1,stateIsEdit:!1}),getters:{isEdit:t=>t.stateIsEdit,formData:t=>t.stateFormData,error:t=>t.stateError,errors:t=>t.stateErrors,isError:t=>t.stateIsError,loading:t=>t.stateLoading,followUpPriorityUomOption:t=>t.stateFollowUpPriorityUomOption},actions:{setIsEdit(t){this.stateIsEdit=t},async getLookup(){const t={ver:"v1"};try{const i=await q.get(Wt,"",new URLSearchParams(t).toString());this.stateFollowUpPriorityUomOption=K(i.data.result.content.uom)}catch(i){i.response.data.statusCode==401&&N().setLoggedIn(!1),z("IRONS",i),console.log(i)}},async insertData(t){try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"},e={interventionStatusId:0,interventionStatus:this.stateFormData.interventionStatus,interventionStatusDesc:this.stateFormData.interventionStatusDesc,followUpPriority:this.stateFormData.followUpPriority,followUpPriorityUom:this.stateFormData.followUpPriorityUom,startDate:C(_(new Date(this.stateFormData.startDate))),endDate:C(_(new Date(this.stateFormData.endDate)))},m=await q.post(`${Xt}?${new URLSearchParams(i).toString()}`,e);m.data.title==="Error"?(this.stateErrors.push(m.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){i.response.data.statusCode==401&&N().setLoggedIn(!1),this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0,z("IRONS",i)}this.stateLoading=!1},async updateData(t){try{this.stateLoading=!0;const i={userAccount:t,ver:"v1"},e={interventionStatusId:this.stateFormData.interventionStatusId,interventionStatus:this.stateFormData.interventionStatus,interventionStatusDesc:this.stateFormData.interventionStatusDesc,followUpPriority:this.stateFormData.followUpPriority,followUpPriorityUom:this.stateFormData.followUpPriorityUom,startDate:C(_(new Date(this.stateFormData.startDate))),endDate:C(_(new Date(this.stateFormData.endDate)))},m=await q.post(`${Jt}?${new URLSearchParams(i).toString()}`,e);m.data.title==="Error"?(this.stateErrors.push(m.data.result.message),this.stateIsError=!0):(this.stateError="",this.stateIsError=!1)}catch(i){i.response.data.statusCode==401&&N().setLoggedIn(!1),this.stateError=i,this.stateErrors.push(i.response.data.result.message),this.stateIsError=!0,z("IRONS",i)}this.stateLoading=!1},setErrors(t){this.stateErrors=t,this.stateIsError=this.stateErrors.length>0},setFormData(t){this.stateFormData.interventionStatusId=t.interventionStatusId,this.stateFormData.interventionStatus=t.interventionStatus,this.stateFormData.interventionStatusDesc=t.interventionStatusDesc,this.stateFormData.followUpPriority=t.followUpPriority,this.stateFormData.followUpPriorityUom=t.followUpPriorityUom,this.stateFormData.startDate=t.startDate,this.stateFormData.endDate=t.endDate},resetState(){this.stateFormData={...gt},this.stateIsError=!1,this.stateError="",this.stateErrors=[],this.stateLoading=!1}}}),le={key:0,style:{height:"100px"}},de={key:1},ue={key:1},ce={key:1},pe={key:1},De={key:0,class:"d-flex align-items-center"},me=u("span",{class:"mx-1 w-20"},"to",-1),he={key:1,class:"row justify-content-center"},ve={key:0,class:"d-flex justify-content-end"},fe=["disabled","onClick"],ge=["onClick"],Se={key:1,class:"d-flex"},Ue=G({__name:"Grid",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},emits:["fetch-data","duplicateData"],setup(t,{emit:i}){const e=t,m=N(),r=ct(),s=pt(),l=i,v=L(()=>(e.page-1)*10+1),S=j(""),y=g=>{S.value=g.order;const a={prop:g.prop,order:g.order};r.setSort(a)},E=L(()=>s.isEdit),I=j({interventionStatusId:0,interventionStatus:"",interventionStatusDesc:"",followUpPriority:"",followUpPriorityUom:"",startDate:_(new Date),endDate:_(new Date("12/31/9999"))}),c=j({interventionStatusId:0,interventionStatus:"",interventionStatusDesc:"",followUpPriority:"",followUpPriorityUom:"",startDate:_(new Date),endDate:_(new Date("12/31/9999"))}),x=Pt().shape({interventionStatus:tt().required("Intervention Status is mandatory"),interventionStatusDesc:tt().required("Intervention Status Description is mandatory"),startDate:et().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:et().required("End Date is mandatory").min(Ft("startDate"),"End date must be later than start date").typeError("End date must be later than start date")}),R=g=>{c.value={...g}},O=()=>{D(),setTimeout(()=>{c.value=Object.assign({},I.value)},300),s.resetState(),s.setIsEdit(!1)},D=()=>{s.setErrors([])},U=L(()=>s.isError),h=L(()=>s.errors),$=async()=>{s.setIsEdit(!0),D(),await x.validate(c.value,{abortEarly:!1}).catch(g=>{s.setErrors(g.errors),window&&window.scrollTo(0,0)}),!U.value&&Q("Are you sure you want to submit ?").then(async g=>{g.isConfirmed&&(s.setFormData(c.value),s.updateData(m.user.Name).then(()=>{s.isError||rt("Form has been successfully submitted!","Ok").then(()=>{O(),l("fetch-data",null)})}))})},w=async g=>{s.setFormData(g),l("duplicateData",!0)};return(g,a)=>{const P=V("inline-svg"),k=V("el-tooltip"),H=lt("loading");return n(r).loading?Y((f(),A("div",le,null,512)),[[H,n(r).loading]]):(f(),A(yt,{key:1},[o(Ut,{name:"fade"},{default:d(()=>[U.value&&E.value?(f(),T(_t,{key:0,errorMessages:h.value,onResetForm:D},null,8,["errorMessages"])):st("",!0)]),_:1}),Y((f(),T(n(wt),{data:e.listData,style:{width:"100%"},onSortChange:y,"empty-text":"No Data"},{default:d(()=>[o(n(b),{label:"No",width:"90",align:"center"},{default:d(p=>[u("span",null,M(v.value+p.$index),1)]),_:1}),o(n(b),{prop:"interventionStatus",label:"Intervention Status","min-width":"170",sortable:"","sort-method":()=>n(X)(S.value)},{default:d(({row:p})=>[p.interventionStatusId===c.value.interventionStatusId?(f(),T(ot,{key:0,value:c.value.interventionStatus,placeholder:"Add Intervention Status",name:"InterventionStatus",onHandleChange:a[0]||(a[0]=F=>c.value.interventionStatus=F)},null,8,["value"])):(f(),A("span",de,M(p.interventionStatus),1))]),_:1},8,["sort-method"]),o(n(b),{prop:"interventionStatusDesc",label:"Intervention Status Desc","min-width":"200",sortable:"","sort-method":()=>n(X)(S.value)},{default:d(({row:p})=>[p.interventionStatusId===c.value.interventionStatusId?(f(),T(ot,{key:0,value:c.value.interventionStatusDesc,placeholder:"Add Intervention Status Description",name:"interventionStatusDesc",onHandleChange:a[1]||(a[1]=F=>c.value.interventionStatusDesc=F)},null,8,["value"])):(f(),A("span",ue,M(p.interventionStatusDesc),1))]),_:1},8,["sort-method"]),o(n(b),{prop:"followUpPriority",label:"Follow Up Priority","min-width":"170",sortable:"","sort-method":()=>n(X)(S.value)},{default:d(({row:p})=>[p.interventionStatusId===c.value.interventionStatusId?(f(),T(It,{key:0,value:c.value.followUpPriority,placeholder:"Add Follow Up Priority",name:"FollowUpPriority",onHandleChange:a[2]||(a[2]=F=>c.value.followUpPriority=F)},null,8,["value"])):(f(),A("span",ce,M(p.followUpPriority),1))]),_:1},8,["sort-method"]),o(n(b),{prop:"followUpPriorityUom",label:"Follow Up Priority Uom","min-width":"190",sortable:"","sort-method":()=>n(X)(S.value)},{default:d(({row:p})=>[p.interventionStatusId===c.value.interventionStatusId?(f(),T(te,{key:0,value:c.value.followUpPriorityUom,placeholder:"Add Follow Up Priority Uom",name:"FollowUpPriority",onHandleChange:a[3]||(a[3]=F=>c.value.followUpPriorityUom=F),options:n(s).followUpPriorityUomOption},null,8,["value","options"])):(f(),A("span",pe,M(p.followUpPriorityUom),1))]),_:1},8,["sort-method"]),o(n(b),{prop:"isActive",label:"Is Active",width:c.value.interventionStatusId!=0?350:100,sortable:"",align:"center"},{default:d(p=>[p.row.interventionStatusId===c.value.interventionStatusId?(f(),A("div",De,[o(at,{value:c.value.startDate,placeholder:"Add Start Date",name:"StartDate",onHandleChange:a[4]||(a[4]=F=>c.value.startDate=F)},null,8,["value"]),me,o(at,{value:c.value.endDate,placeholder:"Add End Date",name:"EndDate",onHandleChange:a[5]||(a[5]=F=>c.value.endDate=F)},null,8,["value"])])):(f(),A("div",he,[p.row.isActive?(f(),T(P,{key:0,src:"/media/svg/tables/rows/check.svg"})):(f(),T(P,{key:1,src:"/media/svg/tables/rows/minus.svg"}))]))]),_:1},8,["width"]),o(n(b),{label:"",width:"100"},{default:d(p=>[p.row.interventionStatusId!==c.value.interventionStatusId?(f(),A("div",ve,[o(k,{class:"box-item",effect:"dark",content:p.row.isActive?"Edit":"Inactive data cannot be edited",placement:"top"},{default:d(()=>[u("div",null,[u("button",{disabled:!p.row.isActive,class:"btn btn-sm btn-icon btn-bg-light me-3",onClick:F=>R(p.row)},[o(P,{src:"/media/svg/tables/rows/pencil-edit-blue.svg",width:"12",height:"12"})],8,fe)])]),_:2},1032,["content"]),o(k,{class:"box-item",effect:"dark",content:"Add new data based on table rows",placement:"top"},{default:d(()=>[u("div",null,[u("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:F=>w(p.row)},[o(P,{src:"/media/svg/tables/rows/paste-icon-button-blue.svg",width:"12",height:"12"})],8,ge)])]),_:2},1024)])):(f(),A("div",Se,[o(k,{class:"box-item",effect:"dark",content:"Save",placement:"top"},{default:d(()=>[u("button",{class:"btn btn-sm btn-icon btn-bg-light me-3",onClick:ht($,["prevent"])},[o(P,{src:"/media/svg/tables/rows/save.svg",width:"12",height:"12"})])]),_:1}),o(k,{class:"box-item",effect:"dark",content:"Cancel",placement:"top"},{default:d(()=>[u("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:ht(O,["prevent"])},[o(P,{src:"/media/svg/tables/rows/valid-false.svg",width:"12",height:"12"})])]),_:1})]))]),_:1})]),_:1},8,["data"])),[[H,n(r).loading]])],64))}}}),ye={class:"col-md-6 fv-row fv-plugins-icon-container"},we={class:"col-md-6 fv-row fv-plugins-icon-container"},Pe={class:"dialog-footer"},Fe=G({__name:"FormAddDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=t,m=i,r=pt(),s=N(),l=dt(e,"visibility"),v=L(()=>r.formData),S=L(()=>r.isEdit),y=L(()=>r.errors),E=L(()=>r.isError),I=Pt().shape({interventionStatus:tt().required("Intervention Status is mandatory"),interventionStatusDesc:tt().required("Intervention Status Description is mandatory"),startDate:et().required("Start Date is mandatory").typeError("Start Date is mandatory"),endDate:et().required("End Date is mandatory").min(Ft("startDate"),"End date must be later than start date").typeError("End date must be later than start date")}),c=()=>{R(""),O(""),D(""),U(""),h(""),$("")},x=(a=!1)=>{g(),c(),r.resetState(),m("handle-close",a)},R=a=>{v.value.interventionStatus=a},O=a=>{v.value.interventionStatusDesc=a},D=a=>{v.value.followUpPriority=a},U=a=>{v.value.followUpPriorityUom=a},h=a=>{v.value.startDate=a},$=a=>{v.value.endDate=a},w=async()=>{g(),await I.validate(v.value,{abortEarly:!1}).catch(a=>{r.setErrors(a.errors)}),!E.value&&Q("Are you sure you want to submit ?").then(async a=>{a.isConfirmed&&r.insertData(s.user.Name).then(()=>{r.isError||rt("Form has been successfully submitted!","Ok").then(()=>{x(!0)})})})},g=()=>{r.setErrors([])};return(a,P)=>{const k=V("el-button"),H=V("el-dialog"),p=lt("loading");return Y((f(),T(H,{modelValue:l.value,"onUpdate:modelValue":P[0]||(P[0]=F=>l.value=F),title:"New Data",width:"40%",onClose:P[1]||(P[1]=F=>x())},{footer:d(()=>[u("span",Pe,[o(k,{type:"primary",onClick:w,disabled:n(r).loading},{default:d(()=>[B("Submit")]),_:1},8,["disabled"]),o(k,{type:"secondary",onClick:x,disabled:n(r).loading},{default:d(()=>[B("Close")]),_:1},8,["disabled"])])]),default:d(()=>[o(Ut,{name:"fade"},{default:d(()=>[E.value&&!S.value?(f(),T(_t,{key:0,errorMessages:y.value,onResetForm:g},null,8,["errorMessages"])):st("",!0)]),_:1}),Y((f(),T(n(ee),{id:"kt_filter_form",class:"row g-9 my-4"},{default:d(()=>[o(ot,{value:v.value.interventionStatus,placeholder:"Add Intervention Status",label:"Intervention Status",name:"InterventionStatus",max:50,onHandleChange:R},null,8,["value"]),o(ot,{value:v.value.interventionStatusDesc,placeholder:"Add Intervention Status Description",label:"Intervention Status Description",name:"interventionStatusDesc",max:50,onHandleChange:O},null,8,["value"]),o(It,{value:v.value.followUpPriority,placeholder:"Add Follow Up Priority",label:"Follow Up Priority",name:"FollowUpPriority",max:10,onHandleChange:D},null,8,["value"]),o(ae,{value:v.value.followUpPriorityUom,placeholder:"Add Follow Up Priority Uom",label:"Follow Up Priority Uom",name:"FollowUpPriority",max:10,onHandleChange:U,options:n(r).followUpPriorityUomOption},null,8,["value","options"]),u("div",ye,[o(at,{value:v.value.startDate,placeholder:"Add Start Date",label:"Start Date",name:"StartDate",onHandleChange:h},null,8,["value"])]),u("div",we,[o(at,{value:v.value.endDate,placeholder:"Add End Date",label:"End Date",name:"EndDate",onHandleChange:$},null,8,["value"])])]),_:1})),[[p,n(r).loading]])]),_:1},8,["modelValue"])),[[p,n(r).loading]])}}}),Dt=ut({id:"interventionStatusBulk",state:()=>({statePagination:new Z,stateValidatedData:[],stateDisplayData:[],stateBulkData:[],stateIsError:!1,stateError:"",stateLoading:!1,stateUploadLoading:!1,stateIsUploaded:!1,stateIsSort:!1,stateSortBy:null,stateSortOrder:null}),getters:{validatedData:t=>t.stateValidatedData,displayData:t=>t.stateDisplayData,pagination:t=>t.statePagination,bulkData:t=>t.stateBulkData,error:t=>t.stateError,isError:t=>t.stateIsError,loading:t=>t.stateLoading,uploadLoading:t=>t.stateUploadLoading,isUploaded:t=>t.stateIsUploaded},actions:{async bulkInsert(t){const i={userAccount:t,ver:"v1"};try{this.stateLoading=!0;const e=await q.post(`${Qt}?${new URLSearchParams(i).toString()}`,this.stateBulkData);this.stateError=e.data.result.isError?e.data.result.message:"",this.stateIsError=e.data.result.isError}catch(e){e.response.data.statusCode==401&&N().setLoggedIn(!1),z("IRONS",e),console.log(e)}this.stateLoading=!1},async upload({userAccount:t,excelFile:i}){const e={userAccount:t,ver:"v1"},m=`${Zt}?${new URLSearchParams(e).toString()}`;try{this.stateIsError=!1,this.stateError="",this.stateValidatedData=[],this.stateDisplayData=[],this.stateUploadLoading=!0;const r=await q.postImages(m,i);r.data.statusCode==200?r.data.result.isError?(this.stateIsError=!0,this.stateError=r.data.result.message):(this.setIsUploadedState(!0),this.stateValidatedData=r.data.result.content,this.setTotalPage(this.stateValidatedData.length),this.stateIsError=oe.some(this.stateValidatedData,{isValid:!1}),this.setPage(1)):(this.stateIsError=r.data.result.isError,this.stateError=r.data.result.message)}catch(r){r.response.data.statusCode==401&&N().setLoggedIn(!1),console.log(r),this.stateIsError=!0,this.stateError=r.response.data.result.message,z("IRONS",r)}this.stateUploadLoading=!1},setTotalPage(t){this.pagination.totalPage=t},setDisplayData(){let t=[...this.stateValidatedData];this.stateIsSort&&(t=t.sort(jt(this.stateSortBy,this.stateSortOrder))),this.stateDisplayData=t.slice(this.statePagination.startPaginationIndex,this.statePagination.endPaginationIndex)},setPage(t){this.statePagination.handleCurrentPageChange(t),this.setDisplayData()},setSort(t){this.stateIsSort=t.prop!==null,this.stateSortBy=t.prop,this.stateSortOrder=t.order,this.setPage(1)},setBulkData(t){this.stateBulkData=t},setIsUploadedState(t){this.stateIsUploaded=t},resetState(){this.stateValidatedData=[],this.stateDisplayData=[],this.stateBulkData=[],this.statePagination=new Z,this.stateIsError=!1,this.stateError="",this.stateLoading=!1,this.stateUploadLoading=!1,this.stateIsSort=!1,this.stateSortBy=null,this.stateSortOrder=null}}}),_e={class:"icon"},Ie=G({__name:"GridBulk",props:{listData:{required:!0,type:Array},page:{required:!0,type:Number,default:1}},setup(t){const i=t,e=Dt(),m=L(()=>(i.page-1)*10+1),r=s=>{const l={prop:s.prop,order:s.order};e.setSort(l)};return(s,l)=>{const v=V("inline-svg");return f(),T(n(wt),{data:i.listData,style:{width:"100%"},onSortChange:r,"empty-text":"No Data"},{default:d(()=>[o(n(b),{label:"No",width:"60",align:"center"},{default:d(S=>[u("span",null,M(m.value+S.$index),1)]),_:1}),o(n(b),{prop:"interventionStatus",label:"Intervention Status",width:"300",sortable:""}),o(n(b),{prop:"interventionStatusDesc",label:"Intervention Status Description",width:"300",sortable:""}),o(n(b),{prop:"followUpPriority",label:"Follow Up Priority",width:"300",sortable:""}),o(n(b),{prop:"followUpPriorityUom",label:"Follow Up Priority Uom",width:"300",sortable:""}),o(n(b),{prop:"startDate",label:"Start Date",align:"center",width:"170",sortable:""},{default:d(S=>[u("span",null,M(n(vt)(S.row.startDate)),1)]),_:1}),o(n(b),{prop:"endDate",label:"End Date",align:"center",width:"170",sortable:""},{default:d(S=>[u("span",null,M(n(vt)(S.row.endDate)),1)]),_:1}),o(n(b),{prop:"validationReason",label:"Remark","min-width":"300",sortable:""}),o(n(b),{prop:"isValid",label:"Status",width:"100",sortable:""},{default:d(S=>[u("div",_e,[o(v,{src:S.row.isValid?"/media/svg/tables/rows/valid-true.svg":"/media/svg/tables/rows/valid-false.svg"},null,8,["src"])])]),_:1})]),_:1},8,["data"])}}}),mt=t=>(Ht("data-v-3da5769a"),t=t(),Mt(),t),be=mt(()=>u("div",{class:"text-center"},null,-1)),Te=mt(()=>u("div",{class:"mb-3"},[u("span",null,[B(" Download template "),u("a",{href:"documents/MasterDataInterventionStatusandFollowUpPriority.xlsx",target:"_blank",id:"link-download"},"here"),B(" before uploading file ")])],-1)),Ee=mt(()=>u("div",{class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},[u("div",{class:"d-flex align-items-center position-relative my-0 mb-2"})],-1)),ke={class:"card"},Ce={class:"card-body grid-padding"},Le={class:"dialog-footer"},xe=G({__name:"UploadBulkDialog",props:{visibility:{required:!0,type:Boolean}},emits:["handle-close"],setup(t,{emit:i}){const e=t,m=i,r=N(),s=Dt(),l=dt(e,"visibility"),v=()=>{const D=ie(s.validatedData,U=>{const h=U;return{interventionStatusId:0,interventionStatus:h.interventionStatus,interventionStatusDesc:h.interventionStatusDesc,followUpPriority:h.followUpPriority,followUpPriorityUom:h.followUpPriorityUom,startDate:h.startDate,endDate:h.endDate}});return Object.values(D)},S=()=>{const D=document.getElementById("link-download");D&&D.click()},y=()=>{s.validatedData.length>0?Q("Cancel Upload Data?","Confirm").then(U=>{U.isConfirmed&&I()}):I()},E=async D=>{await s.upload({userAccount:r.user.Name,excelFile:D}),s.stateError&&W(s.error)},I=(D=!1)=>{s.resetState(),m("handle-close",D)},c=D=>{s.setIsUploadedState(D)},x=D=>{s.setPage(D)},R=()=>{if(s.validatedData.length<1){S();return}const D=["INTERVENTION STATUS","INTERVENTION STATUS DESC","FOLLOW UP PRIORITY","FOLLOW UP PRIORITY UOM","START DATE","END DATE","REMARK","STATUS"],U=s.validatedData.map(h=>({interventionStatus:h.interventionStatus,interventionStatusDesc:h.interventionStatusDesc,followUpPriority:h.followUpPriority,followUpPriorityUom:h.followUpPriorityUom,startDate:h.startDate,endDate:h.endDate,remark:h.validationReason,status:h.isValid?"OK":"Error"}));$t("InterventionStatus",D,U)},O=async()=>{if(s.displayData.length<1){W("There is no data to submit");return}if(s.isError){W("There is still invalid row(s)");return}Q("Are you sure you want to submit ?").then(async D=>{if(D.isConfirmed){const U=v();if(s.setBulkData(U),await s.bulkInsert(r.user.Name),s.isError){W(s.stateError);return}rt("Form has been successfully submitted!","Ok").then(()=>{I(!0)})}})};return(D,U)=>{const h=V("el-button"),$=V("el-dialog"),w=lt("loading");return f(),T($,{title:"Upload Bulk Data",modelValue:l.value,"onUpdate:modelValue":U[1]||(U[1]=g=>l.value=g),"before-close":y,width:"70%","custom-class":"upload-modal"},{footer:d(()=>[u("div",null,[u("span",Le,[o(h,{type:"success",onClick:R},{default:d(()=>[B("Download")]),_:1}),o(h,{type:"primary",onClick:O},{default:d(()=>[B("Upload")]),_:1}),o(h,{type:"success",onClick:y},{default:d(()=>[B("Cancel")]),_:1})])])]),default:d(()=>[be,Te,Y(o(se,{isSubmissionUploadSuccess:n(s).isUploaded,onHandleCloseUploadedFile:y,onHandleUpload:E,onHandleSetIsExcelFileUploaded:c},null,8,["isSubmissionUploadSuccess"]),[[w,n(s).uploadLoading]]),Ee,u("div",ke,[u("div",Ce,[o(Ie,{"list-data":n(s).displayData,page:n(s).pagination.currentPage},null,8,["list-data","page"])])]),n(s).displayData.length>0?(f(),T(St,{key:0,onRaisePageChange:U[0]||(U[0]=g=>x(g)),currentPage:n(s).pagination.currentPage,totalPage:n(s).pagination.totalPage,totalPageSize:n(s).pagination.totalPageSize,startPaginationIndex:n(s).pagination.startPaginationIndex,endPaginationIndex:n(s).pagination.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"])):st("",!0)]),_:1},8,["modelValue"])}}}),Oe=ne(xe,[["__scopeId","data-v-3da5769a"]]),Ae={class:"row g-9 my-4"},Re={class:"dialog-footer"},$e=G({__name:"FilterDialog",props:{visibility:{type:Boolean,default:!1}},emits:["handle-close"],setup(t,{emit:i}){const e=ct(),m=t,r=i,s=dt(m,"visibility"),l=L(()=>e.filterData),v=()=>{S(),e.resetFilter()},S=()=>{r("handle-close",!1)},y=a=>{e.setInterventionStatus(a)},E=a=>{e.setInterventionStatusTo(a)},I=a=>{e.setInterventionStatusDesc(a)},c=a=>{e.setInterventionStatusDescTo(a)},x=a=>{e.setFollowUpPriority(a)},R=a=>{e.setFollowUpPriorityTo(a)},O=a=>{e.setFollowUpPriorityUom(a)},D=a=>{e.setFollowUpPriorityUomTo(a)},U=a=>{e.setStartDate(a)},h=a=>{e.setStartDateTo(a)},$=a=>{e.setEndDate(a)},w=a=>{e.setEndDateTo(a)},g=()=>{const a=e.lastUsedFilterData.interventionStatus!==e.filterData.interventionStatus,P=e.lastUsedFilterData.interventionStatusTo!==e.filterData.interventionStatusTo,k=e.lastUsedFilterData.interventionStatusDesc!==e.filterData.interventionStatusDesc,H=e.lastUsedFilterData.interventionStatusDescTo!==e.filterData.interventionStatusDescTo,p=e.lastUsedFilterData.followUpPriority!==e.filterData.followUpPriority,F=e.lastUsedFilterData.followUpPriorityTo!==e.filterData.followUpPriorityTo,bt=e.lastUsedFilterData.followUpPriorityUom!==e.filterData.followUpPriorityUom,Tt=e.lastUsedFilterData.followUpPriorityUomTo!==e.filterData.followUpPriorityUomTo,Et=e.lastUsedFilterData.startDate!==e.filterData.startDate,kt=e.lastUsedFilterData.startDateTo!==e.filterData.startDateTo,Ct=e.lastUsedFilterData.endDate!==e.filterData.endDate,Lt=e.lastUsedFilterData.endDateTo!==e.filterData.endDateTo;r("handle-close",a||P||k||H||p||F||bt||Tt||Et||kt||Ct||Lt)};return(a,P)=>{const k=V("el-button"),H=V("el-dialog");return f(),T(H,{modelValue:s.value,"onUpdate:modelValue":P[0]||(P[0]=p=>s.value=p),title:"Filter",width:"60%",onClose:P[1]||(P[1]=p=>S())},{footer:d(()=>[u("span",Re,[o(k,{type:"secondary",onClick:v},{default:d(()=>[B("Reset")]),_:1}),o(k,{type:"primary",onClick:g},{default:d(()=>[B("Filter")]),_:1})])]),default:d(()=>[u("div",Ae,[o(J,{"value-from":l.value.interventionStatus,"value-to":l.value.interventionStatusTo,label:"Intervention Status",name:"InterventionStatus",options:n(e).interventionStatusOption,onHandleChangeFrom:y,onHandleChangeTo:E},null,8,["value-from","value-to","options"]),o(J,{"value-from":l.value.interventionStatusDesc,"value-to":l.value.interventionStatusDescTo,label:"Intervention Status Description",name:"interventionStatusDesc",options:n(e).interventionStatusDescOption,onHandleChangeFrom:I,onHandleChangeTo:c},null,8,["value-from","value-to","options"]),o(J,{"value-from":l.value.followUpPriority,"value-to":l.value.followUpPriorityTo,label:"Follow Up Priority",name:"FollowUpPriority",options:n(e).followUpPriorityOption,onHandleChangeFrom:x,onHandleChangeTo:R},null,8,["value-from","value-to","options"]),o(J,{"value-from":l.value.followUpPriorityUom,"value-to":l.value.followUpPriorityUomTo,label:"Follow Up Priority Uom",name:"FollowUpPriorityUom",options:n(e).followUpPriorityUomOption,onHandleChangeFrom:O,onHandleChangeTo:D},null,8,["value-from","value-to","options"]),o(ft,{"value-from":l.value.startDate?l.value.startDate.toString():"","value-to":l.value.startDateTo?l.value.startDateTo.toString():"",label:"Start Date",name:"StartDate",placeholder:"Pick a date",onHandleChangeFrom:U,onHandleChangeTo:h},null,8,["value-from","value-to"]),o(ft,{"value-from":l.value.endDate?l.value.endDate.toString():"","value-to":l.value.endDateTo?l.value.endDateTo.toString():"",label:"End Date",name:"EndDate",placeholder:"Pick a date",onHandleChangeFrom:$,onHandleChangeTo:w},null,8,["value-from","value-to"])])]),_:1},8,["modelValue"])}}}),Ne={class:"grid-icon-buttons d-flex justify-content-between flex-wrap align-items-center"},Be=u("div",{class:"d-flex align-items-center position-relative my-0"},null,-1),Ve={class:"d-flex justify-content-between align-items-center"},He={class:"card"},Me={class:"card-body grid-padding"},qe={class:"my-5"},Za=G({__name:"Index",setup(t){const i=xt(),e=ct(),m=pt(),r=Dt(),s=j(!1),l=j(!1),v=j(!1),S=L(()=>e.displayData),y=L(()=>e.pagination),E=w=>{e.setPage(w)};qt(async()=>{i.dispatch(At.ACTIVE_PAGE,it().meta.parentMenu),Ot("Intervention Status and Follow Up Priority",[{pageName:it().meta.parentMenu,pageRoute:it().meta.parentMenu.toLowerCase()},{pageName:"IronPortal Configuration",pageRoute:"ironlake-config-interventionstatus"},{pageName:"Intervention Status and Follow Up Priority",pageRoute:"ironlake-config-interventionstatus"}]),e.setPage(1),await e.getLookup(),await m.getLookup()}),zt(async()=>{e.resetState(),m.resetState(),r.resetState()});const I=async()=>{await e.setPage(1),await e.getLookup()},c=()=>{s.value=!0,m.setIsEdit(!1),m.setErrors([]),m.resetState()},x=async w=>{s.value=!1,w&&await I()},R=()=>{l.value=!0},O=async w=>{l.value=!1,w&&await I()},D=async()=>{const w=await e.export();re.saveAs(new Blob([w],{type:"application/octet-stream"}),"InterventionStatusandFollowUpPriority.xlsx")},U=()=>{v.value=!0},h=async w=>{v.value=!1,w&&await I()},$=()=>{s.value=!0,m.setErrors([])};return(w,g)=>(f(),A(yt,null,[u("div",Ne,[Be,u("div",Ve,[o(Nt,{onShowDialog:c}),o(Rt,{onShowDialog:R}),o(Vt,{onHandleDownload:D}),o(Bt,{onShowDialog:U})])]),u("div",He,[u("div",Me,[o(Ue,{"list-data":S.value,page:y.value.currentPage,onFetchData:I,onDuplicateData:$},null,8,["list-data","page"])])]),u("div",qe,[n(e).paginationLoading?st("",!0):(f(),T(St,{key:0,onRaisePageChange:g[0]||(g[0]=a=>E(a)),currentPage:y.value.currentPage,totalPage:y.value.totalPage,totalPageSize:y.value.totalPageSize,startPaginationIndex:y.value.startPaginationIndex,endPaginationIndex:y.value.endPaginationIndex},null,8,["currentPage","totalPage","totalPageSize","startPaginationIndex","endPaginationIndex"]))]),o(Fe,{visibility:s.value,onHandleClose:x},null,8,["visibility"]),o($e,{visibility:l.value,onHandleClose:O},null,8,["visibility"]),o(Oe,{visibility:v.value,onHandleClose:h},null,8,["visibility"])],64))}});export{Za as default};

import{k as oe,r as A,p as s,aa as c,F as W,$ as le,aB as e,b4 as X,C as H,A as O,n as et,c as i,s as w,x as q,R as E,u as Z,bd as ye,bb as be,o as De,B as pe,a0 as ie,q as J,b6 as ce,d as Oe,_ as tt,bL as ke,y as xe,a2 as Ce}from"./@vue-BypzYtbH.js";import{_ as ue}from"./nw-img-vue-CR837WER.js";import{n as Me,i as me,A as He}from"./date-format-8-IvfSl3.js";import{_ as Ke}from"./PDFViewerDialog.vue_vue_type_style_index_0_lang-GWz8s3FD.js";import{a as Te,d as Ve}from"./manipulate-html-string-DqTEGh-F.js";import{c as Be,f as _e}from"./index-BuVmIl8K.js";import{s as we}from"./string-to-imageinfo-converter-Cdr1iOkP.js";import{_ as We}from"./FullScreenDialog.vue_vue_type_style_index_0_lang-DXRDt27h.js";import{e as C}from"./lodash-DrHMlsdo.js";import{_ as ze}from"./Confirmation.vue_vue_type_style_index_0_lang-HchphDdZ.js";import{a as at,u as ot}from"./@vueuse-DFoNmIyu.js";import{u as st,_ as lt}from"./ViewOnlyNAReasonDialog-DR-Uz59p.js";import{H as nt,l as Je,p as Pe}from"./helpers-wUOLw-dU.js";import{_ as Ae}from"./ImagePreview.vue_vue_type_style_index_0_lang-DrcOCjy4.js";import{a as it}from"./element-plus-BeWdvTRa.js";import{v as rt,b as dt,f as $e,S as Ie}from"./number-format-BdMuQVyW.js";import{_ as ut}from"./InformationPopUp.vue_vue_type_style_index_0_lang-O2xYF9Pq.js";import{a as ct,b as mt,c as vt,_ as ft}from"./ReferenceInline.vue_vue_type_script_setup_true_lang-DqEUurUl.js";import{_ as ve}from"./Textarea.vue_vue_type_style_index_0_lang-v94SEJmi.js";import{h as pt,s as Ee}from"./urls-CPQ2HRXU.js";import{v as Ye}from"./uuid-SoommWqA.js";import{_ as yt}from"./pdf-DNpyvVEz.js";import{_ as bt}from"./image-close-button-red-B1UxWyBV.js";import{_ as gt}from"./PDFViewerDialog.vue_vue_type_style_index_0_lang-DqiQYePb.js";import{d as ht}from"./pinia-BjOS2_Ao.js";import{d as Re,u as _t,G as kt,f as $t}from"./useComponentInterventionHeaderStore-CbC-c2Z5.js";import{i as Ge}from"./internet-connection-CnLQPjRt.js";import{u as wt}from"./useGlobalConnectionStore-DV9B81de.js";const Dt={class:"d-flex justify-content-between"},xt=["onClick"],Ct=["onClick"],It={key:0,class:"mb-0"},Rt={key:1,class:"mb-0"},Bt=oe({__name:"GroupStepper",props:{groups:{required:!0,type:Object},selectedGroup:{required:!0,type:Object},generalSubmitted:{required:!0,type:Boolean},taskProgress:{required:!0,type:Object},isMonitoring:{type:Boolean,default:!1},countIdentifiedDefect:{type:Number,default:0,required:!1},isApproval:{type:Boolean,default:!1,required:!1}},emits:["groupChange","onGoToOpenRequiredTask"],setup(t,{emit:v}){const a=t,o=v,r=A("fa-chevron-up"),u=A(!0),d=_=>{let g="";return g=_==a.selectedGroup.key?"active":"",a.isMonitoring,g},m=()=>{u.value=!u.value,r.value=u.value?"fa-chevron-up":"fa-chevron-down"},f=_=>{o("groupChange",_)},n=_=>{let g="";const y=b(_.key);if(y.taskTotal>0){const T=_.group!="General",h=y.taskTotal==y.taskDone,D=_.key==a.selectedGroup.key;T&&h&&(g="done-task"),T&&h&&D&&(g="done-task-selected")}return g},R=_=>{if(a.generalSubmitted!==!1&&_.group!="Identified Defects"){if(_.key!=a.selectedGroup.key){o("groupChange",_),et(()=>{o("onGoToOpenRequiredTask",null)});return}o("onGoToOpenRequiredTask",null)}},b=_=>{const g=a.taskProgress.find(y=>y.key==_);return g||{taskDone:0,taskTotal:0}};return(_,g)=>(s(),c("div",Dt,[(s(!0),c(W,null,le(t.groups,(y,T)=>(s(),c("div",{key:y.key,class:X(["d-flex flex-column m-1 mb-3 stepper-button",n(y)]),style:{flex:"1"}},[e("div",{class:X(["box-menu text-center p-2 d-flex justify-content-center align-items-center stepper-title",[d(y.key)]]),onClick:h=>f(y)},[e("span",null,H(y.group=="Identified Defects"&&t.isApproval?"Approval":y.group),1)],10,xt),u.value?(s(),c("div",{key:0,onClick:h=>R(y),class:X(["text-center box-pill rounded-pill mt-2 mb-4 stepper-button-info w-100 py-2 clickable",[T==0?"invisible":"",d(y.key),t.isMonitoring?"normal-cursor":""]])},[y.group=="Identified Defects"?(s(),c("p",It,"Found: "+H(t.countIdentifiedDefect)+" item(s)",1)):(s(),c("p",Rt,"Done "+H(b(y.key).taskDone)+"/"+H(b(y.key).taskTotal),1))],10,Ct)):O("",!0)],2))),128)),e("div",null,[e("button",{class:"border-0 mt-10 align-items-center",onClick:m,style:{background:"transparent"}},[e("em",{class:X(["fa",r.value])},null,2)])])]))}}),_d=ue(Bt,[["__scopeId","data-v-55c3ab4e"]]),re=t=>(ye("data-v-e4f4bb51"),t=t(),be(),t),Tt={class:"equipment-information-intervention mt-5 ps-0"},At=re(()=>e("h4",{class:"subtitle ps-3"},"Equipment Information",-1)),St={class:"p-2 me-0"},Ot={class:"row",style:{width:"101%"}},Vt={class:"col-12 pe-0 pb-2"},Pt={class:"form-floating mb-3"},Nt=["value"],Lt=re(()=>e("label",{for:"floatingInput"},"Unit Number",-1)),Ut={class:"col-12 pe-0 pb-2"},jt={class:"form-floating mb-3"},qt=["value"],Ft=re(()=>e("label",{for:"floatingInput"},"Equipment Model",-1)),Mt={class:"col-12 pe-0 pb-2"},Ht={class:"form-floating mb-3"},Et=["value"],Gt=re(()=>e("label",{for:"floatingInput"},"Location",-1)),Kt={class:"col-12 pe-0 pb-2"},Wt={class:"form-floating mb-3"},zt=["value"],Jt=re(()=>e("label",{for:"floatingInput"},"Condition Rating SMU",-1)),Yt={class:"col-12 pe-0 pb-2"},Qt={class:"form-floating mb-3"},Xt=["value"],Zt=re(()=>e("label",{for:"floatingInput"},"Condition Rating Date",-1)),ea={class:"col-12 pe-0 pb-2"},ta={class:"components-table"},aa=re(()=>e("thead",null,[e("tr",null,[e("th",null,"Component"),e("th",null,"Component Life (hours)"),e("th",null,"BUMA AU Target (hours)"),e("th",null,"Component Life (percentage)")])],-1)),oa=re(()=>e("td",null,"N/A",-1)),sa=re(()=>e("td",null,"N/A",-1)),la={class:"col-12 pe-0 pb-2"},na={class:"form-floating mb-3"},ia=["value"],ra=re(()=>e("label",{for:"floatingInput"},"Follow-up Priority",-1)),da={class:"col-12 pe-0 pb-2"},ua={class:"form-floating mb-3"},ca=["value"],ma=re(()=>e("label",{for:"floatingInput"},"SMU Due",-1)),va={class:"col-12 pe-0 pb-2"},fa={class:"form-floating mb-3"},pa=["value"],ya=re(()=>e("label",{for:"floatingInput"},"Est. Completion Date",-1)),ba={class:"col-12 pe-0 pb-2"},ga={class:"form-floating mb-3"},ha=["value"],_a=re(()=>e("label",{for:"floatingInput"},"SAP Work Order",-1)),ka={class:"col-12 pe-0 pb-2"},$a={class:"form-floating mb-3"},wa={class:"form-control"},Da=["innerHTML"],xa=re(()=>e("label",{for:"floatingInput"},"Intervention Reason",-1)),Ca={class:"col-12 pe-0 pb-2"},Ia={class:"form-floating mb-3"},Ra={class:"form-control"},Ba=["innerHTML"],Ta=re(()=>e("label",{for:"floatingInput"},"Intervention Description",-1)),Aa=oe({__name:"CardEquipmentInformation",props:{defaultAccordionOpen:{type:Boolean,required:!1,default:!0},intervention:{type:Object,required:!0}},setup(t){const v=t,a=A(v.defaultAccordionOpen?"Equipment Information":""),o=i(()=>{let u=[];return!v.intervention.components||v.intervention.components.length<1?u.push({componentId:v.intervention.componentId,componentCode:v.intervention.componentCode,componentDescription:v.intervention.componentDescription,componentHm:v.intervention.componentHm,componentTarget:void 0}):u=v.intervention.components,u}),r=u=>{const f=(+u.componentHm/u.componentTarget).toString().match(/^-?\d+(?:\.\d{0,2})?/);return f?(+f[0]*100).toFixed():""};return(u,d)=>{const m=E("el-collapse-item"),f=E("el-collapse");return s(),c("div",Tt,[w(f,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=n=>a.value=n),class:"general-accordion task-group py-1 px-5 mb-3"},{default:q(()=>[w(m,{name:"Equipment Information"},{title:q(()=>[At]),default:q(()=>[e("div",St,[e("div",Ot,[e("div",Vt,[e("div",Pt,[e("input",{type:"text",class:"form-control",disabled:"",value:t.intervention.equipment},null,8,Nt),Lt])]),e("div",Ut,[e("div",jt,[e("input",{type:"text",class:"form-control",disabled:"",value:t.intervention.equipmentModel},null,8,qt),Ft])]),e("div",Mt,[e("div",Ht,[e("input",{type:"text",class:"form-control",disabled:"",value:t.intervention.sitedesc},null,8,Et),Gt])]),e("div",Kt,[e("div",Wt,[e("input",{type:"text",class:"form-control",disabled:"",value:t.intervention.smu},null,8,zt),Jt])]),e("div",Yt,[e("div",Qt,[e("input",{type:"text",class:"form-control",disabled:"",value:Z(Me)(t.intervention.sampleDate)},null,8,Xt),Zt])]),e("div",ea,[e("table",ta,[aa,e("tbody",null,[(s(!0),c(W,null,le(o.value,n=>(s(),c("tr",{key:n.componentId},[e("td",null,H(n.componentDescription),1),e("td",null,H((+n.componentHm).toFixed()),1),n.componentTarget?(s(),c(W,{key:0},[e("td",null,H((+n.componentTarget).toFixed()),1),e("td",null,H(r(n))+"%",1)],64)):(s(),c(W,{key:1},[oa,sa],64))]))),128))])])]),e("div",la,[e("div",na,[e("input",{type:"text",class:"form-control",disabled:"",value:`${t.intervention.followUpPriority} ${t.intervention.followUpPriorityUom}`},null,8,ia),ra])]),e("div",da,[e("div",ua,[e("input",{type:"text",class:"form-control",disabled:"",value:t.intervention.smuDue},null,8,ca),ma])]),e("div",va,[e("div",fa,[e("input",{type:"text",class:"form-control",disabled:"",value:t.intervention.estimationCompletionDate?Z(Me)(t.intervention.estimationCompletionDate):""},null,8,pa),ya])]),e("div",ba,[e("div",ga,[e("input",{type:"text",class:"form-control",disabled:"",value:t.intervention.sapWorkOrder},null,8,ha),_a])]),e("div",ka,[e("div",$a,[e("div",wa,[e("pre",{class:"pre-class",innerHTML:t.intervention.interventionReason??""},null,8,Da)]),xa])]),e("div",Ca,[e("div",Ia,[e("div",Ra,[e("pre",{class:"pre-class",innerHTML:t.intervention.interventionDiagnosis??""},null,8,Ba)]),Ta])])])])]),_:1})]),_:1},8,["modelValue"])])}}}),kd=ue(Aa,[["__scopeId","data-v-e4f4bb51"]]),Sa={class:"mt-5 ps-0"},Oa={class:"p-2"},Va={class:"p-2 bg-green flex-fill"},Pa=["innerHTML"],$d=oe({__name:"CardSafetyPrecautions",props:{tasks:{required:!0,type:Array}},setup(t){const v=m=>Te(m).replaceAll("{BLOB_URL}","https://digitaldevbumaausta001.blob.core.windows.net"),a=A("Safety Precautions"),o=A(),r=A(!1),u=A(""),d=()=>{r.value=!1};return De(()=>{try{if(!o.value)return}catch(m){console.log(m)}}),(m,f)=>{const n=E("NwImg"),R=E("el-collapse-item"),b=E("el-collapse");return s(),c(W,null,[e("div",Sa,[w(b,{modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=_=>a.value=_),class:"task-group general-accordion py-1 px-5 mb-3"},{default:q(()=>[w(R,{title:"Safety Precautions",name:"Safety Precautions"},{default:q(()=>[(s(!0),c(W,null,le(t.tasks,(_,g)=>(s(),c("div",{key:_.key,class:X(["d-flex justify-content-start",g==t.tasks.length-1?"mb-5":""])},[e("div",Oa,[w(n,{src:"/media/logos/bumaau/cautions.png",alt:"cautions"})]),e("div",Va,[_.items[1].taskType!="html"?(s(),c(W,{key:0},[pe(H(_.items[1].value),1)],64)):(s(),c("span",{key:1,ref_for:!0,ref_key:"safetyPrecautinsHtml",ref:o,innerHTML:v(_.items[1].value)},null,8,Pa))])],2))),128))]),_:1})]),_:1},8,["modelValue"])]),w(Ke,{show:r.value,onHandleCloseModal:d,"blob-url":u.value},null,8,["show","blob-url"])],64)}}}),Na={class:"row my-4"},La={style:{"font-size":"10px","font-weight":"600"}},Ua={class:"bg-secondary"},ja=["src","onClick"],qa={style:{"font-size":"10px",display:"block","text-align":"right"}},Fa=oe({__name:"ImagePreviewWithTimestampIntervention",props:{visibility:{type:Boolean,required:!1},images:{type:Array,required:!0}},emits:["onClose","onDelete","onDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=A([]),u=ie(a,"visibility"),d=A(0),m=A([]),f=A([]),n=A([]),R=A(""),b=A(!1),_=(p,x)=>{let I=a.images.filter(P=>P.updatedBy.id==p);return I=C.orderBy(I,["imageType","updatedDate"],["desc","asc"]),I.findIndex(P=>P.image.filename==x)==0?"Front Page":"Back Page"},g=()=>{R.value="",b.value=!1},y=p=>{var I;if(r.value.length<1)return;let x;do x=(I=r.value.find(K=>K.key==p))==null?void 0:I.value;while(!x);return x},T=()=>{u.value=!1,o("onClose",null)},h=()=>{if(!a.images)return;const p=a.images.map(x=>x.image);n.value=we(p).map(x=>({imgBlob:x.filename,url:"",description:x.description}))},D=async()=>{if(h(),d.value=0,r.value=[],!a.images)return;const p=a.images.map(I=>I.image);f.value=we(p),m.value=Array.apply(null,Array(a.images.length)).map(function(){return!0});const x=f.value.length;for(let I=d.value;I<x;I++){const K=f.value[I].filename;await S(K,I)}},S=async(p,x)=>{const I={fileUrl:p,ver:"v1"};try{const K=`https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/attachment/download_by_url?${new URLSearchParams(I).toString()}`,P=await Be.getBlob(K),$=new Blob([P.data]);let j=window.URL||window.webkitURL;r.value.push({key:p,value:j.createObjectURL($)}),n.value.forEach(te=>{te.imgBlob==p&&(te.url=j.createObjectURL($))}),m.value[x]=!1}catch(K){console.log("image",K)}},M=p=>{const x=n.value.findIndex(I=>I.imgBlob==p);if(x>0){const I=n.value.slice(x),K=n.value.slice(0,x);n.value=[...I,...K]}R.value=p,b.value=!0};return(p,x)=>{const I=E("el-skeleton-item"),K=E("el-skeleton"),P=E("el-dialog");return s(),c(W,null,[w(P,{modelValue:u.value,"onUpdate:modelValue":x[0]||(x[0]=$=>u.value=$),title:"Detailed picture",width:"80%",onOpened:D,onClose:T},{default:q(()=>[e("div",Na,[(s(!0),c(W,null,le(f.value,($,j)=>(s(),c("div",{key:$.filename,class:"col-md-3 fv-row fv-plugins-icon-container p-2 rounded position-relative"},[w(K,{loading:m.value[j],animated:""},{template:q(()=>[w(I,{variant:"image",class:"w-100 rounded",style:{height:"200px","object-fit":"fill"}})]),default:q(()=>[e("span",La,H(_(t.images[j].updatedBy.id,$.filename)),1),e("div",Ua,[y($.filename)!=null?(s(),c("img",{key:0,src:y($.filename),class:"w-100 rounded",style:{height:"200px","object-fit":"contain",cursor:"pointer"},alt:"images",onClick:te=>M($.filename)},null,8,ja)):O("",!0)]),e("span",qa,H(`${t.images[j].updatedBy.name}, ${t.images[j].updatedDate}`),1)]),_:2},1032,["loading"])]))),128))])]),_:1},8,["modelValue"]),w(We,{images:n.value,visibility:b.value,"new-version":!0,image:R.value,onHandleClose:g},null,8,["images","visibility","image"])],64)}}}),Se=t=>(ye("data-v-ac130fdb"),t=t(),be(),t),Ma=Se(()=>e("span",{class:"el-dialog__title",style:{"word-break":"break-word !important","font-size":"18px !important"}},"Detailed picture of Pre-Task Risk Assessment Form",-1)),Ha={class:"row d-flex flex-column"},Ea={key:0,class:"photo-wrapper"},Ga=Se(()=>e("span",{class:"sub-title"},[e("strong",null,"Front Page")],-1)),Ka={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center"}},Wa={class:"d-flex justify-content-center"},za={style:{position:"relative",width:"fit-content"}},Ja=["src"],Ya={class:"timestampp"},Qa=Se(()=>e("div",{class:"my-2"},null,-1)),Xa={key:1,class:"photo-wrapper"},Za=Se(()=>e("span",{class:"sub-title"},[e("strong",null,"Back Page")],-1)),eo={class:"my-2",style:{"object-fit":"contain",cursor:"pointer","text-align":"center",position:"relative"}},to={class:"d-flex justify-content-center"},ao={style:{position:"relative",width:"fit-content"}},oo=["src"],so={class:"timestampp"},lo=oe({__name:"ImagePreviewPreriskIntervention",props:{visibility:{type:Boolean,required:!1},images:{type:Array,required:!0},viewOnly:{type:Boolean,default:!0}},emits:["onClose","onDelete"],setup(t,{expose:v,emit:a}){const o=t,r=a,u=A([]),d=ie(o,"visibility"),m=A(0),f=A(!1),n=A(!1),R=at("(min-width: 1000px)"),b=A(!1),_=A(""),g=A(!1),y=A(),T=A(),h=A(),D=A([]);i(()=>we(o.images.map(L=>L.image)));const S=i(()=>R.value?"70%":"90%"),M=async()=>{T.value=o.images.find(L=>L.imageType=="front"),T.value||(T.value=o.images.find(L=>!L.imageType)),T.value&&await j(typeof T.value.image=="string"?T.value.image:T.value.image.filename)},p=async()=>{h.value=o.images.find(L=>L.imageType=="back"),!h.value&&o.images.length>0&&(h.value=o.images.find(L=>{var V;return L.image.filename!=((V=T.value)==null?void 0:V.image).filename})),h.value&&await te(typeof h.value.image=="string"?h.value.image:h.value.image.filename)},x=L=>`${L.updatedBy.name}, ${L==null?void 0:L.updatedDate}`,I=L=>{var G;if(u.value.length<1)return;let V;do V=(G=u.value.find(ae=>ae.key==L))==null?void 0:G.value;while(!V);return V},K=()=>{d.value=!1,r("onClose",null)},P=()=>{if(!o.images)return;const L=o.images.map(V=>V.image);D.value=we(L).map(V=>({imgBlob:V.filename,url:"",description:V.description}))},$=()=>{P(),m.value=0,u.value=[],o.images&&(M(),p())},j=async L=>{f.value=!0,await k(L)||await B(L),f.value=!1},te=async L=>{n.value=!0,await k(L)||await B(L),n.value=!1},B=async L=>{const V={fileUrl:L,ver:"v1"};try{const G=`https://digital-bumaau-dev-apm-001.azure-api.net/dinspect/api/attachment/download_by_url?${new URLSearchParams(V).toString()}`,ae=await Be.getBlob(G);l(ae.data,L)}catch(G){console.log("image",G)}},l=(L,V)=>{const G=new Blob([L]);let ae=window.URL||window.webkitURL;u.value.push({key:V,value:ae.createObjectURL(G)}),D.value.forEach(ne=>{ne.imgBlob==V&&(ne.url=ae.createObjectURL(G))})},k=async L=>{const V=await _e.pendingTaskFile.where({filename:L}).first();return V?(l(V.blob,L),!0):!1},Y=L=>{const V=D.value.findIndex(G=>G.imgBlob==L);if(V>0){const G=D.value.slice(V),ae=D.value.slice(0,V);D.value=[...G,...ae]}_.value=L,b.value=!0},se=()=>{_.value="",b.value=!1},Q=L=>{g.value=!0,y.value=L},z=()=>{g.value=!1},N=()=>{y.value&&(r("onDelete",typeof y.value.image=="string"?y.value.image:y.value.image.filename),y.value.imageType=="front"?T.value=void 0:h.value=void 0,y.value=void 0,g.value=!1)};return v({openFirstReRender:()=>{$()}}),(L,V)=>{const G=E("el-skeleton-item"),ae=E("NwImg"),ne=E("el-skeleton"),fe=E("el-dialog");return s(),c(W,null,[w(fe,{modelValue:d.value,"onUpdate:modelValue":V[4]||(V[4]=de=>d.value=de),title:"Detailed picture of Pre-Task Risk Assessment Form",width:S.value,onOpened:$,onOpen:$,onClose:K},{title:q(()=>[Ma]),default:q(()=>[e("div",Ha,[T.value?(s(),c("div",Ea,[Ga,w(ne,{loading:f.value,animated:""},{template:q(()=>[w(G,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:q(()=>[e("div",Ka,[e("div",Wa,[e("div",za,[t.viewOnly?O("",!0):(s(),J(ae,{key:0,onClick:V[0]||(V[0]=de=>Q(T.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),I(T.value.image.filename)!=null?(s(),c("img",{key:1,src:I(T.value.image.filename),style:{height:"auto","max-width":"700px"},alt:"images",onClick:V[1]||(V[1]=de=>Y(T.value.image.filename)),class:"front"},null,8,Ja)):O("",!0)])]),e("div",Ya,H(x(T.value)),1)])]),_:1},8,["loading"])])):O("",!0),Qa,h.value?(s(),c("div",Xa,[Za,w(ne,{loading:n.value,animated:""},{template:q(()=>[w(G,{variant:"image",class:"w-100 rounded",style:{height:"450px",width:"auto"}})]),default:q(()=>[e("div",eo,[e("div",to,[e("div",ao,[t.viewOnly?O("",!0):(s(),J(ae,{key:0,onClick:V[2]||(V[2]=de=>Q(h.value)),class:"delete-image-button",src:"/media/svg/dma/image-close-button-red.png"})),I(h.value.image.filename)!=null?(s(),c("img",{key:1,src:I(h.value.image.filename),style:{height:"auto","max-width":"700px"},alt:"images",class:"back",onClick:V[3]||(V[3]=de=>Y(h.value.image.filename))},null,8,oo)):O("",!0)])]),e("div",so,H(x(h.value)),1)])]),_:1},8,["loading"])])):O("",!0)])]),_:1},8,["modelValue","width"]),w(ze,{visibility:g.value,caption:"Are you sure want to delete this image?",onOnNoConfirm:z,onOnYesConfirm:N},null,8,["visibility"]),w(We,{images:D.value,visibility:b.value,"new-version":!0,image:_.value,onHandleClose:se},null,8,["images","visibility","image"])],64)}}}),no=ue(lo,[["__scopeId","data-v-ac130fdb"]]),io=t=>(ye("data-v-12cccd5d"),t=t(),be(),t),ro={class:"mt-5 ps-0"},uo={class:"row vcp mx-0 py-4 d-flex justify-content-between me-3 risk-assessment-title"},co=io(()=>e("div",{class:"col title ps-6"},[pe("Take photo of completed Pre-Task Risk Assessment Form "),e("span",{class:"text-danger"},"(required)"),pe(".")],-1)),mo={class:"col-2 col-md-1"},vo={class:"row justify-content-center"},fo={class:"px-0 col-6"},po=["disabled"],yo={key:0,class:"col-6 ps-0 pe-1"},bo={class:"text-white"},go=oe({__name:"CardRiskAssesment",props:{intervention:{required:!0,type:Object},generalSubmitted:{required:!0,type:Boolean},fitter:{required:!0,type:Object},fitterPhotos:{required:!0,type:Array},reRender:{type:Boolean,default:!1},isMonitoring:{type:Boolean,default:!1}},emits:["onCameraClicked","onPreviewClicked","onImageDownloaded","onImageDeleted"],setup(t,{expose:v,emit:a}){const o=t,r=a,u=A(!1),d=A(),m=i(()=>o.generalSubmitted||!o.fitter),f=i(()=>o.isMonitoring?o.fitterPhotos:o.fitterPhotos.filter(g=>{var y;return g.updatedBy.id==((y=o.fitter)==null?void 0:y.id)})),n=()=>{r("onPreviewClicked",o.fitterPhotos.length),u.value=!0},R=()=>{u.value=!1},b=g=>{r("onImageDeleted",g)};return v({reRender:()=>{setTimeout(()=>{var g;(g=d.value)==null||g.openFirstReRender()},2e3)}}),(g,y)=>{var h,D;const T=E("NwImg");return s(),c(W,null,[e("div",ro,[e("div",uo,[co,e("div",mo,[e("div",vo,[e("div",fo,[e("button",{class:"btn btn-sm btn-icon btn-bg-light",style:{cursor:"default"},disabled:m.value},[((h=f.value)==null?void 0:h.length)==1?(s(),J(T,{key:0,src:"/media/svg/dma/camera/e-form/png/cam-user.png",style:{height:"12px",width:"14px"},alt:"camera"})):((D=f.value)==null?void 0:D.length)==2?(s(),J(T,{key:1,src:"/media/svg/dma/camera/e-form/png/cam-read.png",style:{height:"12px",width:"14px"},alt:"camera"})):(s(),J(T,{key:2,src:"/media/svg/dma/camera/e-form/png/cam-active.png",style:{height:"12px",width:"14px"},alt:"camera"}))],8,po)]),f.value&&f.value.length>0?(s(),c("div",yo,[e("button",{class:"btn btn-sm btn-icon btn-bg-success",style:{"background-color":"#18AF4A"},onClick:n},[e("label",bo,"+"+H(f.value.length),1)])])):O("",!0)])])])]),t.isMonitoring?(s(),J(Fa,{key:0,images:f.value,visibility:u.value,onOnClose:R},null,8,["images","visibility"])):(s(),J(no,{key:1,ref_key:"preview",ref:d,images:f.value,visibility:u.value,"view-only":!1,onOnClose:R,onOnDelete:b},null,8,["images","visibility"]))],64)}}}),wd=ue(go,[["__scopeId","data-v-12cccd5d"]]),ho=["innerHTML"],_o=oe({__name:"LabelItem",props:{item:{type:Object,required:!0},task:{type:Object,required:!0}},setup(t){const v=t,a=i(()=>v.item.style!=null),o=i(()=>v.item.style),r=i(()=>a.value&&o.value.border!=null),u=i(()=>o.value.border),d=i(()=>a.value&&o.value.borderRadius!=null),m=i(()=>o.value.borderRadius),f=i(()=>v.task.updatedBy!=""),n=i(()=>Te(v.item.value)),R=i(()=>{let y="";return a.value&&(o.value.potraitBreakPoint&&o.value.breakPoint!="none"&&(y=`col-md-${o.value.potraitBreakPoint}`),y=`${y} col-lg-${o.value.breakPoint}`),y}),b=i(()=>{let y="";if(v.item.style&&v.item.style.textAlign)switch(v.item.style.textAlign){case"left":y="text-start";break;case"right":y="text-end";break;default:y="text-center"}return y}),_=i(()=>f.value?"":"pb-2"),g=i(()=>{const y=a.value&&o.value.bgColor!="none"?`background-color: ${o.value.bgColor}; `:"",T=a.value&&o.value.fontColor!="none"?`color: ${o.value.fontColor}; `:"",h=r.value&&u.value.top!="none"?`border-top: ${u.value.top}; `:"",D=r.value&&u.value.right!="none"?`border-right: ${u.value.right}; `:"";let S=r.value&&u.value.bottom!="none"?`border-bottom: ${u.value.bottom}; margin-bottom: 1rem;`:"",M=0;v.task.items.forEach($=>{r.value?(u.value.right=="none"&&(M=M+Number(o.value.breakPoint)),C.isEqual($,C.last(v.task.items))&&(M=M+Number(o.value.breakPoint))):r.value||(M=M+Number(o.value.breakPoint))}),M==12&&(S=f.value&&a.value&&!r.value&&u.value.bottom!="none"?`border-bottom: ${u.value.bottom}; margin-bottom: 1rem; `:"");const p=r.value&&u.value.left!="none"?`border-left: ${u.value.left}; `:"",x=d.value&&m.value.topRight!="none"?`border-top-right-radius: ${m.value.topRight}; `:"",I=d.value&&m.value.bottomRight!="none"?`border-bottom-right-radius: ${m.value.bottomRight}; `:"",K=d.value&&m.value.topLeft!="none"?`border-top-left-radius: ${m.value.topLeft}; `:"",P=d.value&&m.value.bottomLeft!="none"?`border-bottom-left-radius: ${m.value.bottomLeft}; `:"";return`${y}${T}${h}${D}${S}${p}${x}${I}${K}${P}`});return(y,T)=>(s(),c("div",{class:X([[b.value,R.value,_.value],"px-2 pt-2"]),style:ce(g.value)},[e("label",{innerHTML:n.value},null,8,ho)],6))}}),ko={key:0,class:"text-danger ps-2 font-weight-bold"},$o={key:1,class:"d-flex align-items-center"},wo=e("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[e("span",{class:"sr-only"},"Loading...")],-1),Do={key:2,class:"d-flex align-items-center"},xo=e("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[e("span",{class:"sr-only"},"Loading...")],-1),Co=e("span",null,"Loading...",-1),Io=[xo,Co],Ro=oe({__name:"InputItem",props:{item:{type:Object,required:!0},task:{type:Object,required:!0},currentFitter:{type:Object,required:!0},validation:{type:String,required:!0},loadingIndicator:{type:Boolean,required:!0},loadingCommentIndicator:{type:Boolean,required:!0},itemTriggerDisabledValue:{required:!0,type:Object},isDisabled:{required:!0,type:Boolean},isReadOnly:{type:Boolean,default:!1},currInputTyped:{type:String,default:""},generalSubmitted:{required:!0,type:Boolean}},emits:["onInputChanged"],setup(t,{emit:v}){var z;const a=t,o=v,r=ie(a,"item"),u=A(""),d=A(a.task.category=="CBM-NORMAL"?"Updating...":"Calculating...");let m=!1;const f=a.item.valueType=="int",n=(z=a.item.customValidation)==null?void 0:z.toLowerCase().includes("percentage"),R=a.item.categoryItemType=="paramRating"||a.item.categoryItemType=="paramRatingDynamic",b=i(()=>a.item.style!=null),_=i(()=>a.item.style),g=i(()=>b.value&&_.value.border!=null),y=i(()=>_.value.border),T=i(()=>b.value&&_.value.borderRadius!=null),h=i(()=>_.value.borderRadius),D=i(()=>a.task.updatedBy!=""),S=i(()=>b.value&&_.value.breakPoint!="none"?`col-${_.value.breakPoint}`:"col"),M=i(()=>{let N="";return b.value&&(_.value.potraitBreakPoint&&_.value.breakPoint!="none"&&(N=`col-md-${_.value.potraitBreakPoint}`),N=`${N} col-lg-${_.value.breakPoint}`),N}),p=i(()=>D.value?"":"pb-2"),x=i(()=>{var Ue,je,qe,Fe;const N=b.value&&_.value.bgColor!="none"?`background-color: ${_.value.bgColor}; `:"",F=b.value&&_.value.fontColor!="none"?`color: ${_.value.fontColor}; `:"",L=g.value&&y.value.top!="none"?`border-top: ${y.value.top}; `:"",V=g.value&&y.value.right!="none"?`border-right: ${y.value.right}; `:"";let G=g.value&&((Ue=y.value)==null?void 0:Ue.bottom)!="none"?`border-bottom: ${(je=y.value)==null?void 0:je.bottom}; margin-bottom: 4px;`:"",ae=0;a.task.items.forEach(Ze=>{g.value?(y.value.right=="none"||C.isEqual(Ze,C.last(a.task.items)))&&(ae=ae+Number(_.value.breakPoint)):ae=ae+Number(_.value.breakPoint)}),ae==12&&(G=D.value&&b.value&&!g.value&&((qe=y.value)==null?void 0:qe.bottom)!="none"?`border-bottom: ${(Fe=y.value)==null?void 0:Fe.bottom}; margin-bottom: 4px; `:"");const ne=g.value&&y.value.left!="none"?`border-left: ${y.value.left}; `:"",fe=T.value&&h.value.topRight!="none"?`border-top-right-radius: ${h.value.topRight}; `:"",de=T.value&&h.value.bottomRight!="none"?`border-bottom-right-radius: ${h.value.bottomRight}; `:"",U=T.value&&h.value.topLeft!="none"?`border-top-left-radius: ${h.value.topLeft}; `:"",he=T.value&&h.value.bottomLeft!="none"?`border-bottom-left-radius: ${h.value.bottomLeft}; `:"";return`${N}${F}${L}${V}${G}${ne}${fe}${de}${U}${he}`}),I=i(()=>{let N="Please Input Value";return b.value&&_.value.placeholder!=null&&(N=_.value.placeholder),N}),K=i(()=>{if(a.isReadOnly||!a.generalSubmitted)return!0;const N=a.item.categoryItemType=="targetRating";let F=!0;return a.currentFitter&&(a.task.taskValue!=""&&a.task.updatedBy.id!=a.currentFitter.id&&(F=!1),a.item.categoryItemType=="paramRating"&&(F=!0)),N||!F}),P=A(!1),$=A(""),j=i(()=>a.validation);Oe(j,N=>{if($.value)return;const F=r.value.key==a.currInputTyped;N&&F&&($.value=N,P.value=!0)});const te=i(()=>{if(a.isReadOnly||!a.generalSubmitted)return!0;let N=!1;const F=a.item.categoryItemType;(F=="targetRating"||F=="resultParamRating")&&(N=!0);let L=!1;F=="paramRatingDynamic"&&a.task.items.forEach(de=>{de.itemType=="dropDown"&&de.categoryItemType=="dropdownTool"&&de.value==""&&(L=!0)});let V=!1;a.item.disabledByItemKey&&a.itemTriggerDisabledValue&&a.itemTriggerDisabledValue[a.item.disabledByItemKey]=="4"&&(V=!0);let G=!1;const ae=a.task.rating=="AUTOMATIC_REPLACEMENT"||a.task.rating=="AUTOMATIC_REPLACEMENT_GAP",ne=a.task.taskNormalValue=="1"||a.task.taskNormalValue=="2",fe=a.item.categoryItemType=="paramRating";return ae&&!ne&&fe&&(G=!0),N||L||V||a.isDisabled||G}),B=i(()=>{if(a.task.category=="NORMAL"&&a.task.rating=="NO")return"";const N=a.item.value.replaceAll("'","");let F;return N=="A"||N=="In spec"?F="a":N=="B"?F="b":N=="C"?F="c":(N=="X"||N=="Out of spec")&&(F="x"),F}),l=i(()=>{let N="text";return(f||n)&&(N="numeric"),N}),k=A(),Y=N=>{if(f||n||R){const F=N.which?N.which:N.keyCode;if((F<48||F>57)&&(F!==46||N.target.value.indexOf(".")!==-1)&&N.preventDefault(),N.target.value.includes(".")?N.target.value.split(".")[0].length>=5&&N.target.value.split(".")[1].length>=2&&N.preventDefault():N.target.value.length>=5&&F!==46&&N.preventDefault(),F==13){k.value.blur();return}}},se=N=>{if(!N.target.value&&u.value==N.target.value||(m&&($.value="",P.value=!1),m=!1,K.value))return;const F=typeof N=="string"?N:N.target.value;let L=F.indexOf(".")>=0?F.substr(0,F.indexOf("."))+F.substr(F.indexOf("."),3):F;if(F){const V={};V.employee=a.currentFitter,V.taskKey=a.task.key,V.taskCategory=a.task.category,V.itemKey=a.item.key,V.type=a.item.valueItemType,f||n||R?V.value=String(parseFloat(L)):V.value=L,V.timeStamp=me(),V.task=a.task,o("onInputChanged",V,()=>{u.value=V.value},()=>{r.value.value=u.value})}else r.value.value=u.value},Q=()=>{m=!0};return De(()=>{u.value=r.value.value}),Oe(r,C.debounce(N=>{const F=a.task.rating=="AUTOMATIC_REPLACEMENT"||a.task.rating=="AUTOMATIC_REPLACEMENT_GAP",L=a.item.categoryItemType=="paramRating",V=u.value!=N.value;if(r.value.key!=localStorage.getItem("itemKey")){let ne=!0;if(F&&L&&V&&!m&&(ne=!1),ne)return}const G={};G.employee=a.currentFitter,G.taskKey=a.task.key,G.taskCategory=a.task.category,G.itemKey=a.item.key,G.type=a.item.valueItemType,G.value=N.value,G.timeStamp=me(),G.task=a.task;const ae=a.task.items.find(ne=>ne.valueItemType=="inputUom");if(ae)G.cbmMeasurement=ae.value;else{const ne=a.task.items[2];G.cbmMeasurement=ne?ne.value:""}F&&L&&V?o("onInputChanged",G,()=>{u.value=N.value},()=>{r.value.value=u.value}):o("onInputChanged",G),localStorage.removeItem("itemKey")},500),{deep:!0}),(N,F)=>{const L=E("el-input");return s(),c("div",{class:X([[M.value,S.value,p.value],"px-2 pt-2 input-eform-status"]),style:ce(x.value)},[w(L,{ref_key:"cbmInput",ref:k,class:X([B.value]),modelValue:r.value.value,"onUpdate:modelValue":F[0]||(F[0]=V=>r.value.value=V),size:"small",placeholder:I.value,readonly:K.value,onKeypress:Y,onFocusout:se,onFocusin:Q,inputmode:l.value,disabled:te.value},null,8,["class","modelValue","placeholder","readonly","inputmode","disabled"]),P.value?(s(),c("label",ko,H($.value),1)):O("",!0),t.loadingIndicator?(s(),c("div",$o,[wo,e("span",null,H(d.value),1)])):O("",!0),t.loadingCommentIndicator?(s(),c("div",Do,Io)):O("",!0)],6)}}}),Ne=t=>(ye("data-v-b42eaba2"),t=t(),be(),t),Bo={class:"px-0 mx-0 d-flex"},To=["innerHTML"],Ao=["innerHTML"],So={key:0,class:"ms-2"},Oo={key:1,class:"ms-2"},Vo=Ne(()=>e("img",{src:lt,alt:"ok",class:"d-icon"},null,-1)),Po=[Vo],No={key:0,class:"ms-1 d-flex align-items-center"},Lo=Ne(()=>e("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[e("span",{class:"sr-only"},"Loading...")],-1)),Uo=Ne(()=>e("span",null,"Loading...",-1)),jo=[Lo,Uo],qo=oe({__name:"DropdownItem",props:{item:{type:Object,required:!0},task:{type:Object,required:!0},currentFitter:{type:Object,required:!0},validation:{type:String,required:!0},loadingIndicator:{type:Boolean,required:!0},itemTriggerDisabledValue:{required:!0,type:Object},isReadOnly:{type:Boolean,default:!1},generalSubmitted:{required:!0,type:Boolean}},emits:["onTaskChanged","onDefectView"],setup(t,{emit:v}){const a=t,o=v,r=A(!1),u=ie(a,"task"),d=st(),m=i({get:()=>a.item.value.toString().replaceAll("'",""),set:l=>{const k={};if(k.employee=a.currentFitter,k.taskKey=a.task.key,k.taskCategory=a.task.category,k.itemKey=a.item.key,k.type=a.item.valueItemType,k.value=l,k.timeStamp=me(),k.task=u.value,a.task.category=="CBM-NORMAL"){const Y=C.find(a.task.items,{valueItemType:"inputUom"});if(Y){const se=C.findIndex(a.task.items,{valueItemType:"inputUom"});k.uomValue=a.task.items[se+1].value,k.cbmMeasurement=Y.value}}o("onTaskChanged",k)}}),f=i(()=>a.item.style!=null),n=i(()=>a.item.style),R=i(()=>f.value&&n.value.border!=null),b=i(()=>n.value.border),_=i(()=>f.value&&n.value.borderRadius!=null),g=i(()=>n.value.borderRadius),y=i(()=>a.task.updatedBy!=""),T=i(()=>f.value&&n.value.breakPoint!="none"?`col-${n.value.breakPoint}`:"col"),h=i(()=>{let l="";return f.value&&(n.value.potraitBreakPoint&&n.value.breakPoint!="none"&&(l=`col-md-${n.value.potraitBreakPoint}`),l=`${l} col-lg-${n.value.breakPoint}`),l}),D=i(()=>y.value?"":"pb-2"),S=i(()=>{const l=f.value&&n.value.bgColor!="none"?`background-color: ${n.value.bgColor}; `:"",k=f.value&&n.value.fontColor!="none"?`color: ${n.value.fontColor}; `:"",Y=R.value&&b.value.top!="none"?`border-top: ${b.value.top}; `:"",se=R.value&&b.value.right!="none"?`border-right: ${b.value.right}; `:"";let Q=R.value&&b.value.bottom!="none"?`border-bottom: ${b.value.bottom}; margin-bottom: 4px;`:"",z=0;a.task.items.forEach(ae=>{R.value?(b.value.right=="none"||C.isEqual(ae,C.last(a.task.items)))&&(z=z+Number(n.value.breakPoint)):z=z+Number(n.value.breakPoint)}),z==12&&(Q=y.value&&f.value&&!R.value&&b.value&&b.value.bottom!="none"?`border-bottom: ${b.value.bottom}; margin-bottom: 4px; `:"");const N=R.value&&b.value.left!="none"?`border-left: ${b.value.left}; `:"",F=_.value&&g.value.topRight!="none"?`border-top-right-radius: ${g.value.topRight}; `:"",L=_.value&&g.value.bottomRight!="none"?`border-bottom-right-radius: ${g.value.bottomRight}; `:"",V=_.value&&g.value.topLeft!="none"?`border-top-left-radius: ${g.value.topLeft}; `:"",G=_.value&&g.value.bottomLeft!="none"?`border-bottom-left-radius: ${g.value.bottomLeft}; `:"";return`${l}${k}${Y}${se}${Q}${N}${F}${L}${V}${G}`}),M=i(()=>{let l="Choose One";return f.value&&n.value.placeholder!=null&&(l=n.value.placeholder),l}),p=i(()=>nt(a.task.updatedBy||"",a.currentFitter)),x=i(()=>{if(a.isReadOnly||!a.generalSubmitted)return!0;let l=!1,k=!0;p.value||(a.item.value=="3"&&a.item.valueItemType=="condition"?k=!0:k=!1);const Y=a.item.valueItemType=="rating";((a.item.value=="1"||a.item.value=="4")&&a.item.valueItemType=="condition"||Y)&&(k=!0);let Q=!1;return a.item.disabledByItemKey&&a.itemTriggerDisabledValue&&a.itemTriggerDisabledValue[a.item.disabledByItemKey]=="4"&&(Q=!0),l||!k||Q}),I=i(()=>r),K=i(()=>{const l=a.item.value.toString().replaceAll("'","");let k;return a.item.categoryItemType=="basic"?"basic":(l=="1"||l=="2"?k="green":l=="3"?k="red":l=="4"?k="yellow":l=="A"?k="a":l=="B"?k="b":l=="C"?k="c":l=="X"&&(k="x"),k)}),P=i(()=>{var l,k;if(a.item.caption&&a.item.itemValue){const Y=a.item.caption.replace("[","").replace("]","").split("; "),se=a.item.itemValue.replace("[","").replace("]","").split(", ");let Q=Y.map((z,N)=>({label:z.replaceAll("'",""),value:se[N].replaceAll("'","")}));return p.value||((((l=a.task)==null?void 0:l.category)=="NORMAL"||((k=a.task)==null?void 0:k.category)=="CRACK")&&m.value=="1"?Q=Q.filter(z=>!z.label.includes("Not Applicable")):a.item.value=="3"&&a.item.valueItemType=="condition"&&(Q=Q.filter(z=>z.value.includes("1")||z.value==m.value))),Q}return[]}),$=i(()=>{var l;return m.value?(l=P.value.find(k=>k.value==String(m.value)))==null?void 0:l.label:m.value}),j=l=>Te(l),te=l=>{const k={};k.key=l,k.value=a.task.key;const Y=a.task;o("onDefectView",{param:k,task:Y})},B=()=>{var l,k;d.setReason((l=a.task)==null?void 0:l.reason),d.setTitle((k=a.task)==null?void 0:k.description),d.setVisible(!0)};return(l,k)=>{const Y=E("el-option"),se=E("el-select"),Q=E("NwImg");return s(),c("div",{class:X([[h.value,T.value,D.value],"px-2 pt-2 dropdown-eform-status"]),style:ce(S.value)},[e("div",Bo,[(s(),J(se,{modelValue:m.value,"onUpdate:modelValue":k[0]||(k[0]=z=>m.value=z),placeholder:M.value,size:"small",class:X(["w-100",K.value]),disabled:x.value,key:I.value},tt({default:q(()=>[(s(!0),c(W,null,le(P.value,z=>(s(),J(Y,{key:z,value:z.value},{default:q(()=>[e("span",{innerHTML:z&&z.label?j(z&&z.label):""},null,8,To)]),_:2},1032,["value"]))),128))]),_:2},[m.value?{name:"prefix",fn:q(()=>[e("span",{class:"el-input__custom-option",innerHTML:$.value},null,8,Ao)]),key:"0"}:void 0]),1032,["modelValue","placeholder","disabled","class"])),a.item.categoryItemType!="basic"?(s(),c(W,{key:0},[a.item.valueItemType=="condition"?(s(),c(W,{key:0},[a.item.value==="3"?(s(),c("div",So,[w(Q,{src:"/media/logos/bumaau/defect.png",alt:"defect",class:"d-icon",onClick:k[1]||(k[1]=z=>te("defect"))})])):O("",!0),a.item.value==="4"?(s(),c("div",Oo,[w(Q,{src:"/media/logos/bumaau/na.png",alt:"na",class:"d-icon",onClick:k[2]||(k[2]=z=>te("na"))})])):O("",!0),(a.item.value==="1"||a.item.value==="2")&&a.task.reason&&a.task.reason!=""?(s(),c("div",{key:2,class:"ms-2",onClick:B},Po)):O("",!0)],64)):O("",!0)],64)):O("",!0)]),t.loadingIndicator?(s(),c("div",No,jo)):O("",!0)],6)}}}),Fo=ue(qo,[["__scopeId","data-v-b42eaba2"]]),Mo=["disabled"],Ho={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},Eo={class:"text-white"},Go=oe({__name:"CameraItem",props:{intervention:{required:!0,type:Object},item:{type:Object,required:!0},task:{type:Object,required:!0},currentFitter:{type:Object,required:!0},reRender:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!1},generalSubmitted:{required:!0,type:Boolean}},emits:["onTaskChanged","onCameraClicked","onImageDelete","onDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=A(!1),u=ie(a,"task"),d=i(()=>a.item.style!=null),m=i(()=>a.item.style),f=i(()=>d.value&&m.value.border!=null),n=i(()=>m.value.border),R=i(()=>d.value&&m.value.borderRadius!=null),b=i(()=>m.value.borderRadius),_=i(()=>a.task.updatedBy!=""),g=i(()=>d.value&&m.value.breakPoint!="none"?`col-${m.value.breakPoint}`:"col"),y=i(()=>{let P="";return d.value&&(m.value.potraitBreakPoint&&m.value.breakPoint!="none"&&(P=`col-md-${m.value.potraitBreakPoint}`),P=`${P} col-lg-${m.value.breakPoint}`),P}),T=i(()=>_.value?"":"pb-2"),h=i(()=>{const P=d.value&&m.value.bgColor!="none"?`background-color: ${m.value.bgColor}; `:"",$=d.value&&m.value.fontColor!="none"?`color: ${m.value.fontColor}; `:"",j=f.value&&n.value.top!="none"?`border-top: ${n.value.top}; `:"",te=f.value&&n.value.right!="none"?`border-right: ${n.value.right}; `:"";let B=f.value&&n.value.bottom!="none"?`border-bottom: ${n.value.bottom}; margin-bottom: 1rem;`:"",l=0;a.task.items.forEach(N=>{f.value?(n.value.right=="none"||C.isEqual(N,C.last(a.task.items)))&&(l=l+Number(m.value.breakPoint)):l=l+Number(m.value.breakPoint)}),l==12&&(B=_.value&&d.value&&!f.value&&n.value.bottom!="none"?`border-bottom: ${n.value.bottom}; margin-bottom: 1rem; `:"");const k=f.value&&n.value.left!="none"?`border-left: ${n.value.left}; `:"",Y=R.value&&b.value.topRight!="none"?`border-top-right-radius: ${b.value.topRight}; `:"",se=R.value&&b.value.bottomRight!="none"?`border-bottom-right-radius: ${b.value.bottomRight}; `:"",Q=R.value&&b.value.topLeft!="none"?`border-top-left-radius: ${b.value.topLeft}; `:"",z=R.value&&b.value.bottomLeft!="none"?`border-bottom-left-radius: ${b.value.bottomLeft}; `:"";return`${P}${$}${j}${te}${B}${k}${Y}${se}${Q}${z}`}),D=i(()=>{if(a.isReadOnly||!a.generalSubmitted)return!0;let P=!0,$=!1;const j=a.task.rating=="AUTOMATIC_REPLACEMENT"||a.task.rating=="AUTOMATIC_REPLACEMENT_GAP",te=a.task.taskNormalValue=="1"||a.task.taskNormalValue=="2";return j&&!te&&($=!0),!P||$});i(()=>{let P=!1;return a.currentFitter&&a.currentFitter&&a.task.taskValue!=""&&a.task.updatedBy.id!=a.currentFitter.id&&(P=!0),P});const S=i(()=>a.task.images&&a.task.images!=""?C.isArray(a.task.images)?a.task.images:JSON.parse(a.task.images):[]),M=()=>{if(console.log(D.value),D.value)return;const P={};P.employee=a.currentFitter,P.taskKey=a.task.key,P.taskCategory=a.task.category,P.itemKey=a.item.key,P.type=a.item.valueItemType,P.value="",P.timeStamp=me(),P.task=u.value,o("onCameraClicked",P)},p=async P=>{const $={};$.employee=a.currentFitter,$.taskKey=a.task.key,$.taskCategory=a.task.category,$.itemKey=a.item.key,$.type=a.item.valueItemType,$.value="",$.timeStamp=me(),$.task=u.value;const j={};j.task=$,j.filename=P,u.value.images.length==1&&K(),o("onImageDelete",j)},x=P=>{o("onDownloaded",P)},I=()=>{r.value=!0},K=()=>{r.value=!1};return(P,$)=>{const j=E("NwImg");return s(),c("div",{class:X([[g.value,y.value,T.value],"pt-2"]),style:ce(h.value)},[e("div",{class:X(["row",!Z(C.isUndefined)(t.item.value)&&t.item.value.length>0?"justify-content-around":"justify-content-center"])},[e("div",{class:X(["d-flex justify-content-center",!Z(C.isUndefined)(t.item.value)&&t.item.value.length>0?"col-6 pe-0 ps-1":"col-6 px-0"])},[e("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:M,disabled:D.value},[t.task.images&&t.task.images.length>0?(s(),J(j,{key:0,src:"/media/svg/dma/camera/e-form/png/cam-user.png",style:{height:"12px",width:"14px"},alt:"camera"})):(s(),J(j,{key:1,src:"/media/svg/dma/camera/e-form/png/cam-active.png",style:{height:"12px",width:"14px"},alt:"camera"}))],8,Mo)],2),S.value&&S.value.length>0?(s(),c("div",Ho,[e("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:I,style:{"background-color":"#18AF4A"}},[e("label",Eo,"+"+H(S.value.length),1)])])):O("",!0)],2),w(Ae,{type:"cbm","re-render":t.reRender,images:S.value,visibility:r.value,showDeleteButton:!D.value,"show-mandatory-caption":!0,"is-monitoring":t.isReadOnly,onOnClose:K,onOnDelete:p,onOnDownloaded:x},null,8,["re-render","images","visibility","showDeleteButton","is-monitoring"])],6)}}}),Ko={class:"row w-100 m-0"},Wo=e("div",{class:"col-md-1 col-lg-1 pb-2 px-2 pt-2"},null,-1),zo={class:"col-md-3 col-lg-3 pb-2 px-2 pt-2"},Jo={class:"col-md-2 col-lg-2 col-2 pb-2 px-2 pt-2 input-eform-status"},Yo={key:0,class:"d-flex align-items-center"},Qo=e("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[e("span",{class:"sr-only"},"Loading...")],-1),Xo=e("span",null,"Loading...",-1),Zo=[Qo,Xo],es={class:"text-start col-md-1 col-lg-1 pb-2 px-2 pt-2"},ts={class:"col-md-2 col-lg-2 col-2 pb-2 px-2 pt-2 input-eform-status"},as={key:0,class:"d-flex align-items-center"},os=e("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[e("span",{class:"sr-only"},"Loading...")],-1),ss=e("span",null,"Loading...",-1),ls=[os,ss],ns={class:"col-1 col-md-1 col-lg-1 pb-2 pt-2"},is={class:"row justify-content-center"},rs={class:"px-0 col-6 d-flex justify-content-center"},ds=["disabled"],us={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},cs={class:"text-white"},ms={key:0,class:"row w-100 position-absolute pe-3"},vs={key:1,class:"row w-100"},fs=e("div",{style:{height:"25px"}},null,-1),ps=[fs],ys={key:2,class:"row w-100 m-0"},bs=e("div",{class:"col-md-1 col-lg-1 pb-2 px-2 pt-2"},null,-1),gs={class:"col-md-3 col-lg-3 pb-2 px-2 pt-2"},hs={class:"col-md-8 col-lg-8 col-8 pb-2 px-2 pt-2 input-eform-status"},_s={key:0,class:"d-flex align-items-center"},ks=e("div",{class:"spinner-border me-1",style:{width:"1rem !important",height:"1rem !important"},role:"status"},[e("span",{class:"sr-only"},"Loading...")],-1),$s=e("span",null,"Loading...",-1),ws=[ks,$s],Ds=oe({__name:"TaskAdjustment",props:{task:{required:!0,type:Object},currentFitter:{type:Object,required:!0},reRender:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!1}},emits:["onHideAdjustment","onCameraClicked","onImageDelete","onTaskChanged","onDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=ie(a,"task"),u=A(!1),d=A(!1),m=A(!1),f=A(!1),n=i(()=>a.task.adjustment||{}),R=i({get:()=>n.value.measurement,set:B=>{rt(B)&&(n.value.measurement=dt(B))}}),b=async B=>{const l={};l.employee=a.currentFitter,l.taskKey=a.task.key,l.taskCategory="Adjustment",l.itemKey=n.value.key,l.type="cbmAdjustment",l.value="",l.timeStamp=me(),l.task=r.value;const k={};k.task=l,k.filename=B,o("onImageDelete",k)},_=B=>{o("onDownloaded",B)},g=i(()=>n.value.pictures),y=i(()=>a.isReadOnly?!0:!!0),T=()=>{u.value=!1},h=()=>{u.value=!0},D=i(()=>{let B="";return a.task.items.forEach(l=>{!C.isUndefined(l.style)&&!C.isUndefined(l.style.border)&&l.style.border.left!="none"&&(B=l.style.border.left)}),B}),S=i(()=>{let B="",l=!1;return r.value.items.forEach(k=>{!C.isUndefined(k.style)&&!C.isUndefined(k.style.border)&&k.style.border.bottom!="none"&&(l=!0)}),(n.value.updatedBy!=""&&n.value.updatedBy.name==""||C.isUndefined(n.value.updatedBy.name)&&l)&&(B=`border-bottom: ${D.value}`),B}),M=B=>{let l=B.keyCode?B.keyCode:B.which;(l<48||l>57)&&l!=46&&B.preventDefault()},p=()=>{let B="/media/svg/dma/camera/e-form/png/cam-active.png";return g.value.length>0&&(B="/media/svg/dma/camera/e-form/png/cam-user.png"),B},x=async B=>{const l=String(parseFloat(B.target.value));if(j.value==l)return;const k={};k.employee=a.currentFitter,k.taskKey=a.task.key,k.taskCategory="Adjustment",k.itemKey=n.value.key,k.type="inputUom",k.value=l,k.timeStamp=me(),k.task=a.task,o("onTaskChanged",k,()=>{j.value=l},{setLoadingMeasurement:Y=>{d.value=Y},setLoadingRating:Y=>{m.value=Y}})},I=async B=>{if(y.value||te.value==B.target.value)return;const l={};l.employee=a.currentFitter,l.taskKey=a.task.key,l.taskCategory="Adjustment",l.itemKey=n.value.key,l.type="commentValue",l.value=B.target.value,l.timeStamp=me(),l.task=a.task,o("onTaskChanged",l,()=>{te.value=B.target.value},{setLoadingComment:k=>{f.value=k}})},K=()=>{const B={};B.employee=a.currentFitter,B.taskKey=a.task.key,B.taskCategory=a.task.category,B.itemKey=n.value.key,B.type="cbmAdjustment",B.value=JSON.stringify(n.value.pictures),B.timeStamp=me(),B.task=r.value,o("onCameraClicked",B)},P=async()=>{if(j.value="",te.value="",n.value.measurement||n.value.rating){const B=it.service({lock:!0,text:"Deleting Adjustment",background:"rgba(0, 0, 0, 0.7)"}),l={};l.employee=a.currentFitter,l.taskKey=a.task.key,l.taskCategory="Adjustment",l.itemKey=n.value.key,l.type="reset",l.value=n.value.rating,l.timeStamp=me(),l.task=a.task,o("onTaskChanged",l,()=>{o("onHideAdjustment"),B.close()})}else o("onHideAdjustment")},$=i(()=>{const B=n.value.rating;let l;return B=="A"?l="a":B=="B"?l="b":B=="C"?l="c":B=="X"&&(l="x"),l}),j=A(""),te=A("");return De(()=>{j.value=n.value.measurement,te.value=n.value.commentValue}),(B,l)=>{const k=E("el-input"),Y=E("NwImg"),se=E("el-button");return s(),c(W,null,[e("div",Ko,[Wo,e("div",zo,H(n.value.description),1),e("div",Jo,[w(k,{modelValue:R.value,"onUpdate:modelValue":l[0]||(l[0]=Q=>R.value=Q),size:"small",placeholder:"Please Input",onKeypress:M,onFocusout:x,inputmode:"numeric",readonly:y.value},null,8,["modelValue","readonly"]),d.value?(s(),c("div",Yo,Zo)):O("",!0)]),e("div",es,H(n.value.uom),1),e("div",ts,[w(k,{modelValue:n.value.rating,"onUpdate:modelValue":l[1]||(l[1]=Q=>n.value.rating=Q),modelModifiers:{lazy:!0},size:"small",disabled:"",class:X($.value)},null,8,["modelValue","class"]),m.value?(s(),c("div",as,ls)):O("",!0)]),e("div",ns,[e("div",is,[e("div",rs,[e("button",{class:"btn btn-sm btn-icon btn-bg-light",onClick:K,disabled:y.value},[w(Y,{src:p(),style:{height:"12px",width:"14px"}},null,8,["src"])],8,ds)]),g.value.length>0?(s(),c("div",us,[e("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:h,style:{"background-color":"#18AF4A"}},[e("label",cs,"+"+H(n.value.pictures.length),1)])])):O("",!0)])]),e("div",{class:"col-2 text-center col-md-2 col-lg-2 pb-2 px-2 pt-2",style:ce([`border-right: ${D.value}`,S.value])},[w(se,{disabled:y.value,type:"danger",size:"small",class:"item-button w-100",onClick:P},{default:q(()=>[pe("Delete")]),_:1},8,["disabled"])],4)]),n.value.updatedBy!=""&&n.value.updatedBy.name?(s(),c("div",ms,[e("div",{class:"d-flex justify-content-end py-1 col-11 offset-1 timestamp-task",style:ce([`border-left: ${D.value}; border-right: ${D.value}`])},H(n.value.updatedBy.name)+", "+H(n.value.updatedDate),5)])):O("",!0),n.value.updatedBy!=""?(s(),c("div",vs,ps)):O("",!0),Z(C.isUndefined)(n.value.commentValue)?O("",!0):(s(),c("div",ys,[bs,e("div",gs,H(n.value.commentLabel),1),e("div",hs,[w(k,{modelValue:n.value.commentValue,"onUpdate:modelValue":l[2]||(l[2]=Q=>n.value.commentValue=Q),modelModifiers:{lazy:!0},size:"small",placeholder:n.value.commentPlaceHolder,onFocusout:I,readonly:y.value},null,8,["modelValue","placeholder","readonly"]),f.value?(s(),c("div",_s,ws)):O("",!0)])])),w(Ae,{"re-render":t.reRender,type:"cbm",images:g.value,visibility:u.value,showDeleteButton:!y.value,"show-mandatory-caption":!0,onOnClose:T,onOnDelete:b,onOnDownloaded:_},null,8,["re-render","images","visibility","showDeleteButton"])],64)}}}),xs=oe({__name:"AdjustmentButton",props:{item:{type:Object,required:!0},task:{type:Object,required:!0},isShowAdjustmentRow:{required:!0,type:Boolean},currentFitter:{type:Object,required:!0},isReadOnly:{type:Boolean,default:!1}},emits:["onShowAdjustment"],setup(t,{emit:v}){const a=t,o=ie(a,"item"),r=ie(a,"task"),u=v,d=i(()=>!C.isUndefined(o.value.style)&&o.value.style.breakPoint!="none"?`col-${o.value.style.breakPoint}`:"col"),m=i(()=>!C.isUndefined(o.value.style)&&o.value.style.fontColor!="none"?`color: ${o.value.style.fontColor}; `:""),f=i(()=>!C.isUndefined(o.value.style)&&o.value.style.bgColor!="none"?`background-color: ${o.value.style.bgColor}; border-color: ${o.value.style.bgColor};`:""),n=i(()=>{let h="";return a.isShowAdjustmentRow&&(h="opacity: 50%;"),R.value&&(h="opacity: 50%;"),h}),R=i(()=>{if(a.isReadOnly)return!0;const h=r.value.taskValue=="",D=r.value.taskValue=="A"||r.value.taskValue=="B";let S=!0;const M=a.task.updatedBy||{};return!C.isUndefined(M)&&!C.isUndefined(M.id)&&(a.currentFitter&&a.currentFitter.id==M.id?S=!0:S=!1),h||D||!S||a.isShowAdjustmentRow}),b=i(()=>{let h="";return C.isUndefined(o.value.style)||(!C.isUndefined(o.value.style.potraitBreakPoint)&&o.value.style.breakPoint!="none"?(h=`col-md-${o.value.style.potraitBreakPoint}`,h=`${h} col-lg-${o.value.style.breakPoint}`):(h=`col-md-${o.value.style.potraitBreakPoint}`,h=`${h} col-lg-${o.value.style.breakPoint}`)),h}),_=i(()=>C.isUndefined(o.value.style)?"":o.value.style.textAlign=="left"?"text-start":o.value.style.textAlign=="right"?"text-end":"text-center"),g=i(()=>{var P;const h=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.border)&&o.value.style.border.top!="none"?`border-top: ${o.value.style.border.top}; `:"",D=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.border)&&o.value.style.border.right!="none"?`border-right: ${o.value.style.border.right}; `:"";let S=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.border)&&o.value.style.border.bottom!="none"?`border-bottom: ${o.value.style.border.bottom}; margin-bottom: 1rem;`:"";if(!C.isUndefined(a.isShowAdjustmentRow)&&a.isShowAdjustmentRow)S="";else{let $=0;(P=a.task)==null||P.items.forEach(j=>{var te;C.isUndefined(j.style)||(C.isUndefined(j.style.border)?C.isUndefined(j.style.border)&&($=$+Number(j.style.breakPoint)):((j.style.border.right=="none"||C.isUndefined(j.style.border.right))&&($=$+Number(j.style.breakPoint)),C.isEqual(j,C.last((te=a.task)==null?void 0:te.items))&&($=$+Number(j.style.breakPoint))))}),$==12&&(S=!(a.task.updatedBy||{}).name&&!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.border)&&o.value.style.border.bottom!="none"?`border-bottom: ${o.value.style.border.bottom}; margin-bottom: 1rem; `:"")}const M=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.border)&&o.value.style.border.left!="none"?`border-left: ${o.value.style.border.left}; `:"",p=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.topRight!="none"?`border-top-right-radius: ${o.value.style.borderRadius.topRight}; `:"",x=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.bottomRight!="none"?`border-bottom-right-radius: ${o.value.style.borderRadius.bottomRight}; `:"",I=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.topLeft!="none"?`border-top-left-radius: ${o.value.style.borderRadius.topLeft}; `:"",K=!C.isUndefined(o.value.style)&&!C.isUndefined(o.value.style.borderRadius)&&o.value.style.borderRadius.bottomLeft!="none"?`border-bottom-left-radius: ${o.value.style.borderRadius.bottomLeft}; `:"";return`${h}${D}${S}${M}${p}${x}${I}${K}`}),y=()=>{o.value.value=="Adjustment"&&u("onShowAdjustment")},T=i(()=>{let h="pb-2";const D=a.task.updatedBy||{};return!C.isUndefined(D.name)&&D.name&&(h=""),h});return(h,D)=>{const S=E("el-button");return s(),c("div",{class:X([[d.value,_.value,b.value,T.value],"px-2 pt-2"]),style:ce(g.value)},[Z(C.isUndefined)(t.item.style)?O("",!0):(s(),J(S,{key:0,style:ce([m.value,f.value,n.value]),size:"small",type:"success",onClick:y,class:"item-button w-100",disabled:R.value},{default:q(()=>[pe(H(t.item.value),1)]),_:1},8,["style","disabled"]))],6)}}}),Cs=["innerHTML"],Is=oe({__name:"HTML",props:{item:{type:Object,required:!0},task:{type:Object,required:!0}},setup(t){const v=t,a=A(null),o=A(""),r=A(!1),u=i(()=>v.item.style!=null),d=i(()=>v.item.style),m=i(()=>u.value&&d.value.border!=null),f=i(()=>d.value.border),n=i(()=>u.value&&d.value.borderRadius!=null),R=i(()=>d.value.borderRadius),b=i(()=>v.task.updatedBy!=""),_=i(()=>Te(v.item.value).replaceAll("{BLOB_URL}","https://digitaldevbumaausta001.blob.core.windows.net")),g=i(()=>{let p="";return u.value&&(d.value.potraitBreakPoint&&d.value.breakPoint!="none"&&(p=`col-md-${d.value.potraitBreakPoint}`),p=`${p} col-lg-${d.value.breakPoint}`),p}),y=i(()=>{let p="";if(v.item.style&&v.item.style.textAlign)switch(v.item.style.textAlign){case"left":p="text-start";break;case"right":p="text-end";break;default:p="text-center"}return p}),T=i(()=>b.value?"":"pb-2"),h=i(()=>{const p=u.value&&d.value.bgColor!="none"?`background-color: ${d.value.bgColor}; `:"",x=u.value&&d.value.fontColor!="none"?`color: ${d.value.fontColor}; `:"",I=m.value&&f.value.top!="none"?`border-top: ${f.value.top}; `:"",K=m.value&&f.value.right!="none"?`border-right: ${f.value.right}; `:"";let P=m.value&&f.value.bottom!="none"?`border-bottom: ${f.value.bottom}; margin-bottom: 1rem;`:"",$=0;v.task.items.forEach(Y=>{m.value?(f.value.right=="none"&&($=$+Number(d.value.breakPoint)),C.isEqual(Y,C.last(v.task.items))&&($=$+Number(d.value.breakPoint))):m.value||($=$+Number(d.value.breakPoint))}),$==12&&(P=b.value&&u.value&&!m.value&&f.value.bottom!="none"?`border-bottom: ${f.value.bottom}; margin-bottom: 1rem; `:"");const j=m.value&&f.value.left!="none"?`border-left: ${f.value.left}; `:"",te=n.value&&R.value.topRight!="none"?`border-top-right-radius: ${R.value.topRight}; `:"",B=n.value&&R.value.bottomRight!="none"?`border-bottom-right-radius: ${R.value.bottomRight}; `:"",l=n.value&&R.value.topLeft!="none"?`border-top-left-radius: ${R.value.topLeft}; `:"",k=n.value&&R.value.bottomLeft!="none"?`border-bottom-left-radius: ${R.value.bottomLeft}; `:"";return`${p}${x}${I}${K}${P}${j}${te}${B}${l}${k}`}),D=A(!1),S=p=>{D.value=p},M=()=>{r.value=!1};return De(()=>{try{Array.from(a.value.getElementsByClassName("show-pdf")).forEach(x=>{x.onclick=I=>{I.preventDefault(),r.value=!0,o.value=x.href}})}catch(p){console.log(p)}try{Array.from(a.value.getElementsByClassName("spv-print-pdf")).forEach(x=>{x.onclick=I=>{I.preventDefault(),r.value=!0,o.value=x.href,S(!0)}})}catch(p){console.log(p)}}),(p,x)=>(s(),c(W,null,[e("div",{class:X([[y.value,g.value,T.value],"px-2 pt-2"]),style:ce(h.value)},[e("span",{ref_key:"html",ref:a,innerHTML:_.value},null,8,Cs)],6),w(Ke,{show:r.value,onHandleCloseModal:M,"blob-url":o.value},null,8,["show","blob-url"]),w(ut,{show:D.value,onClose:S},null,8,["show"])],64))}}),Rs=oe({__name:"RowItem",props:{item:{type:Object,required:!0},reference:{type:Object,required:!0},itemLoading:{type:Boolean,default:!1}},setup(t){const v=t,a=i(()=>{const r=[];for(const u in v.item)r.push(v.item[u]);return r}),o=r=>{let u="";return!C.isUndefined(r.style)&&!C.isUndefined(r.style.textvAlign)&&(u=`align-self-${r.style.textvAlign}`),u};return(r,u)=>(s(!0),c(W,null,le(a.value,d=>(s(),c("div",{class:X([o(d),"eform-table-row col px-0"]),key:d.key},[d.itemType==="image"?(s(),J(ct,{key:0,item:d,reference:t.reference},null,8,["item","reference"])):O("",!0),d.itemType==="label"?(s(),J(mt,{key:1,item:d,reference:t.reference},null,8,["item","reference"])):O("",!0),d.itemType==="html"?(s(),J(vt,{key:2,item:d,reference:t.reference},null,8,["item","reference"])):O("",!0)],2))),128))}}),Bs={class:"row w-100 mx-0 mb-5"},Ts={key:0,class:"col-1 px-2"},As={class:"row text-center task-table__header py-2 w-100"},Ss=oe({__name:"TableItem",props:{reference:{type:Object,required:!0}},setup(t){const v=t,a=i(()=>v.reference.header.replaceAll("'","").replace("[","").replace("]","").split(", ")),o=i(()=>v.reference.style!=null),r=d=>{let m="";return o.value&&v.reference.style.borderBottom&&v.reference.style.borderBottom=="none"?m="":m="border-bottom-table",d+1==v.reference.items.length&&(m="border-bottom-table"),m},u=A(!1);return(d,m)=>(s(),c("div",Bs,[t.reference.style&&t.reference.style.collapseCategory=="taskTable"?(s(),c("div",Ts)):O("",!0),e("div",{class:X(["task-table",t.reference.style&&t.reference.style.collapseCategory=="taskTable"?"col-11 px-0":"col-12 pe-0"]),style:{"font-size":"12px !important"}},[e("label",null,H(t.reference.description),1),e("div",As,[(s(!0),c(W,null,le(a.value,f=>(s(),c("div",{class:"col font-weight-normal task-table__header__item",key:f},H(f),1))),128))]),(s(!0),c(W,null,le(t.reference.items,(f,n)=>(s(),c("div",{key:n,class:X(["row w-100 task-table__body d-flex align-items-start",r(n)])},[w(Rs,{item:f,reference:t.reference,"item-loading":u.value},null,8,["item","reference","item-loading"])],2))),128))],2)]))}}),Os=ue(Ss,[["__scopeId","data-v-d8612adf"]]),Vs={class:"row w-100 mt-3 mb-3"},Ps={key:0,class:"col-1 px-2"},Ns={class:"small-hyperlink-text-style"},Ls=oe({__name:"CollapsibleTableItem",props:{reference:{type:Object,required:!0},isPrint:{type:Boolean,default:!1}},setup(t){const v=t,a=A("open"),o=i(()=>{let r="";return v.reference.style&&v.reference.style.defaultCollapse&&(r=v.reference.style.defaultCollapse),v.isPrint&&(r="open"),r});return(r,u)=>{const d=E("el-collapse-item"),m=E("el-collapse");return s(),c("div",Vs,[t.reference.style&&t.reference.style.collapseCategory=="taskTable"?(s(),c("div",Ps)):O("",!0),e("div",{class:X(["task-table collapsible-table-container",t.reference.style&&t.reference.style.collapseCategory=="taskTable"?"col-11 px-0":"col-12 pe-0"])},[w(m,{class:"task-group general-accordion py-1 px-5",modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=f=>a.value=f)},{default:q(()=>[w(d,{name:o.value},{title:q(()=>[e("span",Ns,H(t.reference.triggerCaption),1)]),default:q(()=>[w(Os,{reference:t.reference},null,8,["reference"])]),_:1},8,["name"])]),_:1},8,["modelValue"])],2)])}}}),Us={key:1,class:"row w-100"},js=oe({__name:"InlineTask",props:{intervention:{required:!0,type:Object},items:{required:!0,type:Object},task:{required:!0,type:Object},defectImages:{type:Object,required:!0},currentFitter:{required:!0,type:Object},loadingIndicator:{required:!0,type:Object},itemTriggerDisabledValue:{required:!0,type:Object},reRender:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!1},validation:{type:String,default:""},currInputTyped:{type:String,default:""},formStatus:{type:String,required:!1},generalSubmitted:{required:!0,type:Boolean}},emits:["onTaskChanged","onNACreated","onDefectView","onInitLoadingIndicator","onSmallCameraClicked","onImageDeleted","onImageDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=A(!1),u=A(!1),d=i(()=>{let p=40;return r.value&&(p=60),p}),m=i(()=>{let p="";return a.task.taskValue!=null&&a.task.taskValue==""&&(p="task-required"),p}),f=i(()=>u.value||!!(a.task.adjustment&&a.task.adjustment.measurement)),n=i(()=>{const p=a.task.items[0],x=C.last(a.items),I=a.task.updatedBy!="",K=!C.isUndefined(x.style)&&!C.isUndefined(x.style.border)&&x.style.border.right!="none"?`border-right: ${x.style.border.right}; `:"",P=I&&!C.isUndefined(x.style)&&!C.isUndefined(x.style.border)&&x.style.border.bottom!="none"?`border-bottom: ${x.style.border.bottom}; `:"",$=!C.isUndefined(p.style)&&!C.isUndefined(p.style.border)&&p.style.border.left!="none"?`border-left: ${p.style.border.left}; `:"",j=I&&!C.isUndefined(x.style)&&!C.isUndefined(x.style.border)&&x.style.border.bottom!="none"?"margin-bottom: 4px ":"";return`${K}${$}${P}${j}`}),R=i(()=>"col-12 offset-0"),b=i(()=>{let p="";return a.formStatus&&a.formStatus=="Open"||!a.isReadOnly||(Object.hasOwn(a.task,"taskValue")&&!a.task.taskValue?p="task-required-highlight":p=""),p}),_=()=>{u.value=!0},g=()=>{u.value=!1},y=(p,x,I)=>{o("onTaskChanged",{data:p,asyncfunction:x,helper:I})},T=p=>{o("onDefectView",p)},h=p=>{o("onImageDownloaded",p)},D=p=>{o("onSmallCameraClicked",p)},S=p=>{o("onImageDeleted",p)},M=p=>p in a.loadingIndicator?a.loadingIndicator[p]:(o("onInitLoadingIndicator",p),!1);return De(()=>{u.value=!!(a.task.adjustment&&a.task.adjustment.measurement)}),(p,x)=>(s(),c("div",null,[e("div",{class:X(["row w-100 m-0",[m.value,b.value]])},[(s(!0),c(W,null,le(t.items,I=>(s(),c(W,{key:I.key},[I.itemType==="label"?(s(),J(_o,{key:0,item:I,task:t.task},null,8,["item","task"])):O("",!0),I.itemType==="input"?(s(),J(Ro,{key:1,item:I,task:t.task,"is-read-only":t.isReadOnly,"current-fitter":t.currentFitter,validation:t.validation,"loading-indicator":M(I.key),"loading-comment-indicator":!1,"item-trigger-disabled-value":a.itemTriggerDisabledValue,"is-disabled":f.value,currInputTyped:t.currInputTyped,"general-submitted":t.generalSubmitted,onOnInputChanged:y},null,8,["item","task","is-read-only","current-fitter","validation","loading-indicator","item-trigger-disabled-value","is-disabled","currInputTyped","general-submitted"])):O("",!0),I.itemType==="dropDown"?(s(),J(Fo,{key:2,item:I,task:t.task,"is-read-only":t.isReadOnly,"current-fitter":t.currentFitter,validation:"","loading-indicator":M(I.key),"loading-comment-indicator":!1,"item-trigger-disabled-value":a.itemTriggerDisabledValue,"general-submitted":t.generalSubmitted,onOnTaskChanged:y,onOnDefectView:T},null,8,["item","task","is-read-only","current-fitter","loading-indicator","item-trigger-disabled-value","general-submitted"])):O("",!0),I.itemType==="smallCamera"?(s(),J(Go,{key:3,"general-submitted":t.generalSubmitted,intervention:t.intervention,"is-read-only":t.isReadOnly,"re-render":t.reRender,item:I,task:t.task,"current-fitter":t.currentFitter,onOnCameraClicked:D,onOnImageDelete:S,onOnDownloaded:h},null,8,["general-submitted","intervention","is-read-only","re-render","item","task","current-fitter"])):O("",!0),I.itemType==="button"?(s(),J(xs,{key:4,item:I,"is-read-only":t.isReadOnly,task:t.task,isShowAdjustmentRow:f.value,"current-fitter":t.currentFitter,onOnShowAdjustment:_},null,8,["item","is-read-only","task","isShowAdjustmentRow","current-fitter"])):O("",!0),I.itemType==="html"?(s(),J(Is,{key:5,item:I,task:t.task},null,8,["item","task"])):O("",!0)],64))),128))],2),t.task.updatedBy!=""&&t.task.updatedBy.name?(s(),c("div",{key:0,class:"row w-100 position-absolute pe-3",style:ce(`top: ${d.value};`)},[e("div",{class:X(["d-flex justify-content-end pb-1 my-0 timestamp-task",R.value])},H(t.task.updatedBy.name)+", "+H(t.task.updatedDate),3)],4)):O("",!0),t.task.updatedBy!=""?(s(),c("div",Us,[e("div",{style:ce([n.value,{height:"25px"}]),class:X(R.value)},null,6)])):O("",!0),f.value&&t.task.adjustment?(s(),J(Ds,{key:2,"re-render":t.reRender,"is-read-only":t.isReadOnly,task:t.task,"current-fitter":t.currentFitter,"loading-indicator":M(t.task.adjustment.key),onOnHideAdjustment:g,onOnTaskChanged:y,onOnCameraClicked:D,onOnImageDelete:S,onOnDownloaded:h},null,8,["re-render","is-read-only","task","current-fitter","loading-indicator"])):O("",!0),t.task.reference?(s(),c(W,{key:3},[t.task.reference.taskType=="collapsibleTable"?(s(),J(Ls,{key:0,reference:t.task.reference},null,8,["reference"])):O("",!0),t.task.reference.taskType=="inline"?(s(),J(ft,{key:1,reference:t.task.reference,items:t.task.reference.items},null,8,["reference","items"])):O("",!0)],64)):O("",!0)]))}}),qs=ue(js,[["__scopeId","data-v-bc0e2295"]]),Fs={class:"ps-0 mt-5"},Ms={class:"card"},Hs={key:1,class:"row w-100 m-0"},Es=e("p",{style:{"text-align":"center"}},"No data recorded",-1),Gs=[Es],Dd=oe({__name:"TaskGroup",props:{intervention:{required:!0,type:Object},section:{required:!0,type:Object},defectImages:{type:Object,required:!0},currentFitter:{required:!0,type:Object},loadingIndicator:{required:!0,type:Object},itemTriggerDisabledValue:{required:!0,type:Object},reRender:{type:Boolean,default:!1},expandAll:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!1},validation:{type:String,default:""},currInputTyped:{type:String,default:""},generalSubmitted:{required:!0,type:Boolean}},emits:["onTaskChanged","onNACreated","onDefectView","onInitLoadingItem","onSmallCameraClicked","onImageDeleted","onImageDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=A(a.section.name),u=g=>{o("onTaskChanged",g)},d=g=>{o("onSmallCameraClicked",g)},m=g=>{o("onImageDeleted",g)},f=g=>{o("onImageDownloaded",g)},n=g=>{o("onNACreated",g)},R=g=>{o("onDefectView",g)},b=g=>{o("onInitLoadingItem",g)},_=()=>{r.value=a.section.name};return Oe(()=>a.expandAll,()=>{_()}),(g,y)=>{const T=E("el-collapse-item"),h=E("el-collapse");return s(),c("div",Fs,[e("div",Ms,[w(h,{modelValue:r.value,"onUpdate:modelValue":y[0]||(y[0]=D=>r.value=D),class:"task-group e-form-only py-1 px-5 mb-3"},{default:q(()=>[w(T,{title:t.section.name,name:t.section.name},{default:q(()=>[(s(!0),c(W,null,le(t.section.tasks,D=>(s(),c(W,{key:D.key},[D.taskType=="inline"?(s(),J(qs,{key:0,"re-render":t.reRender,intervention:t.intervention,task:D,items:D.items,"defect-images":t.defectImages,"current-fitter":t.currentFitter,"loading-indicator":a.loadingIndicator,"item-trigger-disabled-value":a.itemTriggerDisabledValue,"is-read-only":t.isReadOnly,validation:t.validation,currInputTyped:t.currInputTyped,"form-status":t.intervention.interventionExecution,"general-submitted":t.generalSubmitted,onOnTaskChanged:u,onOnNACreated:n,onOnDefectView:R,onOnInitLoadingIndicator:b,onOnSmallCameraClicked:d,onOnImageDeleted:m,onOnImageDownloaded:f},null,8,["re-render","intervention","task","items","defect-images","current-fitter","loading-indicator","item-trigger-disabled-value","is-read-only","validation","currInputTyped","form-status","general-submitted"])):O("",!0),t.section.tasks.length<2?(s(),c("div",Hs,Gs)):O("",!0)],64))),128))]),_:1},8,["title","name"])]),_:1},8,["modelValue"])])])}}}),Ks={class:"py-2 ps-0 pe-2 w-100"},Ws={class:"d-flex align-items-center"},zs={class:"flex-fill large-camera-container"},Js={class:"ms-2"},Ys={key:0,class:"d-flex justify-content-center ms-2"},Qs={class:"text-white"},Xs=oe({__name:"DefectCamera",props:{task:{type:Object,required:!0},type:{type:String,required:!0},allowDelete:{type:Boolean,required:!0,default:!1},disabled:{type:Boolean,required:!0,default:!1},defectImages:{type:Array,required:!0},reRender:{type:Boolean,default:!1},isMonitoring:{type:Boolean,default:!1},generatedID:{required:!1,type:String,default:""},hasSubmitted:{type:Boolean,default:!1}},emits:["onCameraClicked","onImageDownloaded","onImageDelete"],setup(t,{expose:v,emit:a}){const o=t,r=a,u=A(!1),d=ke(()=>o.defectImages.length),m=ke(()=>o.defectImages??[]),f=ke(()=>o.disabled?"disabled":""),n=ke(()=>o.disabled?"not-allowed":"allowed"),R=ke(()=>(d.value??0)>0||!o.hasSubmitted?"mandatory-label":"mandatory-label error"),b=()=>{if(o.disabled)return;const h={};h.type="defect",h.key=o.generatedID!=""?o.generatedID:o.task.key,r("onCameraClicked",h)},_=()=>{u.value=!0},g=()=>{u.value=!1},y=async h=>{r("onImageDelete",h)},T=h=>{r("onImageDownloaded",h)};return v({handleClickCamera:b,handleHideModal:g}),(h,D)=>{const S=E("NwImg");return s(),c(W,null,[e("div",Ks,[e("div",Ws,[e("div",{class:X(["d-flex w-100 align-items-center camera-wrapper py-2",Z(f)])},[e("div",zs,[e("span",{class:X(Z(R))},H(`Please take a photo of the ${t.type} identified`),3)]),e("div",Js,[e("div",{class:X(["p-2 justify-items-center rounded",Z(n)]),style:{background:"#F4F6F8"},onClick:b},[Z(d)>0&&Z(n)!="not-allowed"?(s(),J(S,{key:0,src:"/media/svg/dma/camera/e-form/png/cam-user.png",style:{height:"20px",width:"24px"},class:X(Z(n)),alt:"camera"},null,8,["class"])):Z(n)=="not-allowed"?(s(),J(S,{key:1,src:"/media/svg/dma/camera/e-form/png/cam-read.png",style:{height:"20px",width:"24px"},class:X(Z(n)),alt:"camera"},null,8,["class"])):(s(),J(S,{key:2,src:"/media/svg/dma/camera/e-form/png/cam-active.png",style:{height:"20px",width:"24px"},class:X(Z(n)),alt:"camera"},null,8,["class"]))],2)]),Z(d)&&Z(d)>0?(s(),c("div",Ys,[e("button",{class:"btn btn-sm btn-icon btn-bg-success lg-btn-icon",onClick:_,style:{"background-color":"#18AF4A"}},[e("label",Qs,"+"+H(Z(d)),1)])])):O("",!0)],2)])]),w(Ae,{"is-monitoring":t.isMonitoring,images:Z(m),"re-render":t.reRender,visibility:u.value,showDeleteButton:t.allowDelete,type:"defect","is-mandatory":!1,onOnClose:g,onOnDelete:y,onOnDownloaded:T},null,8,["is-monitoring","images","re-render","visibility","showDeleteButton"])],64)}}}),Qe=ue(Xs,[["__scopeId","data-v-78682d5e"]]),ge=t=>(ye("data-v-2aef3e9c"),t=t(),be(),t),Zs=ge(()=>e("span",{class:"el-dialog__title"},"Detailed Information for Defect Identification",-1)),el=["innerHTML"],tl={key:0,class:"d-flex flex-row justify-content-between"},al={class:"mb-2 w-100"},ol={class:"p-2"},sl={class:"d-flex flex-column"},ll=ge(()=>e("h4",{class:"title ps-3"},'Change Reason - "Not Applicable" ',-1)),nl={key:0,class:"mt-1 p-2"},il={class:"d-flex flex-row justify-content-between"},rl={class:"p-2 d-flex flex-row flex-grow-1"},dl={class:"flex-fill"},ul={class:"form-floating"},cl=["innerHTML"],ml=ge(()=>e("label",{for:"floatingInput"},"Asset Number",-1)),vl={class:"flex-fill ps-3"},fl={class:"form-floating"},pl=["innerHTML"],yl=ge(()=>e("label",{for:"floatingInput"},"Serial Number",-1)),bl={class:"flex-fill ps-3"},gl={class:"form-floating"},hl=["innerHTML"],_l=ge(()=>e("label",{for:"floatingInput"},"Ownership",-1)),kl={class:"d-flex flex-row justify-content-between"},$l={class:"mt-1 p-2"},wl={class:"d-flex flex-column"},Dl={class:"mt-1 p-2"},xl={class:"row",style:{width:"101%"}},Cl={class:"col-6 pe-0"},Il={class:"form-floating"},Rl=["value"],Bl=ge(()=>e("label",null,"Raised By",-1)),Tl={class:"col-6 pe-0"},Al={class:"form-floating"},Sl=["value"],Ol=ge(()=>e("label",null,"Date Raised",-1)),Vl=ge(()=>e("div",{class:"mt-2"},null,-1)),Pl={class:"d-flex flex-fill flex-column"},Nl={class:"mt-2"},Ll=oe({__name:"DefectNoView",props:{visibility:{required:!0,type:Boolean},task:{type:Object,required:!0},data:{required:!0,type:Object},reRender:{type:Boolean,default:!1},isMonitoring:{type:Boolean,default:!1},ownership:{type:String,default:""},serialNumber:{type:String,default:""},generic:{required:!1,type:Boolean,default:!1},naReasonOptions:{required:!0,type:Array}},emits:["onClose","onImageDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=A("Repairs Completed"),u=ie(a,"visibility"),d=ie(a,"data"),m=A(),f=A(Ye()),n=i(()=>{let S="";return a.task.reason&&(S=a.task.reason),S}),R=i(()=>n.value.split(":")[0]),b=i(()=>n.value.split(":")[0].includes("Other")),_=i(()=>n.value.split(":")[1]),g=async()=>{o("onClose",null)},y=()=>{try{Pe(m.value),pt(f.value)}catch(S){console.log(S)}},T=S=>{o("onImageDownloaded",S)},h=i(()=>{const S=a.ownership;return Je(S)}),D=i(()=>{var S,M;return a.generic?(S=d.value)==null?void 0:S.title:Ve((M=d.value)==null?void 0:M.title,!0)});return(S,M)=>{const p=E("el-option"),x=E("el-select"),I=E("el-collapse-item"),K=E("el-collapse"),P=E("el-dialog");return s(),J(P,{modelValue:u.value,"onUpdate:modelValue":M[2]||(M[2]=$=>u.value=$),width:"90%",center:"",onClosed:g,onOpened:y,"destroy-on-close":!0,"custom-class":`el-defect-crack-form-custom form-defect-no-intervention-view ${f.value}`},{title:q(()=>[Zs,e("span",{class:"el-dialog__title task-title",innerHTML:D.value,ref_key:"defectDetailRef",ref:m},null,8,el)]),default:q(()=>[n.value!=""?(s(),c("div",tl,[e("div",al,[e("div",ol,[e("div",sl,[ll,w(x,{modelValue:R.value,"onUpdate:modelValue":M[0]||(M[0]=$=>R.value=$),disabled:!0,class:"w-100"},{default:q(()=>[(s(!0),c(W,null,le(t.naReasonOptions,$=>(s(),J(p,{key:$.id,label:$.reviseNaCondition,value:$.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),b.value?(s(),c("div",nl,[w(ve,{value:_.value,label:"Description <span class='red'>*</span>",name:"Description",placeholder:"Write Reason",disabled:!0},null,8,["value"])])):O("",!0)])])):O("",!0),e("div",il,[e("div",rl,[e("div",dl,[e("div",ul,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:d.value.assetNumber},null,8,cl),ml])]),e("div",vl,[e("div",fl,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:t.serialNumber},null,8,pl),yl])]),e("div",bl,[e("div",gl,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:h.value},null,8,hl),_l])])])]),e("div",kl,[w(Qe,{"is-monitoring":t.isMonitoring,"re-render":t.reRender,task:t.task,"defect-images":t.data.images?JSON.parse(t.data.images):[],"show-delete-button":!1,type:"defect",disabled:!0,"allow-delete":!1,onOnImageDownloaded:T},null,8,["is-monitoring","re-render","task","defect-images"])]),e("div",$l,[e("div",wl,[w(ve,{value:d.value.description,label:"Defect Identified Description",name:"DefectIdentifiedDescription",disabled:!0},null,8,["value"])])]),e("div",Dl,[e("div",xl,[e("div",Cl,[e("div",Il,[e("input",{type:"text",class:"form-control",disabled:"",value:d.value.raisedBy},null,8,Rl),Bl])]),e("div",Tl,[e("div",Al,[e("input",{type:"text",class:"form-control",disabled:"",value:d.value.date},null,8,Sl),Ol])])])]),Vl,w(K,{class:"task-group general-accordion py-1 px-5",modelValue:r.value,"onUpdate:modelValue":M[1]||(M[1]=$=>r.value=$)},{default:q(()=>[w(I,{title:"Repairs Completed",name:"Repairs Completed"},{default:q(()=>{var $;return[(s(!0),c(W,null,le(JSON.parse(($=d.value)==null?void 0:$.actions),j=>(s(),c("div",{class:"p-2 d-flex",key:j},[e("div",Pl,[e("div",Nl,[w(ve,{value:j,label:"Description of Repairs Completed",name:"DescriptionofRepairsCompleted",disabled:!0},null,8,["value"])])])]))),128))]}),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","custom-class"])}}}),xd=ue(Ll,[["__scopeId","data-v-2aef3e9c"]]),Ul=["disabled"],jl=["src"],ql={key:0,class:"col-6 p-0 d-flex justify-content-center text-nowrap"},Fl={class:"text-white"},Ml=oe({__name:"SmallCamera",props:{itemValue:{required:!0,type:Object},index:{requied:!0,type:Number},isDisabled:{required:!1,type:Boolean,defauly:!1},isMonitoring:{type:Boolean,default:!1},mode:{default:""}},emits:["onCameraClicked","onImageDownloaded","onImageDelete"],setup(t,{emit:v}){const a=A(!1),o=t,r=v,u=ie(o,"itemValue"),d=A(!1),m=i(()=>u.value?we(u.value):[]),f=()=>{r("onCameraClicked",{type:o.mode?`parts-${o.mode}`:"parts",key:`${o.index}-parts`})},n=async T=>{r("onImageDelete",T),d.value=!d.value},R=T=>{r("onImageDownloaded",T)},b=()=>{let T="/media/svg/dma/camera/e-form/png/cam-active.png";return m.value.length>0&&(T="/media/svg/dma/camera/e-form/png/cam-user.png"),T},_=()=>{a.value=!0},g=()=>{a.value=!1},y=i(()=>o.isDisabled?o.isDisabled:!1);return(T,h)=>(s(),c(W,null,[e("div",{class:X(["row m-0 p-0",!Z(C.isUndefined)(u.value)&&u.value.length>0?"justify-content-around":"justify-content-center"])},[e("div",{class:X(["d-flex justify-content-center",!Z(C.isUndefined)(u.value)&&u.value.length>0?"col-6 pe-0 ps-1":"col-6 px-0"])},[e("button",{class:"btn btn-sm btn-icon btn-bg-light",disabled:y.value,onClick:f},[e("img",{src:b(),style:{height:"12px",width:"14px"},alt:"camera"},null,8,jl)],8,Ul)],2),m.value&&m.value.length>0?(s(),c("div",ql,[e("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:_,style:{"background-color":"#18AF4A"}},[e("label",Fl,"+"+H(m.value.length),1)])])):O("",!0)],2),w(Ae,{index:t.index,"is-monitoring":t.isMonitoring,images:m.value,"re-render":d.value,visibility:a.value,showDeleteButton:!(t.isDisabled||t.isMonitoring),type:"parts","is-mandatory":!1,onOnClose:g,onOnDelete:n,onOnDownloaded:R},null,8,["index","is-monitoring","images","re-render","visibility","showDeleteButton"])],64))}}),Xe=t=>(ye("data-v-c1edff00"),t=t(),be(),t),Hl={class:"d-flex"},El=["onClick"],Gl=Xe(()=>e("img",{src:yt,alt:"pdf",class:"d-icon pdf",style:{"vertical-align":"-1px",width:"13px"}},null,-1)),Kl=[Gl],Wl=["onClick"],zl={style:{"white-space":"pre-wrap"},class:"pdf"},Jl=["onClick"],Yl=Xe(()=>e("img",{src:bt,alt:"close",class:"d-icon pdf",style:{"vertical-align":"-2px",width:"15px"}},null,-1)),Ql=[Yl],Xl=oe({__name:"AttachmentPreview",props:{visibility:{type:Boolean,required:!1},files:{type:Array,required:!0},showDeleteButton:{type:Boolean,required:!0,default:!0},isMonitoring:{type:Boolean,default:!1}},emits:["onClose","onDelete","onDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=A(!1),u=A(""),d=()=>{r.value=!1},m=ie(a,"files"),f=ie(a,"visibility"),n=A(!1),R=A(""),b=i(()=>{let D=!1;return a.showDeleteButton&&(D=!0),a.isMonitoring&&(D=!1),D}),_=D=>{u.value=D,r.value=!0},g=()=>{f.value=!1,o("onClose")},y=D=>{n.value=!0,R.value=D},T=()=>{n.value=!1},h=()=>{n.value=!1;const D=C.cloneDeep(m.value).filter(S=>S.url!=R.value);o("onDelete",R.value),D.length==0&&g(),R.value=""};return(D,S)=>{const M=E("el-dialog");return s(),c(W,null,[w(M,{modelValue:f.value,"onUpdate:modelValue":S[0]||(S[0]=p=>f.value=p),title:"Detailed Document",width:"80%","custom-class":"el-defect-crack-form-custom multi-defect-list-dialog",onClose:g},{default:q(()=>[(s(!0),c(W,null,le(t.files,p=>(s(),c("div",{class:"multi-defect-list-item py-2 d-flex align-items-center justify-content-between",key:p.filename},[e("div",Hl,[e("div",{class:"multi-icon cursor-pointer",onClick:x=>_(p.url)},Kl,8,El),e("div",{class:"multi-description cursor-pointer",onClick:x=>_(p.url)},[e("span",zl,H(p.filename),1)],8,Wl)]),b.value?(s(),c("div",{key:0,class:"multi-icon cursor-pointer",onClick:x=>y(p.url)},Ql,8,Jl)):O("",!0)]))),128))]),_:1},8,["modelValue"]),w(ze,{visibility:n.value,caption:"Are you sure want to delete this PDF?",onOnNoConfirm:T,onOnYesConfirm:h},null,8,["visibility"]),w(gt,{show:r.value,onHandleCloseModal:d,"blob-url":u.value},null,8,["show","blob-url"])],64)}}}),Zl=ue(Xl,[["__scopeId","data-v-c1edff00"]]),en=["disabled"],tn=["src"],an={key:0,class:"col-6 ps-0 pe-1 d-flex justify-content-center"},on={class:"text-white"},sn=oe({__name:"UploadAttachment",props:{itemValue:{required:!0,type:Object},index:{requied:!0,type:Number},isDisabled:{required:!1,type:Boolean,defauly:!1},mode:{default:""}},emits:["onAttachmentClicked","onAttachmentDelete"],setup(t,{emit:v}){const a=t,o=v,r=A(!1),u=()=>{o("onAttachmentClicked",{key:`${a.index}-parts`,mode:a.mode})},d=_=>{o("onAttachmentDelete",{index:a.index,filename:_})},m=()=>{let _="/media/svg/dma/attachment/blue.png";return a.itemValue.length>0&&(_="/media/svg/dma/attachment/green.png"),_},f=i(()=>!b.value),n=()=>{r.value=!0},R=()=>{r.value=!1},b=i(()=>a.isDisabled?a.isDisabled:!1);return(_,g)=>(s(),c("div",null,[e("div",{class:X(["row m-0",!Z(C.isUndefined)(t.itemValue)&&t.itemValue.length>0?"justify-content-around":"justify-content-center"])},[e("div",{class:X(["d-flex justify-content-center",!Z(C.isUndefined)(t.itemValue)&&t.itemValue.length>0?"col-6 pe-0 ps-1":"col-6 px-0"])},[e("button",{class:"btn btn-sm btn-icon btn-bg-light",disabled:b.value,onClick:u},[e("img",{src:m(),style:{height:"12px",width:"14px"},alt:"camera"},null,8,tn)],8,en)],2),t.itemValue&&t.itemValue.length>0?(s(),c("div",an,[e("button",{class:"btn btn-sm btn-icon btn-bg-success",onClick:n,style:{"background-color":"#18AF4A"}},[e("label",on,"+"+H(t.itemValue.length),1)])])):O("",!0)],2),w(Zl,{visibility:r.value,files:t.itemValue,"is-monitoring":!f.value,"show-delete-button":f.value,onOnClose:R,onOnDelete:d},null,8,["visibility","files","is-monitoring","show-delete-button"])]))}}),ee=t=>(ye("data-v-6b0f23b6"),t=t(),be(),t),ln={class:"el-dialog__title"},nn={key:0,class:"red-bg text-dark-red p-1"},rn={key:1,class:"status-badge-dialog-header approved-badge p-1"},dn=["innerHTML"],un={key:0,class:"d-flex flex-row justify-content-between"},cn={class:"mb-2 w-100"},mn={class:"p-2"},vn={class:"d-flex flex-column"},fn=ee(()=>e("h4",{class:"title ps-3"},'Change Reason - "Not Applicable" ',-1)),pn={key:0,class:"mt-1 p-2"},yn={key:0,class:"mt-1 py-2"},bn={class:"d-flex flex-column"},gn={class:"row mb-1"},hn={class:"col"},_n={class:"form-floating declined-text-box"},kn={class:"form-control"},$n=ee(()=>e("label",null,"Declined Reason*",-1)),wn={key:0,class:"mb-2 text-end"},Dn={key:1,class:"mt-1 py-2"},xn={class:"row mb-1"},Cn={class:"col"},In={key:0,class:"form-floating approved-text-box"},Rn={class:"form-control",style:{"white-space":"break-spaces"}},Bn=ee(()=>e("label",null,"Approved",-1)),Tn={class:"d-flex flex-row justify-content-between"},An={class:"p-2 d-flex flex-row flex-grow-1"},Sn={class:"flex-fill"},On={class:"form-floating"},Vn=["innerHTML"],Pn=ee(()=>e("label",{for:"floatingInput"},"Asset Number",-1)),Nn={class:"flex-fill ps-3"},Ln={class:"form-floating"},Un=["innerHTML"],jn=ee(()=>e("label",{for:"floatingInput"},"Serial Number",-1)),qn={class:"flex-fill ps-3"},Fn={class:"form-floating"},Mn=["innerHTML"],Hn=ee(()=>e("label",{for:"floatingInput"},"Ownership",-1)),En={class:"d-flex flex-row justify-content-between"},Gn={class:"mt-1 p-2"},Kn={class:"mt-1 p-2"},Wn={class:"row"},zn={class:"col pe-0"},Jn={class:"form-floating"},Yn=["value"],Qn=ee(()=>e("label",null,"Raised By",-1)),Xn={class:"mt-1 p-2"},Zn={class:"row"},ei={class:"col-4 pe-0 date"},ti={class:"form-floating"},ai=["value"],oi=ee(()=>e("label",null,"Date Raised",-1)),si={class:"col pe-0 d-flex"},li={class:"d-flex flex-column flex-fill"},ni={class:"form-floating"},ii=["value"],ri=ee(()=>e("label",{class:"text-nowrap"},"How long will this defect repair take?",-1)),di={class:"ms-2 d-flex align-items-center"},ui={class:"mt-1 p-2"},ci=ee(()=>e("div",{class:"mt-2"},null,-1)),mi=ee(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-3"},"Priority"),e("div",{class:"col-6"},"Action"),e("div",{class:"col-3 text-break"},"Person Responsible")],-1)),vi={class:"row p-3 m-1 priority-container"},fi={class:"col-3"},pi={class:"form-check"},yi=ee(()=>e("label",{class:"form-check-label text-nowrap"}," (P1) Immediate ",-1)),bi=ee(()=>e("div",{class:"col-6"},"Shall shut machine down and undertake repairs.",-1)),gi=ee(()=>e("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),hi={class:"row p-3 m-1 priority-container"},_i={class:"col-3"},ki={class:"form-check"},$i=ee(()=>e("label",{class:"form-check-label text-nowrap"}," (P2) Urgent ",-1)),wi=ee(()=>e("div",{class:"col-6"},"Shall complete within 7 days.",-1)),Di=ee(()=>e("div",{class:"col-3 text-break"},"Maintenance Supervisor",-1)),xi={class:"row p-3 m-1 priority-container"},Ci={class:"col-3"},Ii={class:"form-check"},Ri=ee(()=>e("label",{class:"form-check-label text-nowrap"}," (P3) Routine ",-1)),Bi=ee(()=>e("div",{class:"col-6"},"Shall complete within 60 days.",-1)),Ti=ee(()=>e("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),Ai={class:"row p-3 m-1 priority-container"},Si={class:"col-3"},Oi={class:"form-check"},Vi=ee(()=>e("label",{class:"form-check-label text-nowrap"}," (P4) Monitor ",-1)),Pi=ee(()=>e("div",{class:"col-6"},"Shall continue to inspect and monitor for 90 days.",-1)),Ni=ee(()=>e("div",{class:"col-3 text-break"},"Maintenance Planner",-1)),Li=ee(()=>e("div",{class:"mt-2"},null,-1)),Ui=ee(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-3"},"Part Number"),e("div",{class:"col-5"},"Part Description"),e("div",{class:"col-1"},"Qty"),e("div",{class:"col"}),e("div",{class:"col"})],-1)),ji={class:"col-3 px-0"},qi={class:"d-flex flex-column"},Fi=["value"],Mi={class:"col-5"},Hi={class:"d-flex flex-column"},Ei=["value"],Gi={class:"col-1 px-1 d-flex justify-content-start"},Ki={class:"d-flex flex-column"},Wi=["value"],zi=ee(()=>e("div",{class:"ms-4 d-flex align-items-center"},null,-1)),Ji={class:"col px-1 d-flex flex-column justify-content-start"},Yi={class:"row p-0 m-0 h-100 w-100 align-items-center"},Qi={class:"col px-1 d-flex flex-column justify-content-start position-relative"},Xi={class:"row p-0 m-0 h-100 w-100 align-items-center"},Zi=ee(()=>e("div",{class:"mt-2"},null,-1)),er=ee(()=>e("div",{class:"row p-3 m-1 priority-container",style:{background:"#F4F6F8","border-radius":"8px"}},[e("div",{class:"col-6"},"Labour Activity"),e("div",{class:"col-2"},"Qty"),e("div",{class:"col-2 word-breaker"},"Hours Each"),e("div",{class:"col-2 word-breaker"},"Total Hours")],-1)),tr={class:"col-6 px-0"},ar={class:"d-flex flex-column"},or={class:"form-select","aria-label":"Disabled select example",disabled:""},sr={selected:""},lr={class:"col-2 d-flex justify-content-start"},nr={class:"d-flex flex-column"},ir=["value"],rr={class:"col-2 d-flex justify-content-start"},dr={class:"d-flex flex-column"},ur=["value"],cr={class:"col-2 d-flex justify-content-start"},mr={class:"d-flex flex-column"},vr=["value"],fr=ee(()=>e("div",{class:"mt-2"},null,-1)),pr={class:"d-flex flex-fill flex-column"},yr=["value"],br=ee(()=>e("div",{class:"ms-4 d-flex align-items-center"},null,-1)),gr=ee(()=>e("div",{class:"mt-2"},null,-1)),hr={class:"d-flex flex-fill flex-column"},_r={key:0,class:"mt-2"},kr=ee(()=>e("div",{class:"mt-2"},null,-1)),$r={class:"d-flex flex-fill flex-column"},wr={key:0,class:"mt-2"},Dr=oe({__name:"DefectYesView",props:{visibility:{required:!0,type:Boolean},task:{type:Object,required:!0},data:{required:!0,type:Object},positions:{type:Array},symptomOptions:{type:Array},causeOptions:{type:Array},reRender:{type:Boolean,default:!1},decline:{type:Object},isMonitoring:{type:Boolean,default:!1},ownership:{type:String,default:""},serialNumber:{type:String,default:""},approvedDate:{required:!1,type:String,default:""},approvedBy:{required:!1,type:Object,default:{}},naReasonOptions:{required:!0,type:Array}},emits:["onClose","onImageDownloaded"],setup(t,{emit:v}){const a=t,o=v,r=A("Priority"),u=A("Parts Required"),d=A("Labour Required"),m=A("Other Resources Required (optional)"),f=A("Defect Symptom"),n=A("Defect Cause"),R=ie(a,"visibility"),b=ie(a,"data"),_=A(),g=A(Ye()),y=i(()=>a.data.images?JSON.parse(a.data.images):[]),T=i(()=>JSON.parse(b.value.parts)),h=i(()=>JSON.parse(b.value.labours)),D=i(()=>JSON.parse(b.value.resources).map(l=>l)),S=i(()=>JSON.parse(b.value.symptoms).map(l=>l)),M=i(()=>JSON.parse(b.value.causes).map(l=>l)),p=i(()=>{let B="";return a.task.reason&&(B=a.task.reason),B}),x=i(()=>p.value.split(":")[0]),I=i(()=>p.value.split(":")[0].includes("Other")),K=i(()=>p.value.split(":")[1]),P=async()=>{o("onClose")},$=()=>{Pe(_.value)},j=B=>{o("onImageDownloaded",B)},te=i(()=>{const B=a.ownership;return Je(B)});return(B,l)=>{const k=E("el-option"),Y=E("el-select"),se=E("Label"),Q=E("el-collapse-item"),z=E("el-collapse"),N=E("el-dialog");return s(),J(N,{modelValue:R.value,"onUpdate:modelValue":l[11]||(l[11]=F=>R.value=F),width:"90%",center:"",onClosed:P,onOpened:$,"destroy-on-close":!0,"custom-class":`el-defect-crack-form-custom form-defect-yes-intervention-view ${g.value}`},{title:q(()=>{var F,L;return[e("span",ln,[pe("Detailed Information for Defect Identification "),(F=t.decline)!=null&&F.isDecline?(s(),c("span",nn,"Declined")):t.approvedBy&&t.approvedDate?(s(),c("span",rn,"Approved")):O("",!0)]),e("span",{class:"el-dialog__title task-title",innerHTML:Z(Ve)((L=b.value)==null?void 0:L.title,!0),ref_key:"defectDetailRef",ref:_},null,8,dn)]}),default:q(()=>{var F,L,V,G,ae,ne,fe,de;return[p.value!=""?(s(),c("div",un,[e("div",cn,[e("div",mn,[e("div",vn,[fn,w(Y,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=U=>x.value=U),disabled:!0,class:"w-100"},{default:q(()=>[(s(!0),c(W,null,le(t.naReasonOptions,U=>(s(),J(k,{key:U.id,label:U.reviseNaCondition,value:U.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),I.value?(s(),c("div",pn,[w(ve,{value:K.value,label:"Description <span class='red'>*</span>",name:"Description",placeholder:"Write Reason",disabled:!0},null,8,["value"])])):O("",!0)])])):O("",!0),e("div",null,[(F=t.decline)!=null&&F.isDecline?(s(),c("div",yn,[e("div",bn,[e("div",gn,[e("div",hn,[e("div",_n,[e("div",kn,H((L=t.decline)==null?void 0:L.declineReason),1),$n])])]),t.decline&&t.decline.declineBy&&t.decline.declineDate?(s(),c("div",wn,H(t.decline.declineBy.name)+", "+H(t.decline.declineDate),1)):O("",!0)])])):t.approvedBy&&t.approvedDate?(s(),c("div",Dn,[e("div",xn,[e("div",Cn,[t.approvedBy&&t.approvedDate?(s(),c("div",In,[e("div",Rn,H(t.approvedDate)+"  "+H(t.approvedBy.name),1),Bn])):O("",!0)])])])):O("",!0),e("div",Tn,[e("div",An,[e("div",Sn,[e("div",On,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:(V=b.value)==null?void 0:V.assetNumber},null,8,Vn),Pn])]),e("div",Nn,[e("div",Ln,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:t.serialNumber},null,8,Un),jn])]),e("div",qn,[e("div",Fn,[e("div",{type:"text",class:"form-control asset-number-disabled-div",innerHTML:te.value},null,8,Mn),Hn])])])]),e("div",En,[w(Qe,{task:t.task,"is-monitoring":t.isMonitoring,"re-render":t.reRender,"defect-images":y.value,"show-delete-button":!1,type:"defect",disabled:!0,"allow-delete":!1,onOnImageDownloaded:j},null,8,["task","is-monitoring","re-render","defect-images"])]),e("div",Gn,[w(ve,{value:(G=b.value)==null?void 0:G.description,label:"Defect Identified Description",name:"DefectIdentifiedDescription",disabled:!0},null,8,["value"])]),e("div",Kn,[e("div",Wn,[e("div",zn,[e("div",Jn,[e("input",{type:"text",class:"form-control",disabled:"",value:(ae=b.value)==null?void 0:ae.raisedBy},null,8,Yn),Qn])])])]),e("div",Xn,[e("div",Zn,[e("div",ei,[e("div",ti,[e("input",{type:"text",class:"form-control",disabled:"",value:(ne=b.value)==null?void 0:ne.date},null,8,ai),oi])]),e("div",si,[e("div",li,[e("div",ni,[e("input",{type:"text",class:"form-control",value:Z($e)((fe=b.value)==null?void 0:fe.plannedDuration),disabled:""},null,8,ii),ri])]),e("div",di,[w(se,null,{default:q(()=>[pe("Hours")]),_:1})])])])]),e("div",ui,[w(ve,{value:(de=b.value)==null?void 0:de.instruction,label:"Defect Identified instruction",name:"DefectIdentifiedInstruction",disabled:!0},null,8,["value"])]),ci,w(z,{class:"task-group general-accordion py-1 px-5",modelValue:r.value,"onUpdate:modelValue":l[5]||(l[5]=U=>r.value=U)},{default:q(()=>[w(Q,{title:"Priority",name:"Priority"},{default:q(()=>[mi,e("div",vi,[e("div",fi,[e("div",pi,[xe(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":l[1]||(l[1]=U=>b.value.priority=U),value:"P1",disabled:""},null,512),[[Ce,b.value.priority]]),yi])]),bi,gi]),e("div",hi,[e("div",_i,[e("div",ki,[xe(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":l[2]||(l[2]=U=>b.value.priority=U),value:"P2",disabled:""},null,512),[[Ce,b.value.priority]]),$i])]),wi,Di]),e("div",xi,[e("div",Ci,[e("div",Ii,[xe(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":l[3]||(l[3]=U=>b.value.priority=U),value:"P3",disabled:""},null,512),[[Ce,b.value.priority]]),Ri])]),Bi,Ti]),e("div",Ai,[e("div",Si,[e("div",Oi,[xe(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":l[4]||(l[4]=U=>b.value.priority=U),value:"P4",disabled:""},null,512),[[Ce,b.value.priority]]),Vi])]),Pi,Ni])]),_:1})]),_:1},8,["modelValue"]),Li,w(z,{class:"task-group general-accordion py-1 px-5",modelValue:u.value,"onUpdate:modelValue":l[6]||(l[6]=U=>u.value=U)},{default:q(()=>[w(Q,{title:"Parts Required",name:"Parts Required"},{default:q(()=>[Ui,(s(!0),c(W,null,le(T.value,U=>(s(),c("div",{class:"row p-3 m-1 priority-container px-0",key:U.partNumber},[e("div",ji,[e("div",qi,[e("input",{type:"text",class:"form-control",value:U.partNumber,disabled:""},null,8,Fi)])]),e("div",Mi,[e("div",Hi,[e("input",{type:"text",class:"form-control",value:U.partDescription,disabled:""},null,8,Ei)])]),e("div",Gi,[e("div",Ki,[e("input",{class:"form-control",value:Z($e)(U.qty),disabled:""},null,8,Wi)]),zi]),e("div",Ji,[e("div",Yi,[w(Ml,{"item-value":U.images||[],"is-disabled":!0},null,8,["item-value"])])]),e("div",Qi,[e("div",Xi,[w(sn,{"item-value":U.attachment||[],"is-disabled":!0},null,8,["item-value"])])])]))),128))]),_:1})]),_:1},8,["modelValue"]),Zi,w(z,{class:"task-group general-accordion py-1 px-5",modelValue:d.value,"onUpdate:modelValue":l[7]||(l[7]=U=>d.value=U)},{default:q(()=>[w(Q,{title:"Labour Required",name:"Labour Required"},{default:q(()=>[er,(s(!0),c(W,null,le(h.value,U=>(s(),c("div",{class:"row p-3 m-1 priority-container ps-0",key:U.position},[e("div",tr,[e("div",ar,[e("select",or,[e("option",sr,H(U.position),1)])])]),e("div",lr,[e("div",nr,[e("input",{class:"form-control",value:Z($e)(U.qty),disabled:""},null,8,ir)])]),e("div",rr,[e("div",dr,[e("input",{class:"form-control",value:Z($e)(U.hireEach),disabled:""},null,8,ur)])]),e("div",cr,[e("div",mr,[e("input",{class:"form-control",value:Z($e)(U.totalHours),disabled:""},null,8,vr)])])]))),128))]),_:1})]),_:1},8,["modelValue"]),fr,w(z,{class:"task-group general-accordion py-1 px-5",modelValue:m.value,"onUpdate:modelValue":l[8]||(l[8]=U=>m.value=U)},{default:q(()=>[w(Q,{title:"Other Resources Required (optional)",name:"Other Resources Required (optional)"},{default:q(()=>[(s(!0),c(W,null,le(D.value,U=>(s(),c("div",{class:"p-2 d-flex",key:U},[e("div",pr,[e("input",{type:"text",class:"form-control",value:U,placeholder:"Resource1",disabled:""},null,8,yr)]),br]))),128))]),_:1})]),_:1},8,["modelValue"]),gr,w(z,{class:"task-group general-accordion py-1 px-5",modelValue:f.value,"onUpdate:modelValue":l[9]||(l[9]=U=>f.value=U)},{default:q(()=>[w(Q,{title:"Defect Symptom",name:"Defect Symptom"},{default:q(()=>[(s(!0),c(W,null,le(S.value,U=>(s(),c("div",{class:"p-2 d-flex",key:U},[e("div",hr,[w(Y,{modelValue:U.split(":")[0],"onUpdate:modelValue":he=>U.split(":")[0]=he,disabled:!0,class:"w-100"},{default:q(()=>[(s(!0),c(W,null,le(t.symptomOptions,he=>(s(),J(k,{key:he.id,label:U.split(":")[0],value:U.split(":")[0]},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),U.includes("Other")?(s(),c("div",_r,[w(ve,{value:Z(Ee)(U),label:"Description",name:"Description",disabled:!0},null,8,["value"])])):O("",!0)])]))),128))]),_:1})]),_:1},8,["modelValue"]),kr,w(z,{class:"task-group general-accordion py-1 px-5",modelValue:n.value,"onUpdate:modelValue":l[10]||(l[10]=U=>n.value=U)},{default:q(()=>[w(Q,{title:"Defect Cause",name:"Defect Cause"},{default:q(()=>[(s(!0),c(W,null,le(M.value,U=>(s(),c("div",{class:"p-2 d-flex",key:U},[e("div",$r,[w(Y,{modelValue:U.split(":")[0],"onUpdate:modelValue":he=>U.split(":")[0]=he,disabled:"",class:"w-100"},{default:q(()=>[w(k,{label:U.split(":")[0],value:U.split(":")[0]},null,8,["label","value"])]),_:2},1032,["modelValue","onUpdate:modelValue"]),U.includes("Other")?(s(),c("div",wr,[w(ve,{value:Z(Ee)(U),label:"Description",name:"Description",disabled:!0},null,8,["value"])])):O("",!0)])]))),128))]),_:1})]),_:1},8,["modelValue"])])]}),_:1},8,["modelValue","custom-class"])}}}),Cd=ue(Dr,[["__scopeId","data-v-6b0f23b6"]]),Le=t=>(ye("data-v-fa9c580e"),t=t(),be(),t),xr={class:"el-dialog__title"},Cr={key:0,class:"status-badge-dialog-header approved-badge p-1"},Ir={key:1,class:"status-badge-dialog-header declined-badge p-1"},Rr=["innerHTML"],Br={class:"mt-1 p-2"},Tr={class:"d-flex flex-column"},Ar=Le(()=>e("h4",{class:"title ps-3"},"Reason",-1)),Sr={key:0,class:"mt-1 p-2"},Or={key:1,class:"mt-1 py-2"},Vr={class:"row mb-1"},Pr={class:"col"},Nr=Le(()=>e("div",{class:"form-floating approved-text-box"},[e("div",{class:"form-control",style:{"white-space":"break-spaces"}},"This information has been approved"),e("label",null,"Confirmed")],-1)),Lr={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},Ur={key:2,class:"mt-1 py-2"},jr={class:"row mb-1"},qr={class:"col"},Fr={class:"form-floating declined-text-box"},Mr={class:"form-control",style:{"white-space":"break-spaces"}},Hr=Le(()=>e("label",null,"Declined",-1)),Er={key:0,class:"mb-2 text-end status-description-text-box-timestamp"},Gr=oe({__name:"NAView",props:{visibility:{required:!0,type:Boolean},data:{required:!0,type:Object},approvedBy:{required:!1,type:Object,default:{}},approvedDate:{required:!1,type:String,default:""},declineData:{required:!1,type:Object,default:{}},status:{required:!1,type:String},conditions:{type:Array}},emits:["onClose"],setup(t,{emit:v}){const a=t,o=v,r=A(null),u=ie(a,"visibility"),d=i(()=>a.data),m=i(()=>d.value&&d.value.reason&&d.value.reason.split(":")[0].includes("Other")),f=i(()=>d.value&&d.value.reason&&d.value.reason.split(":")[0]),n=i(()=>{var y;const g=(y=d.value.reason)==null?void 0:y.split(":");return g.length>=2?g.slice(1).join(":"):""}),R=async()=>{o("onClose",null)},b=()=>{Pe(r.value)},_=i(()=>d.value&&d.value.title?d.value.title.split(";")[2]:"");return(g,y)=>{const T=E("el-option"),h=E("el-select"),D=E("el-dialog");return s(),J(D,{modelValue:u.value,"onUpdate:modelValue":y[1]||(y[1]=S=>u.value=S),width:"90%",center:"",onOpened:b,onClosed:R,"destroy-on-close":!0,"custom-class":"el-defect-crack-form-custom"},{title:q(()=>[e("span",xr,[pe("Not Applicable "),t.status=="Confirmed"?(s(),c("span",Cr,"Confirmed")):t.status=="Decline"?(s(),c("span",Ir,"Declined")):O("",!0)]),e("span",{class:"el-dialog__title task-title",innerHTML:Z(Ve)(_.value,!0),ref_key:"defectDetailRef",ref:r},null,8,Rr)]),default:q(()=>[e("div",Br,[e("div",Tr,[Ar,w(h,{modelValue:f.value,"onUpdate:modelValue":y[0]||(y[0]=S=>f.value=S),disabled:!0,class:"w-100"},{default:q(()=>[(s(!0),c(W,null,le(t.conditions,S=>(s(),J(T,{key:S.id,label:S.naCondition,value:S.naCondition},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),m.value?(s(),c("div",Sr,[w(ve,{value:n.value,label:"Why not applicable item task?",name:"Reason",disabled:!0},null,8,["value"])])):O("",!0),t.status=="Confirmed"?(s(),c("div",Or,[e("div",Vr,[e("div",Pr,[Nr,t.approvedBy&&t.approvedDate?(s(),c("div",Lr,H(t.approvedBy.name)+", "+H(t.approvedDate),1)):O("",!0)])])])):t.status=="Decline"&&t.declineData?(s(),c("div",Ur,[e("div",jr,[e("div",qr,[e("div",Fr,[e("div",Mr,H(t.declineData.declineReason),1),Hr]),t.declineData.declineBy&&t.declineData.declineDate?(s(),c("div",Er,H(t.declineData.declineBy.name)+", "+H(t.declineData.declineDate),1)):O("",!0)])])])):O("",!0)]),_:1},8,["modelValue"])}}}),Id=ue(Gr,[["__scopeId","data-v-fa9c580e"]]),Rd=ht({id:"InterventionNAStore",state:()=>({stateNAData:{},stateIsBusy:!1}),getters:{NAData:t=>t.stateNAData,IsBusy:t=>t.stateIsBusy,globalConnectionStore:()=>wt()},actions:{createNAData(t){const v=Re();this.stateNAData.header={},this.stateNAData.header.workorder=v.Intervention.sapWorkOrder,this.stateNAData.header.form=v.Intervention.equipmentDesc,this.stateNAData.header.serviceSheetDetailId="",this.stateNAData.header.interventionId=v.Intervention.id,this.stateNAData.header.interventionHeaderId=v.Intervention.trInterventionHeaderId,this.stateNAData.header.category=t.task.taskCategory,this.stateNAData.header.taskId=t.task.taskKey,this.stateNAData.header.taskNo=t.taskNo,this.stateNAData.header.taskDesc=t.taskDesc,this.stateNAData.header.defectWorkorder="",this.stateNAData.header.formDefect="DM-PL-F55",this.stateNAData.header.defectType="",this.stateNAData.header.cbmMeasurement="",this.stateNAData.header.cbmUom="",this.stateNAData.header.cbmImageKey="",this.stateNAData.header.cbmImageProp="",this.stateNAData.header.isCbmAdjusment="",this.stateNAData.header.taskValue=t.task.value,this.stateNAData.header.repairedStatus="Not-Repaired",this.stateNAData.header.cbmNAStatus="Not-Confirm",this.stateNAData.header.supervisor=t.task.supervisor,this.stateNAData.header.status="Submited",this.stateNAData.header.defectStatus="Submited",this.stateNAData.detail={},this.stateNAData.detail.interventionId=t.task.id,this.stateNAData.detail.type="N/A",this.stateNAData.detail.reason=t.reasonDesc!=""?`${t.reason}:${t.reasonDesc}`:t.reason,this.stateNAData.detail.title=t.taskDesc},createNAPayload(t){const v=Re();this.createNAData(t);const a={};a.headerId=t.task.headerId,a.id=t.task.id,a.employee=t.task.employee,a.localInterventionStatus=v.Intervention.interventionExecution,a.workOrder=v.Intervention.sapWorkOrder,a.updateParams=[];const o={};return o.keyValue=t.task.taskKey,o.propertyParams=[],o.propertyParams.push({propertyName:"taskValue",propertyValue:t.task.value}),o.propertyParams.push({propertyName:"updatedBy",propertyValue:JSON.stringify(t.task.employee)}),o.propertyParams.push({propertyName:"updatedDate",propertyValue:t.submitDate}),a.updateParams.push(o),a.defectHeader=this.NAData.header,a.defectDetail=this.NAData.detail,a},async submitNA(t){ot();const v=Re(),a=_t(),o=this.createNAPayload(t);if(v.appendTaskUpdatePayload(o,t.task,!0,!1),Ge())await _e.pendingTask.add({module:"Intervention",section:"E-Form",type:"Defect",workorder:o.workOrder,key:t.task.taskKey,bindingKey:t.task.taskKey,payload:JSON.stringify(o),syncDate:He(),syncStatus:"Pending"});else{try{await a.SyncInterventionDefectData(JSON.stringify(o))}catch(r){if(this.globalConnectionStore.checkIsErrorNoNetwork(r))return await _e.pendingTask.add({module:"Intervention",section:"E-Form",type:"Defect",workorder:o.workOrder,key:t.task.taskKey,bindingKey:t.task.taskKey,payload:JSON.stringify(o),syncDate:He(),syncStatus:"Pending"}),await this.updateDefectDataAndUpdateOnLocal(o,v,t),!1;{const d=Re();return r==Ie.MODIFY_DEFECT_AFTER_SUPERVISOR_APPROVAL||r==Ie.CHANGE_NOT_APPLICABLE_WITHOUT_REASON?(d.stateTaskErrorDialog=!0,d.stateErrorMessageTaskErrorDialog=r):r==Ie.SUBMITTED?d.stateFormSubmittedDialog=!0:r==Ie.CLOSE&&(d.stateFormCloseDialog=!0),!0}}await v.updateIntervention(!0)}await this.updateDefectDataAndUpdateOnLocal(o,v,t)},async updateDefectDataAndUpdateOnLocal(t,v,a){var r,u,d,m,f,n,R,b,_,g,y,T,h,D,S,M,p,x,I,K,P,$,j,te,B,l,k,Y,se;const o=_e.interventionDefect.where({interventionId:(r=t.defectHeader)==null?void 0:r.interventionId,taskId:(u=t.defectHeader)==null?void 0:u.taskId});o&&await o.delete(),await _e.interventionDefect.put({category:(d=t.defectHeader)==null?void 0:d.category,interventionId:(m=t.defectHeader)==null?void 0:m.interventionId,taskId:(f=t.defectHeader)==null?void 0:f.taskId,taskNo:(n=t.defectHeader)==null?void 0:n.taskNo,taskDesc:(R=t.defectHeader)==null?void 0:R.taskDesc,taskValue:(b=t.defectHeader)==null?void 0:b.taskValue,sapWorkorder:t.workOrder,taskKey:(_=t.defectHeader)==null?void 0:_.taskId,type:"N/A",defectData:JSON.stringify(t.defectDetail),repairedStatus:(g=t.defectHeader)==null?void 0:g.repairedStatus,cbmNAStatus:"Not-Confirm",status:(y=t.defectHeader)==null?void 0:y.status,plannerStatus:(T=t.defectHeader)!=null&&T.plannerStatus?(h=t.defectHeader)==null?void 0:h.plannerStatus:"",declineReason:(D=t.defectHeader)!=null&&D.declineReason?(S=t.defectHeader)==null?void 0:S.declineReason:"",statusSync:status,declineDate:(M=t.defectHeader)!=null&&M.declineDate?(p=t.defectHeader)==null?void 0:p.declineDate:"",declineBy:(x=t.defectHeader)!=null&&x.declineBy?(I=t.defectHeader)==null?void 0:I.declineBy:{},createdDate:(K=t.defectHeader)!=null&&K.createdDate?(P=t.defectHeader)==null?void 0:P.createdDate:"",createdBy:($=t.defectHeader)!=null&&$.createdBy?{id:(j=t.defectHeader)==null?void 0:j.createdBy.id,name:(te=t.defectHeader)==null?void 0:te.createdBy.name}:{},updatedBy:(B=t.defectHeader)!=null&&B.updatedBy?{id:(l=t.defectHeader)==null?void 0:l.updatedBy.id,name:(k=t.defectHeader)==null?void 0:k.updatedBy.name}:{},updatedDate:(Y=t.defectHeader)!=null&&Y.updatedDate?(se=t.defectHeader)==null?void 0:se.updatedDate:""}),await v.updateLocalData(a.task)},async getNADetail(t,v,a){const o=await _e.interventionDefect.where("taskKey").equals(t).first();if(o)return o;if(!Ge()){this.stateIsBusy=!0;const r=await this.getNAHeaderFromServer(t,v),u=await this.getNADetailFromServer(t,v),d={category:r.category,interventionId:r.interventionId,taskId:r.taskId,taskNo:r.taskNo,taskDesc:r.taskDesc,taskValue:r.taskValue,sapWorkorder:a,taskKey:t,type:"N/A",defectData:JSON.stringify(u),repairedStatus:r.repairedStatus,cbmNAStatus:"Not-Confirm",status:r.status,plannerStatus:r.plannerStatus,declineReason:r.declineReason,statusSync:"Sync",declineDate:r.declineDate,declineBy:r.declineBy,createdBy:r.createdBy,createdDate:r.createdDate,updatedBy:r.updatedBy,updatedDate:r.updatedDate};return await _e.interventionDefect.put(d),this.stateIsBusy=!1,d}},async getNAHeaderFromServer(t,v){const a={interventionHeaderId:v,taskId:t,isActive:"true",isDeleted:"false"};return(await Be.post(kt,a)).data.result.content},async getNADetailFromServer(t,v){const a={interventionHeaderId:v,taskId:t,isActive:"true",isDeleted:"false"};return(await Be.post($t,a)).data.result.content.detail}}});export{kd as C,Cd as D,_d as G,Id as N,$d as _,wd as a,xd as b,Dd as c,Qe as d,Ml as e,sn as f,Rd as u};
